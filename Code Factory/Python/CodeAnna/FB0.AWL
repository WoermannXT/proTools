FUNCTION_BLOCK FB 165
TITLE =C06: CIP Line x
AUTHOR : Woermann
NAME : C06Comm
VERSION : 0.1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  CIP1 : BOOL ;	
  CIP2 : BOOL ;	
  CIP3 : BOOL ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     MB   112; 
      T     #UnitNo; 

      L     DB165.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

      L     #EquipmentID; 
      L     3091; 
      ==I   ; 
      =     #CIP1; 

      L     #EquipmentID; 
      L     3092; 
      ==I   ; 
      =     #CIP2; 

      L     #EquipmentID; 
      L     3093; 
      ==I   ; 
      =     #CIP3; 

// CIP ----------------------------------------------------------------------
      L     DB165.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB165.DBD   10; 
      L     DB165.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB165.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB165.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB165.GEN,
           RET_VAL                  := #wRetVal);


// ... ToCIP Unit ------------- /
      A     #CIP1; 
      JCN   CIP1; 
      CALL SFC   20 (
           SRCBLK                   := DB502.ToCIP1,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB165.ToCIP);
CIP1: NOP   0; 

      A     #CIP2; 
      JCN   CIP2; 
      CALL SFC   20 (
           SRCBLK                   := DB502.ToCIP2,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB165.ToCIP);
CIP2: NOP   0; 

      A     #CIP3; 
      JCN   CIP3; 
      CALL SFC   20 (
           SRCBLK                   := DB502.ToCIP3,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB165.ToCIP);
CIP3: NOP   0; 

NETWORK
TITLE =external releases

      SET   ; 
      =     DB260.DBX  106.7; 
      =     DB260.DBX  346.7; 
      =     DB260.DBX  426.7; 
      =     DB260.DBX  506.7; 
      =     DB260.DBX  586.7; 
      =     DB260.DBX  666.7; 
      =     DB260.DBX  746.7; 
      =     DB260.DBX  826.7; 
      =     DB260.DBX  906.7; 
      =     DB260.DBX  986.7; 
      =     DB260.DBX 2586.7; 
      =     DB260.DBX 2666.7; 
      =     DB260.DBX 2746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//Temperature CIP Prerun (This is done in General Post Phase Controls)
//      L     "C06ComD".ToCIP.Real03
//      T     #U.Seq.SFM[36].Sp

//Empty Signal
//A     "C06SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB165.DBX   26.5; 

//Full Signal
//A     "C06SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB165.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB165.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB165.DBX   27.0; //Emergency Stop OK

// Counter Value
      L     DB262.DBD  186; 
      T     DB165.DBD   42; 

// Conductivity CIP Return
      L     DB263.DBD  386; 
      T     DB165.DBD   54; 

// Temperature CIP Return
      L     DB263.DBD  266; 
      T     DB165.DBD   50; 

// Flow CIP Prerun
      L     DB263.DBD  506; 
      T     DB165.DBD   46; 

// Temperature CIP Prerun
      L     DB263.DBD  146; 
      T     DB165.DBD   38; 

NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 169
TITLE =C06: CIP Line x
AUTHOR : Woermann
NAME : C06Sim
VERSION : 0.1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      SET   ; 
      =     DB260.DBX  105.3; 
      =     DB260.DBX  345.3; 
      =     DB260.DBX  425.3; 
      =     DB260.DBX  505.3; 
      =     DB260.DBX  585.3; 
      =     DB260.DBX  665.3; 
      =     DB260.DBX  745.3; 
      =     DB260.DBX  825.3; 
      =     DB260.DBX  905.3; 
      =     DB260.DBX  985.3; 
      =     DB260.DBX 2585.3; 
      =     DB260.DBX 2665.3; 
      =     DB260.DBX 2745.3; 

NETWORK
TITLE =Special Input

      SET   ; 
      =     DB261.DBX   81.3; 
      =     DB261.DBX  141.3; 

      A     DB260.DBX  102.6; 
      A     M    101.3; 
      =     DB261.DBX  138.7; 

NETWORK
TITLE =Counter

      SET   ; 
//      =     "C06CntD".IDM_IMPULSE_RV_1FQI.Sim; 
      A     M    101.0; 
      =     DB262.DBX  179.1; 
      CLR   ; 
NETWORK
TITLE =Analog Input

      SET   ; 
      =     DB263.DBX  141.3; 
      =     DB263.DBX  261.3; 
      =     DB263.DBX  381.3; 
      =     DB263.DBX  501.3; 

NETWORK
TITLE =Universal Value

      SET   ; 
//      =     "C06UnVD".unv001.Sim; 
//      =     "C06UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      SET   ; 
//      =     "C06PIDD".RV1RV.Ign; 

NETWORK
TITLE =Message

      SET   ; 
//      =     "C06MsgD".msg001.Sim; 
//      =     "C06MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 175
TITLE =C07: Brunnen Transfer Plan
FAMILY : BOTEC_F1
NAME : U121Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  PartnerUNo : INT ;	//Partner Unit Number
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB170.DBW    0; 
      L     DB175.DBW   16; 
      T     #UnitNo; 

      L     DB175.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB175.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      CLR   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
//     A     "C07ComD".GEN.EStopOK       //General Emergency Stop OK
      SET   ; // Only Management
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB175.GEN,
           RET_VAL                  := #wRetVal);

// Partner
      L     #UnitNo; 
      L     100; 
      -I    ; 
      T     #PartnerUNo; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := #PartnerUNo,
           IsTUnit                  := FALSE,
           DstComDRec               := DB175.DST,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
      A     DB171.DBX   15.0; 
      A     DB171.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB175.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB171.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//Empty Signal
//A     "C07SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
//      =     "C07ComD".Own.Emty

//Full Signal
//A     "C07SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
//      =     "C07ComD".Own.Full

//CIP Program Selected
      A     #CIP; 
      =     DB175.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB175.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1015
TITLE =U001: Water Tank 1
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1010.DBW    0; 
      T     #UnitNo; 

      L     DB1015.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1015.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1015.DBD   10; 
      L     DB1015.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1015.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1011.DBX 1350.1; // Start Tank
      A     DB1011.DBX   15.0; 
      A     DB1011.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1011.DBD 1294,
           Run                      := DB1011.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1019
TITLE =U001: Water Tank 1
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1010.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1011.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1011.DBX   17.3; 
      =     DB2010.DBX  105.3; 
      =     DB2010.DBX  185.3; 
      =     DB2010.DBX  265.3; 
      =     DB2010.DBX  345.3; 
      =     DB2010.DBX  425.3; 
      =     DB2010.DBX  505.3; 
      =     DB2010.DBX  585.3; 
      =     DB2010.DBX  665.3; 
      =     DB2010.DBX  745.3; 
      =     DB2010.DBX  825.3; 
      =     DB2010.DBX  905.3; 
      =     DB2010.DBX  985.3; 
      =     DB2010.DBX 1065.3; 
      =     DB2010.DBX 1145.3; 
      =     DB2010.DBX 1225.3; 
      =     DB2010.DBX 1305.3; 
      =     DB2010.DBX 1385.3; 
      =     DB2010.DBX 1465.3; 
      =     DB2010.DBX 1545.3; 
      =     DB2010.DBX 1625.3; 
      =     DB2010.DBX 1705.3; 
      =     DB2010.DBX 1785.3; 
      =     DB2010.DBX 1865.3; 
      =     DB2010.DBX 1945.3; 
      =     DB2010.DBX 2025.3; 
      =     DB2010.DBX 2105.3; 
      =     DB2010.DBX 2185.3; 
      =     DB2010.DBX 2265.3; 
      =     DB2010.DBX 2345.3; 
      =     DB2010.DBX 2425.3; 
      =     DB2010.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1011.DBX   17.3; 
      =     DB2011.DBX   81.3; 
      =     DB2011.DBX  141.3; 
      =     DB2011.DBX  201.3; 
      =     DB2011.DBX  261.3; 
      =     DB2011.DBX  321.3; 
      =     DB2011.DBX  381.3; 
      =     DB2011.DBX  441.3; 
      =     DB2011.DBX  501.3; 
      =     DB2011.DBX  561.3; 
      =     DB2011.DBX  621.3; 
      =     DB2011.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1011.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1011.DBX   17.3; 
      =     DB2013.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1011.DBX   17.3; 
//      =     "U001UnVD".unv001.Sim; 
//      =     "U001UnVD".unv002.Sim; 
//      =     "U001UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1011.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1011.DBX   17.3; 
//      =     "U001MsgD".msg001.Sim; 
//      =     "U001MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1011.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1025
TITLE =U002: Water Tank 2
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1020.DBW    0; 
      T     #UnitNo; 

      L     DB1025.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1025.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1025.DBD   10; 
      L     DB1025.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1025.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1021.DBX 1350.1; // Start Tank
      A     DB1021.DBX   15.0; 
      A     DB1021.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1021.DBD 1294,
           Run                      := DB1021.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1029
TITLE =U002: Water Tank 2
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1020.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1021.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1021.DBX   17.3; 
      =     DB2020.DBX  105.3; 
      =     DB2020.DBX  185.3; 
      =     DB2020.DBX  265.3; 
      =     DB2020.DBX  345.3; 
      =     DB2020.DBX  425.3; 
      =     DB2020.DBX  505.3; 
      =     DB2020.DBX  585.3; 
      =     DB2020.DBX  665.3; 
      =     DB2020.DBX  745.3; 
      =     DB2020.DBX  825.3; 
      =     DB2020.DBX  905.3; 
      =     DB2020.DBX  985.3; 
      =     DB2020.DBX 1065.3; 
      =     DB2020.DBX 1145.3; 
      =     DB2020.DBX 1225.3; 
      =     DB2020.DBX 1305.3; 
      =     DB2020.DBX 1385.3; 
      =     DB2020.DBX 1465.3; 
      =     DB2020.DBX 1545.3; 
      =     DB2020.DBX 1625.3; 
      =     DB2020.DBX 1705.3; 
      =     DB2020.DBX 1785.3; 
      =     DB2020.DBX 1865.3; 
      =     DB2020.DBX 1945.3; 
      =     DB2020.DBX 2025.3; 
      =     DB2020.DBX 2105.3; 
      =     DB2020.DBX 2185.3; 
      =     DB2020.DBX 2265.3; 
      =     DB2020.DBX 2345.3; 
      =     DB2020.DBX 2425.3; 
      =     DB2020.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1021.DBX   17.3; 
      =     DB2021.DBX   81.3; 
      =     DB2021.DBX  141.3; 
      =     DB2021.DBX  201.3; 
      =     DB2021.DBX  261.3; 
      =     DB2021.DBX  321.3; 
      =     DB2021.DBX  381.3; 
      =     DB2021.DBX  441.3; 
      =     DB2021.DBX  501.3; 
      =     DB2021.DBX  561.3; 
      =     DB2021.DBX  621.3; 
      =     DB2021.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1021.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1021.DBX   17.3; 
      =     DB2023.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1021.DBX   17.3; 
//      =     "U002UnVD".unv001.Sim; 
//      =     "U002UnVD".unv002.Sim; 
//      =     "U002UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1021.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1021.DBX   17.3; 
//      =     "U002MsgD".msg001.Sim; 
//      =     "U002MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1021.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1035
TITLE =U003: Water Tank 3
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1030.DBW    0; 
      T     #UnitNo; 

      L     DB1035.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1035.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1035.DBD   10; 
      L     DB1035.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1035.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1031.DBX 1350.1; // Start Tank
      A     DB1031.DBX   15.0; 
      A     DB1031.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1031.DBD 1294,
           Run                      := DB1031.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1039
TITLE =U003: Water Tank 3
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1030.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1031.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1031.DBX   17.3; 
      =     DB2030.DBX  105.3; 
      =     DB2030.DBX  185.3; 
      =     DB2030.DBX  265.3; 
      =     DB2030.DBX  345.3; 
      =     DB2030.DBX  425.3; 
      =     DB2030.DBX  505.3; 
      =     DB2030.DBX  585.3; 
      =     DB2030.DBX  665.3; 
      =     DB2030.DBX  745.3; 
      =     DB2030.DBX  825.3; 
      =     DB2030.DBX  905.3; 
      =     DB2030.DBX  985.3; 
      =     DB2030.DBX 1065.3; 
      =     DB2030.DBX 1145.3; 
      =     DB2030.DBX 1225.3; 
      =     DB2030.DBX 1305.3; 
      =     DB2030.DBX 1385.3; 
      =     DB2030.DBX 1465.3; 
      =     DB2030.DBX 1545.3; 
      =     DB2030.DBX 1625.3; 
      =     DB2030.DBX 1705.3; 
      =     DB2030.DBX 1785.3; 
      =     DB2030.DBX 1865.3; 
      =     DB2030.DBX 1945.3; 
      =     DB2030.DBX 2025.3; 
      =     DB2030.DBX 2105.3; 
      =     DB2030.DBX 2185.3; 
      =     DB2030.DBX 2265.3; 
      =     DB2030.DBX 2345.3; 
      =     DB2030.DBX 2425.3; 
      =     DB2030.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1031.DBX   17.3; 
      =     DB2031.DBX   81.3; 
      =     DB2031.DBX  141.3; 
      =     DB2031.DBX  201.3; 
      =     DB2031.DBX  261.3; 
      =     DB2031.DBX  321.3; 
      =     DB2031.DBX  381.3; 
      =     DB2031.DBX  441.3; 
      =     DB2031.DBX  501.3; 
      =     DB2031.DBX  561.3; 
      =     DB2031.DBX  621.3; 
      =     DB2031.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1031.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1031.DBX   17.3; 
      =     DB2033.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1031.DBX   17.3; 
//      =     "U003UnVD".unv001.Sim; 
//      =     "U003UnVD".unv002.Sim; 
//      =     "U003UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1031.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1031.DBX   17.3; 
//      =     "U003MsgD".msg001.Sim; 
//      =     "U003MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1031.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1045
TITLE =U004: Water Tank 4
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1040.DBW    0; 
      T     #UnitNo; 

      L     DB1045.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1045.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1045.DBD   10; 
      L     DB1045.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1045.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1041.DBX 1350.1; // Start Tank
      A     DB1041.DBX   15.0; 
      A     DB1041.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1041.DBD 1294,
           Run                      := DB1041.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1049
TITLE =U004: Water Tank 4
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1040.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1041.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1041.DBX   17.3; 
      =     DB2040.DBX  105.3; 
      =     DB2040.DBX  185.3; 
      =     DB2040.DBX  265.3; 
      =     DB2040.DBX  345.3; 
      =     DB2040.DBX  425.3; 
      =     DB2040.DBX  505.3; 
      =     DB2040.DBX  585.3; 
      =     DB2040.DBX  665.3; 
      =     DB2040.DBX  745.3; 
      =     DB2040.DBX  825.3; 
      =     DB2040.DBX  905.3; 
      =     DB2040.DBX  985.3; 
      =     DB2040.DBX 1065.3; 
      =     DB2040.DBX 1145.3; 
      =     DB2040.DBX 1225.3; 
      =     DB2040.DBX 1305.3; 
      =     DB2040.DBX 1385.3; 
      =     DB2040.DBX 1465.3; 
      =     DB2040.DBX 1545.3; 
      =     DB2040.DBX 1625.3; 
      =     DB2040.DBX 1705.3; 
      =     DB2040.DBX 1785.3; 
      =     DB2040.DBX 1865.3; 
      =     DB2040.DBX 1945.3; 
      =     DB2040.DBX 2025.3; 
      =     DB2040.DBX 2105.3; 
      =     DB2040.DBX 2185.3; 
      =     DB2040.DBX 2265.3; 
      =     DB2040.DBX 2345.3; 
      =     DB2040.DBX 2425.3; 
      =     DB2040.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1041.DBX   17.3; 
      =     DB2041.DBX   81.3; 
      =     DB2041.DBX  141.3; 
      =     DB2041.DBX  201.3; 
      =     DB2041.DBX  261.3; 
      =     DB2041.DBX  321.3; 
      =     DB2041.DBX  381.3; 
      =     DB2041.DBX  441.3; 
      =     DB2041.DBX  501.3; 
      =     DB2041.DBX  561.3; 
      =     DB2041.DBX  621.3; 
      =     DB2041.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1041.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1041.DBX   17.3; 
      =     DB2043.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1041.DBX   17.3; 
//      =     "U004UnVD".unv001.Sim; 
//      =     "U004UnVD".unv002.Sim; 
//      =     "U004UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1041.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1041.DBX   17.3; 
//      =     "U004MsgD".msg001.Sim; 
//      =     "U004MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1041.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1055
TITLE =U005: Water Tank 5
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1050.DBW    0; 
      T     #UnitNo; 

      L     DB1055.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1055.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1055.DBD   10; 
      L     DB1055.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1055.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1051.DBX 1350.1; 
      A     DB1051.DBX   15.0; 
      A     DB1051.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1051.DBD 1294,
           Run                      := DB1051.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1059
TITLE =U005: Water Tank 5
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1050.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1051.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1051.DBX   17.3; 
      =     DB2050.DBX  105.3; 
      =     DB2050.DBX  185.3; 
      =     DB2050.DBX  265.3; 
      =     DB2050.DBX  345.3; 
      =     DB2050.DBX  425.3; 
      =     DB2050.DBX  505.3; 
      =     DB2050.DBX  585.3; 
      =     DB2050.DBX  665.3; 
      =     DB2050.DBX  745.3; 
      =     DB2050.DBX  825.3; 
      =     DB2050.DBX  905.3; 
      =     DB2050.DBX  985.3; 
      =     DB2050.DBX 1065.3; 
      =     DB2050.DBX 1145.3; 
      =     DB2050.DBX 1225.3; 
      =     DB2050.DBX 1305.3; 
      =     DB2050.DBX 1385.3; 
      =     DB2050.DBX 1465.3; 
      =     DB2050.DBX 1545.3; 
      =     DB2050.DBX 1625.3; 
      =     DB2050.DBX 1705.3; 
      =     DB2050.DBX 1785.3; 
      =     DB2050.DBX 1865.3; 
      =     DB2050.DBX 1945.3; 
      =     DB2050.DBX 2025.3; 
      =     DB2050.DBX 2105.3; 
      =     DB2050.DBX 2185.3; 
      =     DB2050.DBX 2265.3; 
      =     DB2050.DBX 2345.3; 
      =     DB2050.DBX 2425.3; 
      =     DB2050.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1051.DBX   17.3; 
      =     DB2051.DBX   81.3; 
      =     DB2051.DBX  141.3; 
      =     DB2051.DBX  201.3; 
      =     DB2051.DBX  261.3; 
      =     DB2051.DBX  321.3; 
      =     DB2051.DBX  381.3; 
      =     DB2051.DBX  441.3; 
      =     DB2051.DBX  501.3; 
      =     DB2051.DBX  561.3; 
      =     DB2051.DBX  621.3; 
      =     DB2051.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1051.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1051.DBX   17.3; 
      =     DB2053.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1051.DBX   17.3; 
//      =     "U005UnVD".unv001.Sim; 
//      =     "U005UnVD".unv002.Sim; 
//      =     "U005UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1051.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1051.DBX   17.3; 
//      =     "U005MsgD".msg001.Sim; 
//      =     "U005MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1051.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1065
TITLE =U006: Water Tank 6
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1060.DBW    0; 
      T     #UnitNo; 

      L     DB1065.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1065.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1065.DBD   10; 
      L     DB1065.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1065.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1061.DBX 1350.1; 
      A     DB1061.DBX   15.0; 
      A     DB1061.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1061.DBD 1294,
           Run                      := DB1061.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1069
TITLE =U006: Water Tank 6
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1060.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1061.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1061.DBX   17.3; 
      =     DB2060.DBX  105.3; 
      =     DB2060.DBX  185.3; 
      =     DB2060.DBX  265.3; 
      =     DB2060.DBX  345.3; 
      =     DB2060.DBX  425.3; 
      =     DB2060.DBX  505.3; 
      =     DB2060.DBX  585.3; 
      =     DB2060.DBX  665.3; 
      =     DB2060.DBX  745.3; 
      =     DB2060.DBX  825.3; 
      =     DB2060.DBX  905.3; 
      =     DB2060.DBX  985.3; 
      =     DB2060.DBX 1065.3; 
      =     DB2060.DBX 1145.3; 
      =     DB2060.DBX 1225.3; 
      =     DB2060.DBX 1305.3; 
      =     DB2060.DBX 1385.3; 
      =     DB2060.DBX 1465.3; 
      =     DB2060.DBX 1545.3; 
      =     DB2060.DBX 1625.3; 
      =     DB2060.DBX 1705.3; 
      =     DB2060.DBX 1785.3; 
      =     DB2060.DBX 1865.3; 
      =     DB2060.DBX 1945.3; 
      =     DB2060.DBX 2025.3; 
      =     DB2060.DBX 2105.3; 
      =     DB2060.DBX 2185.3; 
      =     DB2060.DBX 2265.3; 
      =     DB2060.DBX 2345.3; 
      =     DB2060.DBX 2425.3; 
      =     DB2060.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1061.DBX   17.3; 
      =     DB2061.DBX   81.3; 
      =     DB2061.DBX  141.3; 
      =     DB2061.DBX  201.3; 
      =     DB2061.DBX  261.3; 
      =     DB2061.DBX  321.3; 
      =     DB2061.DBX  381.3; 
      =     DB2061.DBX  441.3; 
      =     DB2061.DBX  501.3; 
      =     DB2061.DBX  561.3; 
      =     DB2061.DBX  621.3; 
      =     DB2061.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1061.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1061.DBX   17.3; 
      =     DB2063.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1061.DBX   17.3; 
//      =     "U006UnVD".unv001.Sim; 
//      =     "U006UnVD".unv002.Sim; 
//      =     "U006UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1061.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1061.DBX   17.3; 
//      =     "U006MsgD".msg001.Sim; 
//      =     "U006MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1061.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1075
TITLE =U007: Water Tank 7
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1070.DBW    0; 
      T     #UnitNo; 

      L     DB1075.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1075.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1075.DBD   10; 
      L     DB1075.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1075.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1071.DBX 1350.1; 
      A     DB1071.DBX   15.0; 
      A     DB1071.DBX   17.4; 

      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1071.DBD 1294,
           Run                      := DB1071.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2070.DBX  106.7; 
      =     DB2070.DBX  186.7; 
      =     DB2070.DBX  266.7; 
      =     DB2070.DBX  346.7; 
      =     DB2070.DBX  426.7; 
      =     DB2070.DBX  506.7; 
      =     DB2070.DBX  586.7; 
      =     DB2070.DBX  666.7; 
      =     DB2070.DBX  746.7; 
      =     DB2070.DBX  826.7; 
      =     DB2070.DBX  906.7; 
      =     DB2070.DBX  986.7; 
      =     DB2070.DBX 1066.7; 
      =     DB2070.DBX 1146.7; 
      =     DB2070.DBX 1226.7; 
      =     DB2070.DBX 1306.7; 
      =     DB2070.DBX 1386.7; 
      =     DB2070.DBX 1466.7; 
      =     DB2070.DBX 1546.7; 
      =     DB2070.DBX 1626.7; 
      =     DB2070.DBX 1706.7; 
      =     DB2070.DBX 1786.7; 
      =     DB2070.DBX 1866.7; 
      =     DB2070.DBX 2026.7; 
      =     DB2070.DBX 2106.7; 
      =     DB2070.DBX 2266.7; 
      =     DB2070.DBX 2346.7; 
      =     DB2070.DBX 2426.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1071.DBX   15.0; 
//      AN "WT07SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1075.DBD  150; 
      T     DB1071.DBD  626; 

//Temperature CIP Return
      L     DB1075.DBD  146; 
      T     DB1071.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1071.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1075.DBX  171.7; 
      JCN   pfc; 
      L     DB1071.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1075.DBX  172.0; 
      JCN   ppc; 
      L     DB1071.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1075.DBX  171.6; 
      JCN   pxc; 
      L     DB1071.DBD  574; 
pxc:  NOP   0; 
      T     DB1075.DBD  182; 

//CIP Return
      L     DB1071.DBD  558; 
      T     DB1075.DBD  186; 
      L     DB1075.DBD  138; 
      T     DB1071.DBD  562; 

//CIP Prerun
      L     DB1071.DBD  542; 
      T     DB1075.DBD  190; 
      L     DB1075.DBD  142; 
      T     DB1071.DBD  546; 

// Write Own Data to CIP
      L     DB1075.DBD   10; 
      T     DB1075.DBD  154; 

      L     DB1075.DBW   14; 
      T     DB1075.DBW  158; 

      L     DB1075.DBW   16; 
      T     DB1075.DBW  160; 

      L     DB1075.DBW   18; 
      T     DB1075.DBW  162; 

      L     DB1075.DBW   20; 
      T     DB1075.DBW  164; 

      L     DB1075.DBW   22; 
      T     DB1075.DBW  166; 

      A     DB1075.DBX   24.0; 
      =     DB1075.DBX  168.0; 

      A     DB1075.DBX   24.1; 
      =     DB1075.DBX  168.1; 

      A     DB1075.DBX   24.2; 
      =     DB1075.DBX  168.2; 

      A     DB1075.DBX   24.3; 
      =     DB1075.DBX  168.3; 

      A     DB1075.DBX   24.4; 
      =     DB1075.DBX  168.4; 

      A     DB1075.DBX   24.5; 
      =     DB1075.DBX  168.5; 

      A     DB1075.DBX   24.6; 
      =     DB1075.DBX  168.6; 

      A     DB1075.DBX   24.7; 
      =     DB1075.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1075.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1075.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "WT07SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1075.DBX   26.5; 

//Full Signal
//A     "WT07SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1075.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1075.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1075.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1079
TITLE =U007: Water Tank 7
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1070.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1071.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1071.DBX   17.3; 
      =     DB2070.DBX  105.3; 
      =     DB2070.DBX  185.3; 
      =     DB2070.DBX  265.3; 
      =     DB2070.DBX  345.3; 
      =     DB2070.DBX  425.3; 
      =     DB2070.DBX  505.3; 
      =     DB2070.DBX  585.3; 
      =     DB2070.DBX  665.3; 
      =     DB2070.DBX  745.3; 
      =     DB2070.DBX  825.3; 
      =     DB2070.DBX  905.3; 
      =     DB2070.DBX  985.3; 
      =     DB2070.DBX 1065.3; 
      =     DB2070.DBX 1145.3; 
      =     DB2070.DBX 1225.3; 
      =     DB2070.DBX 1305.3; 
      =     DB2070.DBX 1385.3; 
      =     DB2070.DBX 1465.3; 
      =     DB2070.DBX 1545.3; 
      =     DB2070.DBX 1625.3; 
      =     DB2070.DBX 1705.3; 
      =     DB2070.DBX 1785.3; 
      =     DB2070.DBX 1865.3; 
      =     DB2070.DBX 1945.3; 
      =     DB2070.DBX 2025.3; 
      =     DB2070.DBX 2105.3; 
      =     DB2070.DBX 2185.3; 
      =     DB2070.DBX 2265.3; 
      =     DB2070.DBX 2345.3; 
      =     DB2070.DBX 2425.3; 
      =     DB2070.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1071.DBX   17.3; 
      =     DB2071.DBX   81.3; 
      =     DB2071.DBX  141.3; 
      =     DB2071.DBX  201.3; 
      =     DB2071.DBX  261.3; 
      =     DB2071.DBX  321.3; 
      =     DB2071.DBX  381.3; 
      =     DB2071.DBX  441.3; 
      =     DB2071.DBX  501.3; 
      =     DB2071.DBX  561.3; 
      =     DB2071.DBX  621.3; 
      =     DB2071.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1071.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1071.DBX   17.3; 
      =     DB2073.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1071.DBX   17.3; 
//      =     "U007UnVD".unv001.Sim; 
//      =     "U007UnVD".unv002.Sim; 
//      =     "U007UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1071.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1071.DBX   17.3; 
//      =     "U007MsgD".msg001.Sim; 
//      =     "U007MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1071.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1085
TITLE =U008: Water Tank 8
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1080.DBW    0; 
      T     #UnitNo; 

      L     DB1085.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1085.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1085.DBD   10; 
      L     DB1085.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1085.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1081.DBX 1350.1; 
      A     DB1081.DBX   15.0; 
      A     DB1081.DBX   17.4; 

      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1081.DBD 1294,
           Run                      := DB1081.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2080.DBX  426.7; 
      =     DB2080.DBX  506.7; 
      =     DB2080.DBX  586.7; 
      =     DB2080.DBX  666.7; 
      =     DB2080.DBX  746.7; 
      =     DB2080.DBX  826.7; 
      =     DB2080.DBX  906.7; 
      =     DB2080.DBX  986.7; 
      =     DB2080.DBX 1066.7; 
      =     DB2080.DBX 1146.7; 
      =     DB2080.DBX 1226.7; 
      =     DB2080.DBX 1306.7; 
      =     DB2080.DBX 1386.7; 
      =     DB2080.DBX 1466.7; 
      =     DB2080.DBX 1546.7; 
      =     DB2080.DBX 1626.7; 
      =     DB2080.DBX 1706.7; 
      =     DB2080.DBX 1786.7; 
      =     DB2080.DBX 1866.7; 
      =     DB2080.DBX 1946.7; 
      =     DB2080.DBX 2266.7; 
      =     DB2080.DBX 2346.7; 
      =     DB2080.DBX 2426.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1081.DBX   15.0; 
//      AN "WT08SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1085.DBD  150; 
      T     DB1081.DBD  626; 

//Temperature CIP Return
      L     DB1085.DBD  146; 
      T     DB1081.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1081.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1085.DBX  171.7; 
      JCN   pfc; 
      L     DB1081.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1085.DBX  172.0; 
      JCN   ppc; 
      L     DB1081.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1085.DBX  171.6; 
      JCN   pxc; 
      L     DB1081.DBD  574; 
pxc:  NOP   0; 
      T     DB1085.DBD  182; 

//CIP Return
      L     DB1081.DBD  558; 
      T     DB1085.DBD  186; 
      L     DB1085.DBD  138; 
      T     DB1081.DBD  562; 

//CIP Prerun
      L     DB1081.DBD  542; 
      T     DB1085.DBD  190; 
      L     DB1085.DBD  142; 
      T     DB1081.DBD  546; 

// Write Own Data to CIP
      L     DB1085.DBD   10; 
      T     DB1085.DBD  154; 

      L     DB1085.DBW   14; 
      T     DB1085.DBW  158; 

      L     DB1085.DBW   16; 
      T     DB1085.DBW  160; 

      L     DB1085.DBW   18; 
      T     DB1085.DBW  162; 

      L     DB1085.DBW   20; 
      T     DB1085.DBW  164; 

      L     DB1085.DBW   22; 
      T     DB1085.DBW  166; 

      A     DB1085.DBX   24.0; 
      =     DB1085.DBX  168.0; 

      A     DB1085.DBX   24.1; 
      =     DB1085.DBX  168.1; 

      A     DB1085.DBX   24.2; 
      =     DB1085.DBX  168.2; 

      A     DB1085.DBX   24.3; 
      =     DB1085.DBX  168.3; 

      A     DB1085.DBX   24.4; 
      =     DB1085.DBX  168.4; 

      A     DB1085.DBX   24.5; 
      =     DB1085.DBX  168.5; 

      A     DB1085.DBX   24.6; 
      =     DB1085.DBX  168.6; 

      A     DB1085.DBX   24.7; 
      =     DB1085.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1085.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1085.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "WT08SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1085.DBX   26.5; 

//Full Signal
//A     "WT08SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1085.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1085.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1085.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1089
TITLE =U008: Water Tank 8
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1080.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1081.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1081.DBX   17.3; 
      =     DB2080.DBX  105.3; 
      =     DB2080.DBX  185.3; 
      =     DB2080.DBX  265.3; 
      =     DB2080.DBX  345.3; 
      =     DB2080.DBX  425.3; 
      =     DB2080.DBX  505.3; 
      =     DB2080.DBX  585.3; 
      =     DB2080.DBX  665.3; 
      =     DB2080.DBX  745.3; 
      =     DB2080.DBX  825.3; 
      =     DB2080.DBX  905.3; 
      =     DB2080.DBX  985.3; 
      =     DB2080.DBX 1065.3; 
      =     DB2080.DBX 1145.3; 
      =     DB2080.DBX 1225.3; 
      =     DB2080.DBX 1305.3; 
      =     DB2080.DBX 1385.3; 
      =     DB2080.DBX 1465.3; 
      =     DB2080.DBX 1545.3; 
      =     DB2080.DBX 1625.3; 
      =     DB2080.DBX 1705.3; 
      =     DB2080.DBX 1785.3; 
      =     DB2080.DBX 1865.3; 
      =     DB2080.DBX 1945.3; 
      =     DB2080.DBX 2025.3; 
      =     DB2080.DBX 2105.3; 
      =     DB2080.DBX 2185.3; 
      =     DB2080.DBX 2265.3; 
      =     DB2080.DBX 2345.3; 
      =     DB2080.DBX 2425.3; 
      =     DB2080.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1081.DBX   17.3; 
      =     DB2081.DBX   81.3; 
      =     DB2081.DBX  141.3; 
      =     DB2081.DBX  201.3; 
      =     DB2081.DBX  261.3; 
      =     DB2081.DBX  321.3; 
      =     DB2081.DBX  381.3; 
      =     DB2081.DBX  441.3; 
      =     DB2081.DBX  501.3; 
      =     DB2081.DBX  561.3; 
      =     DB2081.DBX  621.3; 
      =     DB2081.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1081.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1081.DBX   17.3; 
      =     DB2083.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1081.DBX   17.3; 
//      =     "U008UnVD".unv001.Sim; 
//      =     "U008UnVD".unv002.Sim; 
//      =     "U008UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1081.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1081.DBX   17.3; 
//      =     "U008MsgD".msg001.Sim; 
//      =     "U008MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1081.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1095
TITLE =U009: Water Tank 9
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1090.DBW    0; 
      T     #UnitNo; 

      L     DB1095.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1095.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1095.DBD   10; 
      L     DB1095.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1095.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1091.DBX 1350.1; 
      A     DB1091.DBX   15.0; 
      A     DB1091.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1091.DBD 1294,
           Run                      := DB1091.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1099
TITLE =U009: Water Tank 9
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1090.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1091.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1091.DBX   17.3; 
      =     DB2090.DBX  105.3; 
      =     DB2090.DBX  185.3; 
      =     DB2090.DBX  265.3; 
      =     DB2090.DBX  345.3; 
      =     DB2090.DBX  425.3; 
      =     DB2090.DBX  505.3; 
      =     DB2090.DBX  585.3; 
      =     DB2090.DBX  665.3; 
      =     DB2090.DBX  745.3; 
      =     DB2090.DBX  825.3; 
      =     DB2090.DBX  905.3; 
      =     DB2090.DBX  985.3; 
      =     DB2090.DBX 1065.3; 
      =     DB2090.DBX 1145.3; 
      =     DB2090.DBX 1225.3; 
      =     DB2090.DBX 1305.3; 
      =     DB2090.DBX 1385.3; 
      =     DB2090.DBX 1465.3; 
      =     DB2090.DBX 1545.3; 
      =     DB2090.DBX 1625.3; 
      =     DB2090.DBX 1705.3; 
      =     DB2090.DBX 1785.3; 
      =     DB2090.DBX 1865.3; 
      =     DB2090.DBX 1945.3; 
      =     DB2090.DBX 2025.3; 
      =     DB2090.DBX 2105.3; 
      =     DB2090.DBX 2185.3; 
      =     DB2090.DBX 2265.3; 
      =     DB2090.DBX 2345.3; 
      =     DB2090.DBX 2425.3; 
      =     DB2090.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1091.DBX   17.3; 
      =     DB2091.DBX   81.3; 
      =     DB2091.DBX  141.3; 
      =     DB2091.DBX  201.3; 
      =     DB2091.DBX  261.3; 
      =     DB2091.DBX  321.3; 
      =     DB2091.DBX  381.3; 
      =     DB2091.DBX  441.3; 
      =     DB2091.DBX  501.3; 
      =     DB2091.DBX  561.3; 
      =     DB2091.DBX  621.3; 
      =     DB2091.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1091.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1091.DBX   17.3; 
      =     DB2093.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1091.DBX   17.3; 
//      =     "U009UnVD".unv001.Sim; 
//      =     "U009UnVD".unv002.Sim; 
//      =     "U009UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1091.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1091.DBX   17.3; 
//      =     "U009MsgD".msg001.Sim; 
//      =     "U009MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1091.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1105
TITLE =U010: Water Tank 10
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  rUnitNo : REAL ;	
  TankSelected : BOOL ;	//Tank Selected by Water transfer
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1100.DBW    0; 
      T     #UnitNo; 

      L     #UnitNo; 
      ITD   ; 
      DTR   ; 
      T     #rUnitNo; 

      L     DB1105.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1105.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1105.DBD   10; 
      L     DB1105.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1105.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1101.DBX 1350.1; // Start Tank
      A     DB1101.DBX   15.0; 
      A     DB1101.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1101.DBD 1294,
           Run                      := DB1101.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1109
TITLE =U010: Water Tank 10
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1100.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1101.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1101.DBX   17.3; 
      =     DB2100.DBX  105.3; 
      =     DB2100.DBX  185.3; 
      =     DB2100.DBX  265.3; 
      =     DB2100.DBX  345.3; 
      =     DB2100.DBX  425.3; 
      =     DB2100.DBX  505.3; 
      =     DB2100.DBX  585.3; 
      =     DB2100.DBX  665.3; 
      =     DB2100.DBX  745.3; 
      =     DB2100.DBX  825.3; 
      =     DB2100.DBX  905.3; 
      =     DB2100.DBX  985.3; 
      =     DB2100.DBX 1065.3; 
      =     DB2100.DBX 1145.3; 
      =     DB2100.DBX 1225.3; 
      =     DB2100.DBX 1305.3; 
      =     DB2100.DBX 1385.3; 
      =     DB2100.DBX 1465.3; 
      =     DB2100.DBX 1545.3; 
      =     DB2100.DBX 1625.3; 
      =     DB2100.DBX 1705.3; 
      =     DB2100.DBX 1785.3; 
      =     DB2100.DBX 1865.3; 
      =     DB2100.DBX 1945.3; 
      =     DB2100.DBX 2025.3; 
      =     DB2100.DBX 2105.3; 
      =     DB2100.DBX 2265.3; 
      =     DB2100.DBX 2345.3; 
      =     DB2100.DBX 2425.3; 
      =     DB2100.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1101.DBX   17.3; 
      =     DB2101.DBX   81.3; 
      =     DB2101.DBX  141.3; 
      =     DB2101.DBX  201.3; 
      =     DB2101.DBX  261.3; 
      =     DB2101.DBX  321.3; 
      =     DB2101.DBX  381.3; 
      =     DB2101.DBX  441.3; 
      =     DB2101.DBX  501.3; 
      =     DB2101.DBX  561.3; 
      =     DB2101.DBX  621.3; 
      =     DB2101.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1101.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1101.DBX   17.3; 
      =     DB2103.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1101.DBX   17.3; 
//      =     "U010UnVD".unv001.Sim; 
//      =     "U010UnVD".unv002.Sim; 
//      =     "U010UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1101.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1101.DBX   17.3; 
//      =     "U010MsgD".msg001.Sim; 
//      =     "U010MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1101.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1115
TITLE =U011: Water Tank 11
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  TankSelected : BOOL ;	//Tank Selected by Water transfer
  rUnitNo : REAL ;	//Unit Number Real
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1110.DBW    0; 
      T     #UnitNo; 

      L     #UnitNo; 
      ITD   ; 
      DTR   ; 
      T     #rUnitNo; 

      L     DB1115.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1115.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1115.DBD   10; 
      L     DB1115.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1115.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1111.DBX 1350.1; // Start Tank
      A     DB1111.DBX   15.0; 
      A     DB1111.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1111.DBD 1294,
           Run                      := DB1111.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1119
TITLE =U011: Water Tank 11
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1110.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1111.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1111.DBX   17.3; 
      =     DB2110.DBX  105.3; 
      =     DB2110.DBX  185.3; 
      =     DB2110.DBX  265.3; 
      =     DB2110.DBX  345.3; 
      =     DB2110.DBX  425.3; 
      =     DB2110.DBX  505.3; 
      =     DB2110.DBX  585.3; 
      =     DB2110.DBX  665.3; 
      =     DB2110.DBX  745.3; 
      =     DB2110.DBX  825.3; 
      =     DB2110.DBX  905.3; 
      =     DB2110.DBX  985.3; 
      =     DB2110.DBX 1065.3; 
      =     DB2110.DBX 1145.3; 
      =     DB2110.DBX 1225.3; 
      =     DB2110.DBX 1305.3; 
      =     DB2110.DBX 1385.3; 
      =     DB2110.DBX 1465.3; 
      =     DB2110.DBX 1545.3; 
      =     DB2110.DBX 1625.3; 
      =     DB2110.DBX 1705.3; 
      =     DB2110.DBX 1785.3; 
      =     DB2110.DBX 1865.3; 
      =     DB2110.DBX 1945.3; 
      =     DB2110.DBX 2025.3; 
      =     DB2110.DBX 2105.3; 
      =     DB2110.DBX 2185.3; 
      =     DB2110.DBX 2265.3; 
      =     DB2110.DBX 2345.3; 
      =     DB2110.DBX 2425.3; 
      =     DB2110.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1111.DBX   17.3; 
      =     DB2111.DBX   81.3; 
      =     DB2111.DBX  141.3; 
      =     DB2111.DBX  201.3; 
      =     DB2111.DBX  261.3; 
      =     DB2111.DBX  321.3; 
      =     DB2111.DBX  381.3; 
      =     DB2111.DBX  441.3; 
      =     DB2111.DBX  501.3; 
      =     DB2111.DBX  561.3; 
      =     DB2111.DBX  621.3; 
      =     DB2111.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1111.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1111.DBX   17.3; 
      =     DB2113.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1111.DBX   17.3; 
//      =     "U011UnVD".unv001.Sim; 
//      =     "U011UnVD".unv002.Sim; 
//      =     "U011UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1111.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1111.DBX   17.3; 
//      =     "U011MsgD".msg001.Sim; 
//      =     "U011MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1111.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1125
TITLE =U012: Water Tank 12
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  TankSelected : BOOL ;	//Tank Selected by Water transfer
  rUnitNo : REAL ;	//Unit Number Real
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1120.DBW    0; 
      T     #UnitNo; 

      L     #UnitNo; 
      ITD   ; 
      DTR   ; 
      T     #rUnitNo; 

      L     DB1125.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1125.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1125.DBD   10; 
      L     DB1125.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1125.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1121.DBX 1350.1; // Start Tank
      A     DB1121.DBX   15.0; 
      A     DB1121.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1121.DBD 1294,
           Run                      := DB1121.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1129
TITLE =U012: Water Tank 12
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1120.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1121.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1121.DBX   17.3; 
      =     DB2120.DBX  105.3; 
      =     DB2120.DBX  185.3; 
      =     DB2120.DBX  265.3; 
      =     DB2120.DBX  345.3; 
      =     DB2120.DBX  425.3; 
      =     DB2120.DBX  505.3; 
      =     DB2120.DBX  585.3; 
      =     DB2120.DBX  665.3; 
      =     DB2120.DBX  745.3; 
      =     DB2120.DBX  825.3; 
      =     DB2120.DBX  905.3; 
      =     DB2120.DBX  985.3; 
      =     DB2120.DBX 1065.3; 
      =     DB2120.DBX 1145.3; 
      =     DB2120.DBX 1225.3; 
      =     DB2120.DBX 1305.3; 
      =     DB2120.DBX 1385.3; 
      =     DB2120.DBX 1465.3; 
      =     DB2120.DBX 1545.3; 
      =     DB2120.DBX 1625.3; 
      =     DB2120.DBX 1705.3; 
      =     DB2120.DBX 1785.3; 
      =     DB2120.DBX 1865.3; 
      =     DB2120.DBX 1945.3; 
      =     DB2120.DBX 2025.3; 
      =     DB2120.DBX 2105.3; 
      =     DB2120.DBX 2185.3; 
      =     DB2120.DBX 2265.3; 
      =     DB2120.DBX 2345.3; 
      =     DB2120.DBX 2425.3; 
      =     DB2120.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1121.DBX   17.3; 
      =     DB2121.DBX   81.3; 
      =     DB2121.DBX  141.3; 
      =     DB2121.DBX  201.3; 
      =     DB2121.DBX  261.3; 
      =     DB2121.DBX  321.3; 
      =     DB2121.DBX  381.3; 
      =     DB2121.DBX  441.3; 
      =     DB2121.DBX  501.3; 
      =     DB2121.DBX  561.3; 
      =     DB2121.DBX  621.3; 
      =     DB2121.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1121.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1121.DBX   17.3; 
      =     DB2123.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1121.DBX   17.3; 
//      =     "U012UnVD".unv001.Sim; 
//      =     "U012UnVD".unv002.Sim; 
//      =     "U012UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1121.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1121.DBX   17.3; 
//      =     "U012MsgD".msg001.Sim; 
//      =     "U012MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1121.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1135
TITLE =U013: Water Tank 13
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  TankSelected : BOOL ;	//Tank Selected by Water transfer
  rUnitNo : REAL ;	//Unit Number Real
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1130.DBW    0; 
      T     #UnitNo; 

      L     #UnitNo; 
      ITD   ; 
      DTR   ; 
      T     #rUnitNo; 

      L     DB1135.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1135.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1135.DBD   10; 
      L     DB1135.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1135.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1131.DBX 1350.1; // Start Tank
      A     DB1131.DBX   15.0; 
      A     DB1131.DBX   17.4; 
      JCN   Strt; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := DB1131.DBD 1294,
           Run                      := DB1131.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1139
TITLE =U013: Water Tank 13
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1130.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1131.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1131.DBX   17.3; 
      =     DB2130.DBX  105.3; 
      =     DB2130.DBX  185.3; 
      =     DB2130.DBX  265.3; 
      =     DB2130.DBX  345.3; 
      =     DB2130.DBX  425.3; 
      =     DB2130.DBX  505.3; 
      =     DB2130.DBX  585.3; 
      =     DB2130.DBX  665.3; 
      =     DB2130.DBX  745.3; 
      =     DB2130.DBX  825.3; 
      =     DB2130.DBX  905.3; 
      =     DB2130.DBX  985.3; 
      =     DB2130.DBX 1065.3; 
      =     DB2130.DBX 1145.3; 
      =     DB2130.DBX 1225.3; 
      =     DB2130.DBX 1305.3; 
      =     DB2130.DBX 1385.3; 
      =     DB2130.DBX 1465.3; 
      =     DB2130.DBX 1545.3; 
      =     DB2130.DBX 1625.3; 
      =     DB2130.DBX 1705.3; 
      =     DB2130.DBX 1785.3; 
      =     DB2130.DBX 1865.3; 
      =     DB2130.DBX 1945.3; 
      =     DB2130.DBX 2025.3; 
      =     DB2130.DBX 2105.3; 
      =     DB2130.DBX 2185.3; 
      =     DB2130.DBX 2265.3; 
      =     DB2130.DBX 2345.3; 
      =     DB2130.DBX 2425.3; 
      =     DB2130.DBX 2505.3; 

NETWORK
TITLE =Special Input

      A     DB1131.DBX   17.3; 
      =     DB2131.DBX   81.3; 
      =     DB2131.DBX  141.3; 
      =     DB2131.DBX  201.3; 
      =     DB2131.DBX  261.3; 
      =     DB2131.DBX  321.3; 
      =     DB2131.DBX  381.3; 
      =     DB2131.DBX  441.3; 
      =     DB2131.DBX  501.3; 
      =     DB2131.DBX  561.3; 
      =     DB2131.DBX  621.3; 
      =     DB2131.DBX  681.3; 

NETWORK
TITLE =Counter

      A     DB1131.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1131.DBX   17.3; 
      =     DB2133.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1131.DBX   17.3; 
//      =     "U013UnVD".unv001.Sim; 
//      =     "U013UnVD".unv002.Sim; 
//      =     "U013UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     DB1131.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1131.DBX   17.3; 
//      =     "U013MsgD".msg001.Sim; 
//      =     "U013MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1131.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1215
TITLE =U021: Well Transfer VE1
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1210.DBW    0; 
      T     #UnitNo; 

      L     DB1215.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1215.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1215.DBD   10; 
      L     DB1215.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1215.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1215.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1215.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1211.DBX   15.0; 
      A     DB1211.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1215.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1211.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2210.DBX  106.7; 
      =     DB2210.DBX  186.7; 
      =     DB2210.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1211.DBX   15.0; 
//      AN "U021SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1215.DBD  150; 
      T     DB1211.DBD  626; 

//Temperature CIP Return
      L     DB1215.DBD  146; 
      T     DB1211.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1211.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1215.DBX  171.7; 
      JCN   pfc; 
      L     DB1211.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1215.DBX  172.0; 
      JCN   ppc; 
      L     DB1211.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1215.DBX  171.6; 
      JCN   pxc; 
      L     DB1211.DBD  574; 
pxc:  NOP   0; 
      T     DB1215.DBD  182; 

//CIP Return
      L     DB1211.DBD  558; 
      T     DB1215.DBD  186; 
      L     DB1215.DBD  138; 
      T     DB1211.DBD  562; 

//CIP Prerun
      L     DB1211.DBD  542; 
      T     DB1215.DBD  190; 
      L     DB1215.DBD  142; 
      T     DB1211.DBD  546; 

// Write Own Data to CIP
      L     DB1215.DBD   10; 
      T     DB1215.DBD  154; 

      L     DB1215.DBW   14; 
      T     DB1215.DBW  158; 

      L     DB1215.DBW   16; 
      T     DB1215.DBW  160; 

      L     DB1215.DBW   18; 
      T     DB1215.DBW  162; 

      L     DB1215.DBW   20; 
      T     DB1215.DBW  164; 

      L     DB1215.DBW   22; 
      T     DB1215.DBW  166; 

      A     DB1215.DBX   24.0; 
      =     DB1215.DBX  168.0; 

      A     DB1215.DBX   24.1; 
      =     DB1215.DBX  168.1; 

      A     DB1215.DBX   24.2; 
      =     DB1215.DBX  168.2; 

      A     DB1215.DBX   24.3; 
      =     DB1215.DBX  168.3; 

      A     DB1215.DBX   24.4; 
      =     DB1215.DBX  168.4; 

      A     DB1215.DBX   24.5; 
      =     DB1215.DBX  168.5; 

      A     DB1215.DBX   24.6; 
      =     DB1215.DBX  168.6; 

      A     DB1215.DBX   24.7; 
      =     DB1215.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1215.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1215.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U021SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1215.DBX   26.5; 

//Full Signal
//A     "U021SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1215.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1215.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1215.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1219
TITLE =U021: Well Transfer VE1
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1210.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1211.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1211.DBX   17.3; 
      =     DB2210.DBX  105.3; 
      =     DB2210.DBX  185.3; 
      =     DB2210.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1211.DBX   17.3; 
      =     DB2211.DBX   81.3; 
      =     DB2211.DBX  141.3; 
      =     DB2211.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1211.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1211.DBX   17.3; 
      =     DB2213.DBX  141.3; 
      =     DB2213.DBX  261.3; 
      =     DB2213.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1211.DBX   17.3; 
//      =     "U021UnVD".unv001.Sim; 
//      =     "U021UnVD".unv002.Sim; 
//      =     "U021UnVD".unv003.Sim; 
//      =     "U021UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1211.DBX   17.3; 
//      =     "U021PIDD".U21_PID001.Ign; 

NETWORK
TITLE =Message

      A     DB1211.DBX   17.3; 
//      =     "U021MsgD".msg001.Sim; 
//      =     "U021MsgD".msg002.Sim; 
//      =     "U021MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1211.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1225
TITLE =U022: Well Transfer VE2
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1220.DBW    0; 
      T     #UnitNo; 

      L     DB1225.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1225.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1225.DBD   10; 
      L     DB1225.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1225.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1225.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1225.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1221.DBX   15.0; 
      A     DB1221.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1225.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1221.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2220.DBX  106.7; 
      =     DB2220.DBX  186.7; 
      =     DB2220.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1221.DBX   15.0; 
//      AN "U022SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1225.DBD  150; 
      T     DB1221.DBD  626; 

//Temperature CIP Return
      L     DB1225.DBD  146; 
      T     DB1221.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1221.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1225.DBX  171.7; 
      JCN   pfc; 
      L     DB1221.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1225.DBX  172.0; 
      JCN   ppc; 
      L     DB1221.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1225.DBX  171.6; 
      JCN   pxc; 
      L     DB1221.DBD  574; 
pxc:  NOP   0; 
      T     DB1225.DBD  182; 

//CIP Return
      L     DB1221.DBD  558; 
      T     DB1225.DBD  186; 
      L     DB1225.DBD  138; 
      T     DB1221.DBD  562; 

//CIP Prerun
      L     DB1221.DBD  542; 
      T     DB1225.DBD  190; 
      L     DB1225.DBD  142; 
      T     DB1221.DBD  546; 

// Write Own Data to CIP
      L     DB1225.DBD   10; 
      T     DB1225.DBD  154; 

      L     DB1225.DBW   14; 
      T     DB1225.DBW  158; 

      L     DB1225.DBW   16; 
      T     DB1225.DBW  160; 

      L     DB1225.DBW   18; 
      T     DB1225.DBW  162; 

      L     DB1225.DBW   20; 
      T     DB1225.DBW  164; 

      L     DB1225.DBW   22; 
      T     DB1225.DBW  166; 

      A     DB1225.DBX   24.0; 
      =     DB1225.DBX  168.0; 

      A     DB1225.DBX   24.1; 
      =     DB1225.DBX  168.1; 

      A     DB1225.DBX   24.2; 
      =     DB1225.DBX  168.2; 

      A     DB1225.DBX   24.3; 
      =     DB1225.DBX  168.3; 

      A     DB1225.DBX   24.4; 
      =     DB1225.DBX  168.4; 

      A     DB1225.DBX   24.5; 
      =     DB1225.DBX  168.5; 

      A     DB1225.DBX   24.6; 
      =     DB1225.DBX  168.6; 

      A     DB1225.DBX   24.7; 
      =     DB1225.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1225.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1225.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U022SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1225.DBX   26.5; 

//Full Signal
//A     "U022SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1225.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1225.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1225.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1229
TITLE =U022: Well Transfer VE2
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1220.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1221.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1221.DBX   17.3; 
      =     DB2220.DBX  105.3; 
      =     DB2220.DBX  185.3; 
      =     DB2220.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1221.DBX   17.3; 
      =     DB2221.DBX   81.3; 
      =     DB2221.DBX  141.3; 
      =     DB2221.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1221.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1221.DBX   17.3; 
      =     DB2223.DBX  141.3; 
      =     DB2223.DBX  261.3; 
      =     DB2223.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1221.DBX   17.3; 
//      =     "U022UnVD".unv001.Sim; 
//      =     "U022UnVD".unv002.Sim; 
//      =     "U022UnVD".unv003.Sim; 
//      =     "U022UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1221.DBX   17.3; 
//      =     "U022PIDD".U22_PID001.Ign; 

NETWORK
TITLE =Message

      A     DB1221.DBX   17.3; 
//      =     "U022MsgD".msg001.Sim; 
//      =     "U022MsgD".msg002.Sim; 
//      =     "U022MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1221.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1255
TITLE =U025: Well Transfer A
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1250.DBW    0; 
      T     #UnitNo; 

      L     DB1255.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1255.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1255.DBD   10; 
      L     DB1255.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1255.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1255.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1255.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1251.DBX   15.0; 
      A     DB1251.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1255.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1251.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2250.DBX  106.7; 
      =     DB2250.DBX  186.7; 
      =     DB2250.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1251.DBX   15.0; 
//      AN "U025SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1255.DBD  150; 
      T     DB1251.DBD  626; 

//Temperature CIP Return
      L     DB1255.DBD  146; 
      T     DB1251.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1251.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1255.DBX  171.7; 
      JCN   pfc; 
      L     DB1251.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1255.DBX  172.0; 
      JCN   ppc; 
      L     DB1251.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1255.DBX  171.6; 
      JCN   pxc; 
      L     DB1251.DBD  574; 
pxc:  NOP   0; 
      T     DB1255.DBD  182; 

//CIP Return
      L     DB1251.DBD  558; 
      T     DB1255.DBD  186; 
      L     DB1255.DBD  138; 
      T     DB1251.DBD  562; 

//CIP Prerun
      L     DB1251.DBD  542; 
      T     DB1255.DBD  190; 
      L     DB1255.DBD  142; 
      T     DB1251.DBD  546; 

// Write Own Data to CIP
      L     DB1255.DBD   10; 
      T     DB1255.DBD  154; 

      L     DB1255.DBW   14; 
      T     DB1255.DBW  158; 

      L     DB1255.DBW   16; 
      T     DB1255.DBW  160; 

      L     DB1255.DBW   18; 
      T     DB1255.DBW  162; 

      L     DB1255.DBW   20; 
      T     DB1255.DBW  164; 

      L     DB1255.DBW   22; 
      T     DB1255.DBW  166; 

      A     DB1255.DBX   24.0; 
      =     DB1255.DBX  168.0; 

      A     DB1255.DBX   24.1; 
      =     DB1255.DBX  168.1; 

      A     DB1255.DBX   24.2; 
      =     DB1255.DBX  168.2; 

      A     DB1255.DBX   24.3; 
      =     DB1255.DBX  168.3; 

      A     DB1255.DBX   24.4; 
      =     DB1255.DBX  168.4; 

      A     DB1255.DBX   24.5; 
      =     DB1255.DBX  168.5; 

      A     DB1255.DBX   24.6; 
      =     DB1255.DBX  168.6; 

      A     DB1255.DBX   24.7; 
      =     DB1255.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1255.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1255.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U025SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1255.DBX   26.5; 

//Full Signal
//A     "U025SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1255.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1255.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1255.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1259
TITLE =U025: Well Transfer A
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1250.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1251.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1251.DBX   17.3; 
      =     DB2250.DBX  105.3; 
      =     DB2250.DBX  185.3; 
      =     DB2250.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1251.DBX   17.3; 
      =     DB2251.DBX   81.3; 
      =     DB2251.DBX  141.3; 
      =     DB2251.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1251.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1251.DBX   17.3; 
      =     DB2253.DBX  141.3; 
      =     DB2253.DBX  261.3; 
      =     DB2253.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1251.DBX   17.3; 
//      =     "U025UnVD".unv001.Sim; 
//      =     "U025UnVD".unv002.Sim; 
//      =     "U025UnVD".unv003.Sim; 
//      =     "U025UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1251.DBX   17.3; 
//      =     "U025PIDD".CO2ARV1.Ign; 

NETWORK
TITLE =Message

      A     DB1251.DBX   17.3; 
//      =     "U025MsgD".msg001.Sim; 
//      =     "U025MsgD".msg002.Sim; 
//      =     "U025MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1251.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1265
TITLE =U026: Well Transfer B
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1260.DBW    0; 
      T     #UnitNo; 

      L     DB1265.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1265.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1265.DBD   10; 
      L     DB1265.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1265.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1265.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1265.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1261.DBX   15.0; 
      A     DB1261.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1265.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1261.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2260.DBX  106.7; 
      =     DB2260.DBX  186.7; 
      =     DB2260.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1261.DBX   15.0; 
//      AN "U026SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1265.DBD  150; 
      T     DB1261.DBD  626; 

//Temperature CIP Return
      L     DB1265.DBD  146; 
      T     DB1261.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1261.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1265.DBX  171.7; 
      JCN   pfc; 
      L     DB1261.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1265.DBX  172.0; 
      JCN   ppc; 
      L     DB1261.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1265.DBX  171.6; 
      JCN   pxc; 
      L     DB1261.DBD  574; 
pxc:  NOP   0; 
      T     DB1265.DBD  182; 

//CIP Return
      L     DB1261.DBD  558; 
      T     DB1265.DBD  186; 
      L     DB1265.DBD  138; 
      T     DB1261.DBD  562; 

//CIP Prerun
      L     DB1261.DBD  542; 
      T     DB1265.DBD  190; 
      L     DB1265.DBD  142; 
      T     DB1261.DBD  546; 

// Write Own Data to CIP
      L     DB1265.DBD   10; 
      T     DB1265.DBD  154; 

      L     DB1265.DBW   14; 
      T     DB1265.DBW  158; 

      L     DB1265.DBW   16; 
      T     DB1265.DBW  160; 

      L     DB1265.DBW   18; 
      T     DB1265.DBW  162; 

      L     DB1265.DBW   20; 
      T     DB1265.DBW  164; 

      L     DB1265.DBW   22; 
      T     DB1265.DBW  166; 

      A     DB1265.DBX   24.0; 
      =     DB1265.DBX  168.0; 

      A     DB1265.DBX   24.1; 
      =     DB1265.DBX  168.1; 

      A     DB1265.DBX   24.2; 
      =     DB1265.DBX  168.2; 

      A     DB1265.DBX   24.3; 
      =     DB1265.DBX  168.3; 

      A     DB1265.DBX   24.4; 
      =     DB1265.DBX  168.4; 

      A     DB1265.DBX   24.5; 
      =     DB1265.DBX  168.5; 

      A     DB1265.DBX   24.6; 
      =     DB1265.DBX  168.6; 

      A     DB1265.DBX   24.7; 
      =     DB1265.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1265.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1265.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U026SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1265.DBX   26.5; 

//Full Signal
//A     "U026SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1265.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1265.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1265.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1269
TITLE =U026: Well Transfer B
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1260.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1261.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1261.DBX   17.3; 
      =     DB2260.DBX  105.3; 
      =     DB2260.DBX  185.3; 
      =     DB2260.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1261.DBX   17.3; 
      =     DB2261.DBX   81.3; 
      =     DB2261.DBX  141.3; 
      =     DB2261.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1261.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1261.DBX   17.3; 
      =     DB2263.DBX  141.3; 
      =     DB2263.DBX  261.3; 
      =     DB2263.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1261.DBX   17.3; 
//      =     "U026UnVD".unv001.Sim; 
//      =     "U026UnVD".unv002.Sim; 
//      =     "U026UnVD".unv003.Sim; 
//      =     "U026UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1261.DBX   17.3; 
//      =     "U026PIDD".CO2BRV1.Ign; 

NETWORK
TITLE =Message

      A     DB1261.DBX   17.3; 
//      =     "U026MsgD".msg001.Sim; 
//      =     "U026MsgD".msg002.Sim; 
//      =     "U026MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1261.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1275
TITLE =U027: Well Transfer CF
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1270.DBW    0; 
      T     #UnitNo; 

      L     DB1275.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1275.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1275.DBD   10; 
      L     DB1275.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1275.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1275.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1275.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1271.DBX   15.0; 
      A     DB1271.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1275.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1271.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2270.DBX  106.7; 
      =     DB2270.DBX  186.7; 
      =     DB2270.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1271.DBX   15.0; 
//      AN "U027SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1275.DBD  150; 
      T     DB1271.DBD  626; 

//Temperature CIP Return
      L     DB1275.DBD  146; 
      T     DB1271.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1271.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1275.DBX  171.7; 
      JCN   pfc; 
      L     DB1271.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1275.DBX  172.0; 
      JCN   ppc; 
      L     DB1271.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1275.DBX  171.6; 
      JCN   pxc; 
      L     DB1271.DBD  574; 
pxc:  NOP   0; 
      T     DB1275.DBD  182; 

//CIP Return
      L     DB1271.DBD  558; 
      T     DB1275.DBD  186; 
      L     DB1275.DBD  138; 
      T     DB1271.DBD  562; 

//CIP Prerun
      L     DB1271.DBD  542; 
      T     DB1275.DBD  190; 
      L     DB1275.DBD  142; 
      T     DB1271.DBD  546; 

// Write Own Data to CIP
      L     DB1275.DBD   10; 
      T     DB1275.DBD  154; 

      L     DB1275.DBW   14; 
      T     DB1275.DBW  158; 

      L     DB1275.DBW   16; 
      T     DB1275.DBW  160; 

      L     DB1275.DBW   18; 
      T     DB1275.DBW  162; 

      L     DB1275.DBW   20; 
      T     DB1275.DBW  164; 

      L     DB1275.DBW   22; 
      T     DB1275.DBW  166; 

      A     DB1275.DBX   24.0; 
      =     DB1275.DBX  168.0; 

      A     DB1275.DBX   24.1; 
      =     DB1275.DBX  168.1; 

      A     DB1275.DBX   24.2; 
      =     DB1275.DBX  168.2; 

      A     DB1275.DBX   24.3; 
      =     DB1275.DBX  168.3; 

      A     DB1275.DBX   24.4; 
      =     DB1275.DBX  168.4; 

      A     DB1275.DBX   24.5; 
      =     DB1275.DBX  168.5; 

      A     DB1275.DBX   24.6; 
      =     DB1275.DBX  168.6; 

      A     DB1275.DBX   24.7; 
      =     DB1275.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1275.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1275.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U027SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1275.DBX   26.5; 

//Full Signal
//A     "U027SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1275.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1275.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1275.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1279
TITLE =U027: Well Transfer CF
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1270.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1271.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1271.DBX   17.3; 
      =     DB2270.DBX  105.3; 
      =     DB2270.DBX  185.3; 
      =     DB2270.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1271.DBX   17.3; 
      =     DB2271.DBX   81.3; 
      =     DB2271.DBX  141.3; 
      =     DB2271.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1271.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1271.DBX   17.3; 
      =     DB2273.DBX  141.3; 
      =     DB2273.DBX  261.3; 
      =     DB2273.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1271.DBX   17.3; 
//      =     "U027UnVD".unv001.Sim; 
//      =     "U027UnVD".unv002.Sim; 
//      =     "U027UnVD".unv003.Sim; 
//      =     "U027UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1271.DBX   17.3; 
//      =     "U027PIDD".CO2CFRV1.Ign; 

NETWORK
TITLE =Message

      A     DB1271.DBX   17.3; 
//      =     "U027MsgD".msg001.Sim; 
//      =     "U027MsgD".msg002.Sim; 
//      =     "U027MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1271.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1285
TITLE =U028: Well Transfer C
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1280.DBW    0; 
      T     #UnitNo; 

      L     DB1285.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1285.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1285.DBD   10; 
      L     DB1285.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1285.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1285.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1285.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1281.DBX   15.0; 
      A     DB1281.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1285.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1281.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2280.DBX  106.7; 
      =     DB2280.DBX  186.7; 
      =     DB2280.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1281.DBX   15.0; 
//      AN "U028SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1285.DBD  150; 
      T     DB1281.DBD  626; 

//Temperature CIP Return
      L     DB1285.DBD  146; 
      T     DB1281.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1281.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1285.DBX  171.7; 
      JCN   pfc; 
      L     DB1281.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1285.DBX  172.0; 
      JCN   ppc; 
      L     DB1281.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1285.DBX  171.6; 
      JCN   pxc; 
      L     DB1281.DBD  574; 
pxc:  NOP   0; 
      T     DB1285.DBD  182; 

//CIP Return
      L     DB1281.DBD  558; 
      T     DB1285.DBD  186; 
      L     DB1285.DBD  138; 
      T     DB1281.DBD  562; 

//CIP Prerun
      L     DB1281.DBD  542; 
      T     DB1285.DBD  190; 
      L     DB1285.DBD  142; 
      T     DB1281.DBD  546; 

// Write Own Data to CIP
      L     DB1285.DBD   10; 
      T     DB1285.DBD  154; 

      L     DB1285.DBW   14; 
      T     DB1285.DBW  158; 

      L     DB1285.DBW   16; 
      T     DB1285.DBW  160; 

      L     DB1285.DBW   18; 
      T     DB1285.DBW  162; 

      L     DB1285.DBW   20; 
      T     DB1285.DBW  164; 

      L     DB1285.DBW   22; 
      T     DB1285.DBW  166; 

      A     DB1285.DBX   24.0; 
      =     DB1285.DBX  168.0; 

      A     DB1285.DBX   24.1; 
      =     DB1285.DBX  168.1; 

      A     DB1285.DBX   24.2; 
      =     DB1285.DBX  168.2; 

      A     DB1285.DBX   24.3; 
      =     DB1285.DBX  168.3; 

      A     DB1285.DBX   24.4; 
      =     DB1285.DBX  168.4; 

      A     DB1285.DBX   24.5; 
      =     DB1285.DBX  168.5; 

      A     DB1285.DBX   24.6; 
      =     DB1285.DBX  168.6; 

      A     DB1285.DBX   24.7; 
      =     DB1285.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1285.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1285.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U028SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1285.DBX   26.5; 

//Full Signal
//A     "U028SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1285.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1285.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1285.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1289
TITLE =U028: Well Transfer C
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1280.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1281.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1281.DBX   17.3; 
      =     DB2280.DBX  105.3; 
      =     DB2280.DBX  185.3; 
      =     DB2280.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1281.DBX   17.3; 
      =     DB2281.DBX   81.3; 
      =     DB2281.DBX  141.3; 
      =     DB2281.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1281.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1281.DBX   17.3; 
      =     DB2283.DBX  141.3; 
      =     DB2283.DBX  261.3; 
      =     DB2283.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1281.DBX   17.3; 
//      =     "U028UnVD".unv001.Sim; 
//      =     "U028UnVD".unv002.Sim; 
//      =     "U028UnVD".unv003.Sim; 
//      =     "U028UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1281.DBX   17.3; 
//      =     "U028PIDD".CO2CRV1.Ign; 

NETWORK
TITLE =Message

      A     DB1281.DBX   17.3; 
//      =     "U028MsgD".msg001.Sim; 
//      =     "U028MsgD".msg002.Sim; 
//      =     "U028MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1281.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1295
TITLE =U029: Well Transfer B6F
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1290.DBW    0; 
      T     #UnitNo; 

      L     DB1295.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1295.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1295.DBD   10; 
      L     DB1295.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1295.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1295.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1295.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1291.DBX   15.0; 
      A     DB1291.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1295.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1291.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2290.DBX  106.7; 
      =     DB2290.DBX  186.7; 
      =     DB2290.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1291.DBX   15.0; 
//      AN "U029SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1295.DBD  150; 
      T     DB1291.DBD  626; 

//Temperature CIP Return
      L     DB1295.DBD  146; 
      T     DB1291.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1291.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1295.DBX  171.7; 
      JCN   pfc; 
      L     DB1291.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1295.DBX  172.0; 
      JCN   ppc; 
      L     DB1291.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1295.DBX  171.6; 
      JCN   pxc; 
      L     DB1291.DBD  574; 
pxc:  NOP   0; 
      T     DB1295.DBD  182; 

//CIP Return
      L     DB1291.DBD  558; 
      T     DB1295.DBD  186; 
      L     DB1295.DBD  138; 
      T     DB1291.DBD  562; 

//CIP Prerun
      L     DB1291.DBD  542; 
      T     DB1295.DBD  190; 
      L     DB1295.DBD  142; 
      T     DB1291.DBD  546; 

// Write Own Data to CIP
      L     DB1295.DBD   10; 
      T     DB1295.DBD  154; 

      L     DB1295.DBW   14; 
      T     DB1295.DBW  158; 

      L     DB1295.DBW   16; 
      T     DB1295.DBW  160; 

      L     DB1295.DBW   18; 
      T     DB1295.DBW  162; 

      L     DB1295.DBW   20; 
      T     DB1295.DBW  164; 

      L     DB1295.DBW   22; 
      T     DB1295.DBW  166; 

      A     DB1295.DBX   24.0; 
      =     DB1295.DBX  168.0; 

      A     DB1295.DBX   24.1; 
      =     DB1295.DBX  168.1; 

      A     DB1295.DBX   24.2; 
      =     DB1295.DBX  168.2; 

      A     DB1295.DBX   24.3; 
      =     DB1295.DBX  168.3; 

      A     DB1295.DBX   24.4; 
      =     DB1295.DBX  168.4; 

      A     DB1295.DBX   24.5; 
      =     DB1295.DBX  168.5; 

      A     DB1295.DBX   24.6; 
      =     DB1295.DBX  168.6; 

      A     DB1295.DBX   24.7; 
      =     DB1295.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1295.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1295.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U029SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1295.DBX   26.5; 

//Full Signal
//A     "U029SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1295.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1295.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1295.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1299
TITLE =U029: Well Transfer B6F
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1290.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1291.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1291.DBX   17.3; 
      =     DB2290.DBX  105.3; 
      =     DB2290.DBX  185.3; 
      =     DB2290.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1291.DBX   17.3; 
      =     DB2291.DBX   81.3; 
      =     DB2291.DBX  141.3; 
      =     DB2291.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1291.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1291.DBX   17.3; 
      =     DB2293.DBX  141.3; 
      =     DB2293.DBX  261.3; 
      =     DB2293.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1291.DBX   17.3; 
//      =     "U029UnVD".unv001.Sim; 
//      =     "U029UnVD".unv002.Sim; 
//      =     "U029UnVD".unv003.Sim; 
//      =     "U029UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1291.DBX   17.3; 
//      =     "U029PIDD".CO2B6FRV1.Ign; 

NETWORK
TITLE =Message

      A     DB1291.DBX   17.3; 
//      =     "U029MsgD".msg001.Sim; 
//      =     "U029MsgD".msg002.Sim; 
//      =     "U029MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1291.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1305
TITLE =U030: Well Transfer H6
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1300.DBW    0; 
      T     #UnitNo; 

      L     DB1305.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1305.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1305.DBD   10; 
      L     DB1305.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1305.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1305.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1305.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1301.DBX   15.0; 
      A     DB1301.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1305.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1301.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2300.DBX  106.7; 
      =     DB2300.DBX  186.7; 
      =     DB2300.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1301.DBX   15.0; 
//      AN "U030SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1305.DBD  150; 
      T     DB1301.DBD  626; 

//Temperature CIP Return
      L     DB1305.DBD  146; 
      T     DB1301.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1301.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1305.DBX  171.7; 
      JCN   pfc; 
      L     DB1301.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1305.DBX  172.0; 
      JCN   ppc; 
      L     DB1301.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1305.DBX  171.6; 
      JCN   pxc; 
      L     DB1301.DBD  574; 
pxc:  NOP   0; 
      T     DB1305.DBD  182; 

//CIP Return
      L     DB1301.DBD  558; 
      T     DB1305.DBD  186; 
      L     DB1305.DBD  138; 
      T     DB1301.DBD  562; 

//CIP Prerun
      L     DB1301.DBD  542; 
      T     DB1305.DBD  190; 
      L     DB1305.DBD  142; 
      T     DB1301.DBD  546; 

// Write Own Data to CIP
      L     DB1305.DBD   10; 
      T     DB1305.DBD  154; 

      L     DB1305.DBW   14; 
      T     DB1305.DBW  158; 

      L     DB1305.DBW   16; 
      T     DB1305.DBW  160; 

      L     DB1305.DBW   18; 
      T     DB1305.DBW  162; 

      L     DB1305.DBW   20; 
      T     DB1305.DBW  164; 

      L     DB1305.DBW   22; 
      T     DB1305.DBW  166; 

      A     DB1305.DBX   24.0; 
      =     DB1305.DBX  168.0; 

      A     DB1305.DBX   24.1; 
      =     DB1305.DBX  168.1; 

      A     DB1305.DBX   24.2; 
      =     DB1305.DBX  168.2; 

      A     DB1305.DBX   24.3; 
      =     DB1305.DBX  168.3; 

      A     DB1305.DBX   24.4; 
      =     DB1305.DBX  168.4; 

      A     DB1305.DBX   24.5; 
      =     DB1305.DBX  168.5; 

      A     DB1305.DBX   24.6; 
      =     DB1305.DBX  168.6; 

      A     DB1305.DBX   24.7; 
      =     DB1305.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1305.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1305.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U030SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1305.DBX   26.5; 

//Full Signal
//A     "U030SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1305.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1305.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1305.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1309
TITLE =U030: Well Transfer H6
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1300.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1301.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1301.DBX   17.3; 
      =     DB2300.DBX  105.3; 
      =     DB2300.DBX  185.3; 
      =     DB2300.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1301.DBX   17.3; 
      =     DB2301.DBX   81.3; 
      =     DB2301.DBX  141.3; 
      =     DB2301.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1301.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1301.DBX   17.3; 
      =     DB2303.DBX  141.3; 
      =     DB2303.DBX  261.3; 
      =     DB2303.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1301.DBX   17.3; 
//      =     "U030UnVD".unv001.Sim; 
//      =     "U030UnVD".unv002.Sim; 
//      =     "U030UnVD".unv003.Sim; 
//      =     "U030UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1301.DBX   17.3; 
//      =     "U030PIDD".CO2H6FRV1.Ign; 

NETWORK
TITLE =Message

      A     DB1301.DBX   17.3; 
//      =     "U030MsgD".msg001.Sim; 
//      =     "U030MsgD".msg002.Sim; 
//      =     "U030MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1301.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1315
TITLE =U031: Well Transfer J6
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  SEND_DONE : BOOL ;	
  SEND_ERROR : BOOL ;	
  SEND_STATUS : WORD ;	
  RECV_NDR : BOOL ;	
  RECV_ERROR : BOOL ;	
  RECV_STATUS : WORD ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1310.DBW    0; 
      T     #UnitNo; 

      L     DB1315.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1315.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1315.DBD   10; 
      L     DB1315.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1315.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE = read from other unit data



NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1311.DBX   15.0; 
      A     DB1311.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1315.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1311.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1319
TITLE =U031: Well Transfer J6
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1310.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1311.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1311.DBX   17.3; 
      =     DB2310.DBX  105.3; 
      =     DB2310.DBX  185.3; 
      =     DB2310.DBX  265.3; 
      =     DB2310.DBX  345.3; 

NETWORK
TITLE =Special Input

      A     DB1311.DBX   17.3; 
      =     DB2311.DBX   81.3; 
      =     DB2311.DBX  141.3; 
      =     DB2311.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1311.DBX   17.3; 
      A     M    101.0; 


NETWORK
TITLE =Analog Input

      A     DB1311.DBX   17.3; 
      =     DB2313.DBX  141.3; 
      =     DB2313.DBX  261.3; 
      =     DB2313.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1311.DBX   17.3; 
//      =     "U031UnVD".unv001.Sim; 
//      =     "U031UnVD".unv002.Sim; 
//      =     "U031UnVD".unv003.Sim; 
//      =     "U031UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1311.DBX   17.3; 
//  =     "U031PIDD".CO2J6FRV1.Sim

NETWORK
TITLE =Message

      A     DB1311.DBX   17.3; 
//      =     "U031MsgD".msg001.Sim; 
//      =     "U031MsgD".msg002.Sim; 
//      =     "U031MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1311.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1325
TITLE =U032: Well Transfer L6F
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1320.DBW    0; 
      T     #UnitNo; 

      L     DB1325.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1325.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1325.DBD   10; 
      L     DB1325.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1325.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1325.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1325.GEN,

           RET_VAL                  := #wRetVal);

// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1325.CIP,

           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1321.DBX   15.0; 
      A     DB1321.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1325.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1321.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2320.DBX  106.7; 
      =     DB2320.DBX  186.7; 
      =     DB2320.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1321.DBX   15.0; 
//      AN "U032SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1325.DBD  150; 
      T     DB1321.DBD  626; 

//Temperature CIP Return
      L     DB1325.DBD  146; 
      T     DB1321.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1321.DBD  686,

           Indexes                  := #SFM36);

      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1325.DBX  171.7; 
      JCN   pfc; 
      L     DB1321.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1325.DBX  172.0; 
      JCN   ppc; 
      L     DB1321.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1325.DBX  171.6; 
      JCN   pxc; 
      L     DB1321.DBD  574; 
pxc:  NOP   0; 
      T     DB1325.DBD  182; 

//CIP Return
      L     DB1321.DBD  558; 
      T     DB1325.DBD  186; 
      L     DB1325.DBD  138; 
      T     DB1321.DBD  562; 

//CIP Prerun
      L     DB1321.DBD  542; 
      T     DB1325.DBD  190; 
      L     DB1325.DBD  142; 
      T     DB1321.DBD  546; 

// Write Own Data to CIP
      L     DB1325.DBD   10; 
      T     DB1325.DBD  154; 

      L     DB1325.DBW   14; 
      T     DB1325.DBW  158; 

      L     DB1325.DBW   16; 
      T     DB1325.DBW  160; 

      L     DB1325.DBW   18; 
      T     DB1325.DBW  162; 

      L     DB1325.DBW   20; 
      T     DB1325.DBW  164; 

      L     DB1325.DBW   22; 
      T     DB1325.DBW  166; 

      A     DB1325.DBX   24.0; 
      =     DB1325.DBX  168.0; 

      A     DB1325.DBX   24.1; 
      =     DB1325.DBX  168.1; 

      A     DB1325.DBX   24.2; 
      =     DB1325.DBX  168.2; 

      A     DB1325.DBX   24.3; 
      =     DB1325.DBX  168.3; 

      A     DB1325.DBX   24.4; 
      =     DB1325.DBX  168.4; 

      A     DB1325.DBX   24.5; 
      =     DB1325.DBX  168.5; 

      A     DB1325.DBX   24.6; 
      =     DB1325.DBX  168.6; 

      A     DB1325.DBX   24.7; 
      =     DB1325.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1325.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1325.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U032SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1325.DBX   26.5; 

//Full Signal
//A     "U032SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1325.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1325.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1325.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1329
TITLE =U032: Well Transfer L6F
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1320.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1321.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1321.DBX   17.3; 
      =     DB2320.DBX  105.3; 
      =     DB2320.DBX  185.3; 
      =     DB2320.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1321.DBX   17.3; 
      =     DB2321.DBX   81.3; 
      =     DB2321.DBX  141.3; 
      =     DB2321.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1321.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1321.DBX   17.3; 
      =     DB2323.DBX  141.3; 
      =     DB2323.DBX  261.3; 
      =     DB2323.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1321.DBX   17.3; 
//      =     "U032UnVD".unv001.Sim; 
//      =     "U032UnVD".unv002.Sim; 
//      =     "U032UnVD".unv003.Sim; 
//      =     "U032UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1321.DBX   17.3; 
//      =     "U032PIDD".CO2L6FRV1.Ign; 

NETWORK
TITLE =Message

      A     DB1321.DBX   17.3; 
//      =     "U032MsgD".msg001.Sim; 
//      =     "U032MsgD".msg002.Sim; 
//      =     "U032MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1321.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1335
TITLE =U033: Well Transfer B6
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1330.DBW    0; 
      T     #UnitNo; 

      L     DB1335.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1335.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1335.DBD   10; 
      L     DB1335.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1335.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1335.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1335.GEN,

           RET_VAL                  := #wRetVal);

// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1335.CIP,

           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1331.DBX   15.0; 
      A     DB1331.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1335.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1331.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2330.DBX  106.7; 
      =     DB2330.DBX  186.7; 
      =     DB2330.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1331.DBX   15.0; 
//      AN "U033SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1335.DBD  150; 
      T     DB1331.DBD  626; 

//Temperature CIP Return
      L     DB1335.DBD  146; 
      T     DB1331.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1331.DBD  686,

           Indexes                  := #SFM36);

      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1335.DBX  171.7; 
      JCN   pfc; 
      L     DB1331.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1335.DBX  172.0; 
      JCN   ppc; 
      L     DB1331.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1335.DBX  171.6; 
      JCN   pxc; 
      L     DB1331.DBD  574; 
pxc:  NOP   0; 
      T     DB1335.DBD  182; 

//CIP Return
      L     DB1331.DBD  558; 
      T     DB1335.DBD  186; 
      L     DB1335.DBD  138; 
      T     DB1331.DBD  562; 

//CIP Prerun
      L     DB1331.DBD  542; 
      T     DB1335.DBD  190; 
      L     DB1335.DBD  142; 
      T     DB1331.DBD  546; 

// Write Own Data to CIP
      L     DB1335.DBD   10; 
      T     DB1335.DBD  154; 

      L     DB1335.DBW   14; 
      T     DB1335.DBW  158; 

      L     DB1335.DBW   16; 
      T     DB1335.DBW  160; 

      L     DB1335.DBW   18; 
      T     DB1335.DBW  162; 

      L     DB1335.DBW   20; 
      T     DB1335.DBW  164; 

      L     DB1335.DBW   22; 
      T     DB1335.DBW  166; 

      A     DB1335.DBX   24.0; 
      =     DB1335.DBX  168.0; 

      A     DB1335.DBX   24.1; 
      =     DB1335.DBX  168.1; 

      A     DB1335.DBX   24.2; 
      =     DB1335.DBX  168.2; 

      A     DB1335.DBX   24.3; 
      =     DB1335.DBX  168.3; 

      A     DB1335.DBX   24.4; 
      =     DB1335.DBX  168.4; 

      A     DB1335.DBX   24.5; 
      =     DB1335.DBX  168.5; 

      A     DB1335.DBX   24.6; 
      =     DB1335.DBX  168.6; 

      A     DB1335.DBX   24.7; 
      =     DB1335.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1335.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1335.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U033SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1335.DBX   26.5; 

//Full Signal
//A     "U033SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1335.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1335.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1335.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1339
TITLE =U033: Well Transfer B6
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1330.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1331.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1331.DBX   17.3; 
      =     DB2330.DBX  105.3; 
      =     DB2330.DBX  185.3; 
      =     DB2330.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1331.DBX   17.3; 
      =     DB2331.DBX   81.3; 
      =     DB2331.DBX  141.3; 
      =     DB2331.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1331.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1331.DBX   17.3; 
      =     DB2333.DBX  141.3; 
      =     DB2333.DBX  261.3; 
      =     DB2333.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1331.DBX   17.3; 
//      =     "U033UnVD".unv001.Sim; 
//      =     "U033UnVD".unv002.Sim; 
//      =     "U033UnVD".unv003.Sim; 
//      =     "U033UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1331.DBX   17.3; 
//      =     "U033PIDD".CO2B6RV1.Ign; 

NETWORK
TITLE =Message

      A     DB1331.DBX   17.3; 
//      =     "U033MsgD".msg001.Sim; 
//      =     "U033MsgD".msg002.Sim; 
//      =     "U033MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1331.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1345
TITLE =U034: Well Transfer D6
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1340.DBW    0; 
      T     #UnitNo; 

      L     DB1345.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1345.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1345.DBD   10; 
      L     DB1345.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1345.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1345.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1345.GEN,

           RET_VAL                  := #wRetVal);

// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1345.CIP,

           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1341.DBX   15.0; 
      A     DB1341.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1345.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1341.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2340.DBX  106.7; 
      =     DB2340.DBX  186.7; 
      =     DB2340.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1341.DBX   15.0; 
//      AN "U034SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1345.DBD  150; 
      T     DB1341.DBD  626; 

//Temperature CIP Return
      L     DB1345.DBD  146; 
      T     DB1341.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1341.DBD  686,

           Indexes                  := #SFM36);

      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1345.DBX  171.7; 
      JCN   pfc; 
      L     DB1341.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1345.DBX  172.0; 
      JCN   ppc; 
      L     DB1341.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1345.DBX  171.6; 
      JCN   pxc; 
      L     DB1341.DBD  574; 
pxc:  NOP   0; 
      T     DB1345.DBD  182; 

//CIP Return
      L     DB1341.DBD  558; 
      T     DB1345.DBD  186; 
      L     DB1345.DBD  138; 
      T     DB1341.DBD  562; 

//CIP Prerun
      L     DB1341.DBD  542; 
      T     DB1345.DBD  190; 
      L     DB1345.DBD  142; 
      T     DB1341.DBD  546; 

// Write Own Data to CIP
      L     DB1345.DBD   10; 
      T     DB1345.DBD  154; 

      L     DB1345.DBW   14; 
      T     DB1345.DBW  158; 

      L     DB1345.DBW   16; 
      T     DB1345.DBW  160; 

      L     DB1345.DBW   18; 
      T     DB1345.DBW  162; 

      L     DB1345.DBW   20; 
      T     DB1345.DBW  164; 

      L     DB1345.DBW   22; 
      T     DB1345.DBW  166; 

      A     DB1345.DBX   24.0; 
      =     DB1345.DBX  168.0; 

      A     DB1345.DBX   24.1; 
      =     DB1345.DBX  168.1; 

      A     DB1345.DBX   24.2; 
      =     DB1345.DBX  168.2; 

      A     DB1345.DBX   24.3; 
      =     DB1345.DBX  168.3; 

      A     DB1345.DBX   24.4; 
      =     DB1345.DBX  168.4; 

      A     DB1345.DBX   24.5; 
      =     DB1345.DBX  168.5; 

      A     DB1345.DBX   24.6; 
      =     DB1345.DBX  168.6; 

      A     DB1345.DBX   24.7; 
      =     DB1345.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1345.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1345.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U034SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1345.DBX   26.5; 

//Full Signal
//A     "U034SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1345.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1345.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1345.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1349
TITLE =U034: Well Transfer D6
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1340.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1341.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1341.DBX   17.3; 
      =     DB2340.DBX  105.3; 
      =     DB2340.DBX  185.3; 
      =     DB2340.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1341.DBX   17.3; 
      =     DB2341.DBX   81.3; 
      =     DB2341.DBX  141.3; 
      =     DB2341.DBX  201.3; 

NETWORK
TITLE =Counter

      A     DB1341.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1341.DBX   17.3; 
      =     DB2343.DBX  141.3; 
      =     DB2343.DBX  261.3; 
      =     DB2343.DBX  381.3; 

NETWORK
TITLE =Universal Value

      A     DB1341.DBX   17.3; 
//      =     "U034UnVD".unv001.Sim; 
//      =     "U034UnVD".unv002.Sim; 
//      =     "U034UnVD".unv003.Sim; 
//      =     "U034UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1341.DBX   17.3; 
//      =     "U034PIDD".CO2D6RV1.Ign; 

NETWORK
TITLE =Message

      A     DB1341.DBX   17.3; 
//      =     "U034MsgD".msg001.Sim; 
//      =     "U034MsgD".msg002.Sim; 
//      =     "U034MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1341.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1385
TITLE =U038: Water Treatment 1
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1380.DBW    0; 
      T     #UnitNo; 

      L     DB1385.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1385.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1385.DBD   10; 
      L     DB1385.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1385.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1385.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1385.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1385.CIP,
           RET_VAL                  := #wRetVal);

//----------------------------------------
// Communication Well Transfer VE1
//----------------------------------------
      L     DB1381.DBD 1134; // Source
      ITD   ; 
      DTR   ; 
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1385.DST,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
      AN    DB1385.DBX  216.7; 
      A     DB1385.DBX  216.0; 
      A     DB1381.DBX   15.0; 
      A     DB1381.DBX   17.4; 
      JCN   Strt; 
      L     DB1385.DBD  202; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1381.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2380.DBX  106.7; 
      =     DB2380.DBX  186.7; 
      =     DB2380.DBX  266.7; 
      =     DB2380.DBX  426.7; 
      =     DB2380.DBX  506.7; 
      =     DB2380.DBX  586.7; 
      =     DB2380.DBX  666.7; 
      =     DB2380.DBX  746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1381.DBX   15.0; 
//      AN "U038SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1385.DBD  150; 
      T     DB1381.DBD  626; 

//Temperature CIP Return
      L     DB1385.DBD  146; 
      T     DB1381.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1381.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1385.DBX  171.7; 
      JCN   pfc; 
      L     DB1381.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1385.DBX  172.0; 
      JCN   ppc; 
      L     DB1381.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1385.DBX  171.6; 
      JCN   pxc; 
      L     DB1381.DBD  574; 
pxc:  NOP   0; 
      T     DB1385.DBD  182; 

//CIP Return
      L     DB1381.DBD  558; 
      T     DB1385.DBD  186; 
      L     DB1385.DBD  138; 
      T     DB1381.DBD  562; 

//CIP Prerun
      L     DB1381.DBD  542; 
      T     DB1385.DBD  190; 
      L     DB1385.DBD  142; 
      T     DB1381.DBD  546; 

// Write Own Data to CIP
      L     DB1385.DBD   10; 
      T     DB1385.DBD  154; 

      L     DB1385.DBW   14; 
      T     DB1385.DBW  158; 

      L     DB1385.DBW   16; 
      T     DB1385.DBW  160; 

      L     DB1385.DBW   18; 
      T     DB1385.DBW  162; 

      L     DB1385.DBW   20; 
      T     DB1385.DBW  164; 

      L     DB1385.DBW   22; 
      T     DB1385.DBW  166; 

      A     DB1385.DBX   24.0; 
      =     DB1385.DBX  168.0; 

      A     DB1385.DBX   24.1; 
      =     DB1385.DBX  168.1; 

      A     DB1385.DBX   24.2; 
      =     DB1385.DBX  168.2; 

      A     DB1385.DBX   24.3; 
      =     DB1385.DBX  168.3; 

      A     DB1385.DBX   24.4; 
      =     DB1385.DBX  168.4; 

      A     DB1385.DBX   24.5; 
      =     DB1385.DBX  168.5; 

      A     DB1385.DBX   24.6; 
      =     DB1385.DBX  168.6; 

      A     DB1385.DBX   24.7; 
      =     DB1385.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1385.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1385.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U038SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1385.DBX   26.5; 

//Full Signal
//A     "U038SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1385.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1385.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1385.DBX   27.0; //Emergency Stop OK

// Lifebit
      A     DB2381.DBX  258.7; 
      =     DB2380.DBX  748.2; 



NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1389
TITLE =U038: Water Treatment 1
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1380.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1381.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1381.DBX   17.3; 
      =     DB2380.DBX  105.3; 
      =     DB2380.DBX  185.3; 
      =     DB2380.DBX  265.3; 
      =     DB2380.DBX  425.3; 
      =     DB2380.DBX  505.3; 
      =     DB2380.DBX  585.3; 
      =     DB2380.DBX  665.3; 
      =     DB2380.DBX  745.3; 

NETWORK
TITLE =Special Input

      A     DB1381.DBX   17.3; 
      =     DB2381.DBX   81.3; 
      =     DB2381.DBX  141.3; 
      =     DB2381.DBX  201.3; 
      =     DB2381.DBX  261.3; 
      =     DB2381.DBX  321.3; 
      =     DB2381.DBX  381.3; 
      =     DB2381.DBX  441.3; 

NETWORK
TITLE =Counter

      A     DB1381.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1381.DBX   17.3; 
      =     DB2383.DBX  141.3; 
      =     DB2383.DBX  261.3; 
      =     DB2383.DBX  381.3; 
      =     DB2383.DBX  501.3; 

NETWORK
TITLE =Universal Value

      A     DB1381.DBX   17.3; 
//      =     "U038UnVD".unv001.Sim; 
//      =     "U038UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1381.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1381.DBX   17.3; 
//      =     "U038MsgD".msg001.Sim; 
//      =     "U038MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1381.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1395
TITLE =U039: Water Treatment 2
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1390.DBW    0; 
      T     #UnitNo; 

      L     DB1395.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1395.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1395.DBD   10; 
      L     DB1395.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1395.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1395.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1395.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1395.CIP,
           RET_VAL                  := #wRetVal);

//----------------------------------------
// Communication Well Transfer VE2
//----------------------------------------
      L     DB1391.DBD 1134; // Source
      ITD   ; 
      DTR   ; 
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1395.DST,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
      AN    DB1395.DBX  216.7; 
      A     DB1395.DBX  216.0; 
      A     DB1391.DBX   15.0; 
      A     DB1391.DBX   17.4; 
      JCN   Strt; 
      L     DB1395.DBD  202; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1391.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2390.DBX  106.7; 
      =     DB2390.DBX  186.7; 
      =     DB2390.DBX  266.7; 
      =     DB2390.DBX  426.7; 
      =     DB2390.DBX  506.7; 
      =     DB2390.DBX  586.7; 
      =     DB2390.DBX  666.7; 
      =     DB2390.DBX  746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1391.DBX   15.0; 
//      AN "U039SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1395.DBD  150; 
      T     DB1391.DBD  626; 

//Temperature CIP Return
      L     DB1395.DBD  146; 
      T     DB1391.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1391.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1395.DBX  171.7; 
      JCN   pfc; 
      L     DB1391.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1395.DBX  172.0; 
      JCN   ppc; 
      L     DB1391.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1395.DBX  171.6; 
      JCN   pxc; 
      L     DB1391.DBD  574; 
pxc:  NOP   0; 
      T     DB1395.DBD  182; 

//CIP Return
      L     DB1391.DBD  558; 
      T     DB1395.DBD  186; 
      L     DB1395.DBD  138; 
      T     DB1391.DBD  562; 

//CIP Prerun
      L     DB1391.DBD  542; 
      T     DB1395.DBD  190; 
      L     DB1395.DBD  142; 
      T     DB1391.DBD  546; 

// Write Own Data to CIP
      L     DB1395.DBD   10; 
      T     DB1395.DBD  154; 

      L     DB1395.DBW   14; 
      T     DB1395.DBW  158; 

      L     DB1395.DBW   16; 
      T     DB1395.DBW  160; 

      L     DB1395.DBW   18; 
      T     DB1395.DBW  162; 

      L     DB1395.DBW   20; 
      T     DB1395.DBW  164; 

      L     DB1395.DBW   22; 
      T     DB1395.DBW  166; 

      A     DB1395.DBX   24.0; 
      =     DB1395.DBX  168.0; 

      A     DB1395.DBX   24.1; 
      =     DB1395.DBX  168.1; 

      A     DB1395.DBX   24.2; 
      =     DB1395.DBX  168.2; 

      A     DB1395.DBX   24.3; 
      =     DB1395.DBX  168.3; 

      A     DB1395.DBX   24.4; 
      =     DB1395.DBX  168.4; 

      A     DB1395.DBX   24.5; 
      =     DB1395.DBX  168.5; 

      A     DB1395.DBX   24.6; 
      =     DB1395.DBX  168.6; 

      A     DB1395.DBX   24.7; 
      =     DB1395.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1395.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1395.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U039SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1395.DBX   26.5; 

//Full Signal
//A     "U039SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1395.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1395.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1395.DBX   27.0; //Emergency Stop OK


// Life bit
      A     DB2391.DBX  258.7; 
      =     DB2390.DBX  748.2; 


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1399
TITLE =U039: Water Treatment 2
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1390.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1391.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1391.DBX   17.3; 
      =     DB2390.DBX  105.3; 
      =     DB2390.DBX  185.3; 
      =     DB2390.DBX  265.3; 
      =     DB2390.DBX  425.3; 
      =     DB2390.DBX  505.3; 
      =     DB2390.DBX  585.3; 
      =     DB2390.DBX  665.3; 
      =     DB2390.DBX  745.3; 

NETWORK
TITLE =Special Input

      A     DB1391.DBX   17.3; 
      =     DB2391.DBX   81.3; 
      =     DB2391.DBX  141.3; 
      =     DB2391.DBX  201.3; 
      =     DB2391.DBX  261.3; 

NETWORK
TITLE =Counter

      A     DB1391.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1391.DBX   17.3; 
      =     DB2393.DBX  141.3; 
      =     DB2393.DBX  261.3; 
      =     DB2393.DBX  381.3; 
      =     DB2393.DBX  501.3; 

NETWORK
TITLE =Universal Value

      A     DB1391.DBX   17.3; 
//      =     "U039UnVD".unv001.Sim; 
//      =     "U039UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1391.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1391.DBX   17.3; 
//      =     "U039MsgD".msg001.Sim; 
//      =     "U039MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1391.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1405
TITLE =U040: Water Treatment General
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1400.DBW    0; 
      T     #UnitNo; 

      L     DB1405.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1405.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1405.DBD   10; 
      L     DB1405.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1405.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1405.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1405.GEN,

           RET_VAL                  := #wRetVal);

// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1405.CIP,

           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1401.DBX   15.0; 
      A     DB1401.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1405.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1401.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1401.DBX   15.0; 
//      AN "U040SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1405.DBD  150; 
      T     DB1401.DBD  626; 

//Temperature CIP Return
      L     DB1405.DBD  146; 
      T     DB1401.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1401.DBD  686,

           Indexes                  := #SFM36);

      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1405.DBX  171.7; 
      JCN   pfc; 
      L     DB1401.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1405.DBX  172.0; 
      JCN   ppc; 
      L     DB1401.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1405.DBX  171.6; 
      JCN   pxc; 
      L     DB1401.DBD  574; 
pxc:  NOP   0; 
      T     DB1405.DBD  182; 

//CIP Return
      L     DB1401.DBD  558; 
      T     DB1405.DBD  186; 
      L     DB1405.DBD  138; 
      T     DB1401.DBD  562; 

//CIP Prerun
      L     DB1401.DBD  542; 
      T     DB1405.DBD  190; 
      L     DB1405.DBD  142; 
      T     DB1401.DBD  546; 

// Write Own Data to CIP
      L     DB1405.DBD   10; 
      T     DB1405.DBD  154; 

      L     DB1405.DBW   14; 
      T     DB1405.DBW  158; 

      L     DB1405.DBW   16; 
      T     DB1405.DBW  160; 

      L     DB1405.DBW   18; 
      T     DB1405.DBW  162; 

      L     DB1405.DBW   20; 
      T     DB1405.DBW  164; 

      L     DB1405.DBW   22; 
      T     DB1405.DBW  166; 

      A     DB1405.DBX   24.0; 
      =     DB1405.DBX  168.0; 

      A     DB1405.DBX   24.1; 
      =     DB1405.DBX  168.1; 

      A     DB1405.DBX   24.2; 
      =     DB1405.DBX  168.2; 

      A     DB1405.DBX   24.3; 
      =     DB1405.DBX  168.3; 

      A     DB1405.DBX   24.4; 
      =     DB1405.DBX  168.4; 

      A     DB1405.DBX   24.5; 
      =     DB1405.DBX  168.5; 

      A     DB1405.DBX   24.6; 
      =     DB1405.DBX  168.6; 

      A     DB1405.DBX   24.7; 
      =     DB1405.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1405.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1405.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U040SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1405.DBX   26.5; 

//Full Signal
//A     "U040SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1405.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1405.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1405.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1409
TITLE =U040: Water Treatment General
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1400.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1401.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1401.DBX   17.3; 

NETWORK
TITLE =Special Input

      A     DB1401.DBX   17.3; 
      =     DB2401.DBX   81.3; 
      =     DB2401.DBX  141.3; 
      =     DB2401.DBX  201.3; 
      =     DB2401.DBX  261.3; 
      =     DB2401.DBX  321.3; 
      =     DB2401.DBX  381.3; 

NETWORK
TITLE =Counter

      A     DB1401.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1401.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1401.DBX   17.3; 
//      =     "U040UnVD".unv001.Sim; 
//      =     "U040UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1401.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1401.DBX   17.3; 
//      =     "U040MsgD".msg001.Sim; 
//      =     "U040MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1401.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1435
TITLE =U043: Water Transfer Plant 3
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1430.DBW    0; 
      T     #UnitNo; 

      L     DB1435.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1435.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1435.DBD   10; 
      L     DB1435.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1435.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1435.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1435.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 71,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1435.CIP,
           RET_VAL                  := #wRetVal);



NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1431.DBX   15.0; 
      A     DB1431.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1431.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2430.DBX  186.7; 
      =     DB2430.DBX  266.7; 
      =     DB2430.DBX  346.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1431.DBX   15.0; 
//      AN "U043SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1435.DBD  150; 
      T     DB1431.DBD  626; 

//Temperature CIP Return
      L     DB1435.DBD  146; 
      T     DB1431.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1431.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1435.DBX  171.7; 
      JCN   pfc; 
      L     DB1431.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1435.DBX  172.0; 
      JCN   ppc; 
      L     DB1431.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1435.DBX  171.6; 
      JCN   pxc; 
      L     DB1431.DBD  574; 
pxc:  NOP   0; 
      T     DB1435.DBD  182; 

//CIP Return
      L     DB1431.DBD  558; 
      T     DB1435.DBD  186; 
      L     DB1435.DBD  138; 
      T     DB1431.DBD  562; 

//CIP Prerun
      L     DB1431.DBD  542; 
      T     DB1435.DBD  190; 
      L     DB1435.DBD  142; 
      T     DB1431.DBD  546; 

// Write Own Data to CIP
      L     DB1435.DBD   10; 
      T     DB1435.DBD  154; 

      L     DB1435.DBW   14; 
      T     DB1435.DBW  158; 

      L     DB1435.DBW   16; 
      T     DB1435.DBW  160; 

      L     DB1435.DBW   18; 
      T     DB1435.DBW  162; 

      L     DB1435.DBW   20; 
      T     DB1435.DBW  164; 

      L     DB1435.DBW   22; 
      T     DB1435.DBW  166; 

      A     DB1435.DBX   24.0; 
      =     DB1435.DBX  168.0; 

      A     DB1435.DBX   24.1; 
      =     DB1435.DBX  168.1; 

      A     DB1435.DBX   24.2; 
      =     DB1435.DBX  168.2; 

      A     DB1435.DBX   24.3; 
      =     DB1435.DBX  168.3; 

      A     DB1435.DBX   24.4; 
      =     DB1435.DBX  168.4; 

      A     DB1435.DBX   24.5; 
      =     DB1435.DBX  168.5; 

      A     DB1435.DBX   24.6; 
      =     DB1435.DBX  168.6; 

      A     DB1435.DBX   24.7; 
      =     DB1435.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1435.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1435.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U043SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1435.DBX   26.5; 

//Full Signal
//A     "U043SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1435.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1435.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1435.DBX   27.0; //Emergency Stop OK



NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1439
TITLE =U043: Water Transfer Plant 3
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1430.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1431.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1431.DBX   17.3; 
      =     DB2430.DBX  185.3; 
      =     DB2430.DBX  265.3; 
      =     DB2430.DBX  345.3; 

NETWORK
TITLE =Special Input

      A     DB1431.DBX   17.3; 
      =     DB2431.DBX   81.3; 

NETWORK
TITLE =Counter

      A     DB1431.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1431.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1431.DBX   17.3; 
//      =     "U043UnVD".unv001.Sim; 
//      =     "U043UnVD".unv002.Sim; 
//      =     "U043UnVD".unv003.Sim; 
//      =     "U043UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1431.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1431.DBX   17.3; 
//      =     "U043MsgD".msg001.Sim; 
//      =     "U043MsgD".msg002.Sim; 
//      =     "U043MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1431.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1455
TITLE =U045: Water Transfer Plant 5
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  SRCUnit : INT ;	//Source Water Tank
  DummyBool : BOOL ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1450.DBW    0; 
      T     #UnitNo; 

      L     DB1455.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1455.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1455.DBD   10; 
      L     DB1455.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1455.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      L     DB1455.DBD   10; 

// !!! insert correct condition of unit start !!!
      A     DB1451.DBX   15.0; 
      A     DB1451.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1455.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1451.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1459
TITLE =U045: Water Transfer Plant 5
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1450.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1451.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1451.DBX   17.3; 
      =     DB2450.DBX  425.3; 
      =     DB2450.DBX  505.3; 
      =     DB2450.DBX  585.3; 
      =     DB2450.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1451.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1451.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1451.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1451.DBX   17.3; 
//      =     "U045UnVD".unv001.Sim; 
//      =     "U045UnVD".unv002.Sim; 
//      =     "U045UnVD".unv003.Sim; 
//      =     "U045UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1451.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1451.DBX   17.3; 
//      =     "U045MsgD".msg001.Sim; 
//      =     "U045MsgD".msg002.Sim; 
//      =     "U045MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1451.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1475
TITLE =U047: Water Transfer Plant 7
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1470.DBW    0; 
      T     #UnitNo; 

      L     DB1475.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1475.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1475.DBD   10; 
      L     DB1475.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1475.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1475.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1475.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1471.DBX   15.0; 
      A     DB1471.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1475.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1471.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2470.DBX  186.7; 
      =     DB2470.DBX  266.7; 
      =     DB2470.DBX  346.7; 
      =     DB2470.DBX  426.7; 
      =     DB2470.DBX  506.7; 
      =     DB2470.DBX  586.7; 
      =     DB2470.DBX  666.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1471.DBX   15.0; 
//      AN "U047SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1475.DBD  150; 
      T     DB1471.DBD  626; 

//Temperature CIP Return
      L     DB1475.DBD  146; 
      T     DB1471.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1471.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1475.DBX  171.7; 
      JCN   pfc; 
      L     DB1471.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1475.DBX  172.0; 
      JCN   ppc; 
      L     DB1471.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1475.DBX  171.6; 
      JCN   pxc; 
      L     DB1471.DBD  574; 
pxc:  NOP   0; 
      T     DB1475.DBD  182; 

//CIP Return
      L     DB1471.DBD  558; 
      T     DB1475.DBD  186; 
      L     DB1475.DBD  138; 
      T     DB1471.DBD  562; 

//CIP Prerun
      L     DB1471.DBD  542; 
      T     DB1475.DBD  190; 
      L     DB1475.DBD  142; 
      T     DB1471.DBD  546; 

// Write Own Data to CIP
      L     DB1475.DBD   10; 
      T     DB1475.DBD  154; 

      L     DB1475.DBW   14; 
      T     DB1475.DBW  158; 

      L     DB1475.DBW   16; 
      T     DB1475.DBW  160; 

      L     DB1475.DBW   18; 
      T     DB1475.DBW  162; 

      L     DB1475.DBW   20; 
      T     DB1475.DBW  164; 

      L     DB1475.DBW   22; 
      T     DB1475.DBW  166; 

      A     DB1475.DBX   24.0; 
      =     DB1475.DBX  168.0; 

      A     DB1475.DBX   24.1; 
      =     DB1475.DBX  168.1; 

      A     DB1475.DBX   24.2; 
      =     DB1475.DBX  168.2; 

      A     DB1475.DBX   24.3; 
      =     DB1475.DBX  168.3; 

      A     DB1475.DBX   24.4; 
      =     DB1475.DBX  168.4; 

      A     DB1475.DBX   24.5; 
      =     DB1475.DBX  168.5; 

      A     DB1475.DBX   24.6; 
      =     DB1475.DBX  168.6; 

      A     DB1475.DBX   24.7; 
      =     DB1475.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1475.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1475.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U047SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1475.DBX   26.5; 

//Full Signal
//A     "U047SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1475.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1475.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1475.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1479
TITLE =U047: Water Transfer Plant 7
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1470.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1471.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1471.DBX   17.3; 
      =     DB2470.DBX  185.3; 
      =     DB2470.DBX  265.3; 
      =     DB2470.DBX  345.3; 
      =     DB2470.DBX  425.3; 
      =     DB2470.DBX  505.3; 
      =     DB2470.DBX  585.3; 
      =     DB2470.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1471.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1471.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1471.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1471.DBX   17.3; 
//      =     "U047UnVD".unv001.Sim; 
//      =     "U047UnVD".unv002.Sim; 
//      =     "U047UnVD".unv003.Sim; 
//      =     "U047UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1471.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1471.DBX   17.3; 
//      =     "U047MsgD".msg001.Sim; 
//      =     "U047MsgD".msg002.Sim; 
//      =     "U047MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1471.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1485
TITLE =U048: Water Transfer Plant 8
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1480.DBW    0; 
      T     #UnitNo; 

      L     DB1485.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1485.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1485.DBD   10; 
      L     DB1485.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1485.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1485.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1485.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1481.DBX   15.0; 
      A     DB1481.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1485.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1481.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2480.DBX  426.7; 
      =     DB2480.DBX  506.7; 
      =     DB2480.DBX  586.7; 
      =     DB2480.DBX  666.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1481.DBX   15.0; 
//      AN "U048SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1485.DBD  150; 
      T     DB1481.DBD  626; 

//Temperature CIP Return
      L     DB1485.DBD  146; 
      T     DB1481.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1481.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1485.DBX  171.7; 
      JCN   pfc; 
      L     DB1481.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1485.DBX  172.0; 
      JCN   ppc; 
      L     DB1481.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1485.DBX  171.6; 
      JCN   pxc; 
      L     DB1481.DBD  574; 
pxc:  NOP   0; 
      T     DB1485.DBD  182; 

//CIP Return
      L     DB1481.DBD  558; 
      T     DB1485.DBD  186; 
      L     DB1485.DBD  138; 
      T     DB1481.DBD  562; 

//CIP Prerun
      L     DB1481.DBD  542; 
      T     DB1485.DBD  190; 
      L     DB1485.DBD  142; 
      T     DB1481.DBD  546; 

// Write Own Data to CIP
      L     DB1485.DBD   10; 
      T     DB1485.DBD  154; 

      L     DB1485.DBW   14; 
      T     DB1485.DBW  158; 

      L     DB1485.DBW   16; 
      T     DB1485.DBW  160; 

      L     DB1485.DBW   18; 
      T     DB1485.DBW  162; 

      L     DB1485.DBW   20; 
      T     DB1485.DBW  164; 

      L     DB1485.DBW   22; 
      T     DB1485.DBW  166; 

      A     DB1485.DBX   24.0; 
      =     DB1485.DBX  168.0; 

      A     DB1485.DBX   24.1; 
      =     DB1485.DBX  168.1; 

      A     DB1485.DBX   24.2; 
      =     DB1485.DBX  168.2; 

      A     DB1485.DBX   24.3; 
      =     DB1485.DBX  168.3; 

      A     DB1485.DBX   24.4; 
      =     DB1485.DBX  168.4; 

      A     DB1485.DBX   24.5; 
      =     DB1485.DBX  168.5; 

      A     DB1485.DBX   24.6; 
      =     DB1485.DBX  168.6; 

      A     DB1485.DBX   24.7; 
      =     DB1485.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1485.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1485.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U048SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1485.DBX   26.5; 

//Full Signal
//A     "U048SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1485.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1485.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1485.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1489
TITLE =U048: Water Transfer Plant 8
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1480.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1481.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1481.DBX   17.3; 
      =     DB2480.DBX  425.3; 
      =     DB2480.DBX  505.3; 
      =     DB2480.DBX  585.3; 
      =     DB2480.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1481.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1481.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1481.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1481.DBX   17.3; 
//      =     "U048UnVD".unv001.Sim; 
//      =     "U048UnVD".unv002.Sim; 
//      =     "U048UnVD".unv003.Sim; 
//      =     "U048UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1481.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1481.DBX   17.3; 
//      =     "U048MsgD".msg001.Sim; 
//      =     "U048MsgD".msg002.Sim; 
//      =     "U048MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1481.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1495
TITLE =U049: Water Transfer Plant 9
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1490.DBW    0; 
      T     #UnitNo; 

      L     DB1495.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1495.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1495.DBD   10; 
      L     DB1495.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1495.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1495.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1495.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1491.DBX   15.0; 
      A     DB1491.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1495.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1491.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2490.DBX  186.7; 
      =     DB2490.DBX  266.7; 
      =     DB2490.DBX  346.7; 
      =     DB2490.DBX  426.7; 
      =     DB2490.DBX  506.7; 
      =     DB2490.DBX  586.7; 
      =     DB2490.DBX  666.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1491.DBX   15.0; 
//      AN "U049SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1495.DBD  150; 
      T     DB1491.DBD  626; 

//Temperature CIP Return
      L     DB1495.DBD  146; 
      T     DB1491.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1491.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1495.DBX  171.7; 
      JCN   pfc; 
      L     DB1491.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1495.DBX  172.0; 
      JCN   ppc; 
      L     DB1491.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1495.DBX  171.6; 
      JCN   pxc; 
      L     DB1491.DBD  574; 
pxc:  NOP   0; 
      T     DB1495.DBD  182; 

//CIP Return
      L     DB1491.DBD  558; 
      T     DB1495.DBD  186; 
      L     DB1495.DBD  138; 
      T     DB1491.DBD  562; 

//CIP Prerun
      L     DB1491.DBD  542; 
      T     DB1495.DBD  190; 
      L     DB1495.DBD  142; 
      T     DB1491.DBD  546; 

// Write Own Data to CIP
      L     DB1495.DBD   10; 
      T     DB1495.DBD  154; 

      L     DB1495.DBW   14; 
      T     DB1495.DBW  158; 

      L     DB1495.DBW   16; 
      T     DB1495.DBW  160; 

      L     DB1495.DBW   18; 
      T     DB1495.DBW  162; 

      L     DB1495.DBW   20; 
      T     DB1495.DBW  164; 

      L     DB1495.DBW   22; 
      T     DB1495.DBW  166; 

      A     DB1495.DBX   24.0; 
      =     DB1495.DBX  168.0; 

      A     DB1495.DBX   24.1; 
      =     DB1495.DBX  168.1; 

      A     DB1495.DBX   24.2; 
      =     DB1495.DBX  168.2; 

      A     DB1495.DBX   24.3; 
      =     DB1495.DBX  168.3; 

      A     DB1495.DBX   24.4; 
      =     DB1495.DBX  168.4; 

      A     DB1495.DBX   24.5; 
      =     DB1495.DBX  168.5; 

      A     DB1495.DBX   24.6; 
      =     DB1495.DBX  168.6; 

      A     DB1495.DBX   24.7; 
      =     DB1495.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1495.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1495.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U049SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1495.DBX   26.5; 

//Full Signal
//A     "U049SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1495.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1495.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1495.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1499
TITLE =U049: Water Transfer Plant 9
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1490.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1491.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1491.DBX   17.3; 
      =     DB2490.DBX  185.3; 
      =     DB2490.DBX  265.3; 
      =     DB2490.DBX  345.3; 
      =     DB2490.DBX  425.3; 
      =     DB2490.DBX  505.3; 
      =     DB2490.DBX  585.3; 
      =     DB2490.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1491.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1491.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1491.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1491.DBX   17.3; 
//      =     "U049UnVD".unv001.Sim; 
//      =     "U049UnVD".unv002.Sim; 
//      =     "U049UnVD".unv003.Sim; 
//      =     "U049UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1491.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1491.DBX   17.3; 
//      =     "U049MsgD".msg001.Sim; 
//      =     "U049MsgD".msg002.Sim; 
//      =     "U049MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1491.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1505
TITLE =U050: Water Transfer Plant 10
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1500.DBW    0; 
      T     #UnitNo; 

      L     DB1505.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1505.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1505.DBD   10; 
      L     DB1505.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1505.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1505.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1505.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1501.DBX   15.0; 
      A     DB1501.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1505.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1501.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2500.DBX  186.7; 
      =     DB2500.DBX  266.7; 
      =     DB2500.DBX  346.7; 
      =     DB2500.DBX  426.7; 
      =     DB2500.DBX  506.7; 
      =     DB2500.DBX  586.7; 
      =     DB2500.DBX  666.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1501.DBX   15.0; 
//      AN "U050SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1505.DBD  150; 
      T     DB1501.DBD  626; 

//Temperature CIP Return
      L     DB1505.DBD  146; 
      T     DB1501.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1501.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1505.DBX  171.7; 
      JCN   pfc; 
      L     DB1501.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1505.DBX  172.0; 
      JCN   ppc; 
      L     DB1501.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1505.DBX  171.6; 
      JCN   pxc; 
      L     DB1501.DBD  574; 
pxc:  NOP   0; 
      T     DB1505.DBD  182; 

//CIP Return
      L     DB1501.DBD  558; 
      T     DB1505.DBD  186; 
      L     DB1505.DBD  138; 
      T     DB1501.DBD  562; 

//CIP Prerun
      L     DB1501.DBD  542; 
      T     DB1505.DBD  190; 
      L     DB1505.DBD  142; 
      T     DB1501.DBD  546; 

// Write Own Data to CIP
      L     DB1505.DBD   10; 
      T     DB1505.DBD  154; 

      L     DB1505.DBW   14; 
      T     DB1505.DBW  158; 

      L     DB1505.DBW   16; 
      T     DB1505.DBW  160; 

      L     DB1505.DBW   18; 
      T     DB1505.DBW  162; 

      L     DB1505.DBW   20; 
      T     DB1505.DBW  164; 

      L     DB1505.DBW   22; 
      T     DB1505.DBW  166; 

      A     DB1505.DBX   24.0; 
      =     DB1505.DBX  168.0; 

      A     DB1505.DBX   24.1; 
      =     DB1505.DBX  168.1; 

      A     DB1505.DBX   24.2; 
      =     DB1505.DBX  168.2; 

      A     DB1505.DBX   24.3; 
      =     DB1505.DBX  168.3; 

      A     DB1505.DBX   24.4; 
      =     DB1505.DBX  168.4; 

      A     DB1505.DBX   24.5; 
      =     DB1505.DBX  168.5; 

      A     DB1505.DBX   24.6; 
      =     DB1505.DBX  168.6; 

      A     DB1505.DBX   24.7; 
      =     DB1505.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1505.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1505.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U050SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1505.DBX   26.5; 

//Full Signal
//A     "U050SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1505.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1505.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1505.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1509
TITLE =U050: Water Transfer Plant 10
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1500.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1501.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1501.DBX   17.3; 
      =     DB2500.DBX  185.3; 
      =     DB2500.DBX  265.3; 
      =     DB2500.DBX  345.3; 
      =     DB2500.DBX  425.3; 
      =     DB2500.DBX  505.3; 
      =     DB2500.DBX  585.3; 
      =     DB2500.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1501.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1501.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1501.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1501.DBX   17.3; 
//      =     "U050UnVD".unv001.Sim; 
//      =     "U050UnVD".unv002.Sim; 
//      =     "U050UnVD".unv003.Sim; 
//      =     "U050UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1501.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1501.DBX   17.3; 
//      =     "U050MsgD".msg001.Sim; 
//      =     "U050MsgD".msg002.Sim; 
//      =     "U050MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1501.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1515
TITLE =U051: Water Transfer Plant 11
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1510.DBW    0; 
      T     #UnitNo; 

      L     DB1515.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1515.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1515.DBD   10; 
      L     DB1515.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1515.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1515.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1515.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1511.DBX   15.0; 
      A     DB1511.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1515.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1511.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2510.DBX  186.7; 
      =     DB2510.DBX  266.7; 
      =     DB2510.DBX  346.7; 
      =     DB2510.DBX  426.7; 
      =     DB2510.DBX  506.7; 
      =     DB2510.DBX  586.7; 
      =     DB2510.DBX  666.7; 
      =     DB2510.DBX  746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1511.DBX   15.0; 
//      AN "U051SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1515.DBD  150; 
      T     DB1511.DBD  626; 

//Temperature CIP Return
      L     DB1515.DBD  146; 
      T     DB1511.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1511.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1515.DBX  171.7; 
      JCN   pfc; 
      L     DB1511.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1515.DBX  172.0; 
      JCN   ppc; 
      L     DB1511.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1515.DBX  171.6; 
      JCN   pxc; 
      L     DB1511.DBD  574; 
pxc:  NOP   0; 
      T     DB1515.DBD  182; 

//CIP Return
      L     DB1511.DBD  558; 
      T     DB1515.DBD  186; 
      L     DB1515.DBD  138; 
      T     DB1511.DBD  562; 

//CIP Prerun
      L     DB1511.DBD  542; 
      T     DB1515.DBD  190; 
      L     DB1515.DBD  142; 
      T     DB1511.DBD  546; 

// Write Own Data to CIP
      L     DB1515.DBD   10; 
      T     DB1515.DBD  154; 

      L     DB1515.DBW   14; 
      T     DB1515.DBW  158; 

      L     DB1515.DBW   16; 
      T     DB1515.DBW  160; 

      L     DB1515.DBW   18; 
      T     DB1515.DBW  162; 

      L     DB1515.DBW   20; 
      T     DB1515.DBW  164; 

      L     DB1515.DBW   22; 
      T     DB1515.DBW  166; 

      A     DB1515.DBX   24.0; 
      =     DB1515.DBX  168.0; 

      A     DB1515.DBX   24.1; 
      =     DB1515.DBX  168.1; 

      A     DB1515.DBX   24.2; 
      =     DB1515.DBX  168.2; 

      A     DB1515.DBX   24.3; 
      =     DB1515.DBX  168.3; 

      A     DB1515.DBX   24.4; 
      =     DB1515.DBX  168.4; 

      A     DB1515.DBX   24.5; 
      =     DB1515.DBX  168.5; 

      A     DB1515.DBX   24.6; 
      =     DB1515.DBX  168.6; 

      A     DB1515.DBX   24.7; 
      =     DB1515.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1515.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1515.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U051SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1515.DBX   26.5; 

//Full Signal
//A     "U051SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1515.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1515.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1515.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1519
TITLE =U051: Water Transfer Plant 11
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1510.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1511.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1511.DBX   17.3; 
      =     DB2510.DBX  185.3; 
      =     DB2510.DBX  265.3; 
      =     DB2510.DBX  345.3; 
      =     DB2510.DBX  425.3; 
      =     DB2510.DBX  505.3; 
      =     DB2510.DBX  585.3; 
      =     DB2510.DBX  665.3; 
      =     DB2510.DBX  745.3; 

NETWORK
TITLE =Special Input

      A     DB1511.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1511.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1511.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1511.DBX   17.3; 
//      =     "U051UnVD".unv001.Sim; 
//      =     "U051UnVD".unv002.Sim; 
//      =     "U051UnVD".unv003.Sim; 
//      =     "U051UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1511.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1511.DBX   17.3; 
//      =     "U051MsgD".msg001.Sim; 
//      =     "U051MsgD".msg002.Sim; 
//      =     "U051MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1511.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1525
TITLE =U052: Water Transfer Plant 12
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1520.DBW    0; 
      T     #UnitNo; 

      L     DB1525.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1525.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1525.DBD   10; 
      L     DB1525.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1525.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1525.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1525.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1521.DBX   15.0; 
      A     DB1521.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1525.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1521.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2520.DBX  186.7; 
      =     DB2520.DBX  266.7; 
      =     DB2520.DBX  346.7; 
      =     DB2520.DBX  426.7; 
      =     DB2520.DBX  506.7; 
      =     DB2520.DBX  586.7; 
      =     DB2520.DBX  666.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1521.DBX   15.0; 
//      AN "U052SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1525.DBD  150; 
      T     DB1521.DBD  626; 

//Temperature CIP Return
      L     DB1525.DBD  146; 
      T     DB1521.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1521.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1525.DBX  171.7; 
      JCN   pfc; 
      L     DB1521.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1525.DBX  172.0; 
      JCN   ppc; 
      L     DB1521.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1525.DBX  171.6; 
      JCN   pxc; 
      L     DB1521.DBD  574; 
pxc:  NOP   0; 
      T     DB1525.DBD  182; 

//CIP Return
      L     DB1521.DBD  558; 
      T     DB1525.DBD  186; 
      L     DB1525.DBD  138; 
      T     DB1521.DBD  562; 

//CIP Prerun
      L     DB1521.DBD  542; 
      T     DB1525.DBD  190; 
      L     DB1525.DBD  142; 
      T     DB1521.DBD  546; 

// Write Own Data to CIP
      L     DB1525.DBD   10; 
      T     DB1525.DBD  154; 

      L     DB1525.DBW   14; 
      T     DB1525.DBW  158; 

      L     DB1525.DBW   16; 
      T     DB1525.DBW  160; 

      L     DB1525.DBW   18; 
      T     DB1525.DBW  162; 

      L     DB1525.DBW   20; 
      T     DB1525.DBW  164; 

      L     DB1525.DBW   22; 
      T     DB1525.DBW  166; 

      A     DB1525.DBX   24.0; 
      =     DB1525.DBX  168.0; 

      A     DB1525.DBX   24.1; 
      =     DB1525.DBX  168.1; 

      A     DB1525.DBX   24.2; 
      =     DB1525.DBX  168.2; 

      A     DB1525.DBX   24.3; 
      =     DB1525.DBX  168.3; 

      A     DB1525.DBX   24.4; 
      =     DB1525.DBX  168.4; 

      A     DB1525.DBX   24.5; 
      =     DB1525.DBX  168.5; 

      A     DB1525.DBX   24.6; 
      =     DB1525.DBX  168.6; 

      A     DB1525.DBX   24.7; 
      =     DB1525.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1525.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1525.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U052SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1525.DBX   26.5; 

//Full Signal
//A     "U052SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1525.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1525.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1525.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1529
TITLE =U052: Water Transfer Plant 12
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1520.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1521.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1521.DBX   17.3; 
      =     DB2520.DBX  185.3; 
      =     DB2520.DBX  265.3; 
      =     DB2520.DBX  345.3; 
      =     DB2520.DBX  425.3; 
      =     DB2520.DBX  505.3; 
      =     DB2520.DBX  585.3; 
      =     DB2520.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1521.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1521.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1521.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1521.DBX   17.3; 
//      =     "U052UnVD".unv001.Sim; 
//      =     "U052UnVD".unv002.Sim; 
//      =     "U052UnVD".unv003.Sim; 
//      =     "U052UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1521.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1521.DBX   17.3; 
//      =     "U052MsgD".msg001.Sim; 
//      =     "U052MsgD".msg002.Sim; 
//      =     "U052MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1521.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1545
TITLE =U054: Water Transfer Plant 14
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1540.DBW    0; 
      T     #UnitNo; 

      L     DB1545.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1545.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1545.DBD   10; 
      L     DB1545.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1545.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1545.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1545.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1541.DBX   15.0; 
      A     DB1541.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1545.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1541.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2540.DBX  186.7; 
      =     DB2540.DBX  266.7; 
      =     DB2540.DBX  346.7; 
      =     DB2540.DBX  426.7; 
      =     DB2540.DBX  506.7; 
      =     DB2540.DBX  586.7; 
      =     DB2540.DBX  666.7; 
      =     DB2540.DBX  746.7; 
      =     DB2540.DBX  826.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1541.DBX   15.0; 
//      AN "U054SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1545.DBD  150; 
      T     DB1541.DBD  626; 

//Temperature CIP Return
      L     DB1545.DBD  146; 
      T     DB1541.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1541.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1545.DBX  171.7; 
      JCN   pfc; 
      L     DB1541.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1545.DBX  172.0; 
      JCN   ppc; 
      L     DB1541.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1545.DBX  171.6; 
      JCN   pxc; 
      L     DB1541.DBD  574; 
pxc:  NOP   0; 
      T     DB1545.DBD  182; 

//CIP Return
      L     DB1541.DBD  558; 
      T     DB1545.DBD  186; 
      L     DB1545.DBD  138; 
      T     DB1541.DBD  562; 

//CIP Prerun
      L     DB1541.DBD  542; 
      T     DB1545.DBD  190; 
      L     DB1545.DBD  142; 
      T     DB1541.DBD  546; 

// Write Own Data to CIP
      L     DB1545.DBD   10; 
      T     DB1545.DBD  154; 

      L     DB1545.DBW   14; 
      T     DB1545.DBW  158; 

      L     DB1545.DBW   16; 
      T     DB1545.DBW  160; 

      L     DB1545.DBW   18; 
      T     DB1545.DBW  162; 

      L     DB1545.DBW   20; 
      T     DB1545.DBW  164; 

      L     DB1545.DBW   22; 
      T     DB1545.DBW  166; 

      A     DB1545.DBX   24.0; 
      =     DB1545.DBX  168.0; 

      A     DB1545.DBX   24.1; 
      =     DB1545.DBX  168.1; 

      A     DB1545.DBX   24.2; 
      =     DB1545.DBX  168.2; 

      A     DB1545.DBX   24.3; 
      =     DB1545.DBX  168.3; 

      A     DB1545.DBX   24.4; 
      =     DB1545.DBX  168.4; 

      A     DB1545.DBX   24.5; 
      =     DB1545.DBX  168.5; 

      A     DB1545.DBX   24.6; 
      =     DB1545.DBX  168.6; 

      A     DB1545.DBX   24.7; 
      =     DB1545.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1545.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1545.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U054SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1545.DBX   26.5; 

//Full Signal
//A     "U054SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1545.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1545.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1545.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1549
TITLE =U054: Water Transfer Plant 14
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1540.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1541.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1541.DBX   17.3; 
      =     DB2540.DBX  185.3; 
      =     DB2540.DBX  265.3; 
      =     DB2540.DBX  345.3; 
      =     DB2540.DBX  425.3; 
      =     DB2540.DBX  505.3; 
      =     DB2540.DBX  585.3; 
      =     DB2540.DBX  665.3; 
      =     DB2540.DBX  745.3; 
      =     DB2540.DBX  825.3; 

NETWORK
TITLE =Special Input

      A     DB1541.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1541.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1541.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1541.DBX   17.3; 
//      =     "U054UnVD".unv001.Sim; 
//      =     "U054UnVD".unv002.Sim; 
//      =     "U054UnVD".unv003.Sim; 
//      =     "U054UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1541.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1541.DBX   17.3; 
//      =     "U054MsgD".msg001.Sim; 
//      =     "U054MsgD".msg002.Sim; 
//      =     "U054MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1541.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1555
TITLE =U055: Water Transfer Plant 15
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1550.DBW    0; 
      T     #UnitNo; 

      L     DB1555.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1555.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1555.DBD   10; 
      L     DB1555.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1555.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1555.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1555.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1551.DBX   15.0; 
      A     DB1551.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1555.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1551.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2550.DBX  426.7; 
      =     DB2550.DBX  506.7; 
      =     DB2550.DBX  586.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1551.DBX   15.0; 
//      AN "U055SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1555.DBD  150; 
      T     DB1551.DBD  626; 

//Temperature CIP Return
      L     DB1555.DBD  146; 
      T     DB1551.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1551.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1555.DBX  171.7; 
      JCN   pfc; 
      L     DB1551.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1555.DBX  172.0; 
      JCN   ppc; 
      L     DB1551.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1555.DBX  171.6; 
      JCN   pxc; 
      L     DB1551.DBD  574; 
pxc:  NOP   0; 
      T     DB1555.DBD  182; 

//CIP Return
      L     DB1551.DBD  558; 
      T     DB1555.DBD  186; 
      L     DB1555.DBD  138; 
      T     DB1551.DBD  562; 

//CIP Prerun
      L     DB1551.DBD  542; 
      T     DB1555.DBD  190; 
      L     DB1555.DBD  142; 
      T     DB1551.DBD  546; 

// Write Own Data to CIP
      L     DB1555.DBD   10; 
      T     DB1555.DBD  154; 

      L     DB1555.DBW   14; 
      T     DB1555.DBW  158; 

      L     DB1555.DBW   16; 
      T     DB1555.DBW  160; 

      L     DB1555.DBW   18; 
      T     DB1555.DBW  162; 

      L     DB1555.DBW   20; 
      T     DB1555.DBW  164; 

      L     DB1555.DBW   22; 
      T     DB1555.DBW  166; 

      A     DB1555.DBX   24.0; 
      =     DB1555.DBX  168.0; 

      A     DB1555.DBX   24.1; 
      =     DB1555.DBX  168.1; 

      A     DB1555.DBX   24.2; 
      =     DB1555.DBX  168.2; 

      A     DB1555.DBX   24.3; 
      =     DB1555.DBX  168.3; 

      A     DB1555.DBX   24.4; 
      =     DB1555.DBX  168.4; 

      A     DB1555.DBX   24.5; 
      =     DB1555.DBX  168.5; 

      A     DB1555.DBX   24.6; 
      =     DB1555.DBX  168.6; 

      A     DB1555.DBX   24.7; 
      =     DB1555.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1555.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1555.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U055SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1555.DBX   26.5; 

//Full Signal
//A     "U055SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1555.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1555.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1555.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1559
TITLE =U055: Water Transfer Plant 15
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1550.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1551.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1551.DBX   17.3; 
      =     DB2550.DBX  425.3; 
      =     DB2550.DBX  505.3; 
      =     DB2550.DBX  585.3; 

NETWORK
TITLE =Special Input

      A     DB1551.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1551.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1551.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1551.DBX   17.3; 
//      =     "U055UnVD".unv001.Sim; 
//      =     "U055UnVD".unv002.Sim; 
//      =     "U055UnVD".unv003.Sim; 
//      =     "U055UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1551.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1551.DBX   17.3; 
//      =     "U055MsgD".msg001.Sim; 
//      =     "U055MsgD".msg002.Sim; 
//      =     "U055MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1551.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1565
TITLE =U056: Fresh Water Transfer
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1560.DBW    0; 
      T     #UnitNo; 

      L     DB1565.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1565.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1565.DBD   10; 
      L     DB1565.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1565.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1565.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1565.DBW   14,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIP,
           RET_VAL                  := #wRetVal);


// ... CIP Distribution ------------- /

      L     DB1561.DBD   46; 
      L     DB1945.DBD   10; 
      ==D   ; 
      JCN   CIP1; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 94,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1565.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP1);

CIP1: NOP   0; 

      L     DB1561.DBD   46; 
      L     DB1955.DBD   10; 
      ==D   ; 
      JCN   CIP2; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 95,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1565.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP2);
CIP2: NOP   0; 

      L     DB1561.DBD   46; 
      L     DB1965.DBD   10; 
      ==D   ; 
      JCN   CIP3; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 96,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1565.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP3);

CIP3: NOP   0; 

//----------------------------------------
// Communication Water Tank 
//----------------------------------------
// Current Tank ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1561.DBD  270,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T0xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.SRC,
           RET_VAL                  := #wRetVal);
      JU    T0xy; 
T0xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1565.SRC);
T0xy: NOP   0; 

// Priority 1 -----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1561.DBD  286,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T1xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.SRC1,
           RET_VAL                  := #wRetVal);
      JU    T1xy; 
T1xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1565.SRC1);
T1xy: NOP   0; 

// Priority 2 ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1561.DBD  302,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T2xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.SRC2,
           RET_VAL                  := #wRetVal);
      JU    T2xy; 
T2xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1565.SRC2);
T2xy: NOP   0; 

// Pririty 3 ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1561.DBD  318,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T3xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1565.SRC3,
           RET_VAL                  := #wRetVal);
      JU    T3xy; 
T3xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1565.SRC3);
T3xy: NOP   0; 

//----------------------------------------
// Communication Fresh Water
//----------------------------------------
///   L     #U.Seq.Prop.Index0          // Destination
///   ITD   
///   DTR   
///   T     #rTmp

///  CALL  "Eq2PU"
//       EquipmentNo:=#rTmp
//       PLCNo      :=#iPLC
//       UnitNo     :=#iUnit

///  CALL  "UIT3"
//       ActReq      :="Clk1E"
//       PLCNo       :=#iPLC
//       SourceUnitNo:=#iUnit
//       IsTUnit     :=FALSE
//       DstComDRec  :="C04ComD".DST
//       RET_VAL     :=#wRetVal



NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1561.DBX   15.0; 
      A     DB1561.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1565.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1561.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2560.DBX  106.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1561.DBX   15.0; 
//      AN "U056SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1565.DBD  150; 
      T     DB1561.DBD  626; 

//Temperature CIP Return
      L     DB1565.DBD  146; 
      T     DB1561.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1561.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1565.DBX  171.7; 
      JCN   pfc; 
      L     DB1561.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1565.DBX  172.0; 
      JCN   ppc; 
      L     DB1561.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1565.DBX  171.6; 
      JCN   pxc; 
      L     DB1561.DBD  574; 
pxc:  NOP   0; 
      T     DB1565.DBD  182; 

//CIP Return
      L     DB1561.DBD  558; 
      T     DB1565.DBD  186; 
      L     DB1565.DBD  138; 
      T     DB1561.DBD  562; 

//CIP Prerun
      L     DB1561.DBD  542; 
      T     DB1565.DBD  190; 
      L     DB1565.DBD  142; 
      T     DB1561.DBD  546; 

// Write Own Data to CIP
      L     DB1565.DBD   10; 
      T     DB1565.DBD  154; 

      L     DB1565.DBW   14; 
      T     DB1565.DBW  158; 

      L     DB1565.DBW   16; 
      T     DB1565.DBW  160; 

      L     DB1565.DBW   18; 
      T     DB1565.DBW  162; 

      L     DB1565.DBW   20; 
      T     DB1565.DBW  164; 

      L     DB1565.DBW   22; 
      T     DB1565.DBW  166; 

      A     DB1565.DBX   24.0; 
      =     DB1565.DBX  168.0; 

      A     DB1565.DBX   24.1; 
      =     DB1565.DBX  168.1; 

      A     DB1565.DBX   24.2; 
      =     DB1565.DBX  168.2; 

      A     DB1565.DBX   24.3; 
      =     DB1565.DBX  168.3; 

      A     DB1565.DBX   24.4; 
      =     DB1565.DBX  168.4; 

      A     DB1565.DBX   24.5; 
      =     DB1565.DBX  168.5; 

      A     DB1565.DBX   24.6; 
      =     DB1565.DBX  168.6; 

      A     DB1565.DBX   24.7; 
      =     DB1565.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1565.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1565.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U056SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1565.DBX   26.5; 

//Full Signal
//A     "U056SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1565.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1565.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1565.DBX   27.0; //Emergency Stop OK

      L     DB1561.DBD  782; // Material
      T     DB1565.DBD   30; 

      L     DB1561.DBD  270; // Current Water Tank Selection
      T     DB1565.DBD   34; 

      L     DB1561.DBD  286; // Priority 1
      T     DB1565.DBD   38; 

      L     DB1561.DBD  302; // Priority 2
      T     DB1565.DBD   42; 

      L     DB1561.DBD  318; // Priority 3
      T     DB1565.DBD   46; 

NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1569
TITLE =U056: Fresh Water Transfer
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1560.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1561.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1561.DBX   17.3; 
      =     DB2560.DBX  105.3; 
      =     DB2560.DBX  505.3; 

NETWORK
TITLE =Special Input

      A     DB1561.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB1561.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1561.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1561.DBX   17.3; 
//      =     "U056UnVD".unv001.Sim; 
//      =     "U056UnVD".unv002.Sim; 
//      =     "U056UnVD".unv003.Sim; 
//      =     "U056UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1561.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1561.DBX   17.3; 
//      =     "U056MsgD".msg001.Sim; 
//      =     "U056MsgD".msg002.Sim; 
//      =     "U056MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1561.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1575
TITLE =U057: Water Transfer Brewhouse
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1570.DBW    0; 
      T     #UnitNo; 

      L     DB1575.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1575.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1575.DBD   10; 
      L     DB1575.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1575.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1575.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1575.DBW   14,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIP,
           RET_VAL                  := #wRetVal);


// ... CIP Distribution ------------- /

      L     DB1571.DBD   46; 
      L     DB1945.DBD   10; 
      ==D   ; 
      JCN   CIP1; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 94,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1575.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP1);

CIP1: NOP   0; 

      L     DB1571.DBD   46; 
      L     DB1955.DBD   10; 
      ==D   ; 
      JCN   CIP2; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 95,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1575.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP2);
CIP2: NOP   0; 

      L     DB1571.DBD   46; 
      L     DB1965.DBD   10; 
      ==D   ; 
      JCN   CIP3; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 96,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1575.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP3);

CIP3: NOP   0; 

//----------------------------------------
// Communication Water Tank 
//----------------------------------------
// Current Tank ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1571.DBD  270,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T0xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.SRC,
           RET_VAL                  := #wRetVal);
      JU    T0xy; 
T0xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1575.SRC);
T0xy: NOP   0; 

// Priority 1 -----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1571.DBD  286,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T1xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.SRC1,
           RET_VAL                  := #wRetVal);
      JU    T1xy; 
T1xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1575.SRC1);
T1xy: NOP   0; 

// Priority 2 ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1571.DBD  302,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T2xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.SRC2,
           RET_VAL                  := #wRetVal);
      JU    T2xy; 
T2xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1575.SRC2);
T2xy: NOP   0; 

// Pririty 3 ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1571.DBD  318,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T3xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1575.SRC3,
           RET_VAL                  := #wRetVal);
      JU    T3xy; 
T3xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1575.SRC3);
T3xy: NOP   0; 

//----------------------------------------
// Communication Brewhouse
//----------------------------------------
///   L     #U.Seq.Prop.Index0          // Destination
///   ITD   
///   DTR   
///   T     #rTmp

///  CALL  "Eq2PU"
//       EquipmentNo:=#rTmp
//       PLCNo      :=#iPLC
//       UnitNo     :=#iUnit

///  CALL  "UIT3"
//       ActReq      :="Clk1E"
//       PLCNo       :=#iPLC
//       SourceUnitNo:=#iUnit
//       IsTUnit     :=FALSE
//       DstComDRec  :="C04ComD".DST
//       RET_VAL     :=#wRetVal



NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1571.DBX   15.0; 
      A     DB1571.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1575.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1571.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2570.DBX  106.7; 
      =     DB2570.DBX  426.7; 
      =     DB2570.DBX  506.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1571.DBX   15.0; 
//      AN "U057SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1575.DBD  150; 
      T     DB1571.DBD  626; 

//Temperature CIP Return
      L     DB1575.DBD  146; 
      T     DB1571.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1571.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1575.DBX  171.7; 
      JCN   pfc; 
      L     DB1571.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1575.DBX  172.0; 
      JCN   ppc; 
      L     DB1571.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1575.DBX  171.6; 
      JCN   pxc; 
      L     DB1571.DBD  574; 
pxc:  NOP   0; 
      T     DB1575.DBD  182; 

//CIP Return
      L     DB1571.DBD  558; 
      T     DB1575.DBD  186; 
      L     DB1575.DBD  138; 
      T     DB1571.DBD  562; 

//CIP Prerun
      L     DB1571.DBD  542; 
      T     DB1575.DBD  190; 
      L     DB1575.DBD  142; 
      T     DB1571.DBD  546; 

// Write Own Data to CIP
      L     DB1575.DBD   10; 
      T     DB1575.DBD  154; 

      L     DB1575.DBW   14; 
      T     DB1575.DBW  158; 

      L     DB1575.DBW   16; 
      T     DB1575.DBW  160; 

      L     DB1575.DBW   18; 
      T     DB1575.DBW  162; 

      L     DB1575.DBW   20; 
      T     DB1575.DBW  164; 

      L     DB1575.DBW   22; 
      T     DB1575.DBW  166; 

      A     DB1575.DBX   24.0; 
      =     DB1575.DBX  168.0; 

      A     DB1575.DBX   24.1; 
      =     DB1575.DBX  168.1; 

      A     DB1575.DBX   24.2; 
      =     DB1575.DBX  168.2; 

      A     DB1575.DBX   24.3; 
      =     DB1575.DBX  168.3; 

      A     DB1575.DBX   24.4; 
      =     DB1575.DBX  168.4; 

      A     DB1575.DBX   24.5; 
      =     DB1575.DBX  168.5; 

      A     DB1575.DBX   24.6; 
      =     DB1575.DBX  168.6; 

      A     DB1575.DBX   24.7; 
      =     DB1575.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1575.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1575.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U057SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1575.DBX   26.5; 

//Full Signal
//A     "U057SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1575.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1575.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1575.DBX   27.0; //Emergency Stop OK

      L     DB1571.DBD  782; // Material
      T     DB1575.DBD   30; 

      L     DB1571.DBD  270; // Current Water Tank Selection
      T     DB1575.DBD   34; 

      L     DB1571.DBD  286; // Priority 1
      T     DB1575.DBD   38; 

      L     DB1571.DBD  302; // Priority 2
      T     DB1575.DBD   42; 

      L     DB1571.DBD  318; // Priority 3
      T     DB1575.DBD   46; 

NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1579
TITLE =U057: Water Transfer Brewhouse
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1570.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1571.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1571.DBX   17.3; 
      =     DB2570.DBX  105.3; 
      =     DB2570.DBX  185.3; 
      =     DB2570.DBX  265.3; 
      =     DB2570.DBX  345.3; 
      =     DB2570.DBX  505.3; 


NETWORK
TITLE =Special Input

      A     DB1571.DBX   17.3; 
      =     DB2571.DBX  141.3; 
      =     DB2571.DBX  201.3; 
      =     DB2571.DBX  261.3; 
      =     DB2571.DBX  321.3; 
      =     DB2571.DBX  381.3; 

NETWORK
TITLE =Counter

      A     DB1571.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1571.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1571.DBX   17.3; 
//      =     "U057UnVD".unv001.Sim; 
//      =     "U057UnVD".unv002.Sim; 
//      =     "U057UnVD".unv003.Sim; 
//      =     "U057UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1571.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1571.DBX   17.3; 
//      =     "U057MsgD".msg001.Sim; 
//      =     "U057MsgD".msg002.Sim; 
//      =     "U057MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1571.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1585
TITLE =U058: Water Transfer Syrup
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1580.DBW    0; 
      T     #UnitNo; 

      L     DB1585.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1585.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1585.DBD   10; 
      L     DB1585.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1585.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1585.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1585.DBW   14,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.CIP,
           RET_VAL                  := #wRetVal);


// ... CIP Distribution ------------- /
      L     DB1581.DBD   46; 
      L     DB1955.DBD   10; 
      ==D   ; 
      JCN   CIP2; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 95,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.CIPDist,
           RET_VAL                  := #wRetVal);

      CALL SFC   20 (
           SRCBLK                   := DB1585.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP2);
CIP2: NOP   0; 

//----------------------------------------
// Communication Water Tank 
//----------------------------------------
// Current Tank ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1581.DBD  270,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T0xx; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.SRC,
           RET_VAL                  := #wRetVal);
      JU    T0xy; 
T0xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1585.SRC);
T0xy: NOP   0; 

// Priority 1 -----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1581.DBD  286,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T1xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.SRC1,
           RET_VAL                  := #wRetVal);
      JU    T1xy; 
T1xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1585.SRC1);
T1xy: NOP   0; 

// Priority 2 ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1581.DBD  302,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T2xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.SRC2,
           RET_VAL                  := #wRetVal);
      JU    T2xy; 
T2xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1585.SRC2);
T2xy: NOP   0; 

// Pririty 3 ----------------------------
      CALL FC   950 (
           EquipmentNo              := DB1581.DBD  318,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);
      L     #iUnit; 
      L     0; 
      >I    ; 
      JCN   T3xx; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.SRC3,
           RET_VAL                  := #wRetVal);
      JU    T3xy; 
T3xx: NOP   0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1585.SRC3);
T3xy: NOP   0; 


// Sirupraum
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 8,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1585.DST,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1581.DBX   15.0; 
      A     DB1581.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1585.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1581.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2580.DBX  106.7; 
      =     DB2580.DBX  186.7; 
      =     DB2580.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1581.DBX   15.0; 
//      AN "U058SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1585.DBD  150; 
      T     DB1581.DBD  626; 

//Temperature CIP Return
      L     DB1585.DBD  146; 
      T     DB1581.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1581.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1585.DBX  171.7; 
      JCN   pfc; 
      L     DB1581.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1585.DBX  172.0; 
      JCN   ppc; 
      L     DB1581.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1585.DBX  171.6; 
      JCN   pxc; 
      L     DB1581.DBD  574; 
pxc:  NOP   0; 
      T     DB1585.DBD  182; 

//CIP Return
      L     DB1581.DBD  558; 
      T     DB1585.DBD  186; 
      L     DB1585.DBD  138; 
      T     DB1581.DBD  562; 

//CIP Prerun
      L     DB1581.DBD  542; 
      T     DB1585.DBD  190; 
      L     DB1585.DBD  142; 
      T     DB1581.DBD  546; 

// Write Own Data to CIP
      L     DB1585.DBD   10; 
      T     DB1585.DBD  154; 

      L     DB1585.DBW   14; 
      T     DB1585.DBW  158; 

      L     DB1585.DBW   16; 
      T     DB1585.DBW  160; 

      L     DB1585.DBW   18; 
      T     DB1585.DBW  162; 

      L     DB1585.DBW   20; 
      T     DB1585.DBW  164; 

      L     DB1585.DBW   22; 
      T     DB1585.DBW  166; 

      A     DB1585.DBX   24.0; 
      =     DB1585.DBX  168.0; 

      A     DB1585.DBX   24.1; 
      =     DB1585.DBX  168.1; 

      A     DB1585.DBX   24.2; 
      =     DB1585.DBX  168.2; 

      A     DB1585.DBX   24.3; 
      =     DB1585.DBX  168.3; 

      A     DB1585.DBX   24.4; 
      =     DB1585.DBX  168.4; 

      A     DB1585.DBX   24.5; 
      =     DB1585.DBX  168.5; 

      A     DB1585.DBX   24.6; 
      =     DB1585.DBX  168.6; 

      A     DB1585.DBX   24.7; 
      =     DB1585.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1585.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP2);

NCIP: NOP   0; 

//Empty Signal
//A     "U058SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1585.DBX   26.5; 

//Full Signal
//A     "U058SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1585.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1585.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1585.DBX   27.0; //Emergency Stop OK

// Weitere Signale
      L     DB1581.DBD  782; // Material
      T     DB1585.DBD   30; 

      L     DB1581.DBD  270; // Current Water Tank Selection
      T     DB1585.DBD   34; 

      L     DB1581.DBD  286; // Priority 1
      T     DB1585.DBD   38; 

      L     DB1581.DBD  302; // Priority 2
      T     DB1585.DBD   42; 

      L     DB1581.DBD  318; // Priority 3
      T     DB1585.DBD   46; 



      A     DB1585.DBX  458.1; 
      ON    DB5030.DBX  182.5; 
      ON    DB5050.DBX  182.5; 
      ON    DB5070.DBX  182.5; 
      ON    DB5090.DBX  182.5; 
      ON    DB5120.DBX  182.5; 
      ON    DB5140.DBX  182.5; 
      =     DB1585.DBX   26.3; 


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1589
TITLE =U058: Water Transfer Syrup
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1580.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1581.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1581.DBX   17.3; 
      =     DB2580.DBX  105.3; 
      =     DB2580.DBX  185.3; 
      =     DB2580.DBX  265.3; 
      =     DB2580.DBX  505.3; 

NETWORK
TITLE =Special Input

      A     DB1581.DBX   17.3; 
      =     DB2581.DBX  141.3; 
      =     DB2581.DBX  201.3; 


NETWORK
TITLE =Counter

      A     DB1581.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1581.DBX   17.3; 
      =     DB2583.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1581.DBX   17.3; 
//      =     "U058UnVD".unv001.Sim; 
//      =     "U058UnVD".unv002.Sim; 
//      =     "U058UnVD".unv003.Sim; 
//      =     "U058UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1581.DBX   17.3; 
//      =     "U058PIDD".SR_P1_PID.Ign; 

NETWORK
TITLE =Message

      A     DB1581.DBX   17.3; 
//      =     "U058MsgD".msg001.Sim; 
//      =     "U058MsgD".msg002.Sim; 
//      =     "U058MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1581.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1595
TITLE =U059: Molchwasser
FAMILY : BOTEC_F1
NAME : U059Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1590.DBW    0; 
      T     #UnitNo; 

      L     DB1595.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1595.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1595.DBD   10; 
      L     DB1595.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1595.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1595.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
      AN    DB1591.DBX   66.1; 
      A     DB1591.DBX   15.0; 
      A     DB1591.DBX   17.4; 
      JCN   Strt; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1591.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      A     DB1591.DBX   66.1; 
      A     DB1591.DBX   15.0; 
      A     DB1591.DBX   17.4; 
      JCN   Str2; 
      L     L#-100; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1591.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 

NETWORK
TITLE =external releases

      SET   ; 
      =     DB2590.DBX  266.7; 
      =     DB2590.DBX  346.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1591.DBX   15.0; 
//      AN "U059SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1595.DBD  150; 
      T     DB1591.DBD  626; 

//Temperature CIP Return
      L     DB1595.DBD  146; 
      T     DB1591.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1591.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1595.DBX  171.7; 
      JCN   pfc; 
      L     DB1591.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1595.DBX  172.0; 
      JCN   ppc; 
      L     DB1591.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1595.DBX  171.6; 
      JCN   pxc; 
      L     DB1591.DBD  574; 
pxc:  NOP   0; 
      T     DB1595.DBD  182; 

//CIP Return
      L     DB1591.DBD  558; 
      T     DB1595.DBD  186; 
      L     DB1595.DBD  138; 
      T     DB1591.DBD  562; 

//CIP Prerun
      L     DB1591.DBD  542; 
      T     DB1595.DBD  190; 
      L     DB1595.DBD  142; 
      T     DB1591.DBD  546; 

// Write Own Data to CIP
      L     DB1595.DBD   10; 
      T     DB1595.DBD  154; 

      L     DB1595.DBW   14; 
      T     DB1595.DBW  158; 

      L     DB1595.DBW   16; 
      T     DB1595.DBW  160; 

      L     DB1595.DBW   18; 
      T     DB1595.DBW  162; 

      L     DB1595.DBW   20; 
      T     DB1595.DBW  164; 

      L     DB1595.DBW   22; 
      T     DB1595.DBW  166; 

      A     DB1595.DBX   24.0; 
      =     DB1595.DBX  168.0; 

      A     DB1595.DBX   24.1; 
      =     DB1595.DBX  168.1; 

      A     DB1595.DBX   24.2; 
      =     DB1595.DBX  168.2; 

      A     DB1595.DBX   24.3; 
      =     DB1595.DBX  168.3; 

      A     DB1595.DBX   24.4; 
      =     DB1595.DBX  168.4; 

      A     DB1595.DBX   24.5; 
      =     DB1595.DBX  168.5; 

      A     DB1595.DBX   24.6; 
      =     DB1595.DBX  168.6; 

      A     DB1595.DBX   24.7; 
      =     DB1595.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1595.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1595.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U059SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1595.DBX   26.5; 

//Full Signal
//A     "U059SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1595.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1595.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1595.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1599
TITLE =U059: Pig Water
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1590.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1591.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1591.DBX   17.3; 
      =     DB2590.DBX  105.3; 
      =     DB2590.DBX  185.3; 

NETWORK
TITLE =Special Input

      A     DB1591.DBX   17.3; 



NETWORK
TITLE =Counter

      A     DB1591.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1591.DBX   17.3; 


NETWORK
TITLE =Universal Value

      A     DB1591.DBX   17.3; 
//      =     "U059UnVD".unv001.Sim; 
//      =     "U059UnVD".unv002.Sim; 
//      =     "U059UnVD".unv003.Sim; 
//      =     "U059UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1591.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1591.DBX   17.3; 
//    =     "U059MsgD".msg001.Sim
//     =     "U059MsgD".msg002.Sim
//      =     "U059MsgD".msg003.Sim

NETWORK
TITLE =VLT

      A     DB1591.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1635
TITLE =U063: Packaging Plant 3
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1630.DBW    0; 
      T     #UnitNo; 

      L     DB1635.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1635.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1635.DBD   10; 
      L     DB1635.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1635.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1635.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1635.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1631.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      JU    ELS1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1635.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1635.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1435.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1631.DBX   15.0; 
      A     DB1631.DBX   17.4; 

      JCN   Strt; 
      L     DB1435.DBD   10; 
      T     #Prid; 


      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1631.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2630.DBX  106.7; 
      =     DB2630.DBX  186.7; 
      =     DB2630.DBX  266.7; 
      =     DB2630.DBX  346.7; 
      =     DB2630.DBX  426.7; 
      =     DB2630.DBX  506.7; 
      =     DB2630.DBX  586.7; 
      =     DB2630.DBX  666.7; 
      =     DB2630.DBX  746.7; 
      =     DB2630.DBX  826.7; 
      =     DB2630.DBX  906.7; 
      =     DB2630.DBX  986.7; 
      =     DB2630.DBX 1066.7; 
      =     DB2630.DBX 1146.7; 
      =     DB2630.DBX 1226.7; 
      =     DB2630.DBX 1306.7; 
      =     DB2630.DBX 1386.7; 
      =     DB2630.DBX 1466.7; 
      =     DB2630.DBX 1546.7; 
      =     DB2630.DBX 1626.7; 
      =     DB2630.DBX 1706.7; 
      =     DB2630.DBX 1786.7; 
      =     DB2630.DBX 1866.7; 
      =     DB2630.DBX 1946.7; 
      =     DB2630.DBX 2026.7; 
      =     DB2630.DBX 2106.7; 
      =     DB2630.DBX 2186.7; 
      =     DB2630.DBX 2266.7; 
      =     DB2630.DBX 2346.7; 
      =     DB2630.DBX 2426.7; 
      =     DB2630.DBX 2506.7; 
      =     DB2630.DBX 2586.7; 
      =     DB2630.DBX 2666.7; 
      =     DB2630.DBX 2746.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1631.DBX   15.0; 
      AN    DB1631.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1635.DBD  150; 
      T     DB1631.DBD  626; 

//Temperature CIP Return
      L     DB1635.DBD  146; 
      T     DB1631.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1631.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1635.DBX  171.7; 
      JCN   pfc; 
      L     DB1631.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1635.DBX  172.0; 
      JCN   ppc; 
      L     DB1631.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1635.DBX  171.6; 
      JCN   pxc; 
      L     DB1631.DBD  574; 
pxc:  NOP   0; 
      T     DB1635.DBD  182; 

//CIP Return
      L     DB1631.DBD  558; 
      T     DB1635.DBD  186; 
      L     DB1635.DBD  138; 
      T     DB1631.DBD  562; 

//CIP Prerun
      L     DB1631.DBD  542; 
      T     DB1635.DBD  190; 
      L     DB1635.DBD  142; 
      T     DB1631.DBD  546; 

// Write Own Data to CIP
      L     DB1635.DBD   10; 
      T     DB1635.DBD  154; 

      L     DB1635.DBW   14; 
      T     DB1635.DBW  158; 

      L     DB1635.DBW   16; 
      T     DB1635.DBW  160; 

      L     DB1635.DBW   18; 
      T     DB1635.DBW  162; 

      L     DB1635.DBW   20; 
      T     DB1635.DBW  164; 

      L     DB1635.DBW   22; 
      T     DB1635.DBW  166; 

      A     DB1635.DBX   24.0; 
      =     DB1635.DBX  168.0; 

      A     DB1635.DBX   24.1; 
      =     DB1635.DBX  168.1; 

      A     DB1635.DBX   24.2; 
      =     DB1635.DBX  168.2; 

      A     DB1635.DBX   24.3; 
      =     DB1635.DBX  168.3; 

      A     DB1635.DBX   24.4; 
      =     DB1635.DBX  168.4; 

      A     DB1635.DBX   24.5; 
      =     DB1635.DBX  168.5; 

      A     DB1635.DBX   24.6; 
      =     DB1635.DBX  168.6; 

      A     DB1635.DBX   24.7; 
      =     DB1635.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1635.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1635.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U063SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1635.DBX   26.5; 

//Full Signal
//A     "U063SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1635.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1635.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1635.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data

      A     M    100.7; 
      =     Q    946.0; 
      =     Q    986.0; 

      SET   ; 
      =     DB2630.DBX  748.2; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1639
TITLE =U063: Packaging Plant 3
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1630.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1631.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1631.DBX   17.3; 
      =     DB2630.DBX  105.3; 
      =     DB2630.DBX  185.3; 

NETWORK
TITLE =Special Input

      A     DB1631.DBX   17.3; 
      =     DB2631.DBX  141.3; 
      =     DB2631.DBX  201.3; 
NETWORK
TITLE =Counter

      A     DB1631.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1631.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1631.DBX   17.3; 
//      =     "U063UnVD".unv001.Sim; 
//      =     "U063UnVD".unv002.Sim; 
//      =     "U063UnVD".unv003.Sim; 
//      =     "U063UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1631.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1631.DBX   17.3; 
//      =     "U063MsgD".msg001.Sim; 
//      =     "U063MsgD".msg002.Sim; 
//      =     "U063MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1631.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1655
TITLE =U065: Packaging Plant 5
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1650.DBW    0; 
      T     #UnitNo; 

      L     DB1655.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1655.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1655.DBD   10; 
      L     DB1655.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1655.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1655.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1655.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1651.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1655.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1655.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1655.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1655.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1455.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1651.DBX   15.0; 
      A     DB1651.DBX   17.4; 

      JCN   Strt; 
      L     DB1455.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1651.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2650.DBX  106.7; 
      =     DB2650.DBX  186.7; 
      =     DB2650.DBX  266.7; 
      =     DB2650.DBX  346.7; 
      =     DB2650.DBX  426.7; 
      =     DB2650.DBX  506.7; 
      =     DB2650.DBX  586.7; 
      =     DB2650.DBX  666.7; 
      =     DB2650.DBX  746.7; 
      =     DB2650.DBX  826.7; 
      =     DB2650.DBX  906.7; 
      =     DB2650.DBX  986.7; 
      =     DB2650.DBX 1226.7; 
      =     DB2650.DBX 1306.7; 
      =     DB2650.DBX 1386.7; 
      =     DB2650.DBX 1466.7; 
      =     DB2650.DBX 1546.7; 
      =     DB2650.DBX 1626.7; 
      =     DB2650.DBX 1706.7; 
      =     DB2650.DBX 1786.7; 
      =     DB2650.DBX 1866.7; 
      =     DB2650.DBX 1946.7; 
      =     DB2650.DBX 2026.7; 
      =     DB2650.DBX 2106.7; 
      =     DB2650.DBX 2186.7; 
      =     DB2650.DBX 2266.7; 
      =     DB2650.DBX 2346.7; 
      =     DB2650.DBX 2426.7; 
      =     DB2650.DBX 2506.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1651.DBX   15.0; 
//   AN    "U065SeqD".Seq.PO.B30       // CIP Active (Slave)  - not online
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1655.DBD  150; 
      T     DB1651.DBD  626; 

//Temperature CIP Return
      L     DB1655.DBD  146; 
      T     DB1651.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1651.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1655.DBX  171.7; 
      JCN   pfc; 
      L     DB1651.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1655.DBX  172.0; 
      JCN   ppc; 
      L     DB1651.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1655.DBX  171.6; 
      JCN   pxc; 
      L     DB1651.DBD  574; 
pxc:  NOP   0; 
      T     DB1655.DBD  182; 

//CIP Return
      L     DB1651.DBD  558; 
      T     DB1655.DBD  186; 
      L     DB1655.DBD  138; 
      T     DB1651.DBD  562; 

//CIP Prerun
      L     DB1651.DBD  542; 
      T     DB1655.DBD  190; 
      L     DB1655.DBD  142; 
      T     DB1651.DBD  546; 

// Write Own Data to CIP
      L     DB1655.DBD   10; 
      T     DB1655.DBD  154; 

      L     DB1655.DBW   14; 
      T     DB1655.DBW  158; 

      L     DB1655.DBW   16; 
      T     DB1655.DBW  160; 

      L     DB1655.DBW   18; 
      T     DB1655.DBW  162; 

      L     DB1655.DBW   20; 
      T     DB1655.DBW  164; 

      L     DB1655.DBW   22; 
      T     DB1655.DBW  166; 

      A     DB1655.DBX   24.0; 
      =     DB1655.DBX  168.0; 

      A     DB1655.DBX   24.1; 
      =     DB1655.DBX  168.1; 

      A     DB1655.DBX   24.2; 
      =     DB1655.DBX  168.2; 

      A     DB1655.DBX   24.3; 
      =     DB1655.DBX  168.3; 

      A     DB1655.DBX   24.4; 
      =     DB1655.DBX  168.4; 

      A     DB1655.DBX   24.5; 
      =     DB1655.DBX  168.5; 

      A     DB1655.DBX   24.6; 
      =     DB1655.DBX  168.6; 

      A     DB1655.DBX   24.7; 
      =     DB1655.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1655.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1655.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U065SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1655.DBX   26.5; 

//Full Signal
//A     "U065SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1655.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1655.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1655.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE =Signals to Filler / Mixer

// Watchdog
      A     M    100.7; 
      =     Q    197.7; 
      =     Q    173.7; 
      =     Q    199.6; 
      =     Q    345.7; 

// GOA Panel
      A     I    194.0; 
      =     DB5050.DBX 2028.2; 

      A     I    194.1; 
      =     DB5050.DBX 2188.2; 

      A     I    194.2; 
      =     DB5050.DBX 2348.2; 

      CLR   ; 

      L     DB2653.DBD  146; 
      T     QD   356; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1659
TITLE =U065: Packaging Plant 5
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1650.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1651.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1651.DBX   17.3; 
      =     DB2650.DBX  105.3; 
      =     DB2650.DBX  185.3; 
      =     DB2650.DBX  265.3; 
      =     DB2650.DBX  345.3; 
      =     DB2650.DBX  425.3; 
      =     DB2650.DBX  505.3; 
      =     DB2650.DBX  585.3; 
      =     DB2650.DBX  665.3; 
      =     DB2650.DBX  745.3; 
      =     DB2650.DBX  825.3; 
      =     DB2650.DBX  905.3; 
      =     DB2650.DBX  985.3; 
      =     DB2650.DBX 1225.3; 
      =     DB2650.DBX 1305.3; 
      =     DB2650.DBX 1385.3; 
      =     DB2650.DBX 1465.3; 
      =     DB2650.DBX 1545.3; 
      =     DB2650.DBX 1625.3; 
      =     DB2650.DBX 1705.3; 
      =     DB2650.DBX 1785.3; 
      =     DB2650.DBX 1865.3; 
      =     DB2650.DBX 1945.3; 
      =     DB2650.DBX 2025.3; 
      =     DB2650.DBX 2105.3; 
      =     DB2650.DBX 2185.3; 
      =     DB2650.DBX 2265.3; 
      =     DB2650.DBX 2345.3; 
      =     DB2650.DBX 2425.3; 
      =     DB2650.DBX 2505.3; 
      =     DB2650.DBX 2585.3; 
      =     DB2650.DBX 2665.3; 
      =     DB2650.DBX 2745.3; 
      =     DB2650.DBX 2825.3; 
      =     DB2650.DBX 2905.3; 
      =     DB2650.DBX 2985.3; 
      =     DB2650.DBX 3065.3; 
      =     DB2650.DBX 3145.3; 
      =     DB2650.DBX 3225.3; 
      =     DB2650.DBX 3305.3; 
      =     DB2650.DBX 3385.3; 
      =     DB2650.DBX 3465.3; 
      =     DB2650.DBX 3545.3; 
      =     DB2650.DBX 3625.3; 
      =     DB2650.DBX 3705.3; 
      =     DB2650.DBX 3785.3; 
      =     DB2650.DBX 3865.3; 
      =     DB2650.DBX 3945.3; 
      =     DB2650.DBX 4025.3; 
      =     DB2650.DBX 4105.3; 
      =     DB2650.DBX 4185.3; 
      =     DB2650.DBX 4265.3; 
      =     DB2650.DBX 4345.3; 
      =     DB2650.DBX 4425.3; 
      =     DB2650.DBX 4505.3; 
      =     DB2650.DBX 4585.3; 
      =     DB2650.DBX 4665.3; 
      =     DB2650.DBX 4745.3; 
      =     DB2650.DBX 4825.3; 
      =     DB2650.DBX 4905.3; 
      =     DB2650.DBX 4985.3; 
      =     DB2650.DBX 5065.3; 
      =     DB2650.DBX 5145.3; 
      =     DB2650.DBX 5225.3; 
      =     DB2650.DBX 5385.3; 
      =     DB2650.DBX 5465.3; 
      =     DB2650.DBX 5545.3; 
      =     DB2650.DBX 5625.3; 
      =     DB2650.DBX 5705.3; 
      =     DB2650.DBX 5785.3; 

NETWORK
TITLE =Special Input

      A     DB1651.DBX   17.3; 
      =     DB2651.DBX  141.3; 
      =     DB2651.DBX  201.3; 
      =     DB2651.DBX  261.3; 
      =     DB2651.DBX  321.3; 
      =     DB2651.DBX  381.3; 
      =     DB2651.DBX  441.3; 
      =     DB2651.DBX  501.3; 
      =     DB2651.DBX  561.3; 
      =     DB2651.DBX  621.3; 
      =     DB2651.DBX  681.3; 
      =     DB2651.DBX 1881.3; 
      =     DB2651.DBX 1941.3; 
      =     DB2651.DBX 2001.3; 
      =     DB2651.DBX 2061.3; 
      =     DB2651.DBX 2121.3; 
      =     DB2651.DBX 2181.3; 
      =     DB2651.DBX 2421.3; 
      =     DB2651.DBX 2481.3; 
      =     DB2651.DBX 2541.3; 
      =     DB2651.DBX 2721.3; 
      =     DB2651.DBX 2781.3; 
      =     DB2651.DBX 2841.3; 
      =     DB2651.DBX 2901.3; 
      =     DB2651.DBX 2961.3; 
      =     DB2651.DBX 3021.3; 
      =     DB2651.DBX 3081.3; 
      =     DB2651.DBX 3141.3; 
      =     DB2651.DBX 3201.3; 
      =     DB2651.DBX 3261.3; 
      =     DB2651.DBX 3321.3; 
      =     DB2651.DBX 3381.3; 
      =     DB2651.DBX 3441.3; 

NETWORK
TITLE =Counter

      A     DB1651.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1651.DBX   17.3; 
      =     DB2653.DBX  141.3; 
      =     DB2653.DBX  261.3; 
      =     DB2653.DBX  381.3; 
      =     DB2653.DBX  501.3; 
      =     DB2653.DBX  621.3; 
      =     DB2653.DBX  741.3; 

NETWORK
TITLE =Universal Value

      A     DB1651.DBX   17.3; 
//      =     "U065UnVD".unv001.Sim; 
//      =     "U065UnVD".unv002.Sim; 
//      =     "U065UnVD".unv003.Sim; 
//      =     "U065UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1651.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1651.DBX   17.3; 
//      =     "U065MsgD".msg001.Sim; 
//      =     "U065MsgD".msg002.Sim; 
//      =     "U065MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1651.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1675
TITLE =U067: Packaging Plant 7
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1670.DBW    0; 
      T     #UnitNo; 

      L     DB1675.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1675.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1675.DBD   10; 
      L     DB1675.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1675.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1675.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1675.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1671.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1675.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1675.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1675.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1675.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1475.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1671.DBX   15.0; 
      A     DB1671.DBX   17.4; 

      JCN   Strt; 
      L     DB1475.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1671.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2670.DBX  106.7; 
      =     DB2670.DBX  186.7; 
      =     DB2670.DBX  266.7; 
      =     DB2670.DBX  346.7; 
      =     DB2670.DBX  426.7; 
      =     DB2670.DBX  506.7; 
      =     DB2670.DBX  586.7; 
      =     DB2670.DBX  666.7; 
      =     DB2670.DBX  746.7; 
      =     DB2670.DBX  826.7; 
      =     DB2670.DBX  906.7; 
      =     DB2670.DBX  986.7; 
      =     DB2670.DBX 1066.7; 
      =     DB2670.DBX 1146.7; 
      =     DB2670.DBX 1226.7; 
      =     DB2670.DBX 1306.7; 
      =     DB2670.DBX 1386.7; 
      =     DB2670.DBX 1466.7; 
      =     DB2670.DBX 1626.7; 
      =     DB2670.DBX 1706.7; 
      =     DB2670.DBX 1786.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1671.DBX   15.0; 
      AN    DB1671.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1675.DBD  150; 
      T     DB1671.DBD  626; 

//Temperature CIP Return
      L     DB1675.DBD  146; 
      T     DB1671.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1671.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1675.DBX  171.7; 
      JCN   pfc; 
      L     DB1671.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1675.DBX  172.0; 
      JCN   ppc; 
      L     DB1671.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1675.DBX  171.6; 
      JCN   pxc; 
      L     DB1671.DBD  574; 
pxc:  NOP   0; 
      T     DB1675.DBD  182; 

//CIP Return
      L     DB1671.DBD  558; 
      T     DB1675.DBD  186; 
      L     DB1675.DBD  138; 
      T     DB1671.DBD  562; 

//CIP Prerun
      L     DB1671.DBD  542; 
      T     DB1675.DBD  190; 
      L     DB1675.DBD  142; 
      T     DB1671.DBD  546; 

// Write Own Data to CIP
      L     DB1675.DBD   10; 
      T     DB1675.DBD  154; 

      L     DB1675.DBW   14; 
      T     DB1675.DBW  158; 

      L     DB1675.DBW   16; 
      T     DB1675.DBW  160; 

      L     DB1675.DBW   18; 
      T     DB1675.DBW  162; 

      L     DB1675.DBW   20; 
      T     DB1675.DBW  164; 

      L     DB1675.DBW   22; 
      T     DB1675.DBW  166; 

      A     DB1675.DBX   24.0; 
      =     DB1675.DBX  168.0; 

      A     DB1675.DBX   24.1; 
      =     DB1675.DBX  168.1; 

      A     DB1675.DBX   24.2; 
      =     DB1675.DBX  168.2; 

      A     DB1675.DBX   24.3; 
      =     DB1675.DBX  168.3; 

      A     DB1675.DBX   24.4; 
      =     DB1675.DBX  168.4; 

      A     DB1675.DBX   24.5; 
      =     DB1675.DBX  168.5; 

      A     DB1675.DBX   24.6; 
      =     DB1675.DBX  168.6; 

      A     DB1675.DBX   24.7; 
      =     DB1675.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1675.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1675.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U067SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1675.DBX   26.5; 

//Full Signal
//A     "U067SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1675.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1675.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1675.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data

//    A     "U107SpID".GOA_701.Sig
      A     I     26.0; 
      =     DB5070.DBX 1788.2; 

//    A     "U107SpID".GOA_702.Sig
      A     I     26.1; 
      =     DB5070.DBX 1868.2; 

//    A     "U067SpID".GOA_703.Sig
      A     I     26.2; 
      =     DB5070.DBX 1948.2; 





      CLR   ; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1679
TITLE =U067: Packaging Plant 7
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1670.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1671.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1671.DBX   17.3; 
      =     DB2670.DBX  105.3; 
      =     DB2670.DBX  185.3; 
      =     DB2670.DBX  265.3; 
      =     DB2670.DBX  345.3; 
      =     DB2670.DBX  425.3; 
      =     DB2670.DBX  505.3; 
      =     DB2670.DBX  585.3; 
      =     DB2670.DBX  665.3; 
      =     DB2670.DBX  745.3; 
      =     DB2670.DBX  825.3; 
      =     DB2670.DBX  905.3; 
      =     DB2670.DBX  985.3; 
      =     DB2670.DBX 1065.3; 
      =     DB2670.DBX 1145.3; 
      =     DB2670.DBX 1225.3; 
      =     DB2670.DBX 1305.3; 
      =     DB2670.DBX 1385.3; 
      =     DB2670.DBX 1465.3; 
      =     DB2670.DBX 1625.3; 
      =     DB2670.DBX 1705.3; 
      =     DB2670.DBX 1785.3; 

NETWORK
TITLE =Special Input

      A     DB1671.DBX   17.3; 
      CLR   ; 
      =     DB2671.DBX  141.3; 
      =     DB2671.DBX  201.3; 
      =     DB2671.DBX  261.3; 
      =     DB2671.DBX  321.3; 
      =     DB2671.DBX  381.3; 
      =     DB2671.DBX  441.3; 
      =     DB2671.DBX  561.3; 
      =     DB2671.DBX  681.3; 
      =     DB2671.DBX  801.3; 
      =     DB2671.DBX  861.3; 
      =     DB2671.DBX  921.3; 




NETWORK
TITLE =Counter

      A     DB1671.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1671.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1671.DBX   17.3; 
//      =     "U067UnVD".unv001.Sim; 
//      =     "U067UnVD".unv002.Sim; 
//      =     "U067UnVD".unv003.Sim; 
//      =     "U067UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1671.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1671.DBX   17.3; 
//      =     "U067MsgD".msg001.Sim; 
//      =     "U067MsgD".msg002.Sim; 
//      =     "U067MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1671.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1685
TITLE =U068: Packaging Plant 8
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1680.DBW    0; 
      T     #UnitNo; 

      L     DB1685.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1685.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1685.DBD   10; 
      L     DB1685.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1685.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1685.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1685.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1681.DBX   15.0; 
      A     DB1681.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1685.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1681.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2680.DBX  106.7; 
      =     DB2680.DBX  186.7; 
      =     DB2680.DBX  266.7; 
      =     DB2680.DBX  346.7; 
      =     DB2680.DBX  426.7; 
      =     DB2680.DBX  506.7; 
      =     DB2680.DBX  586.7; 
      =     DB2680.DBX  666.7; 
      =     DB2680.DBX  746.7; 
      =     DB2680.DBX  826.7; 
      =     DB2680.DBX 1626.7; 
      =     DB2680.DBX 1706.7; 
      =     DB2680.DBX 1786.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1681.DBX   15.0; 
//      AN "U068SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1685.DBD  150; 
      T     DB1681.DBD  626; 

//Temperature CIP Return
      L     DB1685.DBD  146; 
      T     DB1681.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1681.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1685.DBX  171.7; 
      JCN   pfc; 
      L     DB1681.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1685.DBX  172.0; 
      JCN   ppc; 
      L     DB1681.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1685.DBX  171.6; 
      JCN   pxc; 
      L     DB1681.DBD  574; 
pxc:  NOP   0; 
      T     DB1685.DBD  182; 

//CIP Return
      L     DB1681.DBD  558; 
      T     DB1685.DBD  186; 
      L     DB1685.DBD  138; 
      T     DB1681.DBD  562; 

//CIP Prerun
      L     DB1681.DBD  542; 
      T     DB1685.DBD  190; 
      L     DB1685.DBD  142; 
      T     DB1681.DBD  546; 

// Write Own Data to CIP
      L     DB1685.DBD   10; 
      T     DB1685.DBD  154; 

      L     DB1685.DBW   14; 
      T     DB1685.DBW  158; 

      L     DB1685.DBW   16; 
      T     DB1685.DBW  160; 

      L     DB1685.DBW   18; 
      T     DB1685.DBW  162; 

      L     DB1685.DBW   20; 
      T     DB1685.DBW  164; 

      L     DB1685.DBW   22; 
      T     DB1685.DBW  166; 

      A     DB1685.DBX   24.0; 
      =     DB1685.DBX  168.0; 

      A     DB1685.DBX   24.1; 
      =     DB1685.DBX  168.1; 

      A     DB1685.DBX   24.2; 
      =     DB1685.DBX  168.2; 

      A     DB1685.DBX   24.3; 
      =     DB1685.DBX  168.3; 

      A     DB1685.DBX   24.4; 
      =     DB1685.DBX  168.4; 

      A     DB1685.DBX   24.5; 
      =     DB1685.DBX  168.5; 

      A     DB1685.DBX   24.6; 
      =     DB1685.DBX  168.6; 

      A     DB1685.DBX   24.7; 
      =     DB1685.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1685.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1685.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U068SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1685.DBX   26.5; 

//Full Signal
//A     "U068SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1685.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1685.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1685.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1689
TITLE =U068: Packaging Plant 8
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1680.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1681.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1681.DBX   17.3; 
      =     DB2680.DBX  105.3; 
      =     DB2680.DBX  185.3; 
      =     DB2680.DBX  265.3; 
      =     DB2680.DBX  345.3; 
      =     DB2680.DBX  425.3; 
      =     DB2680.DBX  505.3; 
      =     DB2680.DBX  585.3; 
      =     DB2680.DBX  665.3; 
      =     DB2680.DBX  745.3; 
      =     DB2680.DBX  825.3; 
      =     DB2680.DBX 1625.3; 
      =     DB2680.DBX 1705.3; 
      =     DB2680.DBX 1785.3; 

NETWORK
TITLE =Special Input

      A     DB1681.DBX   17.3; 
      =     DB2681.DBX  141.3; 
      =     DB2681.DBX  201.3; 
      =     DB2681.DBX  681.3; 
      =     DB2681.DBX 1461.3; 
      =     DB2681.DBX 1521.3; 
      =     DB2681.DBX 1581.3; 
      =     DB2681.DBX 1641.3; 
      =     DB2681.DBX 1701.3; 

NETWORK
TITLE =Counter

      A     DB1681.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1681.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1681.DBX   17.3; 
//      =     "U068UnVD".unv001.Sim; 
//      =     "U068UnVD".unv002.Sim; 
//      =     "U068UnVD".unv003.Sim; 
//      =     "U068UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1681.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1681.DBX   17.3; 
//      =     "U068MsgD".msg001.Sim; 
//      =     "U068MsgD".msg002.Sim; 
//      =     "U068MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1681.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1695
TITLE =U069: Packaging Plant 9
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1690.DBW    0; 
      T     #UnitNo; 

      L     DB1695.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1695.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1695.DBD   10; 
      L     DB1695.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1695.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1695.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1695.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1691.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1695.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1695.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1695.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1695.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1495.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1691.DBX   15.0; 
      A     DB1691.DBX   17.4; 

      JCN   Strt; 
      L     DB1495.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1691.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2690.DBX 1626.7; 
      =     DB2690.DBX 1706.7; 
      =     DB2690.DBX 1786.7; 
      =     DB2690.DBX 1866.7; 
      =     DB2690.DBX 1946.7; 
      =     DB2690.DBX 2026.7; 
      =     DB2690.DBX 2106.7; 
      =     DB2690.DBX 2186.7; 
      =     DB2690.DBX 2266.7; 
      =     DB2690.DBX 2346.7; 
      =     DB2690.DBX 2426.7; 
      =     DB2690.DBX 2506.7; 
      =     DB2690.DBX 2586.7; 
      =     DB2690.DBX 2666.7; 
      =     DB2690.DBX 2746.7; 
      =     DB2690.DBX 2826.7; 
      =     DB2690.DBX 2906.7; 
      =     DB2690.DBX 2986.7; 
      =     DB2690.DBX 3066.7; 
      =     DB2690.DBX 3146.7; 
      =     DB2690.DBX 3226.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1691.DBX   15.0; 
      AN    DB1691.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1695.DBD  150; 
      T     DB1691.DBD  626; 

//Temperature CIP Return
      L     DB1695.DBD  146; 
      T     DB1691.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1691.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1695.DBX  171.7; 
      JCN   pfc; 
      L     DB1691.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1695.DBX  172.0; 
      JCN   ppc; 
      L     DB1691.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1695.DBX  171.6; 
      JCN   pxc; 
      L     DB1691.DBD  574; 
pxc:  NOP   0; 
      T     DB1695.DBD  182; 

//CIP Return
      L     DB1691.DBD  558; 
      T     DB1695.DBD  186; 
      L     DB1695.DBD  138; 
      T     DB1691.DBD  562; 

//CIP Prerun
      L     DB1691.DBD  542; 
      T     DB1695.DBD  190; 
      L     DB1695.DBD  142; 
      T     DB1691.DBD  546; 

// Write Own Data to CIP
      L     DB1695.DBD   10; 
      T     DB1695.DBD  154; 

      L     DB1695.DBW   14; 
      T     DB1695.DBW  158; 

      L     DB1695.DBW   16; 
      T     DB1695.DBW  160; 

      L     DB1695.DBW   18; 
      T     DB1695.DBW  162; 

      L     DB1695.DBW   20; 
      T     DB1695.DBW  164; 

      L     DB1695.DBW   22; 
      T     DB1695.DBW  166; 

      A     DB1695.DBX   24.0; 
      =     DB1695.DBX  168.0; 

      A     DB1695.DBX   24.1; 
      =     DB1695.DBX  168.1; 

      A     DB1695.DBX   24.2; 
      =     DB1695.DBX  168.2; 

      A     DB1695.DBX   24.3; 
      =     DB1695.DBX  168.3; 

      A     DB1695.DBX   24.4; 
      =     DB1695.DBX  168.4; 

      A     DB1695.DBX   24.5; 
      =     DB1695.DBX  168.5; 

      A     DB1695.DBX   24.6; 
      =     DB1695.DBX  168.6; 

      A     DB1695.DBX   24.7; 
      =     DB1695.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1695.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1695.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U069SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1695.DBX   26.5; 

//Full Signal
//A     "U069SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1695.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1695.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1695.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1699
TITLE =U069: Packaging Plant 9
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1690.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1691.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1691.DBX   17.3; 
      =     DB2690.DBX 1625.3; 
      =     DB2690.DBX 1705.3; 
      =     DB2690.DBX 1785.3; 
      =     DB2690.DBX 1865.3; 
      =     DB2690.DBX 1945.3; 
      =     DB2690.DBX 2025.3; 
      =     DB2690.DBX 2105.3; 
      =     DB2690.DBX 2185.3; 
      =     DB2690.DBX 2265.3; 
      =     DB2690.DBX 2345.3; 
      =     DB2690.DBX 2425.3; 
      =     DB2690.DBX 2505.3; 
      =     DB2690.DBX 2585.3; 
      =     DB2690.DBX 2665.3; 
      =     DB2690.DBX 2745.3; 
      =     DB2690.DBX 2825.3; 
      =     DB2690.DBX 2905.3; 
      =     DB2690.DBX 2985.3; 
      =     DB2690.DBX 3065.3; 
      =     DB2690.DBX 3145.3; 
      =     DB2690.DBX 3225.3; 

NETWORK
TITLE =Special Input

      A     DB1691.DBX   17.3; 
      =     DB2691.DBX   81.3; 
      =     DB2691.DBX  141.3; 
      =     DB2691.DBX  441.3; 
      =     DB2691.DBX  501.3; 
      =     DB2691.DBX  561.3; 
      =     DB2691.DBX  621.3; 
      =     DB2691.DBX  681.3; 
      =     DB2691.DBX  741.3; 
      =     DB2691.DBX  801.3; 
      =     DB2691.DBX  861.3; 
      =     DB2691.DBX  921.3; 
      =     DB2691.DBX  981.3; 
      =     DB2691.DBX 1041.3; 
      =     DB2691.DBX 1101.3; 
      =     DB2691.DBX 1161.3; 
      =     DB2691.DBX 1221.3; 
      =     DB2691.DBX 1281.3; 
      =     DB2691.DBX 1341.3; 
      =     DB2691.DBX 1401.3; 
      =     DB2691.DBX 1461.3; 
      =     DB2691.DBX 1521.3; 

NETWORK
TITLE =Counter

      A     DB1691.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1691.DBX   17.3; 
      =     DB2693.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1691.DBX   17.3; 
//      =     "U069UnVD".unv001.Sim; 
//      =     "U069UnVD".unv002.Sim; 
//      =     "U069UnVD".unv003.Sim; 
//      =     "U069UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1691.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1691.DBX   17.3; 
//      =     "U069MsgD".msg001.Sim; 
//      =     "U069MsgD".msg002.Sim; 
//      =     "U069MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1691.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1705
TITLE =U070: Packaging Plant 10
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1700.DBW    0; 
      T     #UnitNo; 

      L     DB1705.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1705.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1705.DBD   10; 
      L     DB1705.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1705.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1705.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1705.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1701.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1705.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1705.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1705.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1705.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1505.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1701.DBX   15.0; 
      A     DB1701.DBX   17.4; 

      JCN   Strt; 
      L     DB1505.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1701.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2700.DBX 1626.7; 
      =     DB2700.DBX 1706.7; 
      =     DB2700.DBX 1786.7; 
      =     DB2700.DBX 1866.7; 
      =     DB2700.DBX 1946.7; 
      =     DB2700.DBX 2026.7; 
      =     DB2700.DBX 2106.7; 
      =     DB2700.DBX 2186.7; 
      =     DB2700.DBX 2266.7; 
      =     DB2700.DBX 2346.7; 
      =     DB2700.DBX 2426.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1701.DBX   15.0; 
//      AN "U070SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1705.DBD  150; 
      T     DB1701.DBD  626; 

//Temperature CIP Return
      L     DB1705.DBD  146; 
      T     DB1701.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1701.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1705.DBX  171.7; 
      JCN   pfc; 
      L     DB1701.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1705.DBX  172.0; 
      JCN   ppc; 
      L     DB1701.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1705.DBX  171.6; 
      JCN   pxc; 
      L     DB1701.DBD  574; 
pxc:  NOP   0; 
      T     DB1705.DBD  182; 

//CIP Return
      L     DB1701.DBD  558; 
      T     DB1705.DBD  186; 
      L     DB1705.DBD  138; 
      T     DB1701.DBD  562; 

//CIP Prerun
      L     DB1701.DBD  542; 
      T     DB1705.DBD  190; 
      L     DB1705.DBD  142; 
      T     DB1701.DBD  546; 

// Write Own Data to CIP
      L     DB1705.DBD   10; 
      T     DB1705.DBD  154; 

      L     DB1705.DBW   14; 
      T     DB1705.DBW  158; 

      L     DB1705.DBW   16; 
      T     DB1705.DBW  160; 

      L     DB1705.DBW   18; 
      T     DB1705.DBW  162; 

      L     DB1705.DBW   20; 
      T     DB1705.DBW  164; 

      L     DB1705.DBW   22; 
      T     DB1705.DBW  166; 

      A     DB1705.DBX   24.0; 
      =     DB1705.DBX  168.0; 

      A     DB1705.DBX   24.1; 
      =     DB1705.DBX  168.1; 

      A     DB1705.DBX   24.2; 
      =     DB1705.DBX  168.2; 

      A     DB1705.DBX   24.3; 
      =     DB1705.DBX  168.3; 

      A     DB1705.DBX   24.4; 
      =     DB1705.DBX  168.4; 

      A     DB1705.DBX   24.5; 
      =     DB1705.DBX  168.5; 

      A     DB1705.DBX   24.6; 
      =     DB1705.DBX  168.6; 

      A     DB1705.DBX   24.7; 
      =     DB1705.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1705.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1705.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U070SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1705.DBX   26.5; 

//Full Signal
//A     "U070SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1705.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1705.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1705.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1709
TITLE =U070: Packaging Plant 10
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1700.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1701.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1701.DBX   17.3; 
      =     DB2700.DBX 1625.3; 
      =     DB2700.DBX 1705.3; 
      =     DB2700.DBX 1785.3; 
      =     DB2700.DBX 1865.3; 
      =     DB2700.DBX 1945.3; 
      =     DB2700.DBX 2025.3; 
      =     DB2700.DBX 2105.3; 
      =     DB2700.DBX 2185.3; 
      =     DB2700.DBX 2265.3; 
      =     DB2700.DBX 2345.3; 
      =     DB2700.DBX 2425.3; 

NETWORK
TITLE =Special Input

      A     DB1701.DBX   17.3; 
      =     DB2701.DBX   81.3; 
      =     DB2701.DBX  141.3; 
      =     DB2701.DBX  201.3; 
      =     DB2701.DBX  261.3; 
      =     DB2701.DBX  321.3; 
      =     DB2701.DBX  381.3; 
      =     DB2701.DBX  441.3; 
      =     DB2701.DBX  501.3; 
      =     DB2701.DBX  561.3; 
      =     DB2701.DBX  621.3; 

NETWORK
TITLE =Counter

      A     DB1701.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1701.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1701.DBX   17.3; 
//      =     "U070UnVD".unv001.Sim; 
//      =     "U070UnVD".unv002.Sim; 
//      =     "U070UnVD".unv003.Sim; 
//      =     "U070UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1701.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1701.DBX   17.3; 
//      =     "U070MsgD".msg001.Sim; 
//      =     "U070MsgD".msg002.Sim; 
//      =     "U070MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1701.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1715
TITLE =U071: Packaging Plant 11
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1710.DBW    0; 
      T     #UnitNo; 

      L     DB1715.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1715.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1715.DBD   10; 
      L     DB1715.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1715.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1715.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1715.GEN,
           RET_VAL                  := #wRetVal);

// ... CIP Unit ------------- /
      L     DB1711.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1715.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1715.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1715.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1715.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1515.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1711.DBX   15.0; 
      A     DB1711.DBX   17.4; 

      JCN   Strt; 
      L     DB1515.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1711.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2710.DBX  106.7; 
      =     DB2710.DBX  186.7; 
      =     DB2710.DBX  266.7; 
      =     DB2710.DBX  826.7; 
      =     DB2710.DBX  906.7; 
      =     DB2710.DBX  986.7; 
      =     DB2710.DBX 1066.7; 
      =     DB2710.DBX 1146.7; 
      =     DB2710.DBX 1226.7; 
      =     DB2710.DBX 1306.7; 
      =     DB2710.DBX 1386.7; 
      =     DB2710.DBX 1466.7; 
      =     DB2710.DBX 1626.7; 
      =     DB2710.DBX 1706.7; 
      =     DB2710.DBX 1786.7; 
      =     DB2710.DBX 3466.7; 
      =     DB2710.DBX 3546.7; 
      =     DB2710.DBX 3626.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1711.DBX   15.0; 
      AN    DB1711.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1715.DBD  150; 
      T     DB1711.DBD  626; 

//Temperature CIP Return
      L     DB1715.DBD  146; 
      T     DB1711.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1711.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1715.DBX  171.7; 
      JCN   pfc; 
      L     DB1711.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1715.DBX  172.0; 
      JCN   ppc; 
      L     DB1711.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1715.DBX  171.6; 
      JCN   pxc; 
      L     DB1711.DBD  574; 
pxc:  NOP   0; 
      T     DB1715.DBD  182; 

//CIP Return
      L     DB1711.DBD  558; 
      T     DB1715.DBD  186; 
      L     DB1715.DBD  138; 
      T     DB1711.DBD  562; 

//CIP Prerun
      L     DB1711.DBD  542; 
      T     DB1715.DBD  190; 
      L     DB1715.DBD  142; 
      T     DB1711.DBD  546; 

// Write Own Data to CIP
      L     DB1715.DBD   10; 
      T     DB1715.DBD  154; 

      L     DB1715.DBW   14; 
      T     DB1715.DBW  158; 

      L     DB1715.DBW   16; 
      T     DB1715.DBW  160; 

      L     DB1715.DBW   18; 
      T     DB1715.DBW  162; 

      L     DB1715.DBW   20; 
      T     DB1715.DBW  164; 

      L     DB1715.DBW   22; 
      T     DB1715.DBW  166; 

      A     DB1715.DBX   24.0; 
      =     DB1715.DBX  168.0; 

      A     DB1715.DBX   24.1; 
      =     DB1715.DBX  168.1; 

      A     DB1715.DBX   24.2; 
      =     DB1715.DBX  168.2; 

      A     DB1715.DBX   24.3; 
      =     DB1715.DBX  168.3; 

      A     DB1715.DBX   24.4; 
      =     DB1715.DBX  168.4; 

      A     DB1715.DBX   24.5; 
      =     DB1715.DBX  168.5; 

      A     DB1715.DBX   24.6; 
      =     DB1715.DBX  168.6; 

      A     DB1715.DBX   24.7; 
      =     DB1715.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1715.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1715.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U071SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1715.DBX   26.5; 

//Full Signal
//A     "U071SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1715.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1715.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1715.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE =Signals to Filler / Mixer

// Watchdog
      A     M    100.7; 
//    =     "F11_Watchdog"
//    =     "A11_Mixer_Watchdog"

      CLR   ; 


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1719
TITLE =U071: Packaging Plant 11
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1710.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1711.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1711.DBX   17.3; 
      =     DB2710.DBX  105.3; 
      =     DB2710.DBX  185.3; 
      =     DB2710.DBX  265.3; 
      =     DB2710.DBX  825.3; 
      =     DB2710.DBX  905.3; 
      =     DB2710.DBX  985.3; 
      =     DB2710.DBX 1065.3; 
      =     DB2710.DBX 1145.3; 
      =     DB2710.DBX 1225.3; 
      =     DB2710.DBX 1305.3; 
      =     DB2710.DBX 1385.3; 
      =     DB2710.DBX 1465.3; 
      =     DB2710.DBX 1625.3; 
      =     DB2710.DBX 1705.3; 
      =     DB2710.DBX 1785.3; 
      =     DB2710.DBX 3465.3; 
      =     DB2710.DBX 3545.3; 
      =     DB2710.DBX 3625.3; 

NETWORK
TITLE =Special Input

      A     DB1711.DBX   17.3; 
      =     DB2711.DBX  141.3; 
      =     DB2711.DBX  201.3; 
      =     DB2711.DBX  261.3; 
      =     DB2711.DBX  321.3; 
      =     DB2711.DBX  381.3; 
      =     DB2711.DBX  681.3; 
      =     DB2711.DBX  741.3; 

NETWORK
TITLE =Counter

      A     DB1711.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1711.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1711.DBX   17.3; 
//      =     "U071UnVD".unv001.Sim; 
//      =     "U071UnVD".unv002.Sim; 
//      =     "U071UnVD".unv003.Sim; 
//      =     "U071UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1711.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1711.DBX   17.3; 
//      =     "U071MsgD".msg001.Sim; 
//      =     "U071MsgD".msg002.Sim; 
//      =     "U071MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1711.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1725
TITLE =U072: Packaging Plant 12
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1720.DBW    0; 
      T     #UnitNo; 

      L     DB1725.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1725.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1725.DBD   10; 
      L     DB1725.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1725.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1725.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1725.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1721.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1725.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1725.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1725.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1725.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1525.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1721.DBX   15.0; 
      A     DB1721.DBX   17.4; 

      JCN   Strt; 
      L     DB1525.DBD   10; 
      T     #Prid; 


      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1721.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2720.DBX  106.7; 
      =     DB2720.DBX  186.7; 
      =     DB2720.DBX 1626.7; 
      =     DB2720.DBX 1706.7; 
      =     DB2720.DBX 1786.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1721.DBX   15.0; 
      AN    DB1721.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1725.DBD  150; 
      T     DB1721.DBD  626; 

//Temperature CIP Return
      L     DB1725.DBD  146; 
      T     DB1721.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1721.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1725.DBX  171.7; 
      JCN   pfc; 
      L     DB1721.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1725.DBX  172.0; 
      JCN   ppc; 
      L     DB1721.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1725.DBX  171.6; 
      JCN   pxc; 
      L     DB1721.DBD  574; 
pxc:  NOP   0; 
      T     DB1725.DBD  182; 

//CIP Return
      L     DB1721.DBD  558; 
      T     DB1725.DBD  186; 
      L     DB1725.DBD  138; 
      T     DB1721.DBD  562; 

//CIP Prerun
      L     DB1721.DBD  542; 
      T     DB1725.DBD  190; 
      L     DB1725.DBD  142; 
      T     DB1721.DBD  546; 

// Write Own Data to CIP
      L     DB1725.DBD   10; 
      T     DB1725.DBD  154; 

      L     DB1725.DBW   14; 
      T     DB1725.DBW  158; 

      L     DB1725.DBW   16; 
      T     DB1725.DBW  160; 

      L     DB1725.DBW   18; 
      T     DB1725.DBW  162; 

      L     DB1725.DBW   20; 
      T     DB1725.DBW  164; 

      L     DB1725.DBW   22; 
      T     DB1725.DBW  166; 

      A     DB1725.DBX   24.0; 
      =     DB1725.DBX  168.0; 

      A     DB1725.DBX   24.1; 
      =     DB1725.DBX  168.1; 

      A     DB1725.DBX   24.2; 
      =     DB1725.DBX  168.2; 

      A     DB1725.DBX   24.3; 
      =     DB1725.DBX  168.3; 

      A     DB1725.DBX   24.4; 
      =     DB1725.DBX  168.4; 

      A     DB1725.DBX   24.5; 
      =     DB1725.DBX  168.5; 

      A     DB1725.DBX   24.6; 
      =     DB1725.DBX  168.6; 

      A     DB1725.DBX   24.7; 
      =     DB1725.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1725.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1725.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U072SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1725.DBX   26.5; 

//Full Signal
//A     "U072SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1725.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1725.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1725.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE =Signals to Filler / Mixer

// Watchdog
      A     M    100.7; 
      =     Q    269.7; 
      =     Q    271.6; 


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1729
TITLE =U072: Packaging Plant 12
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1720.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1721.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1721.DBX   17.3; 
      =     DB2720.DBX  105.3; 
      =     DB2720.DBX  185.3; 
      =     DB2720.DBX 1625.3; 
      =     DB2720.DBX 1705.3; 
      =     DB2720.DBX 1785.3; 

NETWORK
TITLE =Special Input

      A     DB1721.DBX   17.3; 
      =     DB2721.DBX  441.3; 
      =     DB2721.DBX  501.3; 
      =     DB2721.DBX  561.3; 
      =     DB2721.DBX  621.3; 
      =     DB2721.DBX  681.3; 
      =     DB2721.DBX  741.3; 
      =     DB2721.DBX  801.3; 

NETWORK
TITLE =Counter

      A     DB1721.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1721.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1721.DBX   17.3; 
//      =     "U072UnVD".unv001.Sim; 
//      =     "U072UnVD".unv002.Sim; 
//      =     "U072UnVD".unv003.Sim; 
//      =     "U072UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1721.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1721.DBX   17.3; 
//      =     "U072MsgD".msg001.Sim; 
//      =     "U072MsgD".msg002.Sim; 
//      =     "U072MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1721.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1745
TITLE =U074: Packaging Plant 14
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1740.DBW    0; 
      T     #UnitNo; 

      L     DB1745.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1745.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1745.DBD   10; 
      L     DB1745.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1745.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1745.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1745.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /
      L     DB1741.DBD   46; // Select
      L     L#0; // Off
      ==D   ; 
      JC    ELS1; 
      TAK   ; 
      L     DB1915.DBD   10; // CIP 1
      ==D   ; 
      JC    M101; 
      TAK   ; 
      L     DB1925.DBD   10; // CIP 2
      ==D   ; 
      JC    M102; 
      TAK   ; 
      L     DB1935.DBD   10; // CIP 3
      ==D   ; 
      JC    M103; 
      JU    ELS1; 
M101: NOP   0; // Do 1
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1745.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M102: NOP   0; // Do 2
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1745.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
M103: NOP   0; // Do 3
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1745.CIP,
           RET_VAL                  := #wRetVal);

      JU    FIN1; 
ELS1: L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB1745.CIP);

FIN1: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB1545.DBX   29.4; // Water Transfer - Request CIP Active
      A     DB1741.DBX   15.0; 
      A     DB1741.DBX   17.4; 

      JCN   Strt; 
      L     DB1545.DBD   10; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1741.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2740.DBX  106.7; 
      =     DB2740.DBX  186.7; 
      =     DB2740.DBX  266.7; 
      =     DB2740.DBX  346.7; 
      =     DB2740.DBX  426.7; 
      =     DB2740.DBX  506.7; 
      =     DB2740.DBX  586.7; 
      =     DB2740.DBX  666.7; 
      =     DB2740.DBX  746.7; 
      =     DB2740.DBX  826.7; 
      =     DB2740.DBX  906.7; 
      =     DB2740.DBX  986.7; 
      =     DB2740.DBX 1066.7; 
      =     DB2740.DBX 1146.7; 
      =     DB2740.DBX 1226.7; 
      =     DB2740.DBX 1306.7; 
      =     DB2740.DBX 1386.7; 
      =     DB2740.DBX 1466.7; 
      =     DB2740.DBX 1546.7; 
      =     DB2740.DBX 1626.7; 
      =     DB2740.DBX 1706.7; 
      =     DB2740.DBX 1786.7; 
      =     DB2740.DBX 1866.7; 
      =     DB2740.DBX 1946.7; 
      =     DB2740.DBX 2026.7; 
      =     DB2740.DBX 2106.7; 
      =     DB2740.DBX 2186.7; 
      =     DB2740.DBX 2266.7; 
      =     DB2740.DBX 2346.7; 
      =     DB2740.DBX 2426.7; 
      =     DB2740.DBX 2506.7; 
      =     DB2740.DBX 2586.7; 
      =     DB2740.DBX 2666.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1741.DBX   15.0; 
//      AN "U074SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1745.DBD  150; 
      T     DB1741.DBD  626; 

//Temperature CIP Return
      L     DB1745.DBD  146; 
      T     DB1741.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1741.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1745.DBX  171.7; 
      JCN   pfc; 
      L     DB1741.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1745.DBX  172.0; 
      JCN   ppc; 
      L     DB1741.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1745.DBX  171.6; 
      JCN   pxc; 
      L     DB1741.DBD  574; 
pxc:  NOP   0; 
      T     DB1745.DBD  182; 

//CIP Return
      L     DB1741.DBD  558; 
      T     DB1745.DBD  186; 
      L     DB1745.DBD  138; 
      T     DB1741.DBD  562; 

//CIP Prerun
      L     DB1741.DBD  542; 
      T     DB1745.DBD  190; 
      L     DB1745.DBD  142; 
      T     DB1741.DBD  546; 

// Write Own Data to CIP
      L     DB1745.DBD   10; 
      T     DB1745.DBD  154; 

      L     DB1745.DBW   14; 
      T     DB1745.DBW  158; 

      L     DB1745.DBW   16; 
      T     DB1745.DBW  160; 

      L     DB1745.DBW   18; 
      T     DB1745.DBW  162; 

      L     DB1745.DBW   20; 
      T     DB1745.DBW  164; 

      L     DB1745.DBW   22; 
      T     DB1745.DBW  166; 

      A     DB1745.DBX   24.0; 
      =     DB1745.DBX  168.0; 

      A     DB1745.DBX   24.1; 
      =     DB1745.DBX  168.1; 

      A     DB1745.DBX   24.2; 
      =     DB1745.DBX  168.2; 

      A     DB1745.DBX   24.3; 
      =     DB1745.DBX  168.3; 

      A     DB1745.DBX   24.4; 
      =     DB1745.DBX  168.4; 

      A     DB1745.DBX   24.5; 
      =     DB1745.DBX  168.5; 

      A     DB1745.DBX   24.6; 
      =     DB1745.DBX  168.6; 

      A     DB1745.DBX   24.7; 
      =     DB1745.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1745.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1745.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U074SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1745.DBX   26.5; 

//Full Signal
//A     "U074SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1745.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1745.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1745.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE =Signals to Filler / Mixer

// Watchdog
      A     M    100.7; 
      =     Q    911.7; 
      =     Q    923.7; 
      =     Q   1003.7; 

// Panel

      A     #CIP; 
      =     Q    911.3; // FG Wasser CIP
      A     DB2741.DBX 1518.7; 
      =     Q    911.4; // FG Komp. CIP
      A     #CIP; 
      =     Q    912.0; // FG Fertigg. CIP


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1749
TITLE =U074: Packaging Plant 14
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1740.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1741.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1741.DBX   17.3; 
      =     DB2740.DBX  105.3; 
      =     DB2740.DBX  185.3; 
      =     DB2740.DBX 1625.3; 
      =     DB2740.DBX 1705.3; 
      =     DB2740.DBX 1785.3; 

NETWORK
TITLE =Special Input

      A     DB1741.DBX   17.3; 
      =     DB2741.DBX 1581.3; 
      =     DB2741.DBX 1641.3; 

NETWORK
TITLE =Counter

      A     DB1741.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1741.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1741.DBX   17.3; 
//      =     "U074UnVD".unv001.Sim; 
//      =     "U074UnVD".unv002.Sim; 
//      =     "U074UnVD".unv003.Sim; 
//      =     "U074UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB1741.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1741.DBX   17.3; 
//      =     "U074MsgD".msg001.Sim; 
//      =     "U074MsgD".msg002.Sim; 
//      =     "U074MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB1741.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1775
TITLE =U077: KZE Anlage  3
FAMILY : BOTEC_F1
NAME : U077Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1770.DBW    0; 
      T     #UnitNo; 

      L     DB1775.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1775.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1775.DBD   10; 
      L     DB1775.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1775.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1775.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1771.DBX   15.0; 
      A     DB1771.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1775.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1771.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1771.DBX   15.0; 
//      AN "U077SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1775.DBD  150; 
      T     DB1771.DBD  626; 

//Temperature CIP Return
      L     DB1775.DBD  146; 
      T     DB1771.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1771.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1775.DBX  171.7; 
      JCN   pfc; 
      L     DB1771.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1775.DBX  172.0; 
      JCN   ppc; 
      L     DB1771.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1775.DBX  171.6; 
      JCN   pxc; 
      L     DB1771.DBD  574; 
pxc:  NOP   0; 
      T     DB1775.DBD  182; 

//CIP Return
      L     DB1771.DBD  558; 
      T     DB1775.DBD  186; 
      L     DB1775.DBD  138; 
      T     DB1771.DBD  562; 

//CIP Prerun
      L     DB1771.DBD  542; 
      T     DB1775.DBD  190; 
      L     DB1775.DBD  142; 
      T     DB1771.DBD  546; 

// Write Own Data to CIP
      L     DB1775.DBD   10; 
      T     DB1775.DBD  154; 

      L     DB1775.DBW   14; 
      T     DB1775.DBW  158; 

      L     DB1775.DBW   16; 
      T     DB1775.DBW  160; 

      L     DB1775.DBW   18; 
      T     DB1775.DBW  162; 

      L     DB1775.DBW   20; 
      T     DB1775.DBW  164; 

      L     DB1775.DBW   22; 
      T     DB1775.DBW  166; 

      A     DB1775.DBX   24.0; 
      =     DB1775.DBX  168.0; 

      A     DB1775.DBX   24.1; 
      =     DB1775.DBX  168.1; 

      A     DB1775.DBX   24.2; 
      =     DB1775.DBX  168.2; 

      A     DB1775.DBX   24.3; 
      =     DB1775.DBX  168.3; 

      A     DB1775.DBX   24.4; 
      =     DB1775.DBX  168.4; 

      A     DB1775.DBX   24.5; 
      =     DB1775.DBX  168.5; 

      A     DB1775.DBX   24.6; 
      =     DB1775.DBX  168.6; 

      A     DB1775.DBX   24.7; 
      =     DB1775.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1775.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1775.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U077SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1775.DBX   26.5; 

//Full Signal
//A     "U077SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1775.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1775.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1775.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1785
TITLE =U078: KZE Anlage  5
FAMILY : BOTEC_F1
NAME : U078Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1780.DBW    0; 
      T     #UnitNo; 

      L     DB1785.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1785.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1785.DBD   10; 
      L     DB1785.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1785.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1785.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1781.DBX   15.0; 
      A     DB1781.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1785.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1781.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2780.DBX  186.7; 
      =     DB2780.DBX  266.7; 
      =     DB2780.DBX  346.7; 
      =     DB2780.DBX  426.7; 
      =     DB2780.DBX  506.7; 
      =     DB2780.DBX  586.7; 
      =     DB2780.DBX  666.7; 
      =     DB2780.DBX  986.7; 
      =     DB2780.DBX 1066.7; 
      =     DB2780.DBX 1146.7; 
      =     DB2780.DBX 1226.7; 
      =     DB2780.DBX 1306.7; 
      =     DB2780.DBX 1386.7; 
      =     DB2780.DBX 1626.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1781.DBX   15.0; 
      AN    DB1781.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1785.DBD  150; 
      T     DB1781.DBD  626; 

//Temperature CIP Return
      L     DB1785.DBD  146; 
      T     DB1781.DBD  594; 

//Temperature CIP Prerun
      L     DB1785.DBD  134; 
      T     DB1781.DBD  690; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1781.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1785.DBX  171.7; 
      JCN   pfc; 
      L     DB1781.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1785.DBX  172.0; 
      JCN   ppc; 
      L     DB1781.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1785.DBX  171.6; 
      JCN   pxc; 
      L     DB1781.DBD  574; 
pxc:  NOP   0; 
      T     DB1785.DBD  182; 

// CIP Prerun Temperature
      L     DB1781.DBD  686; 
      T     DB1785.DBD  182; 

//CIP Return
      L     DB1781.DBD  558; 
      T     DB1785.DBD  186; 
      L     DB1785.DBD  138; 
      T     DB1781.DBD  562; 

//CIP Prerun
      L     DB1781.DBD  542; 
      T     DB1785.DBD  190; 
      L     DB1785.DBD  142; 
      T     DB1781.DBD  546; 

// Write Own Data to CIP
      L     DB1785.DBD   10; 
      T     DB1785.DBD  154; 

      L     DB1785.DBW   14; 
      T     DB1785.DBW  158; 

      L     DB1785.DBW   16; 
      T     DB1785.DBW  160; 

      L     DB1785.DBW   18; 
      T     DB1785.DBW  162; 

      L     DB1785.DBW   20; 
      T     DB1785.DBW  164; 

      L     DB1785.DBW   22; 
      T     DB1785.DBW  166; 

      A     DB1785.DBX   24.0; 
      =     DB1785.DBX  168.0; 

      A     DB1785.DBX   24.1; 
      =     DB1785.DBX  168.1; 

      A     DB1785.DBX   24.2; 
      =     DB1785.DBX  168.2; 

      A     DB1785.DBX   24.3; 
      =     DB1785.DBX  168.3; 

      A     DB1785.DBX   24.4; 
      =     DB1785.DBX  168.4; 

      A     DB1785.DBX   24.5; 
      =     DB1785.DBX  168.5; 

      A     DB1785.DBX   24.6; 
      =     DB1785.DBX  168.6; 

      A     DB1785.DBX   24.7; 
      =     DB1785.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1785.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1785.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U078SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1785.DBX   26.5; 

//Full Signal
//A     "U078SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1785.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1785.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1785.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



// ... CIP / CIP Distribution ------------- /
      CALL FC   563 (
           ActReq                   := TRUE,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1785.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := TRUE,
           PLCNo                    := 3,
           SourceUnitNo             := 94,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1785.CIPDist,
           RET_VAL                  := #wRetVal);

      L     DB1781.DBD   46; 
      L     DB1945.DBD   10; 
      ==D   ; 
      JCN   CIP1; 
      CALL SFC   20 (
           SRCBLK                   := DB1785.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP1);

CIP1: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1795
TITLE =U079: KZE Anlage 14
FAMILY : BOTEC_F1
NAME : U079Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1790.DBW    0; 
      T     #UnitNo; 

      L     DB1795.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1795.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1795.DBD   10; 
      L     DB1795.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1795.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1795.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1791.DBX   15.0; 
      A     DB1791.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1795.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1791.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2790.DBX  186.7; 
      =     DB2790.DBX  266.7; 
      =     DB2790.DBX  426.7; 
      =     DB2790.DBX  506.7; 
      =     DB2790.DBX  586.7; 
      =     DB2790.DBX  666.7; 
      =     DB2790.DBX  986.7; 
      =     DB2790.DBX 1066.7; 
      =     DB2790.DBX 1146.7; 
      =     DB2790.DBX 1226.7; 
      =     DB2790.DBX 1306.7; 
      =     DB2790.DBX 1386.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1791.DBX   15.0; 
//      AN "U079SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1795.DBD  150; 
      T     DB1791.DBD  626; 

//Temperature CIP Return
      L     DB1795.DBD  146; 
      T     DB1791.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1791.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1795.DBX  171.7; 
      JCN   pfc; 
      L     DB1791.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1795.DBX  172.0; 
      JCN   ppc; 
      L     DB1791.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1795.DBX  171.6; 
      JCN   pxc; 
      L     DB1791.DBD  574; 
pxc:  NOP   0; 
      T     DB1795.DBD  182; 

//CIP Return
      L     DB1791.DBD  558; 
      T     DB1795.DBD  186; 
      L     DB1795.DBD  138; 
      T     DB1791.DBD  562; 

//CIP Prerun
      L     DB1791.DBD  542; 
      T     DB1795.DBD  190; 
      L     DB1795.DBD  142; 
      T     DB1791.DBD  546; 

// Write Own Data to CIP
      L     DB1795.DBD   10; 
      T     DB1795.DBD  154; 

      L     DB1795.DBW   14; 
      T     DB1795.DBW  158; 

      L     DB1795.DBW   16; 
      T     DB1795.DBW  160; 

      L     DB1795.DBW   18; 
      T     DB1795.DBW  162; 

      L     DB1795.DBW   20; 
      T     DB1795.DBW  164; 

      L     DB1795.DBW   22; 
      T     DB1795.DBW  166; 

      A     DB1795.DBX   24.0; 
      =     DB1795.DBX  168.0; 

      A     DB1795.DBX   24.1; 
      =     DB1795.DBX  168.1; 

      A     DB1795.DBX   24.2; 
      =     DB1795.DBX  168.2; 

      A     DB1795.DBX   24.3; 
      =     DB1795.DBX  168.3; 

      A     DB1795.DBX   24.4; 
      =     DB1795.DBX  168.4; 

      A     DB1795.DBX   24.5; 
      =     DB1795.DBX  168.5; 

      A     DB1795.DBX   24.6; 
      =     DB1795.DBX  168.6; 

      A     DB1795.DBX   24.7; 
      =     DB1795.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1795.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1795.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U079SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1795.DBX   26.5; 

//Full Signal
//A     "U079SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1795.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1795.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1795.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1815
TITLE =U081: Caustic Tank
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1810.DBW    0; 
      T     #UnitNo; 

      L     DB1815.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1815.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1815.DBD   10; 
      L     DB1815.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1815.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1815.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1815.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 

      A     DB1811.DBX   15.0; 
      A     DB1811.DBX   17.4; 
      JCN   Strt; 
      L     DB1815.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1811.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2810.DBX  106.7; 
      =     DB2810.DBX  186.7; 
      =     DB2810.DBX  266.7; 
      =     DB2810.DBX  346.7; 
      =     DB2810.DBX  426.7; 
      =     DB2810.DBX  506.7; 
      =     DB2810.DBX  586.7; 
      =     DB2810.DBX  666.7; 
      =     DB2810.DBX  746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1811.DBX   15.0; 
//      AN "U081SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1815.DBD  150; 
      T     DB1811.DBD  626; 

//Temperature CIP Return
      L     DB1815.DBD  146; 
      T     DB1811.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1811.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1815.DBX  171.7; 
      JCN   pfc; 
      L     DB1811.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1815.DBX  172.0; 
      JCN   ppc; 
      L     DB1811.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1815.DBX  171.6; 
      JCN   pxc; 
      L     DB1811.DBD  574; 
pxc:  NOP   0; 
      T     DB1815.DBD  182; 

//CIP Return
      L     DB1811.DBD  558; 
      T     DB1815.DBD  186; 
      L     DB1815.DBD  138; 
      T     DB1811.DBD  562; 

//CIP Prerun
      L     DB1811.DBD  542; 
      T     DB1815.DBD  190; 
      L     DB1815.DBD  142; 
      T     DB1811.DBD  546; 

// Write Own Data to CIP
      L     DB1815.DBD   10; 
      T     DB1815.DBD  154; 

      L     DB1815.DBW   14; 
      T     DB1815.DBW  158; 

      L     DB1815.DBW   16; 
      T     DB1815.DBW  160; 

      L     DB1815.DBW   18; 
      T     DB1815.DBW  162; 

      L     DB1815.DBW   20; 
      T     DB1815.DBW  164; 

      L     DB1815.DBW   22; 
      T     DB1815.DBW  166; 

      A     DB1815.DBX   24.0; 
      =     DB1815.DBX  168.0; 

      A     DB1815.DBX   24.1; 
      =     DB1815.DBX  168.1; 

      A     DB1815.DBX   24.2; 
      =     DB1815.DBX  168.2; 

      A     DB1815.DBX   24.3; 
      =     DB1815.DBX  168.3; 

      A     DB1815.DBX   24.4; 
      =     DB1815.DBX  168.4; 

      A     DB1815.DBX   24.5; 
      =     DB1815.DBX  168.5; 

      A     DB1815.DBX   24.6; 
      =     DB1815.DBX  168.6; 

      A     DB1815.DBX   24.7; 
      =     DB1815.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1815.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1815.ToCIP);

NCIP: NOP   0; 

//Empty Signal
      A     DB2811.DBX   78.7; 
      =     DB1815.DBX   26.5; 

//Full Signal
      AN    DB2811.DBX  138.7; 
      O     DB2813.DBX  138.4; 
      =     DB1815.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1815.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1815.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1819
TITLE =U081: Caustic Tank
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1810.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1811.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1811.DBX   17.3; 
      =     DB2810.DBX  105.3; 
      =     DB2810.DBX  185.3; 
      =     DB2810.DBX  265.3; 
      =     DB2810.DBX  345.3; 
      =     DB2810.DBX  425.3; 
      =     DB2810.DBX  505.3; 
      =     DB2810.DBX  585.3; 
      =     DB2810.DBX  665.3; 
      =     DB2810.DBX  745.3; 

NETWORK
TITLE =Special Input

      A     DB1811.DBX   17.3; 
      =     DB2811.DBX   81.3; 
      =     DB2811.DBX  141.3; 
      =     DB2811.DBX  201.3; 
      =     DB2811.DBX  261.3; 
      =     DB2811.DBX  321.3; 
      =     DB2811.DBX  441.3; 
      =     DB2811.DBX  501.3; 

NETWORK
TITLE =Counter

      A     DB1811.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1811.DBX   17.3; 
      =     DB2813.DBX  141.3; 
      =     DB2813.DBX  261.3; 

NETWORK
TITLE =Universal Value

      A     DB1811.DBX   17.3; 
//      =     "U081UnVD".unv001.Sim; 
//      =     "U081UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1811.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1811.DBX   17.3; 
//      =     "U081MsgD".msg001.Sim; 
//      =     "U081MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1811.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1825
TITLE =U082: Acid Tank
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1820.DBW    0; 
      T     #UnitNo; 

      L     DB1825.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1825.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1825.DBD   10; 
      L     DB1825.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1825.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1825.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1825.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 

      A     DB1821.DBX   15.0; 
      A     DB1821.DBX   17.4; 
      JCN   Strt; 
      L     DB1825.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1821.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2820.DBX  106.7; 
      =     DB2820.DBX  186.7; 
      =     DB2820.DBX  346.7; 
      =     DB2820.DBX  426.7; 
      =     DB2820.DBX  586.7; 
      =     DB2820.DBX  666.7; 
      =     DB2820.DBX  746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1821.DBX   15.0; 
//      AN "U082SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1825.DBD  150; 
      T     DB1821.DBD  626; 

//Temperature CIP Return
      L     DB1825.DBD  146; 
      T     DB1821.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1821.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1825.DBX  171.7; 
      JCN   pfc; 
      L     DB1821.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1825.DBX  172.0; 
      JCN   ppc; 
      L     DB1821.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1825.DBX  171.6; 
      JCN   pxc; 
      L     DB1821.DBD  574; 
pxc:  NOP   0; 
      T     DB1825.DBD  182; 

//CIP Return
      L     DB1821.DBD  558; 
      T     DB1825.DBD  186; 
      L     DB1825.DBD  138; 
      T     DB1821.DBD  562; 

//CIP Prerun
      L     DB1821.DBD  542; 
      T     DB1825.DBD  190; 
      L     DB1825.DBD  142; 
      T     DB1821.DBD  546; 

// Write Own Data to CIP
      L     DB1825.DBD   10; 
      T     DB1825.DBD  154; 

      L     DB1825.DBW   14; 
      T     DB1825.DBW  158; 

      L     DB1825.DBW   16; 
      T     DB1825.DBW  160; 

      L     DB1825.DBW   18; 
      T     DB1825.DBW  162; 

      L     DB1825.DBW   20; 
      T     DB1825.DBW  164; 

      L     DB1825.DBW   22; 
      T     DB1825.DBW  166; 

      A     DB1825.DBX   24.0; 
      =     DB1825.DBX  168.0; 

      A     DB1825.DBX   24.1; 
      =     DB1825.DBX  168.1; 

      A     DB1825.DBX   24.2; 
      =     DB1825.DBX  168.2; 

      A     DB1825.DBX   24.3; 
      =     DB1825.DBX  168.3; 

      A     DB1825.DBX   24.4; 
      =     DB1825.DBX  168.4; 

      A     DB1825.DBX   24.5; 
      =     DB1825.DBX  168.5; 

      A     DB1825.DBX   24.6; 
      =     DB1825.DBX  168.6; 

      A     DB1825.DBX   24.7; 
      =     DB1825.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1825.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1825.ToCIP);

NCIP: NOP   0; 

//Empty Signal
      A     DB2821.DBX   78.7; 
      =     DB1825.DBX   26.5; 

//Full Signal
      AN    DB2821.DBX  138.7; 
      O     DB2823.DBX  138.4; 
      =     DB1825.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1825.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1825.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1829
TITLE =U082: Acid Tank
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1820.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1821.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1821.DBX   17.3; 
      =     DB2820.DBX  105.3; 
      =     DB2820.DBX  185.3; 
      =     DB2820.DBX  345.3; 
      =     DB2820.DBX  425.3; 
      =     DB2820.DBX  585.3; 
      =     DB2820.DBX  665.3; 
      =     DB2820.DBX  745.3; 

NETWORK
TITLE =Special Input

      A     DB1821.DBX   17.3; 
      =     DB2821.DBX   81.3; 
      =     DB2821.DBX  141.3; 
      =     DB2821.DBX  201.3; 
      =     DB2821.DBX  261.3; 
      =     DB2821.DBX  441.3; 
      =     DB2821.DBX  501.3; 

NETWORK
TITLE =Counter

      A     DB1821.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1821.DBX   17.3; 
      =     DB2823.DBX  141.3; 
      =     DB2823.DBX  261.3; 

NETWORK
TITLE =Universal Value

      A     DB1821.DBX   17.3; 
//      =     "U082UnVD".unv001.Sim; 
//      =     "U082UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1821.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1821.DBX   17.3; 
//      =     "U082MsgD".msg001.Sim; 
//      =     "U082MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1821.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1835
TITLE =U083: Hot Water Tank
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1830.DBW    0; 
      T     #UnitNo; 

      L     DB1835.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1835.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1835.DBD   10; 
      L     DB1835.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1835.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1835.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1835.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 

      A     DB1831.DBX   15.0; 
      A     DB1831.DBX   17.4; 
      JCN   Strt; 
      L     DB1835.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1831.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2830.DBX  106.7; 
      =     DB2830.DBX  186.7; 
      =     DB2830.DBX  266.7; 
      =     DB2830.DBX  346.7; 
      =     DB2830.DBX  426.7; 
      =     DB2830.DBX  586.7; 
      =     DB2830.DBX  746.7; 
      =     DB2830.DBX  826.7; 
      =     DB2830.DBX  906.7; 
      =     DB2830.DBX  986.7; 
      =     DB2830.DBX 1066.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1831.DBX   15.0; 
//      AN "U083SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1835.DBD  150; 
      T     DB1831.DBD  626; 

//Temperature CIP Return
      L     DB1835.DBD  146; 
      T     DB1831.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1831.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1835.DBX  171.7; 
      JCN   pfc; 
      L     DB1831.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1835.DBX  172.0; 
      JCN   ppc; 
      L     DB1831.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1835.DBX  171.6; 
      JCN   pxc; 
      L     DB1831.DBD  574; 
pxc:  NOP   0; 
      T     DB1835.DBD  182; 

//CIP Return
      L     DB1831.DBD  558; 
      T     DB1835.DBD  186; 
      L     DB1835.DBD  138; 
      T     DB1831.DBD  562; 

//CIP Prerun
      L     DB1831.DBD  542; 
      T     DB1835.DBD  190; 
      L     DB1835.DBD  142; 
      T     DB1831.DBD  546; 

// Write Own Data to CIP
      L     DB1835.DBD   10; 
      T     DB1835.DBD  154; 

      L     DB1835.DBW   14; 
      T     DB1835.DBW  158; 

      L     DB1835.DBW   16; 
      T     DB1835.DBW  160; 

      L     DB1835.DBW   18; 
      T     DB1835.DBW  162; 

      L     DB1835.DBW   20; 
      T     DB1835.DBW  164; 

      L     DB1835.DBW   22; 
      T     DB1835.DBW  166; 

      A     DB1835.DBX   24.0; 
      =     DB1835.DBX  168.0; 

      A     DB1835.DBX   24.1; 
      =     DB1835.DBX  168.1; 

      A     DB1835.DBX   24.2; 
      =     DB1835.DBX  168.2; 

      A     DB1835.DBX   24.3; 
      =     DB1835.DBX  168.3; 

      A     DB1835.DBX   24.4; 
      =     DB1835.DBX  168.4; 

      A     DB1835.DBX   24.5; 
      =     DB1835.DBX  168.5; 

      A     DB1835.DBX   24.6; 
      =     DB1835.DBX  168.6; 

      A     DB1835.DBX   24.7; 
      =     DB1835.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1835.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1835.ToCIP);

NCIP: NOP   0; 

//Empty Signal
      A     DB2831.DBX   78.7; 
      =     DB1835.DBX   26.5; 

//Full Signal
      AN    DB2831.DBX  138.7; 
      O     DB2833.DBX  138.4; 
      =     DB1835.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1835.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1835.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1839
TITLE =U083: Hot Water Tank
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1830.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1831.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1831.DBX   17.3; 
      =     DB2830.DBX  105.3; 
      =     DB2830.DBX  185.3; 
      =     DB2830.DBX  265.3; 
      =     DB2830.DBX  345.3; 
      =     DB2830.DBX  425.3; 
      =     DB2830.DBX  585.3; 
      =     DB2830.DBX  745.3; 
      =     DB2830.DBX  825.3; 
      =     DB2830.DBX  905.3; 
      =     DB2830.DBX  985.3; 
      =     DB2830.DBX 1065.3; 

NETWORK
TITLE =Special Input

      A     DB1831.DBX   17.3; 
      =     DB2831.DBX   81.3; 
      =     DB2831.DBX  141.3; 
      =     DB2831.DBX  201.3; 
      =     DB2831.DBX  261.3; 
      =     DB2831.DBX  321.3; 
      =     DB2831.DBX  381.3; 
      =     DB2831.DBX  441.3; 

NETWORK
TITLE =Counter

      A     DB1831.DBX   17.3; 
      A     M    101.0; 
      =     DB2832.DBX   99.1; 

      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1831.DBX   17.3; 
      =     DB2833.DBX  141.3; 
      =     DB2833.DBX  261.3; 
      =     DB2833.DBX  381.3; 
      =     DB2833.DBX  501.3; 
      =     DB2833.DBX  621.3; 
      =     DB2833.DBX  741.3; 

NETWORK
TITLE =Universal Value

      A     DB1831.DBX   17.3; 
//      =     "U083UnVD".unv001.Sim; 
//      =     "U083UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1831.DBX   17.3; 
//      =     "U083PIDD".HWP1_FU.Ign; 
//      =     "U083PIDD".RV_Kaltwasser.Ign; 

NETWORK
TITLE =Message

      A     DB1831.DBX   17.3; 
//      =     "U083MsgD".msg001.Sim; 
//      =     "U083MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1831.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1845
TITLE =U084: Fresh Water Tank
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1840.DBW    0; 
      T     #UnitNo; 

      L     DB1845.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1845.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1845.DBD   10; 
      L     DB1845.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1845.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1845.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1845.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 

      A     DB1841.DBX   15.0; 
      A     DB1841.DBX   17.4; 
      JCN   Strt; 
      L     DB1845.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1841.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2840.DBX  186.7; 
      =     DB2840.DBX  666.7; 
      =     DB2840.DBX  746.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1841.DBX   15.0; 
//      AN "U084SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1845.DBD  150; 
      T     DB1841.DBD  626; 

//Temperature CIP Return
      L     DB1845.DBD  146; 
      T     DB1841.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1841.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1845.DBX  171.7; 
      JCN   pfc; 
      L     DB1841.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1845.DBX  172.0; 
      JCN   ppc; 
      L     DB1841.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1845.DBX  171.6; 
      JCN   pxc; 
      L     DB1841.DBD  574; 
pxc:  NOP   0; 
      T     DB1845.DBD  182; 

//CIP Return
      L     DB1841.DBD  558; 
      T     DB1845.DBD  186; 
      L     DB1845.DBD  138; 
      T     DB1841.DBD  562; 

//CIP Prerun
      L     DB1841.DBD  542; 
      T     DB1845.DBD  190; 
      L     DB1845.DBD  142; 
      T     DB1841.DBD  546; 

// Write Own Data to CIP
      L     DB1845.DBD   10; 
      T     DB1845.DBD  154; 

      L     DB1845.DBW   14; 
      T     DB1845.DBW  158; 

      L     DB1845.DBW   16; 
      T     DB1845.DBW  160; 

      L     DB1845.DBW   18; 
      T     DB1845.DBW  162; 

      L     DB1845.DBW   20; 
      T     DB1845.DBW  164; 

      L     DB1845.DBW   22; 
      T     DB1845.DBW  166; 

      A     DB1845.DBX   24.0; 
      =     DB1845.DBX  168.0; 

      A     DB1845.DBX   24.1; 
      =     DB1845.DBX  168.1; 

      A     DB1845.DBX   24.2; 
      =     DB1845.DBX  168.2; 

      A     DB1845.DBX   24.3; 
      =     DB1845.DBX  168.3; 

      A     DB1845.DBX   24.4; 
      =     DB1845.DBX  168.4; 

      A     DB1845.DBX   24.5; 
      =     DB1845.DBX  168.5; 

      A     DB1845.DBX   24.6; 
      =     DB1845.DBX  168.6; 

      A     DB1845.DBX   24.7; 
      =     DB1845.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1845.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1845.ToCIP);

NCIP: NOP   0; 

//Empty Signal
      A     DB2841.DBX   78.7; 
      =     DB1845.DBX   26.5; 

//Full Signal
      AN    DB2841.DBX  138.7; 
      O     DB2843.DBX  138.4; 
      =     DB1845.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1845.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1845.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1849
TITLE =U084: Fresh Water Tank
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1840.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1841.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1841.DBX   17.3; 
      =     DB2840.DBX  185.3; 
      =     DB2840.DBX  665.3; 
      =     DB2840.DBX  745.3; 

NETWORK
TITLE =Special Input

      A     DB1841.DBX   17.3; 
      =     DB2841.DBX   81.3; 
      =     DB2841.DBX  141.3; 
      =     DB2841.DBX  201.3; 
      =     DB2841.DBX  321.3; 
      =     DB2841.DBX  381.3; 
      =     DB2841.DBX  441.3; 
      =     DB2841.DBX  501.3; 
      =     DB2841.DBX  621.3; 
      =     DB2841.DBX  681.3; 
      =     DB2841.DBX  741.3; 
      =     DB2841.DBX  921.3; 

NETWORK
TITLE =Counter

      A     DB1841.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1841.DBX   17.3; 
      =     DB2843.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1841.DBX   17.3; 
//      =     "U084UnVD".unv001.Sim; 
//      =     "U084UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1841.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1841.DBX   17.3; 
//      =     "U084MsgD".msg001.Sim; 
//      =     "U084MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1841.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1915
TITLE =U091: CIP Line 1
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1910.DBW    0; 
      T     #UnitNo; 

      L     DB1915.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1915.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1915.DBD   10; 
      L     DB1915.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1915.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      L     DB502.DBD    0; 
      L     0; 
      >D    ; 
      A     DB1911.DBX   15.0; 
      A     DB1911.DBX   17.4; 
      JCN   Strt; 
      L     DB502.DBD    0; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1911.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      L     0; 
      T     DB502.DBD    0; // Reset Start Request

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1919
TITLE =U091: CIP Line 1
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1910.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1911.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1911.DBX   17.3; 
      =     DB2910.DBX  105.3; 
      =     DB2910.DBX  345.3; 
      =     DB2910.DBX  425.3; 
      =     DB2910.DBX  505.3; 
      =     DB2910.DBX  585.3; 
      =     DB2910.DBX  665.3; 
      =     DB2910.DBX  745.3; 
      =     DB2910.DBX  825.3; 
      =     DB2910.DBX  905.3; 
      =     DB2910.DBX  985.3; 
      =     DB2910.DBX 2585.3; 
      =     DB2910.DBX 2665.3; 
      =     DB2910.DBX 2745.3; 

NETWORK
TITLE =Special Input

      A     DB1911.DBX   17.3; 
      =     DB2911.DBX   81.3; 
      =     DB2911.DBX  141.3; 

      A     DB2910.DBX  102.6; 
      A     M    101.3; 
      =     DB2911.DBX  138.7; 

NETWORK
TITLE =Counter

      A     DB1911.DBX   17.3; 
//      =     "U091CntD".IDM_IMPULSE_RV_1FQI.Sim; 
      A     M    101.0; 
      =     DB2912.DBX  179.1; 
      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1911.DBX   17.3; 
      =     DB2913.DBX  141.3; 
      =     DB2913.DBX  261.3; 
      =     DB2913.DBX  381.3; 
      =     DB2913.DBX  501.3; 

NETWORK
TITLE =Universal Value

      A     DB1911.DBX   17.3; 
//      =     "U091UnVD".unv001.Sim; 
//      =     "U091UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1911.DBX   17.3; 
//      =     "U091PIDD".RV1RV.Ign; 

NETWORK
TITLE =Message

      A     DB1911.DBX   17.3; 
//      =     "U091MsgD".msg001.Sim; 
//      =     "U091MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1911.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1925
TITLE =U092: CIP Line 2
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1920.DBW    0; 
      T     #UnitNo; 

      L     DB1925.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1925.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1925.DBD   10; 
      L     DB1925.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1925.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      L     DB502.DBD    4; 
      L     0; 
      >D    ; 
      A     DB1921.DBX   15.0; 
      A     DB1921.DBX   17.4; 
      JCN   Strt; 
      L     DB502.DBD    4; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1921.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      L     0; 
      T     DB502.DBD    4; // Reset Start Request

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1929
TITLE =U092: CIP Line 2
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1920.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1921.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1921.DBX   17.3; 
      =     DB2920.DBX  105.3; 
      =     DB2920.DBX  265.3; 
      =     DB2920.DBX  345.3; 
      =     DB2920.DBX  425.3; 
      =     DB2920.DBX  505.3; 
      =     DB2920.DBX  585.3; 
      =     DB2920.DBX  665.3; 
      =     DB2920.DBX  745.3; 
      =     DB2920.DBX  825.3; 
      =     DB2920.DBX  905.3; 
      =     DB2920.DBX  985.3; 
      =     DB2920.DBX 1785.3; 
      =     DB2920.DBX 2105.3; 
      =     DB2920.DBX 2185.3; 
      =     DB2920.DBX 2265.3; 
      =     DB2920.DBX 2345.3; 
      =     DB2920.DBX 2505.3; 
      =     DB2920.DBX 2585.3; 
      =     DB2920.DBX 2665.3; 
      =     DB2920.DBX 2745.3; 


NETWORK
TITLE =Special Input

      A     DB1921.DBX   17.3; 
      =     DB2921.DBX   81.3; 
      =     DB2921.DBX  141.3; 

      A     DB2920.DBX  102.6; 
      A     M    101.3; 
      =     DB2921.DBX  138.7; 

NETWORK
TITLE =Counter

      A     DB1921.DBX   17.3; 
//      =     "U092CntD".IDM_IMPULSE_RV_2FQI.Sim; 
      A     M    101.0; 
      =     DB2922.DBX  179.1; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1921.DBX   17.3; 
      =     DB2923.DBX  141.3; 
      =     DB2923.DBX  261.3; 
      =     DB2923.DBX  381.3; 
      =     DB2923.DBX  501.3; 

NETWORK
TITLE =Universal Value

      A     DB1921.DBX   17.3; 
//      =     "U092UnVD".unv001.Sim; 
//      =     "U092UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1921.DBX   17.3; 
//      =     "U092PIDD".RV2RV.Ign; 

NETWORK
TITLE =Message

      A     DB1921.DBX   17.3; 
//      =     "U092MsgD".msg001.Sim; 
//      =     "U092MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1921.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1935
TITLE =U093: CIP Line 3
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1930.DBW    0; 
      T     #UnitNo; 

      L     DB1935.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1935.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1935.DBD   10; 
      L     DB1935.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1935.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      L     DB502.DBD    8; 
      L     0; 
      >D    ; 
      A     DB1931.DBX   15.0; 
      A     DB1931.DBX   17.4; 
      JCN   Strt; 
      L     DB502.DBD    8; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1931.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      L     0; 
      T     DB502.DBD    8; // Reset Start Request


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1939
TITLE =U093: CIP Line 3
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1930.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1931.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1931.DBX   17.3; 
      =     DB2930.DBX  105.3; 
      =     DB2930.DBX  345.3; 
      =     DB2930.DBX  425.3; 
      =     DB2930.DBX  505.3; 
      =     DB2930.DBX  585.3; 
      =     DB2930.DBX  665.3; 
      =     DB2930.DBX  745.3; 
      =     DB2930.DBX  825.3; 
      =     DB2930.DBX  905.3; 
      =     DB2930.DBX  985.3; 
      =     DB2930.DBX 2505.3; 
      =     DB2930.DBX 2585.3; 
      =     DB2930.DBX 2665.3; 
      =     DB2930.DBX 2745.3; 

NETWORK
TITLE =Special Input

      A     DB1931.DBX   17.3; 
      =     DB2931.DBX   81.3; 
      =     DB2931.DBX  141.3; 
      =     DB2931.DBX  201.3; 

      A     DB2930.DBX  102.6; 
      A     M    101.3; 
      =     DB2931.DBX  138.7; 

NETWORK
TITLE =Counter

      A     DB1931.DBX   17.3; 
//      =     "U093CntD".IDM_IMPULSE_RV_3FQI.Sim; 
      A     M    101.0; 
      =     DB2932.DBX  179.1; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1931.DBX   17.3; 
      =     DB2933.DBX  141.3; 
      =     DB2933.DBX  261.3; 
      =     DB2933.DBX  381.3; 
      =     DB2933.DBX  501.3; 

NETWORK
TITLE =Universal Value

      A     DB1931.DBX   17.3; 
//      =     "U093UnVD".unv001.Sim; 
//      =     "U093UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1931.DBX   17.3; 
//      =     "U093PIDD".RV3RV.Ign; 

NETWORK
TITLE =Message

      A     DB1931.DBX   17.3; 
//      =     "U093MsgD".msg001.Sim; 
//      =     "U093MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1931.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1945
TITLE =U094: CIP 1 Distribution
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1940.DBW    0; 
      T     #UnitNo; 

      L     DB1945.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1945.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1945.DBD   10; 
      L     DB1945.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1945.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1945.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1945.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1945.CIP,
           RET_VAL                  := #wRetVal);

// ... To CIP Unit ------------- /
      AN    DB1941.DBX   15.0; 
      A     DB1941.DBX 1233.6; // CIP Active (Slave)
      O     DB1941.DBX 1230.3; // Production active
//   A     #ComCIP
      JCN   Slav; 
      CALL SFC   20 (
           SRCBLK                   := DB502.ToCIP1,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1945.ToCIP);
Slav: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 
//-----------------------------------
// Start Request
//-----------------------------------
      L     DB502.DBD  156; 
      L     0; 
      >D    ; 
      A     DB1941.DBX   15.0; 
      A     DB1941.DBX   17.4; 
      JCN   Strt; 
      L     DB502.DBD  156; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1941.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      L     0; 
      T     DB502.DBD  156; 

NETWORK
TITLE =external releases

      SET   ; 
      =     DB2940.DBX  106.7; 
      =     DB2940.DBX  266.7; 
      =     DB2940.DBX  346.7; 
      =     DB2940.DBX  426.7; 
      =     DB2940.DBX  506.7; 
      =     DB2940.DBX  586.7; 
      =     DB2940.DBX  666.7; 
      =     DB2940.DBX  746.7; 
      =     DB2940.DBX  826.7; 
      =     DB2940.DBX  906.7; 
      =     DB2940.DBX  986.7; 
      =     DB2940.DBX 1066.7; 
      =     DB2940.DBX 1146.7; 
      =     DB2940.DBX 1226.7; 
      =     DB2940.DBX 1306.7; 
      =     DB2940.DBX 1386.7; 
      =     DB2940.DBX 1466.7; 
      =     DB2940.DBX 1546.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1941.DBX   15.0; 
      AN    DB1941.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1945.DBD  150; 
      T     DB1941.DBD  626; 

//Temperature CIP Return
      L     DB1945.DBD  146; 
      T     DB1941.DBD  594; 

//CIP Prerun Pump SP
      CALL FC    45 (
           SFM                      := DB1941.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1945.DBX  171.7; 
      JCN   pfc; 
      L     DB1941.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1945.DBX  172.0; 
      JCN   ppc; 
      L     DB1941.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1945.DBX  171.6; 
      JCN   pxc; 
      L     DB1941.DBD  574; 
pxc:  NOP   0; 
      T     DB1945.DBD  182; 

//CIP Return
      L     DB1941.DBD  558; 
      T     DB1945.DBD  186; 
      L     DB1945.DBD  138; 
      T     DB1941.DBD  562; 

//CIP Prerun
      L     DB1941.DBD  542; 
      T     DB1945.DBD  190; 
      L     DB1945.DBD  142; 
      T     DB1941.DBD  546; 

// CIP Prerun Temperature
      L     DB1941.DBD  686; 
      T     DB1945.DBD  182; 

// Write Own Data to CIP
      L     DB1945.DBD   10; 
      T     DB1945.DBD  154; 

      L     DB1945.DBW   14; 
      T     DB1945.DBW  158; 

      L     DB1945.DBW   16; 
      T     DB1945.DBW  160; 

      L     DB1945.DBW   18; 
      T     DB1945.DBW  162; 

      L     DB1945.DBW   20; 
      T     DB1945.DBW  164; 

      L     DB1945.DBW   22; 
      T     DB1945.DBW  166; 

      A     DB1945.DBX   24.0; 
      =     DB1945.DBX  168.0; 

      A     DB1945.DBX   24.1; 
      =     DB1945.DBX  168.1; 

      A     DB1945.DBX   24.2; 
      =     DB1945.DBX  168.2; 

      A     DB1945.DBX   24.3; 
      =     DB1945.DBX  168.3; 

      A     DB1945.DBX   24.4; 
      =     DB1945.DBX  168.4; 

      A     DB1945.DBX   24.5; 
      =     DB1945.DBX  168.5; 

      A     DB1945.DBX   24.6; 
      =     DB1945.DBX  168.6; 

      A     DB1945.DBX   24.7; 
      =     DB1945.DBX  168.7; 

      L     DB1945.DBD  138; // CIP Amount
      T     DB1945.DBD   54; // CIP Amount

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1945.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP1);

      CLR   ; 
      =     DB1945.DBX  173.7; 

NCIP: NOP   0; 

//Empty Signal
//A     "U094SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1945.DBX   26.5; 

//Full Signal
//A     "U094SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1945.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1945.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1945.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1949
TITLE =U094: CIP 1 Distribution
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1940.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1941.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1941.DBX   17.3; 
      =     DB2940.DBX  105.3; 
      =     DB2940.DBX  265.3; 
      =     DB2940.DBX  345.3; 
      =     DB2940.DBX  425.3; 
      =     DB2940.DBX  505.3; 
      =     DB2940.DBX  585.3; 
      =     DB2940.DBX  665.3; 
      =     DB2940.DBX  745.3; 
      =     DB2940.DBX  825.3; 
      =     DB2940.DBX  905.3; 
      =     DB2940.DBX  985.3; 
      =     DB2940.DBX 1065.3; 
      =     DB2940.DBX 1145.3; 
      =     DB2940.DBX 1225.3; 
      =     DB2940.DBX 1305.3; 
      =     DB2940.DBX 1385.3; 
      =     DB2940.DBX 1465.3; 
      =     DB2940.DBX 1545.3; 


NETWORK
TITLE =Special Input

      A     DB1941.DBX   17.3; 
      =     DB2941.DBX   81.3; 
      =     DB2941.DBX  141.3; 
      =     DB2941.DBX  201.3; 
      =     DB2941.DBX  261.3; 
      =     DB2941.DBX  321.3; 
      =     DB2941.DBX  381.3; 

NETWORK
TITLE =Counter

      A     DB1941.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1941.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1941.DBX   17.3; 
//      =     "U094UnVD".unv001.Sim; 
//      =     "U094UnVD".unv002.Sim; 
//      =     "U094UnVD".RK1_KreisNr.Sim
//      =     "U094UnVD".RK1_Medium.Sim

NETWORK
TITLE =PID

      A     DB1941.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1941.DBX   17.3; 
//      =     "U094MsgD".msg001.Sim; 
//      =     "U094MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1941.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1955
TITLE =U095: CIP 2 Distribution
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1950.DBW    0; 
      T     #UnitNo; 

      L     DB1955.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1955.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1955.DBD   10; 
      L     DB1955.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1955.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1955.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1955.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1955.CIP,
           RET_VAL                  := #wRetVal);

// ... To CIP Unit ------------- /
      AN    DB1951.DBX   15.0; 
      A     DB1951.DBX 1233.6; // CIP Active (Slave)
      O     DB1951.DBX 1230.3; // production active
//    A     #ComCIP
      JCN   Slav; 
      CALL SFC   20 (
           SRCBLK                   := DB502.ToCIP2,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1955.ToCIP);
Slav: NOP   0; 

NETWORK
TITLE =remote start

      SET   ; 

//-----------------------------------
// Start Request
//-----------------------------------
      L     DB502.DBD  160; 
      L     0; 
      >D    ; 
      A     DB1951.DBX   15.0; 
      A     DB1951.DBX   17.4; 
      JCN   Strt; 
      L     DB502.DBD  160; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1951.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      L     0; 
      T     DB502.DBD  160; 


NETWORK
TITLE =external releases

      SET   ; 
      =     DB2950.DBX  266.7; 
      =     DB2950.DBX  346.7; 
      =     DB2950.DBX  506.7; 
      =     DB2950.DBX  586.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1951.DBX   15.0; 
      AN    DB1951.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1955.DBD  150; 
      T     DB1951.DBD  626; 

//Temperature CIP Return
      L     DB1955.DBD  146; 
      T     DB1951.DBD  594; 

//CIP Prerun Pump SP
      CALL FC    45 (
           SFM                      := DB1951.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1955.DBX  171.7; 
      JCN   pfc; 
      L     DB1951.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1955.DBX  172.0; 
      JCN   ppc; 
      L     DB1951.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1955.DBX  171.6; 
      JCN   pxc; 
      L     DB1951.DBD  574; 
pxc:  NOP   0; 
      T     DB1955.DBD  182; 

//CIP Return
      L     DB1951.DBD  558; 
      T     DB1955.DBD  186; 
      L     DB1955.DBD  138; 
      T     DB1951.DBD  562; 

//CIP Prerun
      L     DB1951.DBD  542; 
      T     DB1955.DBD  190; 
      L     DB1955.DBD  142; 
      T     DB1951.DBD  546; 

// CIP Prerun Temperature
      L     DB1951.DBD  686; 
      T     DB1955.DBD  182; 

// Write Own Data to CIP
      L     DB1955.DBD   10; 
      T     DB1955.DBD  154; 

      L     DB1955.DBW   14; 
      T     DB1955.DBW  158; 

      L     DB1955.DBW   16; 
      T     DB1955.DBW  160; 

      L     DB1955.DBW   18; 
      T     DB1955.DBW  162; 

      L     DB1955.DBW   20; 
      T     DB1955.DBW  164; 

      L     DB1955.DBW   22; 
      T     DB1955.DBW  166; 

      A     DB1955.DBX   24.0; 
      =     DB1955.DBX  168.0; 

      A     DB1955.DBX   24.1; 
      =     DB1955.DBX  168.1; 

      A     DB1955.DBX   24.2; 
      =     DB1955.DBX  168.2; 

      A     DB1955.DBX   24.3; 
      =     DB1955.DBX  168.3; 

      A     DB1955.DBX   24.4; 
      =     DB1955.DBX  168.4; 

      A     DB1955.DBX   24.5; 
      =     DB1955.DBX  168.5; 

      A     DB1955.DBX   24.6; 
      =     DB1955.DBX  168.6; 

      A     DB1955.DBX   24.7; 
      =     DB1955.DBX  168.7; 

      L     DB1955.DBD  138; // CIP Amount
      T     DB1955.DBD   54; // CIP Amount

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1955.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP2);

NCIP: NOP   0; 

//Empty Signal
//A     "U095SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1955.DBX   26.5; 

//Full Signal
//A     "U095SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1955.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1955.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1955.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1959
TITLE =U095: CIP 2 Distribution
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1950.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1951.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1951.DBX   17.3; 
      =     DB2950.DBX  265.3; 
      =     DB2950.DBX  345.3; 
      =     DB2950.DBX  505.3; 
      =     DB2950.DBX  585.3; 
NETWORK
TITLE =Special Input

      A     DB1951.DBX   17.3; 
      =     DB2951.DBX   81.3; 
      =     DB2951.DBX  141.3; 
      =     DB2951.DBX  201.3; 
      =     DB2951.DBX  261.3; 
NETWORK
TITLE =Counter

      A     DB1951.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1951.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1951.DBX   17.3; 
//      =     "U095UnVD".unv001.Sim; 
//      =     "U095UnVD".unv002.Sim; 
//      =     "U095UnVD".RK2_KreisNr.Sim; 
//      =     "U095UnVD".RK2_Medium.Sim; 

NETWORK
TITLE =PID

      A     DB1951.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1951.DBX   17.3; 
//      =     "U095MsgD".msg001.Sim; 
//      =     "U095MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1951.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1965
TITLE =U096: CIP 3 Distribution
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1960.DBW    0; 
      T     #UnitNo; 

      L     DB1965.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1965.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1965.DBD   10; 
      L     DB1965.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1965.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1965.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1965.GEN,
           RET_VAL                  := #wRetVal);


// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1965.CIP,
           RET_VAL                  := #wRetVal);

// ... To CIP Unit ------------- /
      A     DB1961.DBX 1233.6; // CIP Active (Slave)
      O     DB1961.DBX 1230.3; // production active
      AN    DB1961.DBX   15.0; 

// A     #ComCIP
      JCN   Slav; 
      CALL SFC   20 (
           SRCBLK                   := DB502.ToCIP3,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1965.ToCIP);
Slav: NOP   0; 
NETWORK
TITLE =remote start

      SET   ; 

//-----------------------------------
// Start Request
//-----------------------------------
      L     DB502.DBD  164; 
      L     0; 
      >D    ; 
      A     DB1961.DBX   15.0; 
      A     DB1961.DBX   17.4; 
      JCN   Strt; 
      L     DB502.DBD  164; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1961.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

      L     0; 
      T     DB502.DBD  164; 


NETWORK
TITLE =external releases

      SET   ; 
      =     DB2960.DBX  186.7; 
      =     DB2960.DBX  266.7; 
      =     DB2960.DBX  346.7; 
      =     DB2960.DBX  426.7; 
      =     DB2960.DBX  506.7; 
      =     DB2960.DBX  586.7; 
      =     DB2960.DBX  666.7; 
      =     DB2960.DBX  746.7; 
      =     DB2960.DBX  826.7; 
      =     DB2960.DBX  906.7; 
      =     DB2960.DBX  986.7; 
      =     DB2960.DBX 1066.7; 
      =     DB2960.DBX 1146.7; 
      =     DB2960.DBX 1226.7; 
      =     DB2960.DBX 1306.7; 
      =     DB2960.DBX 1546.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1961.DBX   15.0; 
      AN    DB1961.DBX 1233.6; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1965.DBD  150; 
      T     DB1961.DBD  626; 

//Temperature CIP Return
      L     DB1965.DBD  146; 
      T     DB1961.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1961.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1965.DBX  171.7; 
      JCN   pfc; 
      L     DB1961.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1965.DBX  172.0; 
      JCN   ppc; 
      L     DB1961.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1965.DBX  171.6; 
      JCN   pxc; 
      L     DB1961.DBD  574; 
pxc:  NOP   0; 
      T     DB1965.DBD  182; 

//CIP Return
      L     DB1961.DBD  558; 
      T     DB1965.DBD  186; 
      L     DB1965.DBD  138; 
      T     DB1961.DBD  562; 

//CIP Prerun
      L     DB1961.DBD  542; 
      T     DB1965.DBD  190; 
      L     DB1965.DBD  142; 
      T     DB1961.DBD  546; 

// CIP Prerun Temperature
      L     DB1961.DBD  686; 
      T     DB1965.DBD  182; 

// Write Own Data to CIP
      L     DB1965.DBD   10; 
      T     DB1965.DBD  154; 

      L     DB1965.DBW   14; 
      T     DB1965.DBW  158; 

      L     DB1965.DBW   16; 
      T     DB1965.DBW  160; 

      L     DB1965.DBW   18; 
      T     DB1965.DBW  162; 

      L     DB1965.DBW   20; 
      T     DB1965.DBW  164; 

      L     DB1965.DBW   22; 
      T     DB1965.DBW  166; 

      A     DB1965.DBX   24.0; 
      =     DB1965.DBX  168.0; 

      A     DB1965.DBX   24.1; 
      =     DB1965.DBX  168.1; 

      A     DB1965.DBX   24.2; 
      =     DB1965.DBX  168.2; 

      A     DB1965.DBX   24.3; 
      =     DB1965.DBX  168.3; 

      A     DB1965.DBX   24.4; 
      =     DB1965.DBX  168.4; 

      A     DB1965.DBX   24.5; 
      =     DB1965.DBX  168.5; 

      A     DB1965.DBX   24.6; 
      =     DB1965.DBX  168.6; 

      A     DB1965.DBX   24.7; 
      =     DB1965.DBX  168.7; 

      L     DB1965.DBD  138; // CIP Amount
      T     DB1965.DBD   54; // CIP Amount

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1965.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP3);

NCIP: NOP   0; 

//Empty Signal
//A     "U096SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1965.DBX   26.5; 

//Full Signal
//A     "U096SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1965.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1965.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1965.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1969
TITLE =U096: CIP 3 Distribution
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1960.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1961.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1961.DBX   17.3; 
      =     DB2960.DBX  185.3; 
      =     DB2960.DBX  265.3; 
      =     DB2960.DBX  345.3; 
      =     DB2960.DBX  425.3; 
      =     DB2960.DBX  505.3; 
      =     DB2960.DBX  585.3; 
      =     DB2960.DBX  665.3; 
      =     DB2960.DBX  745.3; 
      =     DB2960.DBX  825.3; 
      =     DB2960.DBX  905.3; 
      =     DB2960.DBX  985.3; 
      =     DB2960.DBX 1065.3; 
      =     DB2960.DBX 1145.3; 
      =     DB2960.DBX 1225.3; 
      =     DB2960.DBX 1305.3; 
      =     DB2960.DBX 1545.3; 
NETWORK
TITLE =Special Input

      A     DB1961.DBX   17.3; 
      =     DB2961.DBX   81.3; 
      =     DB2961.DBX  141.3; 
      =     DB2961.DBX  201.3; 
      =     DB2961.DBX  261.3; 
      =     DB2961.DBX  321.3; 
      =     DB2961.DBX  381.3; 

NETWORK
TITLE =Counter

      A     DB1961.DBX   17.3; 
      A     M    101.0; 
      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1961.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB1961.DBX   17.3; 
//      =     "U096UnVD".unv001.Sim; 
//      =     "U096UnVD".unv002.Sim; 
//      =     "U096UnVD".RK3_KreisNr.Sim; 
//      =     "U096UnVD".RK3_Medium.Sim; 

NETWORK
TITLE =PID

      A     DB1961.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1961.DBX   17.3; 
//      =     "U096MsgD".msg001.Sim; 
//      =     "U096MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1961.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1985
TITLE =U098: General Syrup Room
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1980.DBW    0; 
      T     #UnitNo; 

      L     DB1985.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1985.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1985.DBD   10; 
      L     DB1985.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1985.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB1985.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1985.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1981.DBX   15.0; 
      A     DB1981.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1985.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1981.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2980.DBX  106.7; 
      =     DB2980.DBX  186.7; 
      =     DB2980.DBX  266.7; 
      =     DB2980.DBX  346.7; 
      =     DB2980.DBX  426.7; 
      =     DB2980.DBX  506.7; 
      =     DB2980.DBX  586.7; 
      =     DB2980.DBX  666.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1981.DBX   15.0; 
//      AN "U098SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1985.DBD  150; 
      T     DB1981.DBD  626; 

//Temperature CIP Return
      L     DB1985.DBD  146; 
      T     DB1981.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1981.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1985.DBX  171.7; 
      JCN   pfc; 
      L     DB1981.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1985.DBX  172.0; 
      JCN   ppc; 
      L     DB1981.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1985.DBX  171.6; 
      JCN   pxc; 
      L     DB1981.DBD  574; 
pxc:  NOP   0; 
      T     DB1985.DBD  182; 

//CIP Return
      L     DB1981.DBD  558; 
      T     DB1985.DBD  186; 
      L     DB1985.DBD  138; 
      T     DB1981.DBD  562; 

//CIP Prerun
      L     DB1981.DBD  542; 
      T     DB1985.DBD  190; 
      L     DB1985.DBD  142; 
      T     DB1981.DBD  546; 

// Write Own Data to CIP
      L     DB1985.DBD   10; 
      T     DB1985.DBD  154; 

      L     DB1985.DBW   14; 
      T     DB1985.DBW  158; 

      L     DB1985.DBW   16; 
      T     DB1985.DBW  160; 

      L     DB1985.DBW   18; 
      T     DB1985.DBW  162; 

      L     DB1985.DBW   20; 
      T     DB1985.DBW  164; 

      L     DB1985.DBW   22; 
      T     DB1985.DBW  166; 

      A     DB1985.DBX   24.0; 
      =     DB1985.DBX  168.0; 

      A     DB1985.DBX   24.1; 
      =     DB1985.DBX  168.1; 

      A     DB1985.DBX   24.2; 
      =     DB1985.DBX  168.2; 

      A     DB1985.DBX   24.3; 
      =     DB1985.DBX  168.3; 

      A     DB1985.DBX   24.4; 
      =     DB1985.DBX  168.4; 

      A     DB1985.DBX   24.5; 
      =     DB1985.DBX  168.5; 

      A     DB1985.DBX   24.6; 
      =     DB1985.DBX  168.6; 

      A     DB1985.DBX   24.7; 
      =     DB1985.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1985.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1985.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U098SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1985.DBX   26.5; 

//Full Signal
//A     "U098SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1985.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1985.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB1985.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1989
TITLE =U098: General Syrup Room
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1980.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1981.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1981.DBX   17.3; 
      =     DB2980.DBX  105.3; 
      =     DB2980.DBX  185.3; 
      =     DB2980.DBX  265.3; 
      =     DB2980.DBX  345.3; 
      =     DB2980.DBX  425.3; 
      =     DB2980.DBX  505.3; 
      =     DB2980.DBX  585.3; 
      =     DB2980.DBX  665.3; 

NETWORK
TITLE =Special Input

      A     DB1981.DBX   17.3; 
      =     DB2981.DBX   81.3; 
      =     DB2981.DBX  141.3; 
      =     DB2981.DBX  201.3; 
      =     DB2981.DBX  261.3; 
      =     DB2981.DBX  321.3; 
      =     DB2981.DBX  381.3; 
      =     DB2981.DBX  441.3; 
      =     DB2981.DBX  501.3; 

NETWORK
TITLE =Counter

      A     DB1981.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1981.DBX   17.3; 
      =     DB2983.DBX  141.3; 
      =     DB2983.DBX  261.3; 
      =     DB2983.DBX  381.3; 
      =     DB2983.DBX  501.3; 

NETWORK
TITLE =Universal Value

      A     DB1981.DBX   17.3; 
//      =     "U098UnVD".unv001.Sim; 
//      =     "U098UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1981.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1981.DBX   17.3; 
//      =     "U098MsgD".msg001.Sim; 
//      =     "U098MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1981.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1995
TITLE =U099: PLC 3 General
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  SEND_DONE : BOOL ;	
  SEND_ERROR : BOOL ;	
  SEND_STATUS : WORD ;	
  RECV_NDR : BOOL ;	
  RECV_ERROR : BOOL ;	
  RECV_STATUS : WORD ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB1990.DBW    0; 
      T     #UnitNo; 

      L     DB1995.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB1995.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB1995.DBD   10; 
      L     DB1995.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB1995.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

      L     MW  2900; 
      SLW   1; 
      T     MW  2900; 
      L     0; 
      ==D   ; 
      S     M   2901.0; 


// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := TRUE,
           PLCNo                    := DB1995.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.GEN,
           RET_VAL                  := #wRetVal);

// ... MTE1 from PLC01 ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 14,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.MTE1,
           RET_VAL                  := #wRetVal);

// ... MTE2 from PLC01 ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 19,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.MTE2,
           RET_VAL                  := #wRetVal);

// ... MTE3 from PLC01 ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 24,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.MTE3,
           RET_VAL                  := #wRetVal);

// ... MTE4 from PLC01 ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 29,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.MTE4,
           RET_VAL                  := #wRetVal);

// ... KZESR from PLC01 ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 7,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U007,
           RET_VAL                  := #wRetVal);

// ... Wasser SR from PLC01 ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 9,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U009,
           RET_VAL                  := #wRetVal);



//----------------------------------------
// Communication Remote Wells
//----------------------------------------

// ...Well Transfer A from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 25,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U025,
           RET_VAL                  := #wRetVal);

// ...Well Transfer B from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 26,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U026,
           RET_VAL                  := #wRetVal);

// ...Well Transfer CF from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 27,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U027,
           RET_VAL                  := #wRetVal);

// ...Well Transfer C from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 28,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U028,
           RET_VAL                  := #wRetVal);

// ...Well Transfer B6F from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 29,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U029,
           RET_VAL                  := #wRetVal);

// ...Well Transfer H6 from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 30,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U030,
           RET_VAL                  := #wRetVal);

// ...Well Transfer J6 from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 31,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U031,
           RET_VAL                  := #wRetVal);

// ...Well Transfer L6F from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 32,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U032,
           RET_VAL                  := #wRetVal);

// ...Well Transfer B6 from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 33,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U033,
           RET_VAL                  := #wRetVal);

// ...Well Transfer D6 from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 34,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U034,
           RET_VAL                  := #wRetVal);

//----------------------------------------
// Communication Local Wells
//----------------------------------------
// ...Local Well 2A from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 1,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U001,
           RET_VAL                  := #wRetVal);

// ...Local Well 2B from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 2,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U002,
           RET_VAL                  := #wRetVal);


// ...Local Well 3 from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 3,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U003,
           RET_VAL                  := #wRetVal);

// ...Local Well 7 from PLC04 --- /
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceUnitNo             := 4,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P04U004,
           RET_VAL                  := #wRetVal);


//----------------------------------------
// Communication P01 Anlage
//----------------------------------------
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 153,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U153,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 155,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U155,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 157,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U157,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 159,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U159,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 162,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U162,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceUnitNo             := 164,
           IsTUnit                  := FALSE,
           DstComDRec               := DB1995.P01U164,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB1991.DBX   15.0; 
      A     DB1991.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB1995.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB1991.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 
      =     DB2990.DBX  106.7; 
      =     DB2990.DBX  186.7; 
      =     DB2990.DBX  266.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB1991.DBX   15.0; 
//      AN "U099SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB1995.DBD  150; 
      T     DB1991.DBD  626; 

//Temperature CIP Return
      L     DB1995.DBD  146; 
      T     DB1991.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB1991.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB1995.DBX  171.7; 
      JCN   pfc; 
      L     DB1991.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB1995.DBX  172.0; 
      JCN   ppc; 
      L     DB1991.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB1995.DBX  171.6; 
      JCN   pxc; 
      L     DB1991.DBD  574; 
pxc:  NOP   0; 
      T     DB1995.DBD  182; 

//CIP Return
      L     DB1991.DBD  558; 
      T     DB1995.DBD  186; 
      L     DB1995.DBD  138; 
      T     DB1991.DBD  562; 

//CIP Prerun
      L     DB1991.DBD  542; 
      T     DB1995.DBD  190; 
      L     DB1995.DBD  142; 
      T     DB1991.DBD  546; 

// Write Own Data to CIP
      L     DB1995.DBD   10; 
      T     DB1995.DBD  154; 

      L     DB1995.DBW   14; 
      T     DB1995.DBW  158; 

      L     DB1995.DBW   16; 
      T     DB1995.DBW  160; 

      L     DB1995.DBW   18; 
      T     DB1995.DBW  162; 

      L     DB1995.DBW   20; 
      T     DB1995.DBW  164; 

      L     DB1995.DBW   22; 
      T     DB1995.DBW  166; 

      A     DB1995.DBX   24.0; 
      =     DB1995.DBX  168.0; 

      A     DB1995.DBX   24.1; 
      =     DB1995.DBX  168.1; 

      A     DB1995.DBX   24.2; 
      =     DB1995.DBX  168.2; 

      A     DB1995.DBX   24.3; 
      =     DB1995.DBX  168.3; 

      A     DB1995.DBX   24.4; 
      =     DB1995.DBX  168.4; 

      A     DB1995.DBX   24.5; 
      =     DB1995.DBX  168.5; 

      A     DB1995.DBX   24.6; 
      =     DB1995.DBX  168.6; 

      A     DB1995.DBX   24.7; 
      =     DB1995.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB1995.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB1995.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U099SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB1995.DBX   26.5; 

//Full Signal
//A     "U099SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB1995.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB1995.DBX   27.1; 

// Emergency Stop
      SET   ; 
      =     DB1995.DBX   27.0; //Emergency Stop OK


// Sing bend connections

      A     DB2991.DBX  438.7; 
      =     DB1995.DBX   27.2; 

      A     DB2991.DBX  498.7; 
      =     DB1995.DBX   27.3; 


NETWORK
TITLE = read from other unit data






END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1999
TITLE =U099: PLC 3 General
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB1990.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1991.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB1991.DBX   17.3; 
      =     DB2990.DBX  105.3; 
      =     DB2990.DBX  185.3; 
      =     DB2990.DBX  265.3; 

NETWORK
TITLE =Special Input

      A     DB1991.DBX   17.3; 
      =     DB2991.DBX   81.3; 
      =     DB2991.DBX  141.3; 
      =     DB2991.DBX  201.3; 
      =     DB2991.DBX  261.3; 
      =     DB2991.DBX  321.3; 
      =     DB2991.DBX  381.3; 
      =     DB2991.DBX  441.3; 
      =     DB2991.DBX  501.3; 

NETWORK
TITLE =Counter

      A     DB1991.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB1991.DBX   17.3; 
      =     DB2993.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB1991.DBX   17.3; 
//      =     "U099UnVD".unv001.Sim; 
//      =     "U099UnVD".unv002.Sim; 

NETWORK
TITLE =PID

      A     DB1991.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB1991.DBX   17.3; 
//      =     "U099MsgD".msg001.Sim; 
//      =     "U099MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     DB1991.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4035
TITLE =U103: Transfer Plant 3
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4030.DBW    0; 
      T     #UnitNo; 

      L     DB4035.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4035.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4035.DBD   10; 
      L     DB4035.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4035.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4031.DBX   66.2; 
      A     DB4031.DBX   15.0; 
      A     DB4031.DBX   17.4; 
      JCN   Strt; 
      L     DB4035.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4031.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

// Start von Sirupraum (VP3)
      AN    DB1995.DBX 1176.7; 
      A     DB1995.DBX 1176.0; 
      A     DB4031.DBX   15.0; 
      A     DB4031.DBX   17.4; 
      JCN   Str2; 
      L     DB1995.DBD 1162; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4031.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4039
TITLE =U103: Transfer Plant 3
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4030.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4031.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4031.DBX   17.3; 
      =     DB5030.DBX  425.3; 
      =     DB5030.DBX  505.3; 
      =     DB5030.DBX  585.3; 
      =     DB5030.DBX  665.3; 
      =     DB5030.DBX  745.3; 
      =     DB5030.DBX  825.3; 
      =     DB5030.DBX  905.3; 
      =     DB5030.DBX  985.3; 
      =     DB5030.DBX 1065.3; 
      =     DB5030.DBX 1145.3; 
      =     DB5030.DBX 1225.3; 
      =     DB5030.DBX 1305.3; 
      =     DB5030.DBX 2665.3; 
      =     DB5030.DBX 2745.3; 
      =     DB5030.DBX 2825.3; 
      =     DB5030.DBX 2905.3; 
      =     DB5030.DBX 3065.3; 
      =     DB5030.DBX 3145.3; 
      =     DB5030.DBX 3225.3; 
      =     DB5030.DBX 3305.3; 

NETWORK
TITLE =Special Input

      A     DB4031.DBX   17.3; 
      =     DB5031.DBX  681.3; 
      =     DB5031.DBX  741.3; 
      =     DB5031.DBX 1041.3; 
      =     DB5031.DBX 1101.3; 
      =     DB5031.DBX 1221.3; 
      =     DB5031.DBX 1281.3; 
      =     DB5031.DBX 1341.3; 
      =     DB5031.DBX 1761.3; 
      =     DB5031.DBX 1881.3; 
      =     DB5031.DBX 1941.3; 


NETWORK
TITLE =Counter

      A     DB4031.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4031.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4031.DBX   17.3; 
//      =     "U103UnVD".unv001.Sim; 
//      =     "U103UnVD".unv002.Sim; 
//      =     "U103UnVD".unv003.Sim; 
//      =     "U103UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4031.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4031.DBX   17.3; 
//      =     "U103MsgD".msg001.Sim; 
//      =     "U103MsgD".msg002.Sim; 
//      =     "U103MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4031.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4055
TITLE =U105: Transfer Plant 5
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4050.DBW    0; 
      T     #UnitNo; 

      L     DB4055.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4055.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4055.DBD   10; 
      L     DB4055.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4055.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4051.DBX   66.2; 
      A     DB4051.DBX   15.0; 
      A     DB4051.DBX   17.4; 
      JCN   Strt; 
      L     DB4055.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4051.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

// Start von Sirupraum (VP3)
      AN    DB1995.DBX 1224.7; 
      A     DB1995.DBX 1224.0; 
      A     DB4051.DBX   15.0; 
      A     DB4051.DBX   17.4; 
      JCN   Str2; 
      L     DB1995.DBD 1210; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4051.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4059
TITLE =U105: Transfer Plant 5
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4050.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4051.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4051.DBX   17.3; 
      =     DB5050.DBX  105.3; 
      =     DB5050.DBX  185.3; 
      =     DB5050.DBX  265.3; 
      =     DB5050.DBX  345.3; 
      =     DB5050.DBX  425.3; 
      =     DB5050.DBX  505.3; 
      =     DB5050.DBX  585.3; 
      =     DB5050.DBX  665.3; 
      =     DB5050.DBX  745.3; 
      =     DB5050.DBX  825.3; 
      =     DB5050.DBX  905.3; 
      =     DB5050.DBX  985.3; 
      =     DB5050.DBX 1065.3; 
      =     DB5050.DBX 1145.3; 
      =     DB5050.DBX 1225.3; 
      =     DB5050.DBX 1305.3; 
      =     DB5050.DBX 1385.3; 
      =     DB5050.DBX 1465.3; 
      =     DB5050.DBX 1545.3; 
      =     DB5050.DBX 1625.3; 
      =     DB5050.DBX 1705.3; 
      =     DB5050.DBX 1785.3; 
      =     DB5050.DBX 1865.3; 
      =     DB5050.DBX 2345.3; 
      =     DB5050.DBX 3065.3; 
      =     DB5050.DBX 3145.3; 
      =     DB5050.DBX 3225.3; 
      =     DB5050.DBX 3305.3; 

NETWORK
TITLE =Special Input

      A     DB4051.DBX   17.3; 
      =     DB5051.DBX   81.3; 
      =     DB5051.DBX  141.3; 
      =     DB5051.DBX  201.3; 
      =     DB5051.DBX  261.3; 
      =     DB5051.DBX  321.3; 
      =     DB5051.DBX  381.3; 
      =     DB5051.DBX  441.3; 
      =     DB5051.DBX  501.3; 
      =     DB5051.DBX  561.3; 
      =     DB5051.DBX  621.3; 
      =     DB5051.DBX  681.3; 
      =     DB5051.DBX  741.3; 
      =     DB5051.DBX  801.3; 
      =     DB5051.DBX 1041.3; 
      =     DB5051.DBX 1101.3; 
      =     DB5051.DBX 1161.3; 
      =     DB5051.DBX 1221.3; 
      =     DB5051.DBX 1281.3; 
      =     DB5051.DBX 1341.3; 
      =     DB5051.DBX 1461.3; 
      =     DB5051.DBX 1521.3; 
      =     DB5051.DBX 1581.3; 
      =     DB5051.DBX 1641.3; 
      =     DB5051.DBX 1701.3; 
      =     DB5051.DBX 1761.3; 
      =     DB5051.DBX 1821.3; 
      =     DB5051.DBX 1881.3; 
      =     DB5051.DBX 1941.3; 
      =     DB5051.DBX 2001.3; 
      =     DB5051.DBX 2061.3; 


NETWORK
TITLE =Counter

      A     DB4051.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4051.DBX   17.3; 
      =     DB5053.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     DB4051.DBX   17.3; 
//      =     "U105UnVD".unv001.Sim; 
//      =     "U105UnVD".unv002.Sim; 
//      =     "U105UnVD".unv003.Sim; 
//      =     "U105UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4051.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4051.DBX   17.3; 
//      =     "U105MsgD".msg001.Sim; 
//      =     "U105MsgD".msg002.Sim; 
//      =     "U105MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4051.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4075
TITLE =U107: Transfer Plant 7
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4070.DBW    0; 
      T     #UnitNo; 

      L     DB4075.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4075.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4075.DBD   10; 
      L     DB4075.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4075.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4071.DBX   66.2; 
      A     DB4071.DBX   15.0; 
      A     DB4071.DBX   17.4; 
      JCN   Strt; 
      L     DB4075.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4071.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

// Start von Sirupraum (VP3)
      AN    DB1995.DBX 1272.7; 
      A     DB1995.DBX 1272.0; 
      A     DB4071.DBX   15.0; 
      A     DB4071.DBX   17.4; 
      JCN   Str2; 
      L     DB1995.DBD 1258; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4071.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4079
TITLE =U107: Transfer Plant 7
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4070.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4071.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4071.DBX   17.3; 
      =     DB5070.DBX  425.3; 
      =     DB5070.DBX  505.3; 
      =     DB5070.DBX  585.3; 
      =     DB5070.DBX  665.3; 
      =     DB5070.DBX  745.3; 
      =     DB5070.DBX  825.3; 
      =     DB5070.DBX  905.3; 
      =     DB5070.DBX  985.3; 
      =     DB5070.DBX 1065.3; 
      =     DB5070.DBX 1145.3; 
      =     DB5070.DBX 1225.3; 
      =     DB5070.DBX 1305.3; 
      =     DB5070.DBX 1385.3; 
      =     DB5070.DBX 1465.3; 
      =     DB5070.DBX 1945.3; 
      =     DB5070.DBX 2025.3; 
      =     DB5070.DBX 2105.3; 
      =     DB5070.DBX 2185.3; 
      =     DB5070.DBX 2265.3; 
      =     DB5070.DBX 2345.3; 
      =     DB5070.DBX 2425.3; 
      =     DB5070.DBX 2505.3; 
      =     DB5070.DBX 2585.3; 
      =     DB5070.DBX 2665.3; 
      =     DB5070.DBX 2745.3; 
      =     DB5070.DBX 2825.3; 
      =     DB5070.DBX 2905.3; 
      =     DB5070.DBX 2985.3; 
      =     DB5070.DBX 3065.3; 
      =     DB5070.DBX 3145.3; 
      =     DB5070.DBX 3225.3; 
      =     DB5070.DBX 3305.3; 

NETWORK
TITLE =Special Input

      A     DB4071.DBX   17.3; 
      =     DB5071.DBX  681.3; 
      =     DB5071.DBX  741.3; 
      =     DB5071.DBX 1041.3; 
      =     DB5071.DBX 1101.3; 
      =     DB5071.DBX 1161.3; 
      =     DB5071.DBX 1221.3; 
      =     DB5071.DBX 1281.3; 
      =     DB5071.DBX 1341.3; 
      =     DB5071.DBX 1461.3; 
      =     DB5071.DBX 1521.3; 
      =     DB5071.DBX 1581.3; 
      =     DB5071.DBX 1761.3; 
      =     DB5071.DBX 1821.3; 
      =     DB5071.DBX 1881.3; 
      =     DB5071.DBX 1941.3; 
      =     DB5071.DBX 2001.3; 
      =     DB5071.DBX 2061.3; 

NETWORK
TITLE =Counter

      A     DB4071.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4071.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4071.DBX   17.3; 
//      =     "U107UnVD".unv001.Sim; 
//      =     "U107UnVD".unv002.Sim; 
//      =     "U107UnVD".unv003.Sim; 
//      =     "U107UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4071.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4071.DBX   17.3; 
//      =     "U107MsgD".msg001.Sim; 
//      =     "U107MsgD".msg002.Sim; 
//      =     "U107MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4071.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4085
TITLE =U108: Transfer Plant 8
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4080.DBW    0; 
      T     #UnitNo; 

      L     DB4085.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4085.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4085.DBD   10; 
      L     DB4085.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4085.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB4085.DBW   14,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4085.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4081.DBX   66.2; 
//      O     DB5081.DBX 1098.7
      A     DB4081.DBX   15.0; 
      A     DB4081.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4081.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4081.DBX   15.0; 
//      AN "U108SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4085.DBD  150; 
      T     DB4081.DBD  626; 

//Temperature CIP Return
      L     DB4085.DBD  146; 
      T     DB4081.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4081.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4085.DBX  171.7; 
      JCN   pfc; 
      L     DB4081.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4085.DBX  172.0; 
      JCN   ppc; 
      L     DB4081.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4085.DBX  171.6; 
      JCN   pxc; 
      L     DB4081.DBD  574; 
pxc:  NOP   0; 
      T     DB4085.DBD  182; 

//CIP Return
      L     DB4081.DBD  558; 
      T     DB4085.DBD  186; 
      L     DB4085.DBD  138; 
      T     DB4081.DBD  562; 

//CIP Prerun
      L     DB4081.DBD  542; 
      T     DB4085.DBD  190; 
      L     DB4085.DBD  142; 
      T     DB4081.DBD  546; 

// Write Own Data to CIP
      L     DB4085.DBD   10; 
      T     DB4085.DBD  154; 

      L     DB4085.DBW   14; 
      T     DB4085.DBW  158; 

      L     DB4085.DBW   16; 
      T     DB4085.DBW  160; 

      L     DB4085.DBW   18; 
      T     DB4085.DBW  162; 

      L     DB4085.DBW   20; 
      T     DB4085.DBW  164; 

      L     DB4085.DBW   22; 
      T     DB4085.DBW  166; 

      A     DB4085.DBX   24.0; 
      =     DB4085.DBX  168.0; 

      A     DB4085.DBX   24.1; 
      =     DB4085.DBX  168.1; 

      A     DB4085.DBX   24.2; 
      =     DB4085.DBX  168.2; 

      A     DB4085.DBX   24.3; 
      =     DB4085.DBX  168.3; 

      A     DB4085.DBX   24.4; 
      =     DB4085.DBX  168.4; 

      A     DB4085.DBX   24.5; 
      =     DB4085.DBX  168.5; 

      A     DB4085.DBX   24.6; 
      =     DB4085.DBX  168.6; 

      A     DB4085.DBX   24.7; 
      =     DB4085.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4085.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4085.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U108SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4085.DBX   26.5; 

//Full Signal
//A     "U108SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4085.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4085.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4085.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4089
TITLE =U108: Transfer Plant 8
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4080.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4081.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4081.DBX   17.3; 

NETWORK
TITLE =Special Input

      A     DB4081.DBX   17.3; 

NETWORK
TITLE =Counter

      A     DB4081.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4081.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4081.DBX   17.3; 
//      =     "U108UnVD".unv001.Sim; 
//      =     "U108UnVD".unv002.Sim; 
//      =     "U108UnVD".unv003.Sim; 
//      =     "U108UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4081.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4081.DBX   17.3; 
//      =     "U108MsgD".msg001.Sim; 
//      =     "U108MsgD".msg002.Sim; 
//      =     "U108MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4081.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4095
TITLE =U109: Transfer Plant 9
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4090.DBW    0; 
      T     #UnitNo; 

      L     DB4095.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4095.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4095.DBD   10; 
      L     DB4095.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4095.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4091.DBX   66.2; 
      A     DB4091.DBX   15.0; 
      A     DB4091.DBX   17.4; 
      JCN   Strt; 
      L     DB4095.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4091.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

// Start von Sirupraum (VP3)
      AN    DB1995.DBX 1320.7; 
      A     DB1995.DBX 1320.0; 
      A     DB4091.DBX   15.0; 
      A     DB4091.DBX   17.4; 
      JCN   Str2; 
      L     DB1995.DBD 1306; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4091.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4099
TITLE =U109: Transfer Plant 9
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4090.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4091.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4091.DBX   17.3; 
      =     DB5090.DBX  425.3; 
      =     DB5090.DBX  505.3; 
      =     DB5090.DBX  585.3; 
      =     DB5090.DBX  665.3; 
      =     DB5090.DBX  745.3; 
      =     DB5090.DBX  825.3; 
      =     DB5090.DBX  905.3; 
      =     DB5090.DBX  985.3; 
      =     DB5090.DBX 1065.3; 
      =     DB5090.DBX 1145.3; 
      =     DB5090.DBX 1225.3; 
      =     DB5090.DBX 1305.3; 
      =     DB5090.DBX 1385.3; 
      =     DB5090.DBX 3065.3; 
      =     DB5090.DBX 3145.3; 
      =     DB5090.DBX 3225.3; 
      =     DB5090.DBX 3305.3; 


NETWORK
TITLE =Special Input

      A     DB4091.DBX   17.3; 
      =     DB5091.DBX   81.3; 
      =     DB5091.DBX  681.3; 
      =     DB5091.DBX  741.3; 
      =     DB5091.DBX 1041.3; 
      =     DB5091.DBX 1101.3; 
      =     DB5091.DBX 1161.3; 
      =     DB5091.DBX 1221.3; 
      =     DB5091.DBX 1281.3; 
      =     DB5091.DBX 1341.3; 
      =     DB5091.DBX 1461.3; 
      =     DB5091.DBX 1521.3; 
      =     DB5091.DBX 1581.3; 
      =     DB5091.DBX 1641.3; 
      =     DB5091.DBX 1701.3; 
      =     DB5091.DBX 1761.3; 
      =     DB5091.DBX 2001.3; 
      =     DB5091.DBX 2061.3; 

NETWORK
TITLE =Counter

      A     DB4091.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4091.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4091.DBX   17.3; 
//      =     "U109UnVD".unv001.Sim; 
//      =     "U109UnVD".unv002.Sim; 
//      =     "U109UnVD".unv003.Sim; 
//      =     "U109UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4091.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4091.DBX   17.3; 
//      =     "U109MsgD".msg001.Sim; 
//      =     "U109MsgD".msg002.Sim; 
//      =     "U109MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4091.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4115
TITLE =U111: Transfer Plant 11
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4110.DBW    0; 
      T     #UnitNo; 

      L     DB4115.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4115.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4115.DBD   10; 
      L     DB4115.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4115.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4111.DBX   66.2; 
      O     DB5111.DBX 1098.7; 
      A     DB4111.DBX   15.0; 
      A     DB4111.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4115.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4111.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4119
TITLE =U111: Transfer Plant 11
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4110.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4111.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4111.DBX   17.3; 
      =     DB5110.DBX 1465.3; 
      =     DB5110.DBX 1545.3; 
      =     DB5110.DBX 1945.3; 
      =     DB5110.DBX 2025.3; 
      =     DB5110.DBX 2105.3; 
      =     DB5110.DBX 2185.3; 
      =     DB5110.DBX 2265.3; 
      =     DB5110.DBX 2345.3; 
      =     DB5110.DBX 2425.3; 
      =     DB5110.DBX 2505.3; 
      =     DB5110.DBX 2585.3; 
      =     DB5110.DBX 2665.3; 
      =     DB5110.DBX 2745.3; 
      =     DB5110.DBX 2825.3; 
      =     DB5110.DBX 2905.3; 
      =     DB5110.DBX 2985.3; 


NETWORK
TITLE =Special Input

      A     DB4111.DBX   17.3; 
      =     DB5111.DBX  561.3; 

NETWORK
TITLE =Counter

      A     DB4111.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4111.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4111.DBX   17.3; 
//      =     "U111UnVD".unv001.Sim; 
//      =     "U111UnVD".unv002.Sim; 
//      =     "U111UnVD".unv003.Sim; 
//      =     "U111UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4111.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4111.DBX   17.3; 
//      =     "U111MsgD".msg001.Sim; 
//      =     "U111MsgD".msg002.Sim; 
//      =     "U111MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4111.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4125
TITLE =U112: Transfer Plant 12
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4120.DBW    0; 
      T     #UnitNo; 

      L     DB4125.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4125.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4125.DBD   10; 
      L     DB4125.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4125.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4121.DBX   66.2; 
      A     DB4121.DBX   15.0; 
      A     DB4121.DBX   17.4; 
      JCN   Strt; 
      L     DB4125.DBD   10; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4121.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

// Start von Sirupraum (VP3)
      AN    DB1995.DBX 1368.7; 
      A     DB1995.DBX 1368.0; 
      A     DB4121.DBX   15.0; 
      A     DB4121.DBX   17.4; 
      JCN   Str2; 
      L     DB1995.DBD 1354; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4121.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 

NETWORK
TITLE =



// Signale Panel an Mixer  
      A     I    262.0; 
      =     Q    271.2; 
      A     I    262.1; 
      =     Q    271.4; 
      A     I    262.2; 
      =     Q    271.5; 


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4129
TITLE =U112: Transfer Plant 12
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4120.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4121.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4121.DBX   17.3; 
      =     DB5120.DBX  425.3; 
      =     DB5120.DBX  505.3; 
      =     DB5120.DBX  585.3; 
      =     DB5120.DBX  665.3; 
      =     DB5120.DBX  745.3; 
      =     DB5120.DBX  825.3; 
      =     DB5120.DBX  905.3; 
      =     DB5120.DBX  985.3; 
      =     DB5120.DBX 1065.3; 
      =     DB5120.DBX 1145.3; 
      =     DB5120.DBX 1225.3; 
      =     DB5120.DBX 1305.3; 
      =     DB5120.DBX 1385.3; 
      =     DB5120.DBX 1465.3; 
//      =     "U112ActD".A12_MOLCH_A12_L.Sim; 
      =     DB5120.DBX 3145.3; 
      =     DB5120.DBX 3225.3; 
      =     DB5120.DBX 3305.3; 

NETWORK
TITLE =Special Input

      A     DB4121.DBX   17.3; 
      =     DB5121.DBX  441.3; 
      =     DB5121.DBX  681.3; 
      =     DB5121.DBX  741.3; 
      =     DB5121.DBX 1041.3; 
      =     DB5121.DBX 1101.3; 
      =     DB5121.DBX 1161.3; 
      =     DB5121.DBX 1221.3; 
      =     DB5121.DBX 1281.3; 
      =     DB5121.DBX 1341.3; 
      =     DB5121.DBX 1461.3; 
      =     DB5121.DBX 1521.3; 
      =     DB5121.DBX 1581.3; 
      =     DB5121.DBX 1641.3; 
      =     DB5121.DBX 1701.3; 
      =     DB5121.DBX 1761.3; 
      =     DB5121.DBX 1821.3; 
      =     DB5121.DBX 1881.3; 
      =     DB5121.DBX 1941.3; 


NETWORK
TITLE =Counter

      A     DB4121.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4121.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4121.DBX   17.3; 
//      =     "U112UnVD".unv001.Sim; 
//      =     "U112UnVD".unv002.Sim; 
//      =     "U112UnVD".unv003.Sim; 
//      =     "U112UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4121.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4121.DBX   17.3; 
//      =     "U112MsgD".msg001.Sim; 
//      =     "U112MsgD".msg002.Sim; 
//      =     "U112MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4121.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4145
TITLE =U114: Transfer Plant 14
FAMILY : BOTEC_F1
NAME : Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4140.DBW    0; 
      T     #UnitNo; 

      L     DB4145.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4145.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4145.DBD   10; 
      L     DB4145.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4145.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =remote start

      SET   ; 
      A     DB4141.DBX   66.2; 
      A     DB4141.DBX   15.0; 
      A     DB4141.DBX   17.4; 
      JCN   Strt; 
      L     L#-1; // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4141.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 

// Start von Sirupraum (VP3)
      AN    DB1995.DBX 1416.7; 
      A     DB1995.DBX 1416.0; 
      A     DB4141.DBX   15.0; 
      A     DB4141.DBX   17.4; 
      JCN   Str2; 
      L     DB1995.DBD 1402; 
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4141.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Str2: NOP   0; 

NETWORK
TITLE =Signale


// Schwenkbogen auf CIP
      A     DB5141.DBX 1338.7; 
      O     DB5141.DBX 1518.7; 
      S     DB5140.DBX 3948.2; 

// Molch im Sirupraum
      A     DB5140.DBX  903.4; 
      S     DB5140.DBX 3788.2; 

// Molch an der Anlage
      A     DB5140.DBX 1703.4; 
      S     DB5140.DBX 3708.2; 

// Bereit fr Produktion
      A     DB5141.DBX 1398.7; 
      AN    DB5141.DBX 1278.7; 
      A     DB5140.DBX 3708.2; 
      S     DB5140.DBX 3868.2; 

// Bereit fr CIP
      A     DB5141.DBX 1338.7; 
      O     DB5141.DBX 1518.7; 
      AN    DB5141.DBX 1278.7; 
      A     DB5140.DBX 3788.2; 
      S     DB5140.DBX 3948.2; 

// Sirupanforderung
      A     DB2741.DBX  378.7; 
      S     DB5140.DBX 4028.2; 




END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4149
TITLE =U114: Transfer Plant 14
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : Sim
VERSION : 0.1


VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB4140.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4141.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     DB4141.DBX   17.3; 
      =     DB5140.DBX  425.3; 
      =     DB5140.DBX  505.3; 
      =     DB5140.DBX  585.3; 
      =     DB5140.DBX  665.3; 
      =     DB5140.DBX  745.3; 
      =     DB5140.DBX  825.3; 
      =     DB5140.DBX  905.3; 
      =     DB5140.DBX  985.3; 
      =     DB5140.DBX 1065.3; 
      =     DB5140.DBX 1145.3; 
      =     DB5140.DBX 1225.3; 
      =     DB5140.DBX 1305.3; 
      =     DB5140.DBX 2665.3; 
      =     DB5140.DBX 2745.3; 
      =     DB5140.DBX 2825.3; 
      =     DB5140.DBX 2905.3; 
      =     DB5140.DBX 3065.3; 
      =     DB5140.DBX 3145.3; 
      =     DB5140.DBX 3225.3; 
      =     DB5140.DBX 3305.3; 

NETWORK
TITLE =Special Input

      A     DB4141.DBX   17.3; 
      =     DB5141.DBX  681.3; 
      =     DB5141.DBX  741.3; 
      =     DB5141.DBX 1041.3; 
      =     DB5141.DBX 1221.3; 
      =     DB5141.DBX 1281.3; 
      =     DB5141.DBX 1341.3; 
      =     DB5141.DBX 1461.3; 
      =     DB5141.DBX 1521.3; 
      =     DB5141.DBX 1581.3; 
      =     DB5141.DBX 1641.3; 
      =     DB5141.DBX 1701.3; 
      =     DB5141.DBX 1761.3; 
      =     DB5141.DBX 1821.3; 
      =     DB5141.DBX 1881.3; 
      =     DB5141.DBX 1941.3; 


NETWORK
TITLE =Counter

      A     DB4141.DBX   17.3; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     DB4141.DBX   17.3; 

NETWORK
TITLE =Universal Value

      A     DB4141.DBX   17.3; 
//      =     "U114UnVD".unv001.Sim; 
//      =     "U114UnVD".unv002.Sim; 
//      =     "U114UnVD".unv003.Sim; 
//      =     "U114UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     DB4141.DBX   17.3; 

NETWORK
TITLE =Message

      A     DB4141.DBX   17.3; 
//      =     "U114MsgD".msg001.Sim; 
//      =     "U114MsgD".msg002.Sim; 
//      =     "U114MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     DB4141.DBX   17.3; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4215
TITLE =U121: Planung Transfer VE1
FAMILY : BOTEC_F1
NAME : U121Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4210.DBW    0; 
      T     #UnitNo; 

      L     DB4215.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4215.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4215.DBD   10; 
      L     DB4215.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4215.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4215.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4211.DBX   15.0; 
      A     DB4211.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4215.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4211.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4211.DBX   15.0; 
//      AN "U121SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4215.DBD  150; 
      T     DB4211.DBD  626; 

//Temperature CIP Return
      L     DB4215.DBD  146; 
      T     DB4211.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4211.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4215.DBX  171.7; 
      JCN   pfc; 
      L     DB4211.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4215.DBX  172.0; 
      JCN   ppc; 
      L     DB4211.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4215.DBX  171.6; 
      JCN   pxc; 
      L     DB4211.DBD  574; 
pxc:  NOP   0; 
      T     DB4215.DBD  182; 

//CIP Return
      L     DB4211.DBD  558; 
      T     DB4215.DBD  186; 
      L     DB4215.DBD  138; 
      T     DB4211.DBD  562; 

//CIP Prerun
      L     DB4211.DBD  542; 
      T     DB4215.DBD  190; 
      L     DB4215.DBD  142; 
      T     DB4211.DBD  546; 

// Write Own Data to CIP
      L     DB4215.DBD   10; 
      T     DB4215.DBD  154; 

      L     DB4215.DBW   14; 
      T     DB4215.DBW  158; 

      L     DB4215.DBW   16; 
      T     DB4215.DBW  160; 

      L     DB4215.DBW   18; 
      T     DB4215.DBW  162; 

      L     DB4215.DBW   20; 
      T     DB4215.DBW  164; 

      L     DB4215.DBW   22; 
      T     DB4215.DBW  166; 

      A     DB4215.DBX   24.0; 
      =     DB4215.DBX  168.0; 

      A     DB4215.DBX   24.1; 
      =     DB4215.DBX  168.1; 

      A     DB4215.DBX   24.2; 
      =     DB4215.DBX  168.2; 

      A     DB4215.DBX   24.3; 
      =     DB4215.DBX  168.3; 

      A     DB4215.DBX   24.4; 
      =     DB4215.DBX  168.4; 

      A     DB4215.DBX   24.5; 
      =     DB4215.DBX  168.5; 

      A     DB4215.DBX   24.6; 
      =     DB4215.DBX  168.6; 

      A     DB4215.DBX   24.7; 
      =     DB4215.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4215.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4215.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U121SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4215.DBX   26.5; 

//Full Signal
//A     "U121SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4215.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4215.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4215.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4225
TITLE =U122: Planung Transfer VE2
FAMILY : BOTEC_F1
NAME : U122Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4220.DBW    0; 
      T     #UnitNo; 

      L     DB4225.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4225.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4225.DBD   10; 
      L     DB4225.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4225.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4225.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4221.DBX   15.0; 
      A     DB4221.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4225.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4221.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4221.DBX   15.0; 
//      AN "U122SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4225.DBD  150; 
      T     DB4221.DBD  626; 

//Temperature CIP Return
      L     DB4225.DBD  146; 
      T     DB4221.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4221.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4225.DBX  171.7; 
      JCN   pfc; 
      L     DB4221.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4225.DBX  172.0; 
      JCN   ppc; 
      L     DB4221.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4225.DBX  171.6; 
      JCN   pxc; 
      L     DB4221.DBD  574; 
pxc:  NOP   0; 
      T     DB4225.DBD  182; 

//CIP Return
      L     DB4221.DBD  558; 
      T     DB4225.DBD  186; 
      L     DB4225.DBD  138; 
      T     DB4221.DBD  562; 

//CIP Prerun
      L     DB4221.DBD  542; 
      T     DB4225.DBD  190; 
      L     DB4225.DBD  142; 
      T     DB4221.DBD  546; 

// Write Own Data to CIP
      L     DB4225.DBD   10; 
      T     DB4225.DBD  154; 

      L     DB4225.DBW   14; 
      T     DB4225.DBW  158; 

      L     DB4225.DBW   16; 
      T     DB4225.DBW  160; 

      L     DB4225.DBW   18; 
      T     DB4225.DBW  162; 

      L     DB4225.DBW   20; 
      T     DB4225.DBW  164; 

      L     DB4225.DBW   22; 
      T     DB4225.DBW  166; 

      A     DB4225.DBX   24.0; 
      =     DB4225.DBX  168.0; 

      A     DB4225.DBX   24.1; 
      =     DB4225.DBX  168.1; 

      A     DB4225.DBX   24.2; 
      =     DB4225.DBX  168.2; 

      A     DB4225.DBX   24.3; 
      =     DB4225.DBX  168.3; 

      A     DB4225.DBX   24.4; 
      =     DB4225.DBX  168.4; 

      A     DB4225.DBX   24.5; 
      =     DB4225.DBX  168.5; 

      A     DB4225.DBX   24.6; 
      =     DB4225.DBX  168.6; 

      A     DB4225.DBX   24.7; 
      =     DB4225.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4225.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4225.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U122SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4225.DBX   26.5; 

//Full Signal
//A     "U122SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4225.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4225.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4225.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4255
TITLE =U125: Planung Transfer A
FAMILY : BOTEC_F1
NAME : U125Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4250.DBW    0; 
      T     #UnitNo; 

      L     DB4255.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4255.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4255.DBD   10; 
      L     DB4255.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4255.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4255.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4251.DBX   15.0; 
      A     DB4251.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4255.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4251.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4251.DBX   15.0; 
//      AN "U125SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4255.DBD  150; 
      T     DB4251.DBD  626; 

//Temperature CIP Return
      L     DB4255.DBD  146; 
      T     DB4251.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4251.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4255.DBX  171.7; 
      JCN   pfc; 
      L     DB4251.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4255.DBX  172.0; 
      JCN   ppc; 
      L     DB4251.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4255.DBX  171.6; 
      JCN   pxc; 
      L     DB4251.DBD  574; 
pxc:  NOP   0; 
      T     DB4255.DBD  182; 

//CIP Return
      L     DB4251.DBD  558; 
      T     DB4255.DBD  186; 
      L     DB4255.DBD  138; 
      T     DB4251.DBD  562; 

//CIP Prerun
      L     DB4251.DBD  542; 
      T     DB4255.DBD  190; 
      L     DB4255.DBD  142; 
      T     DB4251.DBD  546; 

// Write Own Data to CIP
      L     DB4255.DBD   10; 
      T     DB4255.DBD  154; 

      L     DB4255.DBW   14; 
      T     DB4255.DBW  158; 

      L     DB4255.DBW   16; 
      T     DB4255.DBW  160; 

      L     DB4255.DBW   18; 
      T     DB4255.DBW  162; 

      L     DB4255.DBW   20; 
      T     DB4255.DBW  164; 

      L     DB4255.DBW   22; 
      T     DB4255.DBW  166; 

      A     DB4255.DBX   24.0; 
      =     DB4255.DBX  168.0; 

      A     DB4255.DBX   24.1; 
      =     DB4255.DBX  168.1; 

      A     DB4255.DBX   24.2; 
      =     DB4255.DBX  168.2; 

      A     DB4255.DBX   24.3; 
      =     DB4255.DBX  168.3; 

      A     DB4255.DBX   24.4; 
      =     DB4255.DBX  168.4; 

      A     DB4255.DBX   24.5; 
      =     DB4255.DBX  168.5; 

      A     DB4255.DBX   24.6; 
      =     DB4255.DBX  168.6; 

      A     DB4255.DBX   24.7; 
      =     DB4255.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4255.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4255.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U125SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4255.DBX   26.5; 

//Full Signal
//A     "U125SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4255.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4255.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4255.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4265
TITLE =U126: Planung Transfer B
FAMILY : BOTEC_F1
NAME : U126Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4260.DBW    0; 
      T     #UnitNo; 

      L     DB4265.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4265.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4265.DBD   10; 
      L     DB4265.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4265.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4265.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4261.DBX   15.0; 
      A     DB4261.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4265.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4261.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4261.DBX   15.0; 
//      AN "U126SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4265.DBD  150; 
      T     DB4261.DBD  626; 

//Temperature CIP Return
      L     DB4265.DBD  146; 
      T     DB4261.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4261.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4265.DBX  171.7; 
      JCN   pfc; 
      L     DB4261.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4265.DBX  172.0; 
      JCN   ppc; 
      L     DB4261.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4265.DBX  171.6; 
      JCN   pxc; 
      L     DB4261.DBD  574; 
pxc:  NOP   0; 
      T     DB4265.DBD  182; 

//CIP Return
      L     DB4261.DBD  558; 
      T     DB4265.DBD  186; 
      L     DB4265.DBD  138; 
      T     DB4261.DBD  562; 

//CIP Prerun
      L     DB4261.DBD  542; 
      T     DB4265.DBD  190; 
      L     DB4265.DBD  142; 
      T     DB4261.DBD  546; 

// Write Own Data to CIP
      L     DB4265.DBD   10; 
      T     DB4265.DBD  154; 

      L     DB4265.DBW   14; 
      T     DB4265.DBW  158; 

      L     DB4265.DBW   16; 
      T     DB4265.DBW  160; 

      L     DB4265.DBW   18; 
      T     DB4265.DBW  162; 

      L     DB4265.DBW   20; 
      T     DB4265.DBW  164; 

      L     DB4265.DBW   22; 
      T     DB4265.DBW  166; 

      A     DB4265.DBX   24.0; 
      =     DB4265.DBX  168.0; 

      A     DB4265.DBX   24.1; 
      =     DB4265.DBX  168.1; 

      A     DB4265.DBX   24.2; 
      =     DB4265.DBX  168.2; 

      A     DB4265.DBX   24.3; 
      =     DB4265.DBX  168.3; 

      A     DB4265.DBX   24.4; 
      =     DB4265.DBX  168.4; 

      A     DB4265.DBX   24.5; 
      =     DB4265.DBX  168.5; 

      A     DB4265.DBX   24.6; 
      =     DB4265.DBX  168.6; 

      A     DB4265.DBX   24.7; 
      =     DB4265.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4265.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4265.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U126SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4265.DBX   26.5; 

//Full Signal
//A     "U126SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4265.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4265.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4265.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4275
TITLE =U127: Planung Transfer CF
FAMILY : BOTEC_F1
NAME : U127Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4270.DBW    0; 
      T     #UnitNo; 

      L     DB4275.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4275.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4275.DBD   10; 
      L     DB4275.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4275.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4275.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4271.DBX   15.0; 
      A     DB4271.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4275.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4271.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4271.DBX   15.0; 
//      AN "U127SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4275.DBD  150; 
      T     DB4271.DBD  626; 

//Temperature CIP Return
      L     DB4275.DBD  146; 
      T     DB4271.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4271.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4275.DBX  171.7; 
      JCN   pfc; 
      L     DB4271.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4275.DBX  172.0; 
      JCN   ppc; 
      L     DB4271.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4275.DBX  171.6; 
      JCN   pxc; 
      L     DB4271.DBD  574; 
pxc:  NOP   0; 
      T     DB4275.DBD  182; 

//CIP Return
      L     DB4271.DBD  558; 
      T     DB4275.DBD  186; 
      L     DB4275.DBD  138; 
      T     DB4271.DBD  562; 

//CIP Prerun
      L     DB4271.DBD  542; 
      T     DB4275.DBD  190; 
      L     DB4275.DBD  142; 
      T     DB4271.DBD  546; 

// Write Own Data to CIP
      L     DB4275.DBD   10; 
      T     DB4275.DBD  154; 

      L     DB4275.DBW   14; 
      T     DB4275.DBW  158; 

      L     DB4275.DBW   16; 
      T     DB4275.DBW  160; 

      L     DB4275.DBW   18; 
      T     DB4275.DBW  162; 

      L     DB4275.DBW   20; 
      T     DB4275.DBW  164; 

      L     DB4275.DBW   22; 
      T     DB4275.DBW  166; 

      A     DB4275.DBX   24.0; 
      =     DB4275.DBX  168.0; 

      A     DB4275.DBX   24.1; 
      =     DB4275.DBX  168.1; 

      A     DB4275.DBX   24.2; 
      =     DB4275.DBX  168.2; 

      A     DB4275.DBX   24.3; 
      =     DB4275.DBX  168.3; 

      A     DB4275.DBX   24.4; 
      =     DB4275.DBX  168.4; 

      A     DB4275.DBX   24.5; 
      =     DB4275.DBX  168.5; 

      A     DB4275.DBX   24.6; 
      =     DB4275.DBX  168.6; 

      A     DB4275.DBX   24.7; 
      =     DB4275.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4275.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4275.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U127SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4275.DBX   26.5; 

//Full Signal
//A     "U127SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4275.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4275.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4275.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4285
TITLE =U128: Planung Transfer C.1
FAMILY : BOTEC_F1
NAME : U128Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4280.DBW    0; 
      T     #UnitNo; 

      L     DB4285.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4285.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4285.DBD   10; 
      L     DB4285.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4285.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4285.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4281.DBX   15.0; 
      A     DB4281.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4285.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4281.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4281.DBX   15.0; 
//      AN "U128SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4285.DBD  150; 
      T     DB4281.DBD  626; 

//Temperature CIP Return
      L     DB4285.DBD  146; 
      T     DB4281.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4281.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4285.DBX  171.7; 
      JCN   pfc; 
      L     DB4281.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4285.DBX  172.0; 
      JCN   ppc; 
      L     DB4281.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4285.DBX  171.6; 
      JCN   pxc; 
      L     DB4281.DBD  574; 
pxc:  NOP   0; 
      T     DB4285.DBD  182; 

//CIP Return
      L     DB4281.DBD  558; 
      T     DB4285.DBD  186; 
      L     DB4285.DBD  138; 
      T     DB4281.DBD  562; 

//CIP Prerun
      L     DB4281.DBD  542; 
      T     DB4285.DBD  190; 
      L     DB4285.DBD  142; 
      T     DB4281.DBD  546; 

// Write Own Data to CIP
      L     DB4285.DBD   10; 
      T     DB4285.DBD  154; 

      L     DB4285.DBW   14; 
      T     DB4285.DBW  158; 

      L     DB4285.DBW   16; 
      T     DB4285.DBW  160; 

      L     DB4285.DBW   18; 
      T     DB4285.DBW  162; 

      L     DB4285.DBW   20; 
      T     DB4285.DBW  164; 

      L     DB4285.DBW   22; 
      T     DB4285.DBW  166; 

      A     DB4285.DBX   24.0; 
      =     DB4285.DBX  168.0; 

      A     DB4285.DBX   24.1; 
      =     DB4285.DBX  168.1; 

      A     DB4285.DBX   24.2; 
      =     DB4285.DBX  168.2; 

      A     DB4285.DBX   24.3; 
      =     DB4285.DBX  168.3; 

      A     DB4285.DBX   24.4; 
      =     DB4285.DBX  168.4; 

      A     DB4285.DBX   24.5; 
      =     DB4285.DBX  168.5; 

      A     DB4285.DBX   24.6; 
      =     DB4285.DBX  168.6; 

      A     DB4285.DBX   24.7; 
      =     DB4285.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4285.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4285.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U128SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4285.DBX   26.5; 

//Full Signal
//A     "U128SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4285.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4285.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4285.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4295
TITLE =U129: Planung Transfer B6F
FAMILY : BOTEC_F1
NAME : U129Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4290.DBW    0; 
      T     #UnitNo; 

      L     DB4295.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4295.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4295.DBD   10; 
      L     DB4295.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4295.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4295.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4291.DBX   15.0; 
      A     DB4291.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4295.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4291.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4291.DBX   15.0; 
//      AN "U129SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4295.DBD  150; 
      T     DB4291.DBD  626; 

//Temperature CIP Return
      L     DB4295.DBD  146; 
      T     DB4291.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4291.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4295.DBX  171.7; 
      JCN   pfc; 
      L     DB4291.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4295.DBX  172.0; 
      JCN   ppc; 
      L     DB4291.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4295.DBX  171.6; 
      JCN   pxc; 
      L     DB4291.DBD  574; 
pxc:  NOP   0; 
      T     DB4295.DBD  182; 

//CIP Return
      L     DB4291.DBD  558; 
      T     DB4295.DBD  186; 
      L     DB4295.DBD  138; 
      T     DB4291.DBD  562; 

//CIP Prerun
      L     DB4291.DBD  542; 
      T     DB4295.DBD  190; 
      L     DB4295.DBD  142; 
      T     DB4291.DBD  546; 

// Write Own Data to CIP
      L     DB4295.DBD   10; 
      T     DB4295.DBD  154; 

      L     DB4295.DBW   14; 
      T     DB4295.DBW  158; 

      L     DB4295.DBW   16; 
      T     DB4295.DBW  160; 

      L     DB4295.DBW   18; 
      T     DB4295.DBW  162; 

      L     DB4295.DBW   20; 
      T     DB4295.DBW  164; 

      L     DB4295.DBW   22; 
      T     DB4295.DBW  166; 

      A     DB4295.DBX   24.0; 
      =     DB4295.DBX  168.0; 

      A     DB4295.DBX   24.1; 
      =     DB4295.DBX  168.1; 

      A     DB4295.DBX   24.2; 
      =     DB4295.DBX  168.2; 

      A     DB4295.DBX   24.3; 
      =     DB4295.DBX  168.3; 

      A     DB4295.DBX   24.4; 
      =     DB4295.DBX  168.4; 

      A     DB4295.DBX   24.5; 
      =     DB4295.DBX  168.5; 

      A     DB4295.DBX   24.6; 
      =     DB4295.DBX  168.6; 

      A     DB4295.DBX   24.7; 
      =     DB4295.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4295.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4295.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U129SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4295.DBX   26.5; 

//Full Signal
//A     "U129SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4295.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4295.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4295.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4305
TITLE =U130: Planung Transfer H6F
FAMILY : BOTEC_F1
NAME : U130Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4300.DBW    0; 
      T     #UnitNo; 

      L     DB4305.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4305.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4305.DBD   10; 
      L     DB4305.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4305.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4305.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4301.DBX   15.0; 
      A     DB4301.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4305.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4301.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4301.DBX   15.0; 
//      AN "U130SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4305.DBD  150; 
      T     DB4301.DBD  626; 

//Temperature CIP Return
      L     DB4305.DBD  146; 
      T     DB4301.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4301.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4305.DBX  171.7; 
      JCN   pfc; 
      L     DB4301.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4305.DBX  172.0; 
      JCN   ppc; 
      L     DB4301.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4305.DBX  171.6; 
      JCN   pxc; 
      L     DB4301.DBD  574; 
pxc:  NOP   0; 
      T     DB4305.DBD  182; 

//CIP Return
      L     DB4301.DBD  558; 
      T     DB4305.DBD  186; 
      L     DB4305.DBD  138; 
      T     DB4301.DBD  562; 

//CIP Prerun
      L     DB4301.DBD  542; 
      T     DB4305.DBD  190; 
      L     DB4305.DBD  142; 
      T     DB4301.DBD  546; 

// Write Own Data to CIP
      L     DB4305.DBD   10; 
      T     DB4305.DBD  154; 

      L     DB4305.DBW   14; 
      T     DB4305.DBW  158; 

      L     DB4305.DBW   16; 
      T     DB4305.DBW  160; 

      L     DB4305.DBW   18; 
      T     DB4305.DBW  162; 

      L     DB4305.DBW   20; 
      T     DB4305.DBW  164; 

      L     DB4305.DBW   22; 
      T     DB4305.DBW  166; 

      A     DB4305.DBX   24.0; 
      =     DB4305.DBX  168.0; 

      A     DB4305.DBX   24.1; 
      =     DB4305.DBX  168.1; 

      A     DB4305.DBX   24.2; 
      =     DB4305.DBX  168.2; 

      A     DB4305.DBX   24.3; 
      =     DB4305.DBX  168.3; 

      A     DB4305.DBX   24.4; 
      =     DB4305.DBX  168.4; 

      A     DB4305.DBX   24.5; 
      =     DB4305.DBX  168.5; 

      A     DB4305.DBX   24.6; 
      =     DB4305.DBX  168.6; 

      A     DB4305.DBX   24.7; 
      =     DB4305.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4305.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4305.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U130SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4305.DBX   26.5; 

//Full Signal
//A     "U130SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4305.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4305.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4305.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4315
TITLE =U131: Planung Transfer J6F
FAMILY : BOTEC_F1
NAME : U131Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4310.DBW    0; 
      T     #UnitNo; 

      L     DB4315.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4315.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4315.DBD   10; 
      L     DB4315.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4315.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4315.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4311.DBX   15.0; 
      A     DB4311.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4315.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4311.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4311.DBX   15.0; 
//      AN "U131SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4315.DBD  150; 
      T     DB4311.DBD  626; 

//Temperature CIP Return
      L     DB4315.DBD  146; 
      T     DB4311.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4311.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4315.DBX  171.7; 
      JCN   pfc; 
      L     DB4311.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4315.DBX  172.0; 
      JCN   ppc; 
      L     DB4311.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4315.DBX  171.6; 
      JCN   pxc; 
      L     DB4311.DBD  574; 
pxc:  NOP   0; 
      T     DB4315.DBD  182; 

//CIP Return
      L     DB4311.DBD  558; 
      T     DB4315.DBD  186; 
      L     DB4315.DBD  138; 
      T     DB4311.DBD  562; 

//CIP Prerun
      L     DB4311.DBD  542; 
      T     DB4315.DBD  190; 
      L     DB4315.DBD  142; 
      T     DB4311.DBD  546; 

// Write Own Data to CIP
      L     DB4315.DBD   10; 
      T     DB4315.DBD  154; 

      L     DB4315.DBW   14; 
      T     DB4315.DBW  158; 

      L     DB4315.DBW   16; 
      T     DB4315.DBW  160; 

      L     DB4315.DBW   18; 
      T     DB4315.DBW  162; 

      L     DB4315.DBW   20; 
      T     DB4315.DBW  164; 

      L     DB4315.DBW   22; 
      T     DB4315.DBW  166; 

      A     DB4315.DBX   24.0; 
      =     DB4315.DBX  168.0; 

      A     DB4315.DBX   24.1; 
      =     DB4315.DBX  168.1; 

      A     DB4315.DBX   24.2; 
      =     DB4315.DBX  168.2; 

      A     DB4315.DBX   24.3; 
      =     DB4315.DBX  168.3; 

      A     DB4315.DBX   24.4; 
      =     DB4315.DBX  168.4; 

      A     DB4315.DBX   24.5; 
      =     DB4315.DBX  168.5; 

      A     DB4315.DBX   24.6; 
      =     DB4315.DBX  168.6; 

      A     DB4315.DBX   24.7; 
      =     DB4315.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4315.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4315.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U131SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4315.DBX   26.5; 

//Full Signal
//A     "U131SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4315.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4315.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4315.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4325
TITLE =U132: Planung Transfer L6F
FAMILY : BOTEC_F1
NAME : U132Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4320.DBW    0; 
      T     #UnitNo; 

      L     DB4325.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4325.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4325.DBD   10; 
      L     DB4325.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4325.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4325.GEN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4321.DBX   15.0; 
      A     DB4321.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4325.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4321.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4321.DBX   15.0; 
//      AN "U132SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4325.DBD  150; 
      T     DB4321.DBD  626; 

//Temperature CIP Return
      L     DB4325.DBD  146; 
      T     DB4321.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4321.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4325.DBX  171.7; 
      JCN   pfc; 
      L     DB4321.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4325.DBX  172.0; 
      JCN   ppc; 
      L     DB4321.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4325.DBX  171.6; 
      JCN   pxc; 
      L     DB4321.DBD  574; 
pxc:  NOP   0; 
      T     DB4325.DBD  182; 

//CIP Return
      L     DB4321.DBD  558; 
      T     DB4325.DBD  186; 
      L     DB4325.DBD  138; 
      T     DB4321.DBD  562; 

//CIP Prerun
      L     DB4321.DBD  542; 
      T     DB4325.DBD  190; 
      L     DB4325.DBD  142; 
      T     DB4321.DBD  546; 

// Write Own Data to CIP
      L     DB4325.DBD   10; 
      T     DB4325.DBD  154; 

      L     DB4325.DBW   14; 
      T     DB4325.DBW  158; 

      L     DB4325.DBW   16; 
      T     DB4325.DBW  160; 

      L     DB4325.DBW   18; 
      T     DB4325.DBW  162; 

      L     DB4325.DBW   20; 
      T     DB4325.DBW  164; 

      L     DB4325.DBW   22; 
      T     DB4325.DBW  166; 

      A     DB4325.DBX   24.0; 
      =     DB4325.DBX  168.0; 

      A     DB4325.DBX   24.1; 
      =     DB4325.DBX  168.1; 

      A     DB4325.DBX   24.2; 
      =     DB4325.DBX  168.2; 

      A     DB4325.DBX   24.3; 
      =     DB4325.DBX  168.3; 

      A     DB4325.DBX   24.4; 
      =     DB4325.DBX  168.4; 

      A     DB4325.DBX   24.5; 
      =     DB4325.DBX  168.5; 

      A     DB4325.DBX   24.6; 
      =     DB4325.DBX  168.6; 

      A     DB4325.DBX   24.7; 
      =     DB4325.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4325.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4325.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U132SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4325.DBX   26.5; 

//Full Signal
//A     "U132SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4325.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4325.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4325.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4335
TITLE =U133: Planung Transfer B6
FAMILY : BOTEC_F1
NAME : U133Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4330.DBW    0; 
      T     #UnitNo; 

      L     DB4335.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4335.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4335.DBD   10; 
      L     DB4335.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4335.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4335.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4331.DBX   15.0; 
      A     DB4331.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4335.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4331.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4331.DBX   15.0; 
//      AN "U133SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4335.DBD  150; 
      T     DB4331.DBD  626; 

//Temperature CIP Return
      L     DB4335.DBD  146; 
      T     DB4331.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4331.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4335.DBX  171.7; 
      JCN   pfc; 
      L     DB4331.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4335.DBX  172.0; 
      JCN   ppc; 
      L     DB4331.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4335.DBX  171.6; 
      JCN   pxc; 
      L     DB4331.DBD  574; 
pxc:  NOP   0; 
      T     DB4335.DBD  182; 

//CIP Return
      L     DB4331.DBD  558; 
      T     DB4335.DBD  186; 
      L     DB4335.DBD  138; 
      T     DB4331.DBD  562; 

//CIP Prerun
      L     DB4331.DBD  542; 
      T     DB4335.DBD  190; 
      L     DB4335.DBD  142; 
      T     DB4331.DBD  546; 

// Write Own Data to CIP
      L     DB4335.DBD   10; 
      T     DB4335.DBD  154; 

      L     DB4335.DBW   14; 
      T     DB4335.DBW  158; 

      L     DB4335.DBW   16; 
      T     DB4335.DBW  160; 

      L     DB4335.DBW   18; 
      T     DB4335.DBW  162; 

      L     DB4335.DBW   20; 
      T     DB4335.DBW  164; 

      L     DB4335.DBW   22; 
      T     DB4335.DBW  166; 

      A     DB4335.DBX   24.0; 
      =     DB4335.DBX  168.0; 

      A     DB4335.DBX   24.1; 
      =     DB4335.DBX  168.1; 

      A     DB4335.DBX   24.2; 
      =     DB4335.DBX  168.2; 

      A     DB4335.DBX   24.3; 
      =     DB4335.DBX  168.3; 

      A     DB4335.DBX   24.4; 
      =     DB4335.DBX  168.4; 

      A     DB4335.DBX   24.5; 
      =     DB4335.DBX  168.5; 

      A     DB4335.DBX   24.6; 
      =     DB4335.DBX  168.6; 

      A     DB4335.DBX   24.7; 
      =     DB4335.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4335.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4335.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U133SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4335.DBX   26.5; 

//Full Signal
//A     "U133SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4335.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4335.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4335.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4345
TITLE =U134: Planung Transfer D6
FAMILY : BOTEC_F1
NAME : U134Comm
VERSION : 0.1


VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	// CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB4340.DBW    0; 
      T     #UnitNo; 

      L     DB4345.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB4345.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB4345.DBD   10; 
      L     DB4345.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB4345.DBX   75.0; //General Emergency Stop OK
      CLR   ; 
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 99,
           IsTUnit                  := FALSE,
           DstComDRec               := DB4345.GEN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =remote start

      SET   ; 
// !!! insert correct condition of unit start !!!
      A     DB4341.DBX   15.0; 
      A     DB4341.DBX   17.4; 
      CLR   ; 
      JCN   Strt; 
      L     DB4345.DBD   10; 
//L        L#-1;                            // Prid negative to start on its own
      T     #Prid; 

      CALL FC    48 (
           UnitNo                   := #UnitNo,
           PrId                     := #Prid,
           Run                      := DB4341.DBX   17.4,
           PrIdTransfer             := TRUE,
           Start                    := TRUE,
           RetVal                   := #wRetVal);
Strt: NOP   0; 
NETWORK
TITLE =external releases

      SET   ; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    DB4341.DBX   15.0; 
//      AN "U134SeqD".Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB4345.DBD  150; 
      T     DB4341.DBD  626; 

//Temperature CIP Return
      L     DB4345.DBD  146; 
      T     DB4341.DBD  594; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := DB4341.DBD  686,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB4345.DBX  171.7; 
      JCN   pfc; 
      L     DB4341.DBD  654; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB4345.DBX  172.0; 
      JCN   ppc; 
      L     DB4341.DBD  670; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB4345.DBX  171.6; 
      JCN   pxc; 
      L     DB4341.DBD  574; 
pxc:  NOP   0; 
      T     DB4345.DBD  182; 

//CIP Return
      L     DB4341.DBD  558; 
      T     DB4345.DBD  186; 
      L     DB4345.DBD  138; 
      T     DB4341.DBD  562; 

//CIP Prerun
      L     DB4341.DBD  542; 
      T     DB4345.DBD  190; 
      L     DB4345.DBD  142; 
      T     DB4341.DBD  546; 

// Write Own Data to CIP
      L     DB4345.DBD   10; 
      T     DB4345.DBD  154; 

      L     DB4345.DBW   14; 
      T     DB4345.DBW  158; 

      L     DB4345.DBW   16; 
      T     DB4345.DBW  160; 

      L     DB4345.DBW   18; 
      T     DB4345.DBW  162; 

      L     DB4345.DBW   20; 
      T     DB4345.DBW  164; 

      L     DB4345.DBW   22; 
      T     DB4345.DBW  166; 

      A     DB4345.DBX   24.0; 
      =     DB4345.DBX  168.0; 

      A     DB4345.DBX   24.1; 
      =     DB4345.DBX  168.1; 

      A     DB4345.DBX   24.2; 
      =     DB4345.DBX  168.2; 

      A     DB4345.DBX   24.3; 
      =     DB4345.DBX  168.3; 

      A     DB4345.DBX   24.4; 
      =     DB4345.DBX  168.4; 

      A     DB4345.DBX   24.5; 
      =     DB4345.DBX  168.5; 

      A     DB4345.DBX   24.6; 
      =     DB4345.DBX  168.6; 

      A     DB4345.DBX   24.7; 
      =     DB4345.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB4345.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB4345.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "U134SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB4345.DBX   26.5; 

//Full Signal
//A     "U134SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB4345.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB4345.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB4345.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 72
TITLE =
AUTHOR : Riedl
FAMILY : BOTEC
NAME : PDAA
VERSION : 2.0

BEGIN
NETWORK
TITLE =

      CALL FC    72 (
           DBConfig                 := DB    72,
           DBData                   := DB    73);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 81
TITLE =
AUTHOR : Riedl
FAMILY : BOTEC
NAME : CrCA
VERSION : 2.1


VAR_TEMP
  wTmp : WORD ;	
END_VAR
BEGIN
NETWORK
TITLE =transfer data in own Datablock

// Alter DB Doehler Tuch
      CALL FC   564 (
           ActReq                   := M    101.0,
           PLCNo                    := 1,
           SourceAdr                := P#DB834.DBX 0.0 BYTE 64,
           DataLen                  := 64,
           DestAdr                  := P#DB304.DBX0.0 BYTE 64,
           RET_VAL                  := #wTmp);

// Read from PLC04
      CALL FC   564 (
           ActReq                   := M    101.0,
           PLCNo                    := 4,
           SourceAdr                := P#DB302.DBX0.0 BYTE 128,
           DataLen                  := 128,
           DestAdr                  := P#DB302.DBX0.0 BYTE 128,
           RET_VAL                  := #wTmp);

NETWORK
TITLE =Daten An PLC01 (Tuchenhagen Daten)

      CALL FC   999 ;

NETWORK
TITLE =coupling active bits initialize

      AN    M    101.4; 
      JC    NCRC; 
      R     DB79.DBX   13.4; // initialize active bits (reset)
      R     DB79.DBX   33.4; 
      R     DB79.DBX   53.4; 
      R     DB79.DBX   73.4; 
      R     DB79.DBX   93.4; 
      R     DB79.DBX  113.4; 
      R     DB79.DBX  133.4; 
      R     DB79.DBX  153.4; 
      R     DB79.DBX  173.4; 
      R     DB79.DBX  193.4; 
      R     DB79.DBX  213.4; 
      R     DB79.DBX  233.4; 
      R     DB79.DBX  253.4; 
      R     DB79.DBX  273.4; 
      R     DB79.DBX  293.4; 
      R     DB79.DBX  313.4; 
NCRC: SET   ; 
NETWORK
TITLE =read data from remote PLC

      NOP   0; 

// From PLC01
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=1

// From PLC02
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=2

// From PLC03
//     CALL  "CrC" , "CrCD"
//       RemotePLCNo:=3

// From PLC04
      CALL FB    80 , DB    80 (
           RemotePLCNo              := 4);

// From PLC05
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=5

// From PLC06
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=6

// From PLC07
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=7

// From PLC08
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=8

// From PLC09
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=9

// From PLC10
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=10

// From PLC11
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=11

// From PLC12
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=12

// From PLC13
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=13

// From PLC14
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=14

// From PLC15
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=15

// From PLC16
//      CALL  "CrC" , "CrCD"
//       RemotePLCNo:=16

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 111
TITLE =C01: Water Tank x
// NW  1 : phase and index evaluation
// NW  2 : phase  1: start position
// NW  3 : phase  4: Filling
// NW  4 : phase  5: Storage
// NW  5 : phase  8: Emptying
// NW  6 : phase 20: Quality Check
// NW  7 : phase 21: Prepare Tank
// NW  8 : phase 23: Connect Tank
// NW  9 : phase 31: CIP Start
// NW 10 : phase 32: CIP Prerun
// NW 11 : phase 33: CIP Return
// NW 12 : phase 34: CIP Rinsing
// NW 13 : phase 35: CIP Emptying
// NW 14 : phase 36: CIP Drain
// NW 15 : phase 40: CIP End
// NW 16 : end of sequence
// NW 17 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Process Time                        Duration        min
// 40 : Density                             Value           kg/l
// 42 : Material                            Value
AUTHOR : Woermann
NAME : C01Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  ComSRC : BOOL ;	//Communication With Well Transfer x
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dUnitNo : DINT ;	//Unit Number 
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM26 : STRUCT 	//Cip Step On Condition
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Conductivity High
    I02 : BOOL ;	//Conductivity Low
    I03 : BOOL ;	//Time
    I04 : BOOL ;	//Amount
    I05 : BOOL ;	//Temperature High
    I06 : BOOL ;	//Temperature Low
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM27 : STRUCT 	//Cip Prerun
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM28 : STRUCT 	//Cip Return
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	//Drain
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM37 : STRUCT 	//Cip Pump Mode
    I00 : BOOL ;	//Off
    I01 : BOOL ;	//Flow
    I02 : BOOL ;	//Pressure
    I03 : BOOL ;	//Fix Speed
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM31 : STRUCT 	//Cip Distribution Circuit No
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Auto Select
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM39 : STRUCT 	//Q-Status
    I00 : BOOL ;	//Please select
    I01 : BOOL ;	//released
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	//Ignore
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	//locked
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
  ComDST : BOOL ;	//Communication Water Transfer to Packaging Plant
  ComCIPDist : BOOL ;	//Communication with CIP Distribution
  ReqInlet : BOOL ;	//Request Inlet
  RelOutlet : BOOL ;	//Release Outlet
  Empty : BOOL ;	//Tank Empty
  reqAnlage : BOOL ;	//Destination Requests Filling
  ComU043 : BOOL ;	
  ComU045 : BOOL ;	
  ComU047 : BOOL ;	
  ComU048 : BOOL ;	
  ComU049 : BOOL ;	
  ComU050 : BOOL ;	
  ComU051 : BOOL ;	
  ComU052 : BOOL ;	
  ComU054 : BOOL ;	
  ComU055 : BOOL ;	
  ComU056 : BOOL ;	
  ComU057 : BOOL ;	
  ComU058 : BOOL ;	
  ComLine : INT ;	//Check Line Communikation and send to all lines
END_VAR
BEGIN
NETWORK
TITLE = Phase and Index Evaluation


      CLR   ; 
      =     #RRel; 
      =     #ReqInlet; 
      =     #RelOutlet; 
      L     0; 
      T     #ComLine; 

// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     60; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB115.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      L     MD   124; 
      L     DB115.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

      L     MD   124; 
      L     DB1945.DBD   10; // CIP Dist 1
      ==D   ; 
      =     #ComCIPDist; 

      A(    ; 
      L     DB115.DBD  226; 
      RND   ; 
      L     #EquipmentID; 
      ==D   ; 
      )     ; 
      A(    ; 
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB115.DBD  222; 
      ==R   ; 
      )     ; 
      =     #ComSRC; 




      CLR   ; 
      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1435.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1435.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU043; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1455.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1455.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU045; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1475.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1475.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU047; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1485.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1485.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU048; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1495.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1495.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU049; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1505.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1505.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU050; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1515.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1515.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU051; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1525.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1525.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU052; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1545.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1545.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU054; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1555.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1555.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU055; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1565.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1565.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU056; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1575.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1575.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU057; 

      A(    ; // Material Check
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB1585.DBD   30; 
      ==R   ; 
      )     ; 
      A(    ; 
      L     DB1585.DBD   34; 
      RND   ; 
      L     #EquipmentID; 
      ==R   ; 
      )     ; 
      =     #ComU058; 



      CLR   ; 
      =     #ComDST; 

// Release Emptying / Filling of Tank ----------------------------------------
      A     DB211.DBX   78.7; 
      =     M    130.3; // Delay Empty

      A     M    152.1; // Filling Release
      S     #U.Seq.User.Bit5; 
      AN    DB211.DBX  138.7; // Full False
      R     #U.Seq.User.Bit5; 

      A     M    152.2; // Emptying Release
      ON    DB115.DBX  218.3; 
      S     #U.Seq.User.Bit6; 
      A     M    150.3; // Empty True
      R     #U.Seq.User.Bit6; 

// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB115.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 

// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: start position
      JU    X0; // phase  2:
      JU    X0; // phase  3:
      JU    X4; // phase  4: Filling
      JU    X5; // phase  5: Storage
      JU    X0; // phase  6:
      JU    X0; // phase  7:
      JU    X8; // phase  8: Emptying
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X0; // phase 11:
      JU    X0; // phase 12:
      JU    X0; // phase 13:
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X0; // phase 18:
      JU    X0; // phase 19:
      JU    X20; // phase 20: Quality Check
      JU    X21; // phase 21: Prepare Tank
      JU    X0; // phase 22:
      JU    X23; // phase 23: Connect Tank
      JU    X0; // phase 24:
      JU    X0; // phase 25:
      JU    X0; // phase 26:
      JU    X0; // phase 27:
      JU    X0; // phase 28:
      JU    X0; // phase 29:
      JU    X0; // phase 30:
      JU    X31; // phase 31: CIP Start
      JU    X32; // phase 32: CIP Prerun
      JU    X33; // phase 33: CIP Return
      JU    X34; // phase 34: CIP Rinsing
      JU    X35; // phase 35: CIP Emptying
      JU    X36; // phase 36: CIP Drain
      JU    X0; // phase 37:
      JU    X0; // phase 38:
      JU    X0; // phase 39:
      JU    X40; // phase 40: CIP End
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 

// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 

      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   110 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   110 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 
NETWORK
TITLE =phase 4: Filling 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 17 : Level                               Value           l
X4:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      A     M    102.3; 
      =     DB115.DBX   26.0; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 

// ---------------------------------------------------------------------------
// transition condition 
      A     #U.Seq.User.Bit6; // EMPTY_REL
      AN    M    102.2; 
      =     M    102.1; 


// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y4; 
      L     1; 
      T     MW   116; 
Y4:   SET   ; 

// subphase evaluation
      L     MW   110; 
      JL    A400; 
      JU    COMM; // subphase  0:
      JU    A401; // subphase  1: Waiting
      JU    A402; // subphase  2: Active
// ---------------------------------------------------------------------------
A400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A401: SET   ; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 


// -------------------------------------------------
// subphase transition 
      A     DB115.DBX  218.4; 
      A     #ComSRC; 
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
A402: SET   ; 
      A     #U.Seq.User.Bit2; 
      A     M    103.3; 
      =     DB115.DBX   26.1; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 
      =     #ReqInlet; 
// -------------------------------------------------
// subphase transition 
      AN    DB115.DBX  218.4; 
      ON    #ComSRC; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 5: Production
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 05 : Substep Time                        Duration        s
// 17 : Level                               Value           l
X5:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      A     M    102.3; 
      =     DB115.DBX   26.3; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.4; 
      S     M    140.4; // Substep Time

// ---------------------------------------------------------------------------
// communication
      A     DB1435.DBX   26.1; 
      A     #ComU043; 
      O     ; 
      A     DB1455.DBX   26.1; 
      A     #ComU045; 
      O     ; 
      A     DB1475.DBX   26.1; 
      A     #ComU047; 
      O     ; 
      A     DB1485.DBX   26.1; 
      A     #ComU048; 
      O     ; 
      A     DB1495.DBX   26.1; 
      A     #ComU049; 
      O     ; 
      A     DB1505.DBX   26.1; 
      A     #ComU050; 
      O     ; 
      A     DB1515.DBX   26.1; 
      A     #ComU051; 
      O     ; 
      A     DB1525.DBX   26.1; 
      A     #ComU052; 
      O     ; 
      A     DB1545.DBX   26.1; 
      A     #ComU054; 
      O     ; 
      A     DB1555.DBX   26.1; 
      A     #ComU055; 
      O     ; 
      A     DB1565.DBX   26.1; 
      A     #ComU056; 
      O     ; 
      A     DB1575.DBX   26.1; 
      A     #ComU057; 
      O     ; 
      A     DB1585.DBX   26.1; 
      A     #ComU058; 
      =     #reqAnlage; 



// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      AN    #U.Seq.User.Bit5; // FILL_REL
      ON    #U.Seq.User.Bit6; // EMPTY_REL
      AN    M    102.2; 
      =     M    102.1; 

      AN    #U.Seq.User.Bit6; // EMPTY_REL        
      JCN   N401; // GoTo Filling
      L     MW   104; 
      L     1; 
      -I    ; 
      T     MW   106; 
N401: SET   ; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y5; 
      L     1; 
      T     MW   116; 
Y5:   SET   ; 

// subphase evaluation
      L     MW   110; 
      JL    A500; 
      JU    COMM; // subphase  0:
      JU    A501; // subphase  1: Waiting
      JU    A502; // subphase  2: Active
// ---------------------------------------------------------------------------
A500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A501: SET   ; 
      A     M    103.3; 
      =     DB115.DBX   26.0; 
      R     DB115.DBX   26.4; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     #reqAnlage; 
      O     DB115.DBX  218.4; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
A502: SET   ; 
// Communication Filling
      A     #U.Seq.User.Bit2; 
      A     M    103.3; 
      =     DB115.DBX   26.1; 

      AN    DB115.DBX  218.4; 
      A     M    103.3; 
      =     DB115.DBX   26.0; 

// Communication Emptying

      A     M    103.3; 
      =     DB115.DBX   26.3; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator


// Emptying -------------
      CLR   ; 
      =     DB115.DBX   26.4; 
//KEG
      A     DB1435.DBX   26.1; 
      A     #ComU043; 
      A     M    103.3; 
      =     DB210.DBX  268.0; 

      A     DB210.DBX  268.0; 
      A     DB210.DBX  262.6; 
      S     DB115.DBX   26.4; 
      JCN   A3rm; 
      L     #ComLine; 
      L     1; 
      OW    ; 
      T     #ComLine; 
A3rm: NOP   0; 
//A5
      A     DB1455.DBX   26.1; 
      A     #ComU045; 
      A     M    103.3; 
      =     DB210.DBX  828.0; 

      A     DB210.DBX  828.0; 
      A     DB210.DBX  822.6; 
      S     DB115.DBX   26.4; 
      JCN   A5rm; 
      L     #ComLine; 
      L     2; 
      OW    ; 
      T     #ComLine; 
A5rm: NOP   0; 

//A7
      A     DB1475.DBX   26.1; 
      A     #ComU047; 
      A     M    103.3; 
      =     DB210.DBX  668.0; 

      A     DB210.DBX  668.0; 
      A     DB210.DBX  662.6; 
      S     DB115.DBX   26.4; 
      JCN   A7rm; 
      L     #ComLine; 
      L     4; 
      OW    ; 
      T     #ComLine; 
A7rm: NOP   0; 

//A9
      A     DB1495.DBX   26.1; 
      A     #ComU049; 
      A     M    103.3; 
      =     DB210.DBX  508.0; 

      A     DB210.DBX  508.0; 
      A     DB210.DBX  502.6; 
      S     DB115.DBX   26.4; 
      JCN   A9rm; 
      L     #ComLine; 
      L     8; 
      OW    ; 
      T     #ComLine; 
A9rm: NOP   0; 

//A10
      A     DB1505.DBX   26.1; 
      A     #ComU050; 
      A     M    103.3; 
      =     DB210.DBX  428.0; 

      A     DB210.DBX  428.0; 
      A     DB210.DBX  422.6; 
      S     DB115.DBX   26.4; 
      JCN   AArm; 
      L     #ComLine; 
      L     16; 
      OW    ; 
      T     #ComLine; 
AArm: NOP   0; 

//A11
      A     DB1515.DBX   26.1; 
      A     #ComU051; 
      A     M    103.3; 
      =     DB210.DBX  908.0; 

      A     DB210.DBX  908.0; 
      A     DB210.DBX  902.6; 
      S     DB115.DBX   26.4; 
      JCN   ABrm; 
      L     #ComLine; 
      L     32; 
      OW    ; 
      T     #ComLine; 
ABrm: NOP   0; 

//A12
      A     DB1525.DBX   26.1; 
      A     #ComU052; 
      A     M    103.3; 
      =     DB210.DBX  588.0; 

      A     DB210.DBX  588.0; 
      A     DB210.DBX  582.6; 
      S     DB115.DBX   26.4; 
      JCN   ACrm; 
      L     #ComLine; 
      L     64; 
      OW    ; 
      T     #ComLine; 
ACrm: NOP   0; 

//A14
      A     DB1545.DBX   26.1; 
      A     #ComU054; 
      A     M    103.3; 
      =     DB210.DBX  988.0; 

      A     DB210.DBX  988.0; 
      A     DB210.DBX  982.6; 
      S     DB115.DBX   26.4; 
      JCN   AFrm; 
      L     #ComLine; 
      L     128; 
      OW    ; 
      T     #ComLine; 
AFrm: NOP   0; 

//Frischwasser
      A     DB1565.DBX   26.1; 
      A     #ComU056; 
      A     M    103.3; 
      =     DB210.DBX  108.0; 

      A     DB210.DBX  108.0; 
      A     DB210.DBX  102.6; 
      S     DB115.DBX   26.4; 
      JCN   AXrm; 
      L     #ComLine; 
      L     256; 
      OW    ; 
      T     #ComLine; 
AXrm: NOP   0; 

//Brauhaus
      A     DB1575.DBX   26.1; 
      A     #ComU057; 
      A     M    103.3; 
      =     DB210.DBX  188.0; 

      A     DB210.DBX  188.0; 
      A     DB210.DBX  182.6; 
      S     DB115.DBX   26.4; 
      JCN   AYrm; 
      L     #ComLine; 
      L     512; 
      OW    ; 
      T     #ComLine; 
AYrm: NOP   0; 
//Sirupraum
      A     DB1585.DBX   26.1; 
      A     #ComU058; 
      A     M    103.3; 
      =     DB210.DBX  348.0; 

      A     DB210.DBX  348.0; 
      A     DB210.DBX  342.6; 
      S     DB115.DBX   26.4; 
      JCN   AZrm; 
      L     #ComLine; 
      L     1024; 
      OW    ; 
      T     #ComLine; 
AZrm: NOP   0; 


      A     #ComSRC; 
      A     DB115.DBX  218.4; 
      A     M    103.3; 
      =     #ReqInlet; 

// -------------------------------------------------
// subphase transition 
      AN    #reqAnlage; 
      AN    DB115.DBX  218.4; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 8: Emptying 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 04 : Delay Empty                         Duration        s
// 17 : Level                               Value           l
X8:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      A     M    102.3; 
      S     DB115.DBX   26.3; 

      A     M    152.1; // Befllfreigabe
      A     M    102.3; 
      S     DB115.DBX   26.0; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.3; 
      S     M    140.3; // Delay Empty

// ---------------------------------------------------------------------------
// communication
      A     DB1435.DBX   26.1; 
      A     #ComU043; 
      O     ; 
      A     DB1455.DBX   26.1; 
      A     #ComU045; 
      O     ; 
      A     DB1475.DBX   26.1; 
      A     #ComU047; 
      O     ; 
      A     DB1485.DBX   26.1; 
      A     #ComU048; 
      O     ; 
      A     DB1495.DBX   26.1; 
      A     #ComU049; 
      O     ; 
      A     DB1505.DBX   26.1; 
      A     #ComU050; 
      O     ; 
      A     DB1515.DBX   26.1; 
      A     #ComU051; 
      O     ; 
      A     DB1525.DBX   26.1; 
      A     #ComU052; 
      O     ; 
      A     DB1545.DBX   26.1; 
      A     #ComU054; 
      O     ; 
      A     DB1555.DBX   26.1; 
      A     #ComU055; 
      O     ; 
      A     DB1565.DBX   26.1; 
      A     #ComU056; 
      O     ; 
      A     DB1575.DBX   26.1; 
      A     #ComU057; 
      O     ; 
      A     DB1585.DBX   26.1; 
      A     #ComU058; 
      =     #reqAnlage; 


// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #U.Seq.User.Bit5; // FILL_REL
      A     DB115.DBX  218.3; 
      AN    M    102.2; 
      =     M    102.1; 
      JCN   N501; 
      L     MW   104; 
      L     1; // Return to Production
      -I    ; 
      T     MW   106; 
N501: NOP   0; 

      AN    #U.Seq.User.Bit6; // EMPTY_REL
      A     #U.Seq.User.Bit5; // FILL_REL
      AN    M    102.2; 
      S     M    102.1; 
      JCN   N502; 
      L     MW   104; 
      L     2; // Return to Filling
      -I    ; 
      T     MW   106; 
N502: NOP   0; 


// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y8; 
      L     1; 
      T     MW   116; 
Y8:   SET   ; 

// subphase evaluation
      L     MW   110; 
      JL    A800; 
      JU    COMM; // subphase  0:
      JU    A801; // subphase  1: Waiting
      JU    A802; // subphase  2: Active
// ---------------------------------------------------------------------------
A800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A801: SET   ; 
      A     M    103.0; 
      R     DB115.DBX   26.4; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     #reqAnlage; 
//      AN    "C01SpiD".LABOR_FREIG_T13.Sig
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
A802: SET   ; 
      A     M    103.0; 
      =     DB115.DBX   26.4; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
// Emptying -------------
      CLR   ; 
      =     DB115.DBX   26.4; 
//KEG
      A     DB1435.DBX   26.1; 
      A     #ComU043; 
      A     M    103.3; 
      =     DB210.DBX  268.0; 

      A     DB210.DBX  268.0; 
      A     DB210.DBX  262.6; 
      S     DB115.DBX   26.4; 
      JCN   A3rn; 
      L     #ComLine; 
      L     1; 
      OW    ; 
      T     #ComLine; 
A3rn: NOP   0; 
//A5
      A     DB1455.DBX   26.1; 
      A     #ComU045; 
      A     M    103.3; 
      =     DB210.DBX  828.0; 

      A     DB210.DBX  828.0; 
      A     DB210.DBX  822.6; 
      S     DB115.DBX   26.4; 
      JCN   A5rn; 
      L     #ComLine; 
      L     2; 
      OW    ; 
      T     #ComLine; 
A5rn: NOP   0; 

//A7
      A     DB1475.DBX   26.1; 
      A     #ComU047; 
      A     M    103.3; 
      =     DB210.DBX  668.0; 

      A     DB210.DBX  668.0; 
      A     DB210.DBX  662.6; 
      S     DB115.DBX   26.4; 
      JCN   A7rn; 
      L     #ComLine; 
      L     4; 
      OW    ; 
      T     #ComLine; 
A7rn: NOP   0; 

//A9
      A     DB1495.DBX   26.1; 
      A     #ComU049; 
      A     M    103.3; 
      =     DB210.DBX  508.0; 

      A     DB210.DBX  508.0; 
      A     DB210.DBX  502.6; 
      S     DB115.DBX   26.4; 
      JCN   A9rn; 
      L     #ComLine; 
      L     8; 
      OW    ; 
      T     #ComLine; 
A9rn: NOP   0; 

//A10
      A     DB1505.DBX   26.1; 
      A     #ComU050; 
      A     M    103.3; 
      =     DB210.DBX  428.0; 

      A     DB210.DBX  428.0; 
      A     DB210.DBX  422.6; 
      S     DB115.DBX   26.4; 
      JCN   AArn; 
      L     #ComLine; 
      L     16; 
      OW    ; 
      T     #ComLine; 
AArn: NOP   0; 

//A11
      A     DB1515.DBX   26.1; 
      A     #ComU051; 
      A     M    103.3; 
      =     DB210.DBX  908.0; 

      A     DB210.DBX  908.0; 
      A     DB210.DBX  902.6; 
      S     DB115.DBX   26.4; 
      JCN   ABrn; 
      L     #ComLine; 
      L     32; 
      OW    ; 
      T     #ComLine; 
ABrn: NOP   0; 

//A12
      A     DB1525.DBX   26.1; 
      A     #ComU052; 
      A     M    103.3; 
      =     DB210.DBX  588.0; 

      A     DB210.DBX  588.0; 
      A     DB210.DBX  582.6; 
      S     DB115.DBX   26.4; 
      JCN   ACrn; 
      L     #ComLine; 
      L     64; 
      OW    ; 
      T     #ComLine; 
ACrn: NOP   0; 

//A14
      A     DB1545.DBX   26.1; 
      A     #ComU054; 
      A     M    103.3; 
      =     DB210.DBX  988.0; 

      A     DB210.DBX  988.0; 
      A     DB210.DBX  982.6; 
      S     DB115.DBX   26.4; 
      JCN   AFrn; 
      L     #ComLine; 
      L     128; 
      OW    ; 
      T     #ComLine; 
AFrn: NOP   0; 

//Frischwasser
      A     DB1565.DBX   26.1; 
      A     #ComU056; 
      A     M    103.3; 
      =     DB210.DBX  108.0; 

      A     DB210.DBX  108.0; 
      A     DB210.DBX  102.6; 
      S     DB115.DBX   26.4; 
      JCN   AXrn; 
      L     #ComLine; 
      L     256; 
      OW    ; 
      T     #ComLine; 
AXrn: NOP   0; 

//Brauhaus
      A     DB1575.DBX   26.1; 
      A     #ComU057; 
      A     M    103.3; 
      =     DB210.DBX  188.0; 

      A     DB210.DBX  188.0; 
      A     DB210.DBX  182.6; 
      S     DB115.DBX   26.4; 
      JCN   AYrn; 
      L     #ComLine; 
      L     512; 
      OW    ; 
      T     #ComLine; 
AYrn: NOP   0; 
//Sirupraum
      A     DB1585.DBX   26.1; 
      A     #ComU058; 
      A     M    103.3; 
      =     DB210.DBX  348.0; 

      A     DB210.DBX  348.0; 
      A     DB210.DBX  342.6; 
      S     DB115.DBX   26.4; 
      JCN   AZrn; 
      L     #ComLine; 
      L     1024; 
      OW    ; 
      T     #ComLine; 
AZrn: NOP   0; 


// -------------------------------------------------
// subphase transition 
      AN    #reqAnlage; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 20: Quality Check 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 39 : Q-Status                            Enumeration     min
X20:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: Q-Status
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[39].Sp,
           Indexes                  := #S2I.SFM39);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C000; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 21: Prepare Tank 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 17 : Level                               Value           l
X21:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 

      CLR   ; 
      =     DB211.DBX  503.1; // Filling Hand Valve
      =     DB211.DBX  623.1; // CIP Hand Valve

      A     M    102.3; 
      =     DB211.DBX  503.0; // Filling Hand Valve
      =     DB211.DBX  623.0; // CIP Hand Valve

// ---------------------------------------------------------------------------
// transition condition 
      AN    DB211.DBX  498.7; // Filling Hand Valve
      AN    DB211.DBX  618.7; // CIP Hand Valve
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 23: Connect Tank 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X23:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C300; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 31: CIP Start 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X31:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y31
//      L     1
//      T     "SOSubStepNew"
//Y31:  SET

// subphase evaluation
      L     MW   110; 
      JL    D100; 
      JU    COMM; // subphase  0:
      JU    D101; // subphase  1: Wait For CIP
      JU    D102; // subphase  2: Wait For Partner
// ---------------------------------------------------------------------------
D100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Wait For CIP
D101: SET   ; 

// -------------------------------------------------
// CIP Signals ---
// Start Signal
      A     M    120.0; 
      A     M    103.3; 
      =     DB115.DBX  172.4; 
      JCN   CIPS; 
      L     MD   124; 
      T     DB502.DBD    0; 
      T     DB502.DBD  156; 
CIPS: NOP   0; 

// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
// CIP Ready
      A     #ComCIP; 
      A     DB115.DBX  123.5; 
      A     DB115.DBX  120.0; 
// CIP Distribution Ready 
      A     #ComCIPDist; 
      A     DB1945.DBX   27.5; 
      A     DB1945.DBX   24.0; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Wait For Partner
D102: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 32: CIP Prerun 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 04 : Delay Level                         Duration        s
// 15 : Amount                              Value           m3
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
X32:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// CIP Unit
      AN    #ComCIP; 
      ON    DB115.DBX  123.4; 
      ON    DB115.DBX  123.5; 
      JCN   x321; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x321: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB1945.DBX   27.4; 
      ON    DB1945.DBX   27.5; 
      JCN   x322; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x322: NOP   0; 

// CIP Signals ---
      L     #U.Seq.SFM[17].Sp; 
      L     0.000000e+000; 
      <=R   ; 
      O     M    152.0; 
      =     #xTmp; 
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB211.DBX   78.7,
           EmptyLevel               := #xTmp,
           CIPPumpRun               := DB115.DBX  124.3,
           CIPReady                 := DB115.DBX  123.5,
           Empty                    := DB115.DBX   26.5,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB115.DBX  171.4; 
      =     DB115.DBX  172.6; 
      =     DB115.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB115.DBX  171.5; 

// Prerun Pump
      A     DB115.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB115.DBX  173.3; 

// Return Pump
      AN    DB115.DBX   26.5; 
      A     #RRel; 
      =     DB115.DBX  173.4; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     M    102.0; 
      =     DB210.DBX 1228.0; 
      =     DB210.DBX 2268.0; 

      A     M    102.3; 
      =     DB210.DBX 1148.0; 

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"

// subphase evaluation
      L     MW   110; 
      JL    D200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 33: CIP Return 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 04 : Delay Level                         Duration        s
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 26 : CIP Step On Condition               Enumeration     min
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
X33:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Step On Condition
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[26].Sp,
           Indexes                  := #S2I.SFM26);

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// CIP Unit
      AN    #ComCIP; 
      ON    DB115.DBX  123.4; 
      ON    DB115.DBX  123.5; 
      JCN   x331; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x331: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB1945.DBX   27.4; 
      ON    DB1945.DBX   27.5; 
      JCN   x332; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x332: NOP   0; 

// CIP Signals ---
      L     #U.Seq.SFM[17].Sp; 
      L     0.000000e+000; 
      <=R   ; 
      O     M    152.0; 
      =     #xTmp; 

      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB211.DBX   78.7,
           EmptyLevel               := #xTmp,
           CIPPumpRun               := DB115.DBX  124.3,
           CIPReady                 := DB115.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB115.DBX  171.4; 
      =     DB115.DBX  172.6; 
      =     DB115.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB115.DBX  171.5; 

// Prerun Pump
      A     DB115.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB115.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      =     DB115.DBX  173.4; 

// Bypass Valve
      A     M    102.3; 
      =     DB115.DBX  173.5; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     M    102.0; 
      =     DB210.DBX 2268.0; 

// Bypass Valve Used in CIP Distribution
//      A     "SOPA"
//      =     "C01ActD".RV1_T13.ACo

//      A     "SOPH"
//      =     "C01ActD".T13_RR1.ACo

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"

// subphase evaluation
      L     MW   110; 
      JL    D300; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 34: CIP Rinsing 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 04 : Delay Level                         Duration        s
// 05 : Substep Time                        Duration        s
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
// 59 : Interval Counter                    Value           No.
X34:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// CIP Unit
      AN    #ComCIP; 
      ON    DB115.DBX  123.4; 
      ON    DB115.DBX  123.5; 
      JCN   x341; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x341: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB1945.DBX   27.4; 
      ON    DB1945.DBX   27.5; 
      JCN   x342; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x342: NOP   0; 

// CIP Signals ---
      L     #U.Seq.SFM[17].Sp; 
      L     0.000000e+000; 
      <=R   ; 
      O     M    152.0; 
      =     #xTmp; 

      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB211.DBX   78.7,
           EmptyLevel               := #xTmp,
           CIPPumpRun               := DB115.DBX  124.3,
           CIPReady                 := DB115.DBX  123.5,
           Empty                    := DB115.DBX   26.5,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB115.DBX  171.4; 
      =     DB115.DBX  172.6; 
      =     DB115.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB115.DBX  171.5; 

// Prerun Pump
      A     DB115.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB115.DBX  173.3; 

// Return Pump
      AN    DB115.DBX   26.5; 
      A     #RRel; 
      =     DB115.DBX  173.4; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     M    102.0; 
      =     DB210.DBX 1228.0; 
      =     DB210.DBX 2268.0; 

      A     M    102.3; 
      =     DB210.DBX 1148.0; 

// ---------------------------------------------------------------------------
// transition condition (Check CIPUnitC)
//      A     #SubStepMaxD
//      =     "SOPD"

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y34; 
      L     1; 
      T     MW   116; 
Y34:  NOP   0; 

      A     #SubStepMax; 
      AN    M    103.0; 
      JCN   Y34a; 
      L     #U.Seq.SFM[59].Val; // Increment Interval Counter
      L     1.000000e+000; 
      +R    ; 
      T     #U.Seq.SFM[59].Val; 
Y34a: SET   ; 
      A     M    102.2; 
      ON    M    102.0; 
      JCN   IntR; // Reset Interval Counter at Start and End Of Phase
      L     0.000000e+000; 
      T     #U.Seq.SFM[59].Val; 
IntR: NOP   0; 

// subphase evaluation
      L     MW   110; 
      JL    D400; 
      JU    COMM; // subphase  0:
      JU    D401; // subphase  1: Pause
      JU    D402; // subphase  2: Main
      JU    D403; // subphase  3: Expulse
      JU    D404; // subphase  4: Seat Lift
      JU    D400; // subphase  5:
      JU    D406; // subphase  6: Shaft Rinse
      JU    D407; // subphase  7: Drain
// ---------------------------------------------------------------------------
D400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Pause
D401: SET   ; 
      A     M    103.0; 
      R     DB115.DBX  173.3; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
      A     M    150.3; // Delay Level
      A     M    130.3; 
      O     M    150.4; // Substep Time Done
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Main
D402: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done   
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Expulse
D403: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Seat Lift
D404: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 6: Shaft Rinse
D406: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 7: Drain
D407: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 35: CIP Emptying 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 04 : Delay Empty                         Duration        s
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 26 : Step On Empty                       Enumeration     min
// 28 : CIP Return                          Enumeration     min
X35:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: Step On Empty
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[26].Sp,
           Indexes                  := #S2I.SFM26);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// CIP Unit
      AN    #ComCIP; 
      ON    DB115.DBX  123.4; 
      ON    DB115.DBX  123.5; 
      JCN   x351; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x351: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB1945.DBX   27.4; 
      ON    DB1945.DBX   27.5; 
      JCN   x352; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x352: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB211.DBX   78.7,
           EmptyLevel               := M    152.0,
           CIPPumpRun               := DB115.DBX  124.3,
           CIPReady                 := DB115.DBX  123.5,
           Empty                    := DB115.DBX   26.5,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB115.DBX  171.4; 
      =     DB115.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB115.DBX  171.5; 

// Prerun Pump
      A     DB115.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      CLR   ; 
      =     DB115.DBX  173.3; 

// Return Pump
      AN    DB115.DBX   26.5; 
      A     #RRel; 
      =     DB115.DBX  173.4; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     M    102.0; 
      =     DB210.DBX 1228.0; 
      =     DB210.DBX 2268.0; 

      A     M    102.3; 
      =     DB210.DBX 1148.0; 

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"


// subphase evaluation
      L     MW   110; 
      JL    D500; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 36: CIP Drain 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        Min
// 04 : Delay Empty                         Duration        #sec
X36:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.3; 
      S     M    140.3; // Delay Empty

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    D600; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D600: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 40: CIP End 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X40:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   110 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 
// ---------------------------------------------------------------------------
// general functions 
//      AN    "SOSTAl"
      A     M    102.3; 
      =     #RRel; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := 0.000000e+000,
           EmptySig                 := FALSE,
           EmptyLevel               := FALSE,
           CIPPumpRun               := FALSE,
           CIPReady                 := FALSE,
           Empty                    := #xTmp,
           TransCondOK              := #xTmp,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      =     DB115.DBX  173.7; 

// ---------------------------------------------------------------------------
// transition condition 
      AN    #ComCIP; 
      AN    #ComCIPDist; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    E000; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
E000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// pause timer unit parameter

// Laborfreigabe 
      A     DB211.DBX  678.7; 
      AN    #CIP; 
      O     DB211.DBX   78.7; 
      R     DB115.DBX   26.3; 
      R     DB115.DBX   26.4; 

      AN    DB211.DBX  138.7; 
      R     DB115.DBX   26.0; 
      R     DB115.DBX   26.1; 

// Line Communication
      L     #ComLine; 
      T     DB115.DBD   50; 

NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  
// Inlet Control
      L     DB115.DBW  208; 
      L     29; // B6F 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1308.0; 

      L     DB115.DBW  208; 
      L     30; // H6 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1388.0; 

      L     DB115.DBW  208; 
      L     31; // J6 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1468.0; 

      L     DB115.DBW  208; 
      L     32; // L6F
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1548.0; 

      L     DB115.DBW  208; 
      L     34; // D6
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1628.0; 

      L     DB115.DBW  208; 
      L     33; // B6
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1708.0; 

      L     DB115.DBW  208; 
      L     25; // A 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1788.0; 

      L     DB115.DBW  208; 
      L     26; // B 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1868.0; 

      L     DB115.DBW  208; 
      L     27; //CF 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 1948.0; 

      L     DB115.DBW  208; 
      L     28; // C1 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 2028.0; 

      L     DB115.DBW  208; 
      L     21; // VE1 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 2188.0; 

      L     DB115.DBW  208; 
      L     22; // VE2 
      ==I   ; 
      A     #ReqInlet; 
      =     DB210.DBX 2108.0; 

      A     DB210.DBX 1302.6; 
      O     DB210.DBX 1382.6; 
      O     DB210.DBX 1462.6; 
      O     DB210.DBX 1542.6; 
      O     DB210.DBX 1622.6; 
      O     DB210.DBX 1702.6; 
      O     DB210.DBX 1782.6; 
      O     DB210.DBX 1862.6; 
      O     DB210.DBX 1942.6; 
      O     DB210.DBX 2022.6; 
      O     DB210.DBX 2102.6; 
      O     DB210.DBX 2182.6; 
      =     #U.Seq.User.Bit2; 

NETWORK
TITLE =Process Status Management

      NOP   0; 
// ---------------------------------------------------------------------------
// Signal Control
      OPN   DB   500; 
      L     #UnitNo; 
      L     32; //U Structure Length
      *I    ; 
      L     20; //DB Heading Offset
      +I    ; 
      SLD   3; 
      LAR2  ; 

// -------------------------------------------------
// Maintenance
      A     #U.Seq.Switch.Sw31; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.0]; //"PStatD".U[#UnitNo].MTNC
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
      A     DB115.DBX   26.2; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.7]; //"PStatD".U[#UnitNo].FULL
// -------------------------------------------------
// Filling
      A     DB115.DBX   26.1; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.0]; //"PStatD".U[#UnitNo].FILL   
// -------------------------------------------------
// Ready For Filling
      A     DB115.DBX   26.0; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.1]; //"PStatD".U[#UnitNo].RFFI 
// -------------------------------------------------
// Empty
      A     DB115.DBX   26.5; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.2]; //"PStatD".U[#UnitNo].EMTY 
// -------------------------------------------------
// Emptying
      A     DB115.DBX   26.4; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.3]; //"PStatD".U[#UnitNo].EMTI
// -------------------------------------------------
// Ready For Emptying
      A     DB115.DBX   26.3; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.4]; //"PStatD".U[#UnitNo].RFEM
// -------------------------------------------------
// Reserved
//      A     #ComXYZ
//      OPN   "PStatD"
//      =     DBX [AR2,P#1.5]             //"PStatD".U[#UnitNo].RESV
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used

// -------------------------------------------------
// PStat Function Call 

      CALL FC   500 (
           UnitNo                   := #UnitNo,
           PStatModVal              := DB215.DBD  234);


NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 113
TITLE =C01: Water Tank x 
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C01E
VERSION : 1.2
CODE_VERSION1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
  ComCIP1 : BOOL ;	//CIP1 in use
  ComCIP3 : BOOL ;	//CIP3 in use
  LabRel : BOOL ;	//Laborfreigabe
END_VAR
BEGIN
NETWORK
TITLE =General


      SET   ; 
// Simulation ---------------------------------------------------------------
      A     #U.Seq.User.Bit63; 
      CC    FB   119; 
      A     #U.Seq.Sim; 
      =     #U.Seq.User.Bit63; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     MB   112; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB115.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    #U.Seq.Switch.Sw31; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   115; 

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// LI_T13 Niveau Tank 13
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB213.DBD  238; 

//      CLR   
//      =     "C01AniD".LI_T13.EAlHH

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C01UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000
//      T     "C01UnVD".unv002.ValExt

      A     M    101.3; 
      JCN   STG1; 
      L     DB213.DBD  146; 
      L     #U.Seq.User.Real11; 
      -R    ; 
      L     6.000000e+002; 
      *R    ; 
      T     #rTmp; 
      L     DB215.DBD  362; 
      L     1.000000e+002; 
      *R    ; 
      L     #rTmp; 
      +R    ; 
      L     1.010000e+002; 
      /R    ; 
      JO    STG1; 
      T     DB215.DBD  362; 
      L     DB213.DBD  146; 
      T     #U.Seq.User.Real11; 
STG1: NOP   0; 

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C01UnVD".unv003.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LLL_T13 LS- Tank 13
// ----------------------------------------------------------
      CLR   ; 
      =     DB211.DBX   81.4; 
      CLR   ; 
      =     DB211.DBX   81.5; 


// ----------------------------------------------------------
// LS_HL_T13 LS+ Tank 13
// ----------------------------------------------------------
      CLR   ; // Used to stop Filling   
      =     DB211.DBX  141.4; 
      =     DB211.DBX  141.5; 

// ----------------------------------------------------------
// GOA_T13_ML Mannloch Tank 13
// ----------------------------------------------------------
      SET   ; 
      =     DB211.DBX  201.4; 
      =     DB211.DBX  201.5; 

// ----------------------------------------------------------
// U13_SpI04 spare
// ----------------------------------------------------------
      CLR   ; 
      =     DB211.DBX  261.4; 
      =     DB211.DBX  261.5; 

// ----------------------------------------------------------
// LS_LL_T13 LS/ Tank 13
// ----------------------------------------------------------
      CLR   ; 
      =     DB211.DBX  321.4; 
      CLR   ; 
      =     DB211.DBX  321.5; 


// ----------------------------------------------------------
// RM_NI_T13_K4_AUF 
// ----------------------------------------------------------
      AN    #U.Seq.Step0; 
      =     DB211.DBX  381.4; 

      AN    #CIP; 
      =     DB211.DBX  381.5; 


// ----------------------------------------------------------
// RM_NI_T13_K4_ZU 
// ----------------------------------------------------------
      AN    #U.Seq.Step0; 
      =     DB211.DBX  441.4; 

      A     #U.Seq.Step0; 
      O     #CIP; 
      =     DB211.DBX  441.5; 

// ----------------------------------------------------------
// RM_NI_T13_K2 
// ----------------------------------------------------------
      AN    #U.Seq.Step0; 
      =     DB211.DBX  501.4; 

      A     #CIP; 
      AN    #U.Seq.Step0; 
      =     DB211.DBX  501.5; 

// ----------------------------------------------------------
// U13_SpI009 spare
// ----------------------------------------------------------
      CLR   ; 
      =     DB211.DBX  561.4; 
      =     DB211.DBX  561.5; 

// ----------------------------------------------------------
// RM_NI_T13_K3 
// ----------------------------------------------------------
      A     #CIP; 
      AN    #U.Seq.Step0; 
      =     DB211.DBX  621.4; 
      SET   ; 
      =     DB211.DBX  621.5; 

// ----------------------------------------------------------
// LABOR_FREIG_T13 SCHLUESSELSCHALTER LABOR
// ----------------------------------------------------------
      CLR   ; 
      =     DB211.DBX  681.4; 
      =     DB211.DBX  681.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB217.DBX   80.7; 
      =     DB217.DBX   81.4; 

      CLR   ; 
      =     DB217.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB217.DBX  140.7; 
      =     DB217.DBX  141.4; 

      CLR   ; 
      =     DB217.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

// SFM supply ----------------------------------------------------------------

// analog value to SFM Niveau Tank 13 -----------------------
      L     DB213.DBD  146; 
      T     #U.Seq.SFM[17].Val; 

// Offset Level
      L     #U.Seq.Prop.Val1; 
      L     DB213.DBD  146; 
      -R    ; 
      T     #U.Seq.SFM[18].Val; 

// Offset Level Emptying  
      L     DB213.DBD  146; 
      T     #U.Seq.SFM[19].Val; 


NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB210.DBX  105.4; 
      =     DB210.DBX  185.4; 
      =     DB210.DBX  265.4; 
      =     DB210.DBX  345.4; 
      =     DB210.DBX  425.4; 
      =     DB210.DBX  505.4; 
      =     DB210.DBX  585.4; 
      =     DB210.DBX  665.4; 
      =     DB210.DBX  745.4; 
      =     DB210.DBX  825.4; 
      =     DB210.DBX  905.4; 
      =     DB210.DBX  985.4; 
      =     DB210.DBX 1065.4; 
      =     DB210.DBX 1145.4; 
      =     DB210.DBX 1225.4; 
      =     DB210.DBX 1305.4; 
      =     DB210.DBX 1385.4; 
      =     DB210.DBX 1465.4; 
      =     DB210.DBX 1545.4; 
      =     DB210.DBX 1625.4; 
      =     DB210.DBX 1705.4; 
      =     DB210.DBX 1785.4; 
      =     DB210.DBX 1865.4; 
      =     DB210.DBX 1945.4; 
      =     DB210.DBX 2025.4; 
      =     DB210.DBX 2105.4; 
      =     DB210.DBX 2185.4; 
      =     DB210.DBX 2265.4; 
      =     DB210.DBX 2345.4; 
      =     DB210.DBX 2425.4; 
      =     DB210.DBX 2505.4; 



MODE: SET   ; 

      AN    DB211.DBX  678.7; 
      O     #CIP; 
      =     #LabRel; 

NETWORK
TITLE =U13_Act001 spare

      AN    #CIP; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  106.7; 
      =     DB210.DBX  107.6; 
NETWORK
TITLE =U13_Act002 spare

      AN    #CIP; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  186.7; 
      =     DB210.DBX  187.6; 
NETWORK
TITLE =U13_Act003 spare

      AN    #CIP; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  266.7; 
      =     DB210.DBX  267.6; 
NETWORK
TITLE =U13_Act004 spare

      AN    #CIP; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  346.7; 
      =     DB210.DBX  347.6; 

NETWORK
TITLE =T13_A10 

      AN    DB115.DBX   27.1; 
      AN    DB1505.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  426.7; 
      =     DB210.DBX  427.6; 
NETWORK
TITLE =T13_A9 

      AN    DB115.DBX   27.1; 
      AN    DB1495.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  506.7; 
      =     DB210.DBX  507.6; 
NETWORK
TITLE =T13_A12 

      AN    DB115.DBX   27.1; 
      AN    DB1525.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  586.7; 
      =     DB210.DBX  587.6; 
NETWORK
TITLE =T13_A7 

      AN    DB115.DBX   27.1; 
      AN    DB1475.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  666.7; 
      =     DB210.DBX  667.6; 
NETWORK
TITLE =T13_A8 

      AN    DB115.DBX   27.1; 
      AN    DB1485.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  746.7; 
      =     DB210.DBX  747.6; 
NETWORK
TITLE =T13_A5 


      AN    DB115.DBX   27.1; 
      AN    DB1455.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  826.7; 
      =     DB210.DBX  827.6; 
NETWORK
TITLE =T13_A11 

      AN    DB115.DBX   27.1; 
      AN    DB1515.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  906.7; 
      =     DB210.DBX  907.6; 
NETWORK
TITLE =T13_A14 

      AN    DB115.DBX   27.1; 
      AN    DB1545.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX  986.7; 
      =     DB210.DBX  987.6; 

NETWORK
TITLE =T13_A15 

      AN    DB115.DBX   27.1; 
      AN    DB1555.DBX   27.1; 

      AN    DB210.DBX 1142.6; 
      A     #LabRel; 
      A     #GenRel; 
      A     DB210.DBX 1066.7; 
      =     DB210.DBX 1067.6; 
NETWORK
TITLE =T13_RR1 

      A     DB115.DBX   27.1; 
      O     DB115.DBX   24.7; 
      A     #GenRel; 
      A     DB210.DBX 1146.7; 
      =     DB210.DBX 1147.6; 
NETWORK
TITLE =RV1_T13 

      A     DB115.DBX   27.1; 
      O     DB115.DBX   24.7; 

      A     #GenRel; 
      A     DB210.DBX 1226.7; 
      =     DB210.DBX 1227.6; 
NETWORK
TITLE =B6F_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1295.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1306.7; 
      =     DB210.DBX 1307.6; 
NETWORK
TITLE =H6F_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1305.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1386.7; 
      =     DB210.DBX 1387.6; 
NETWORK
TITLE =J6F_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1315.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1466.7; 
      =     DB210.DBX 1467.6; 
NETWORK
TITLE =L6F_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1325.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1546.7; 
      =     DB210.DBX 1547.6; 
NETWORK
TITLE =D6_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1345.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1626.7; 
      =     DB210.DBX 1627.6; 
NETWORK
TITLE =B6_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1335.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1706.7; 
      =     DB210.DBX 1707.6; 
NETWORK
TITLE =A_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1255.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1786.7; 
      =     DB210.DBX 1787.6; 
NETWORK
TITLE =B_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1265.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1866.7; 
      =     DB210.DBX 1867.6; 
NETWORK
TITLE =CF_T13 

      AN    DB115.DBX   27.1; 
      AN    DB1275.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 1946.7; 
      =     DB210.DBX 1947.6; 
NETWORK
TITLE =U13_Act025 spare

      AN    DB115.DBX   27.1; 
      AN    DB1285.DBX   27.1; 

      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 2026.7; 
      =     DB210.DBX 2027.6; 
NETWORK
TITLE =RW5_T13 


      AN    DB115.DBX   27.1; 
      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 2106.7; 
      =     DB210.DBX 2107.6; 
NETWORK
TITLE =RW6_T13 

      AN    DB115.DBX   27.1; 
      A     DB211.DBX  138.7; 

      A     #GenRel; 
      A     DB210.DBX 2186.7; 
      =     DB210.DBX 2187.6; 
NETWORK
TITLE =VVT13 Vacuumventil Tank 13

      A     #GenRel; 
      A     DB210.DBX 2266.7; 
      =     DB210.DBX 2267.6; 
NETWORK
TITLE =VR_T13 

      A     #GenRel; 
      A     DB210.DBX 2346.7; 
      =     DB210.DBX 2347.6; 
NETWORK
TITLE =ML_LABORFREIGABE_T13 

      A     #GenRel; 
      A     DB210.DBX 2426.7; 
      =     DB210.DBX 2427.6; 
NETWORK
TITLE =U13_Act031 spare

      A     DB211.DBX  678.7; 
      =     DB210.DBX 2508.2; 

      A     #GenRel; 
      A     DB210.DBX 2506.7; 
      =     DB210.DBX 2507.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 115
TITLE =C01: Water Tank x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C01Comm
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EqID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	//CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
  rUnitNo : REAL ;	
  DSTUnit : INT ;	//Destination Unit
  SRCUnit : INT ;	
  STBYUnit : INT ;	
  rEqID : REAL ;	
  dst0 : BOOL ;	//No Destination Selected
  comDST : BOOL ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

      L     DB115.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EqID; 

      L     #EqID; 
      ITD   ; 
      DTR   ; 
      T     #rEqID; 


// CIP ----------------------------------------------------------------------
      L     DB115.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB115.DBD   10; 
      L     DB115.DBD  106; 
      ==D   ; 
      =     #ComCIP; 


NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL SFC   20 (
           SRCBLK                   := DB1995.Own,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB115.GEN);

// emergency OK -------------------------------------------------------------
      A     DB115.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

// ... CIP Unit ------------- /

      CALL SFC   20 (
           SRCBLK                   := DB1915.Own,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB115.CIP);



      JU    next; 

      L     0; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB115.SRC);


      L     DB1215.DBD   38; 
      L     #rEqID; 
      ==R   ; 
      O(    ; 
      L     DB1215.DBD   42; 
      L     #rEqID; 
      ==R   ; 
      )     ; 
      O(    ; 
      L     DB1215.DBD   46; 
      L     #rEqID; 
      ==R   ; 
      )     ; 
      =     #xTmp; 

      L     DB1215.DBD   30; 
      L     DB115.DBD   30; 
      ==R   ; 
      O     M    120.7; 
      A     #xTmp; 
      JCN   N021; 
      CALL SFC   20 (
           SRCBLK                   := DB1215.Own,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB115.SRC);

N021: NOP   0; 

next: NOP   0; 




















//----------------------------------------
// Communication Well Transfer 
//----------------------------------------
      A     #U.Seq.Step0; 
      JCN   REM1; 
      L     0.000000e+000; 
      T     #U.Seq.User.Real1; 
REM1: NOP   0; 

      L     #U.Seq.User.Real1; 
      L     0.000000e+000; 
      ==R   ; 
      =     #xTmp; 

      JCN   CPY1; 


// Priority 1
      L     #rEqID; 
      L     DB1215.DBD   38; 
      ==R   ; 
      JCN   U021; 
      L     3.021000e+003; 
      JU    SRC1; 
U021: NOP   0; 
      L     #rEqID; 
      L     DB1225.DBD   38; 
      ==R   ; 
      JCN   U022; 
      L     3.022000e+003; 
      JU    SRC1; 
U022: NOP   0; 
      L     #rEqID; 
      L     DB1255.DBD   38; 
      ==R   ; 
      JCN   U025; 
      L     3.025000e+003; 
      JU    SRC1; 
U025: NOP   0; 
      L     #rEqID; 
      L     DB1265.DBD   38; 
      ==R   ; 
      JCN   U026; 
      L     3.026000e+003; 
      JU    SRC1; 
U026: NOP   0; 
      L     #rEqID; 
      L     DB1275.DBD   38; 
      ==R   ; 
      JCN   U027; 
      L     3.027000e+003; 
      JU    SRC1; 
U027: NOP   0; 
      L     #rEqID; 
      L     DB1285.DBD   38; 
      ==R   ; 
      JCN   U028; 
      L     3.028000e+003; 
      JU    SRC1; 
U028: NOP   0; 
      L     #rEqID; 
      L     DB1295.DBD   38; 
      ==R   ; 
      JCN   U029; 
      L     3.029000e+003; 
      JU    SRC1; 
U029: NOP   0; 
      L     #rEqID; 
      L     DB1305.DBD   38; 
      ==R   ; 
      JCN   U030; 
      L     3.000000e+001; 
      JU    SRC1; 
U030: NOP   0; 
      L     #rEqID; 
      L     DB1315.DBD   38; 
      ==R   ; 
      JCN   U031; 
      L     3.031000e+003; 
      JU    SRC1; 
U031: NOP   0; 
      L     #rEqID; 
      L     DB1325.DBD   38; 
      ==R   ; 
      JCN   U032; 
      L     3.032000e+003; 
      JU    SRC1; 
U032: NOP   0; 
      L     #rEqID; 
      L     DB1335.DBD   38; 
      ==R   ; 
      JCN   U033; 
      L     3.033000e+003; 
      JU    SRC1; 
U033: NOP   0; 
      L     #rEqID; 
      L     DB1345.DBD   38; 
      ==R   ; 
      JCN   U034; 
      L     3.034000e+003; 
      JU    SRC1; 
U034: NOP   0; 


// Priority 2
      L     #rEqID; 
      L     DB1215.DBD   42; 
      ==R   ; 
      JCN   O021; 
      L     3.021000e+003; 
      JU    SRC1; 
O021: NOP   0; 
      L     #rEqID; 
      L     DB1225.DBD   42; 
      ==R   ; 
      JCN   O022; 
      L     3.022000e+003; 
      JU    SRC1; 
O022: NOP   0; 
      L     #rEqID; 
      L     DB1255.DBD   42; 
      ==R   ; 
      JCN   O025; 
      L     3.025000e+003; 
      JU    SRC1; 
O025: NOP   0; 
      L     #rEqID; 
      L     DB1265.DBD   42; 
      ==R   ; 
      JCN   O026; 
      L     3.026000e+003; 
      JU    SRC1; 
O026: NOP   0; 
      L     #rEqID; 
      L     DB1275.DBD   42; 
      ==R   ; 
      JCN   O027; 
      L     3.027000e+003; 
      JU    SRC1; 
O027: NOP   0; 
      L     #rEqID; 
      L     DB1285.DBD   42; 
      ==R   ; 
      JCN   O028; 
      L     3.028000e+003; 
      JU    SRC1; 
O028: NOP   0; 
      L     #rEqID; 
      L     DB1295.DBD   42; 
      ==R   ; 
      JCN   O029; 
      L     3.029000e+003; 
      JU    SRC1; 
O029: NOP   0; 
      L     #rEqID; 
      L     DB1305.DBD   42; 
      ==R   ; 
      JCN   O030; 
      L     3.000000e+001; 
      JU    SRC1; 
O030: NOP   0; 
      L     #rEqID; 
      L     DB1315.DBD   42; 
      ==R   ; 
      JCN   O031; 
      L     3.031000e+003; 
      JU    SRC1; 
O031: NOP   0; 
      L     #rEqID; 
      L     DB1325.DBD   42; 
      ==R   ; 
      JCN   O032; 
      L     3.032000e+003; 
      JU    SRC1; 
O032: NOP   0; 
      L     #rEqID; 
      L     DB1335.DBD   42; 
      ==R   ; 
      JCN   O033; 
      L     3.033000e+003; 
      JU    SRC1; 
O033: NOP   0; 
      L     #rEqID; 
      L     DB1345.DBD   42; 
      ==R   ; 
      JCN   O034; 
      L     3.034000e+003; 
      JU    SRC1; 
O034: NOP   0; 


// Priority 3 
      L     #rEqID; 
      L     DB1215.DBD   46; 
      ==R   ; 
      JCN   P021; 
      L     3.021000e+003; 
      JU    SRC1; 
P021: NOP   0; 
      L     #rEqID; 
      L     DB1225.DBD   46; 
      ==R   ; 
      JCN   P022; 
      L     3.022000e+003; 
      JU    SRC1; 
P022: NOP   0; 
      L     #rEqID; 
      L     DB1255.DBD   46; 
      ==R   ; 
      JCN   P025; 
      L     3.025000e+003; 
      JU    SRC1; 
P025: NOP   0; 
      L     #rEqID; 
      L     DB1265.DBD   46; 
      ==R   ; 
      JCN   P026; 
      L     3.026000e+003; 
      JU    SRC1; 
P026: NOP   0; 
      L     #rEqID; 
      L     DB1275.DBD   46; 
      ==R   ; 
      JCN   P027; 
      L     3.027000e+003; 
      JU    SRC1; 
P027: NOP   0; 
      L     #rEqID; 
      L     DB1285.DBD   46; 
      ==R   ; 
      JCN   P028; 
      L     3.028000e+003; 
      JU    SRC1; 
P028: NOP   0; 
      L     #rEqID; 
      L     DB1295.DBD   46; 
      ==R   ; 
      JCN   P029; 
      L     3.029000e+003; 
      JU    SRC1; 
P029: NOP   0; 
      L     #rEqID; 
      L     DB1305.DBD   46; 
      ==R   ; 
      JCN   P030; 
      L     3.000000e+001; 
      JU    SRC1; 
P030: NOP   0; 
      L     #rEqID; 
      L     DB1315.DBD   46; 
      ==R   ; 
      JCN   P031; 
      L     3.031000e+003; 
      JU    SRC1; 
P031: NOP   0; 
      L     #rEqID; 
      L     DB1325.DBD   46; 
      ==R   ; 
      JCN   P032; 
      L     3.032000e+003; 
      JU    SRC1; 
P032: NOP   0; 
      L     #rEqID; 
      L     DB1335.DBD   46; 
      ==R   ; 
      JCN   P033; 
      L     3.033000e+003; 
      JU    SRC1; 
P033: NOP   0; 
      L     #rEqID; 
      L     DB1345.DBD   46; 
      ==R   ; 
      JCN   P034; 
      L     3.034000e+003; 
      JU    SRC1; 
P034: NOP   0; 


      JU    REM2; 
SRC1: NOP   0; 
      A     #xTmp; 
      O     #U.Seq.Step0; 
      JCN   REM2; 
      T     #U.Seq.User.Real1; 
REM2: NOP   0; 

      L     #U.Seq.User.Real1; 
      L     0.000000e+000; 
      >R    ; 
      JC    CPY1; 
      T     #iTmp; 
      CALL SFC   21 (
           BVAL                     := #iTmp,
           RET_VAL                  := #iRetVal,
           BLK                      := DB115.SRC);
      JU    END1; 


CPY1: NOP   0; 
      CALL FC   950 (
           EquipmentNo              := #U.Seq.User.Real1,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);


      CALL FC   563 (
           ActReq                   := TRUE,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB115.SRC,
           RET_VAL                  := #wRetVal);
END1: NOP   0; 

      A     #U.Seq.Step0; 
      O     DB115.DBX  219.2; 
      L     #U.Seq.User.Real1; // Tank Selection
      L     0.000000e+000; 
      >R    ; 
      A     DB115.DBX  218.3; 
      =     #U.Seq.User.Bit1; // Start Tank

      AN    #U.Seq.Step0; 
      R     #U.Seq.User.Bit1; // Start Tank

      L     DB115.DBW  206; 
      L     L#1000000; 
      *D    ; 
      T     #dTmp; 

      L     DB115.DBW  208; 
      L     1000; 
      *D    ; 

      L     #dTmp; 
      +D    ; 
      L     1; 
      +D    ; 
      NEGD  ; 
      T     #U.Seq.User.Dint0; 


NETWORK
TITLE =external releases

      SET   ; 
      =     DB210.DBX  426.7; 
      =     DB210.DBX  506.7; 
      =     DB210.DBX  586.7; 
      =     DB210.DBX  666.7; 
      =     DB210.DBX  746.7; 
      =     DB210.DBX  826.7; 
      =     DB210.DBX  906.7; 
      =     DB210.DBX  986.7; 
      =     DB210.DBX 1146.7; 
      =     DB210.DBX 1226.7; 
      =     DB210.DBX 1306.7; 
      =     DB210.DBX 1386.7; 
      =     DB210.DBX 1466.7; 
      =     DB210.DBX 1546.7; 
      =     DB210.DBX 1626.7; 
      =     DB210.DBX 1706.7; 
      =     DB210.DBX 1786.7; 
      =     DB210.DBX 1866.7; 
      =     DB210.DBX 1946.7; 
      =     DB210.DBX 2106.7; 
      =     DB210.DBX 2186.7; 
      =     DB210.DBX 2266.7; 
      =     DB210.DBX 2346.7; 
      =     DB210.DBX 2426.7; 
      =     DB210.DBX 2506.7; 
NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    #U.Seq.Step0; 
//      AN #U.Seq.PO.B30 // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB115.DBD  150; 
      T     #U.Seq.SFM[32].Val; 

//Temperature CIP Return
      L     DB115.DBD  146; 
      T     #U.Seq.SFM[30].Val; 

//CIP Prerun Pump SP
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[36].Sp,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB115.DBX  171.7; 
      JCN   pfc; 
      L     #U.Seq.SFM[34].Sp; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB115.DBX  172.0; 
      JCN   ppc; 
      L     #U.Seq.SFM[35].Sp; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB115.DBX  171.6; 
      JCN   pxc; 
      L     #U.Seq.SFM[29].Sp; 
pxc:  NOP   0; 
      T     DB115.DBD  182; 

// CIP Prerun Temperature
      L     #U.Seq.SFM[36].Sp; 
      T     DB115.DBD  182; 

//CIP Return
      L     #U.Seq.SFM[28].Sp; 
      T     DB115.DBD  186; 
      L     DB115.DBD  138; 
      T     #U.Seq.SFM[28].Val; 

//CIP Prerun
      L     #U.Seq.SFM[27].Sp; 
      T     DB115.DBD  190; 
      L     DB115.DBD  142; 
      T     #U.Seq.SFM[27].Val; 

// Write Own Data to CIP
      L     DB115.DBD   10; 
      T     DB115.DBD  154; 

      L     DB115.DBW   14; 
      T     DB115.DBW  158; 

      L     DB115.DBW   16; 
      T     DB115.DBW  160; 

      L     DB115.DBW   18; 
      T     DB115.DBW  162; 

      L     DB115.DBW   20; 
      T     DB115.DBW  164; 

      L     DB115.DBW   22; 
      T     DB115.DBW  166; 

      A     DB115.DBX   24.0; 
      =     DB115.DBX  168.0; 

      A     DB115.DBX   24.1; 
      =     DB115.DBX  168.1; 

      A     DB115.DBX   24.2; 
      =     DB115.DBX  168.2; 

      A     DB115.DBX   24.3; 
      =     DB115.DBX  168.3; 

      A     DB115.DBX   24.4; 
      =     DB115.DBX  168.4; 

      A     DB115.DBX   24.5; 
      =     DB115.DBX  168.5; 

      A     DB115.DBX   24.6; 
      =     DB115.DBX  168.6; 

      A     DB115.DBX   24.7; 
      =     DB115.DBX  168.7; 

      L     DB115.DBD  138; // CIP Amount
      T     DB115.DBD   54; // CIP Amount

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB115.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB502.ToCIP1);

NCIP: NOP   0; 

//Empty Signal
      A     DB211.DBX   78.7; 
      =     DB115.DBX   26.5; 

//Full Signal
      AN    DB211.DBX  138.7; 
      =     DB115.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB115.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB115.DBX   27.0; //Emergency Stop OK

// Material
      L     #U.Seq.SFM[42].Sp; // Material
      T     DB115.DBD   30; 

//----------------------------------------
// Communication Well Transfer
//----------------------------------------
      A     #U.Seq.SFM[18].D; // Level Offset
      AN    DB115.DBX   26.2; 
      S     DB115.DBX   27.2; 

      AN    #U.Seq.SFM[18].D; // Level Offset
      AN    DB115.DBX   26.0; 
      AN    DB115.DBX   26.1; 
      O     DB115.DBX   26.2; 
      R     DB115.DBX   27.2; 

//----------------------------------------
// Communication Water Transfer to Plant
//----------------------------------------
      A     #U.Seq.SFM[19].D; // Empty release
      AN    DB115.DBX   26.5; 
      S     DB115.DBX   27.3; 

      AN    #U.Seq.SFM[19].D; // Level Offset
      AN    DB115.DBX   26.3; 
      AN    DB115.DBX   26.4; 
      O     DB115.DBX   26.5; 
      R     DB115.DBX   27.3; 


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 119
TITLE =C01: Water Tank x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C01Sim
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     #U.Seq.Sim; 
      =     DB210.DBX  425.3; 
      =     DB210.DBX  505.3; 
      =     DB210.DBX  665.3; 
      =     DB210.DBX  585.3; 
      =     DB210.DBX  745.3; 
      =     DB210.DBX  825.3; 
      =     DB210.DBX  905.3; 
      =     DB210.DBX  985.3; 
      =     DB210.DBX 1145.3; 
      =     DB210.DBX 1225.3; 
      =     DB210.DBX 1305.3; 
      =     DB210.DBX 1385.3; 
      =     DB210.DBX 1465.3; 
      =     DB210.DBX 1545.3; 
      =     DB210.DBX 1625.3; 
      =     DB210.DBX 1705.3; 
      =     DB210.DBX 1785.3; 
      =     DB210.DBX 1865.3; 
      =     DB210.DBX 1945.3; 
      =     DB210.DBX 2105.3; 
      =     DB210.DBX 2185.3; 
      =     DB210.DBX 2265.3; 
      =     DB210.DBX 2345.3; 
      =     DB210.DBX 2505.3; 
      =     DB210.DBX 2425.3; 

NETWORK
TITLE =Special Input

      A     #U.Seq.Sim; 
      =     DB211.DBX   81.3; 
      =     DB211.DBX  141.3; 
      =     DB211.DBX  201.3; 
      =     DB211.DBX  261.3; 
//     =     "WT13SpID".GOA_T13_VV.Sim; 
      =     DB211.DBX  381.3; 
      =     DB211.DBX  441.3; 
      =     DB211.DBX  501.3; 
      =     DB211.DBX  621.3; 
      =     DB211.DBX  681.3; 

NETWORK
TITLE =Counter

      A     #U.Seq.Sim; 
      A     M    101.0; 
      CLR   ; 
NETWORK
TITLE =Analog Input

      A     #U.Seq.Sim; 
      =     DB213.DBX  141.3; 

NETWORK
TITLE =Universal Value

      A     #U.Seq.Sim; 
//      =     "WT13UnVD".unv001.Sim; 
//      =     "WT13UnVD".unv002.Sim; 
//      =     "WT13UnVD".unv003.Sim; 

NETWORK
TITLE =PID

      A     #U.Seq.Sim; 

NETWORK
TITLE =Message

      A     #U.Seq.Sim; 
//      =     "WT13MsgD".msg001.Sim; 
//      =     "WT13MsgD".msg002.Sim; 

NETWORK
TITLE =VLT

      A     #U.Seq.Sim; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 121
TITLE =C02: Well Transfer x
// NW  1 : phase and index evaluation
// NW  2 : phase  1: start position
// NW  3 : phase  3: Prerinse
// NW  4 : phase  4: Fill System
// NW  5 : phase  5: Transfer
// NW  6 : phase  6: Standby
// NW  7 : phase  8: Push Out
// NW  8 : phase 11: Postrinse
// NW  9 : phase 21: Prepare Line
// NW 10 : phase 22: Tank Selection
// NW 11 : end of sequence
// NW 12 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Process Time                        Duration        min
// 40 : Density                             Value           kg/l
// 42 : Material                            Value
// 43 : Destination                         Enumeration
// 44 : Standby                             Val
AUTHOR : Woermann
NAME : C02Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 121;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  ComSRC : BOOL ;	//Communication With Well Managment x
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dUnitNo : DINT ;	//Unit Number 
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM26 : STRUCT 	//Cip Step On Condition
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Conductivity High
    I02 : BOOL ;	//Conductivity Low
    I03 : BOOL ;	//Time
    I04 : BOOL ;	//Amount
    I05 : BOOL ;	//Temperature High
    I06 : BOOL ;	//Temperature Low
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM27 : STRUCT 	//Cip Prerun
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM28 : STRUCT 	//Cip Return
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	//Drain
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM37 : STRUCT 	//Cip Pump Mode
    I00 : BOOL ;	//Off
    I01 : BOOL ;	//Flow
    I02 : BOOL ;	//Pressure
    I03 : BOOL ;	//Fix Speed
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM31 : STRUCT 	//Cip Distribution Circuit No
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Auto Select
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM39 : STRUCT 	//Q-Status
    I00 : BOOL ;	//Please select
    I01 : BOOL ;	//released
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	//Ignore
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	//locked
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM10 : STRUCT 	//Current Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM11 : STRUCT 	//1. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM12 : STRUCT 	//2. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM13 : STRUCT 	//3. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
  ComCIPDist : BOOL ;	//Communication with CIP Distribution
  ComDST : BOOL ;	//Communication with Water Tank
  ComWT1 : BOOL ;	//Comminication with unit Water Treatment 1 OK
  FLT : BOOL ;	//Line has Carbon Filter
  rUnitNo : REAL ;	//Unit Number Real
  CurrSel : REAL ;	//Current Tank Selection SP
  ComWTank2 : BOOL ;	//Communication Water Tank Priority 2
  ComWTank3 : BOOL ;	//Communication Water Tank Priority 3
  ComWTank1 : BOOL ;	//Communication Water Tank Priority 1
  ComPLN : BOOL ;	//Communication with Transfer Plan
END_VAR
BEGIN
NETWORK
TITLE = Phase and Index Evaluation

      CLR   ; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     46; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB125.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      L     MD   124; 
      L     DB125.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

      L     MD   124; 
      L     DB125.DBD  202; 
      ==D   ; 
      =     #ComSRC; 

      L     DB125.DBD  318; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #ComDST; 

      L     DB125.DBD  366; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #ComWTank1; 

      L     DB125.DBD  414; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #ComWTank2; 

      L     DB125.DBD  462; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #ComWTank3; 


// Load Source to SFM
      L     DB125.DBD  242; 
      T     #U.Seq.SFM[14].Sp; 


// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB125.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 

// ---------------------------------------------------------------------------
// index evaluation: Current Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[10].Sp,
           Indexes                  := #S2I.SFM10);

// index evaluation: 1. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[11].Sp,
           Indexes                  := #S2I.SFM11);

// index evaluation: 2. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[12].Sp,
           Indexes                  := #S2I.SFM12);

// index evaluation: 3. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[13].Sp,
           Indexes                  := #S2I.SFM13);

// index evaluation: Q-Status
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[39].Sp,
           Indexes                  := #S2I.SFM39);

// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: start position
      JU    X0; // phase  2:
      JU    X3; // phase  3: Prerinse
      JU    X4; // phase  4: Fill System
      JU    X5; // phase  5: Transfer
      JU    X6; // phase  6: Standby
      JU    X0; // phase  7:
      JU    X8; // phase  8: Push Out
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X11; // phase 11: Postrinse
      JU    X0; // phase 12:
      JU    X0; // phase 13:
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X0; // phase 18:
      JU    X0; // phase 19:
      JU    X0; // phase 20:
      JU    X21; // phase 21: Prepare Line
      JU    X22; // phase 22: Tank Selection
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 
// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 
      R     DB125.DBX   26.1; 

      L     0.000000e+000; 
      T     DB125.DBD   30; 
      T     DB125.DBD   34; 
      T     DB125.DBD   38; 
      T     DB125.DBD   42; 
      T     DB125.DBD   46; 
      T     DB125.DBD   50; 
      T     DB125.DBD   54; 
      T     #U.Seq.SFM[10].Sp; 
      T     #U.Seq.SFM[11].Sp; 
      T     #U.Seq.SFM[12].Sp; 
      T     #U.Seq.SFM[13].Sp; 

      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   120 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   120 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 
NETWORK
TITLE =phase 3: Prerinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X3:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB125.DBX  363.2,
           P2Rel                    := DB125.DBX  411.2,
           P3Rel                    := DB125.DBX  459.2,
           CurrSel                  := #U.Seq.User.Real10);

      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; 

// ---------------------------------------------------------------------------
// messages 
      A     #S2I.SFM39.I01; // Released
      JCN   N301; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N301: NOP   0; 

      A     M    151.6; // Rinse Amount
      A     #S2I.SFM39.I00; // Please Select
      JCN   N302; 
      L     816; // LAB Release Required
      T     MD    90; 
N302: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 
      =     M    131.6; 

// Presinse
      AN    #U.Seq.SFM[15].P; 
      =     #xTmp; 
      CALL FC   710 (
           RefVal                   := DB125.DBD  230,
           Active                   := #xTmp,
           Reset                    := #U.Seq.SFM[15].Res,
           Down                     := FALSE,
           CntVal                   := #U.Seq.SFM[15].Val,
           RefMem                   := #U.Seq.User.Real1);

// ---------------------------------------------------------------------------
// pause timer  .
      SET   ; 
      S     M    141.7; 
// ---------------------------------------------------------------------------
// communication
// Water Tank
      A     M    102.3; 
      =     DB125.DBX   26.3; 


// Well Management
      A     DB220.DBX  102.6; 
      AN    M    151.6; // Rinse Amount
      A     M    102.3; 
      =     DB125.DBX   26.1; // Request Water


// ---------------------------------------------------------------------------
// Check Partner
      AN    #ComSRC; 
      O(    ; 
      AN    DB125.DBX  218.3; 
      AN    DB125.DBX  218.4; 
      )     ; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      JCN   NC03; 
      L     904; // "Source Not Ready!
      T     MD    90; 
NC03: NOP   0; 

      AN    DB125.DBX  314.0; // Water Tank Ready
      AN    DB125.DBX  314.1; 
      AN    #ComDST; 
      A     #S2I.SFM10.I00; 
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B22; 
      AN    #CIP; 
      JCN   NC04; 
      L     903; // Destination not Ready
      T     MD    90; 
NC04: NOP   0; 

// ---------------------------------------------------------------------------
// control modules 
// Drain    
      A     #ComSRC; // Coms Well Management
      A     DB125.DBX   75.2; 
      AN    M    151.6; 
      A     M    102.3; 
      =     DB220.DBX  108.0; 

// CO2
//      A     "C02ComD".DST.Fill        
//      A     #ComDST                   
      L     #U.Seq.SFM[22].Sp; 
      L     1.000000e+001; 
      <R    ; 
      A(    ; 
      L     #U.Seq.SFM[22].Sp; 
      L     5.000000e+000; 
      >R    ; 
      )     ; 
      A     DB125.DBX  218.4; 
      A     DB125.DBX  219.7; 
      A     M    103.3; 
      =     DB220.DBX  348.0; 
      =     DB220.DBX  188.0; 
      =     DB220.DBX  268.0; 

// ---------------------------------------------------------------------------
// transition condition 
      A     M    151.6; // Amount
      O     M    120.6; 
      A     #S2I.SFM39.I01; // Released
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A300; 
      JU    COMM; // subphase  0:
      JU    A301; // subphase  1: Gully VEE
      JU    A302; // subphase  2: Gully Befllung
// ---------------------------------------------------------------------------
A300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
// subphase 1: Gully VEE
A301: SET   ; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      SET   ; 
      =     M    103.1; 
      JU    COMM; 
// subphase 2: Gully Befllung
A302: SET   ; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

NETWORK
TITLE =phase 4: Fill System 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X4:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 


// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A400; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =phase 5: Transfer 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X5:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB125.DBX  363.2,
           P2Rel                    := DB125.DBX  411.2,
           P3Rel                    := DB125.DBX  459.2,
           CurrSel                  := #U.Seq.User.Real10);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      A     M    102.3; 
      =     DB125.DBX   26.3; 

      A     M    102.3; 
      =     DB125.DBX   27.2; 

// ---------------------------------------------------------------------------
// messages 

      AN    #ComDST; 
      JCN   N501; 
      L     903; // Destination not Ready
      T     MD    90; 
N501: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 

// Amount
      AN    #U.Seq.SFM[16].P; 
      =     #xTmp; 
      CALL FC   710 (
           RefVal                   := DB125.DBD  230,
           Active                   := #xTmp,
           Reset                    := #U.Seq.SFM[16].Res,
           Down                     := FALSE,
           CntVal                   := #U.Seq.SFM[16].Val,
           RefMem                   := #U.Seq.User.Real2);

      AN    #U.Seq.SFM[17].P; // TT Counter
      =     #xTmp; 
      CALL FC   710 (
           RefVal                   := DB125.DBD  230,
           Active                   := #xTmp,
           Reset                    := #U.Seq.SFM[17].Res,
           Down                     := FALSE,
           CntVal                   := #U.Seq.SFM[17].Val,
           RefMem                   := #U.Seq.User.Real4);

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication


// ---------------------------------------------------------------------------
// Check Partner
      AN    #ComSRC; 
      O(    ; 
      AN    DB125.DBX  218.3; 
      AN    DB125.DBX  218.4; 
      )     ; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      JCN   NC05; 
      L     904; // "Source Not Ready!
      T     MD    90; 
NC05: NOP   0; 

      AN    DB125.DBX  314.0; // Water Tank Ready
      AN    DB125.DBX  314.1; 
      AN    #ComDST; 
      A     #S2I.SFM10.I00; 
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B22; 
      AN    #CIP; 
      JCN   NX05; 
      L     903; // Destination not Ready
      T     MD    90; 
NX05: NOP   0; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      L     #U.Seq.User.Real10; 
      L     0.000000e+000; 
      ==R   ; 
      O     M    151.7; // Amount
      AN    M    102.2; 
      =     M    102.1; 
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y5; 
      L     1; 
      T     MW   116; 
Y5:   SET   ; 
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase evaluation
      L     MW   110; 
      JL    A500; 
      JU    COMM; // subphase  0:
      JU    A501; // subphase  1: Waiting
      JU    A502; // subphase  2: Active
      JU    A503; // subphase  3: Tank Change
// ---------------------------------------------------------------------------
A500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A501: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A(    ; 
      L     #U.Seq.User.Real10; 
      L     #U.Seq.SFM[10].Sp; 
      <>R   ; 
      )     ; 
      O(    ; 
      A     DB125.DBX  314.0; 
      A     DB125.DBX  315.2; 
      A     DB125.DBX  218.3; 
      O     #S2I.SFM10.I00; 
      )     ; 
      =     M    103.1; 

      JU    COMM; 

// subphase 2: Active
A502: SET   ; 

// Well Management
      A     DB125.DBX  314.1; 
      A     #ComSRC; // Comms Well Managment
      A     M    103.3; 
      =     DB125.DBX   26.1; // Request Water

// Water Tank
      A     DB125.DBX  218.3; // Well Managment
      O     DB125.DBX  218.4; // Well Managment 
      A     M    103.3; 
      =     DB125.DBX   26.4; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
// -------------------------------------------------
// subphase actuator 
      L     #U.Seq.SFM[22].Sp; 
      L     1.000000e+001; 
      <R    ; 
      A(    ; 
      L     #U.Seq.SFM[22].Sp; 
      L     5.000000e+000; 
      >R    ; 
      )     ; 
      A     DB125.DBX  314.1; 
      A     DB125.DBX  219.7; 
      A     M    103.3; 
      =     DB220.DBX  348.0; 
      =     DB220.DBX  188.0; 
      =     DB220.DBX  268.0; 
// -------------------------------------------------
// subphase transition 
      L     #U.Seq.User.Real10; 
      L     #U.Seq.SFM[10].Sp; 
      <>R   ; 
      O     #S2I.SFM10.I00; 
      ON    DB125.DBX  315.2; 
      =     M    103.1; 

      JU    COMM; 
// subphase 3: Tank Change
A503: SET   ; 
      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; // Current Tank

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    162.0; 

// -------------------------------------------------
// subphase actuator 
//      A     "U099ComD".Own.Bit26
//      A     "SOSPH"
//      =     "C02ActD".A_G1.ACo
// -------------------------------------------------
// subphase transition 
      AN    #S2I.SFM10.I00; 
      AN    M    102.2; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 6: Standby
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 02 : Step Time                           Duration        h
X6:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 


      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB125.DBX  363.2,
           P2Rel                    := DB125.DBX  411.2,
           P3Rel                    := DB125.DBX  459.2,
           CurrSel                  := #U.Seq.User.Real10);

      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 
      R     DB125.DBX   26.1; 

      A     M    102.3; 
      =     DB125.DBX   27.2; 
// ---------------------------------------------------------------------------
// messages 
      AN    M    151.7; 
      A     M    150.1; // Max Standby Time
      JCN   N601; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N601: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 
      =     M    130.1; 
// ---------------------------------------------------------------------------
// pause timer
//      ON    "SOPH"
//      O     "SFM02D"
//      S     "SFM02P"                    // Step Time

      SET   ; 
      S     M    141.7; 

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// Check Partner
      AN    #ComSRC; 
      O(    ; 
      AN    DB125.DBX  218.3; 
      AN    DB125.DBX  218.4; 
      )     ; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      JCN   NC06; 
      L     904; // "Source Not Ready!
      T     MD    90; 
NC06: NOP   0; 

//      AN    "C02ComD".DST.WfFi          // Water Tank Ready
//      AN    "C02ComD".DST.Fill
      AN    #ComDST; 
      AN    M    150.1; // Max Standby Time
//      A     #S2I.SFM10.I00
      AN    M    151.7; 
      CLR   ; // Thats why we are in StandBy
      JCN   NX06; 
      L     903; // Destination not Ready
      T     MD    90; 
NX06: NOP   0; 

// ---------------------------------------------------------------------------
// control modules 

// ---------------------------------------------------------------------------
// transition condition 
      CLR   ; 
      =     #xTmp; 

      AN    #S2I.SFM10.I00; 
      AN    M    150.1; // Max Standby Time
      AN    M    151.7; 
      S     #xTmp; // AutoCont
      JCN   N6x2; 
      L     MW   104; 
      L     -1; 
      +I    ; 
      T     MW   106; 
N6x2: NOP   0; 

      A     M    150.1; // Max Standby Time
      AN    M    151.7; 
      A     M    120.6; 
      S     #xTmp; // ReqRestart
      JCN   N6y2; 
      L     MW   104; 
      L     -2; 
      +I    ; 
      T     MW   106; 
N6y2: NOP   0; 

      A     M    150.1; // Max Standby Time
      A     M    151.7; 
      S     #xTmp; // ReqEnd

      A     #xTmp; 
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A600; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A600: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 8: Push Out 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X8:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A800; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 11: Postrinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X11:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 21: Prepare Line 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X21:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      A     M    102.2; 
      JCN   N903; 
      L     DB125.DBD  234; 
      T     #U.Seq.SFM[22].Sp; 
N903: NOP   0; 
// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
      A     #ComSRC; 
      A     M    103.3; 
      =     DB125.DBX   26.0; // Wait for filling
      =     DB125.DBX   27.2; 
// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      AN    M    102.2; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y21
//      L     1
//      T     "SOSubStepNew"
//Y21:  SET

// subphase evaluation
      L     MW   110; 
      JL    C100; 
      JU    COMM; // subphase  0:
      JU    C101; // subphase  1: Start Well
      JU    C102; // subphase  2: Check Partner
// ---------------------------------------------------------------------------
C100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Start Well
C101: SET   ; 
// Request Well start

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     DB125.DBX  218.3; // Well Ready   
      A     #ComSRC; 
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Check Partner
C102: SET   ; 
      A     M    103.3; 
      =     DB125.DBX   26.3; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      AN    DB125.DBX   75.2; // Swingbend drain Tank filling
      JCN   N801; 
      L     920; // Check connections (Swingbend)
      T     MD    90; 
N801: NOP   0; 

// -------------------------------------------------
// subphase transition 
      A     DB125.DBX   75.2; // Swingbend drain Tank filling
      A     DB125.DBX  218.3; // Well Ready 
      A     #ComSRC; // Communication Well Management
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 22: Tank Selection 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X22:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   120 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 

      AN    #S2I.SFM11.I00; // Priority 1 Tank   
      A     #ComSRC; 
      JCN   N901; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N901: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      R     DB125.DBX   26.1; 
      A     M    102.0; 
      =     DB125.DBX   26.0; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     M    120.6; 
      A     #ComSRC; 
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// Comm with Transfer Plan Unit
      AN    DB125.DBX  509.0; 
      R     DB125.DBX   29.0; 

      L     DB125.DBD  510; 
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      AN    DB125.DBX  504.7; 
      AN    DB125.DBX   24.7; 
      =     #ComPLN; 

      A     DB125.DBX  509.0; 
      AN    DB125.DBX   29.0; 
      A     #ComPLN; 
      A     M    102.3; 
      JCN   CpDt; 
      SET   ; 
      =     DB125.DBX   29.0; 
// Menge
      L     DB125.DBD  514; 
      L     #U.Seq.SFM[16].E; 
      -R    ; 
      L     #U.Seq.SFM[16].Sp; 
      +R    ; 
      T     #U.Seq.SFM[16].Sp; 

// Tanks
      L     #U.Seq.SFM[11].Sp; 
      L     0.000000e+000; 
      ==R   ; 
      JCN   T1st; 
      L     DB125.DBD  518; 
      T     #U.Seq.SFM[11].Sp; 
T1st: NOP   0; 
      L     #U.Seq.SFM[12].Sp; 
      L     0.000000e+000; 
      ==R   ; 
      JCN   T2st; 
      L     DB125.DBD  518; 
      T     #U.Seq.SFM[12].Sp; 
T2st: NOP   0; 
      L     #U.Seq.SFM[13].Sp; 
      L     0.000000e+000; 
      ==R   ; 
      JCN   T3st; 
      L     DB125.DBD  518; 
      T     #U.Seq.SFM[13].Sp; 
T3st: NOP   0; 


CpDt: NOP   0; 


NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  
      AN    M    120.7; 
      S     M    131.7; 

// Check Selection / Material -----------------------------------------------
      L     0; 
      L     DB125.DBD  318; // 1. Tank
      <R    ; 
      JCN   MCk1; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      S     M    120.3; 
      JCN   MCk0; 
      L     910; 
      T     MD    80; 
MCk0: NOP   0; 
      L     0; 
      L     DB125.DBD  366; // 1. Tank
      <R    ; 
      JCN   MCk1; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk1; 
      L     910; 
      T     MD    90; 
MCk1: NOP   0; 
      L     0; 
      L     DB125.DBD  414; // 2. Tank
      <R    ; 
      JCN   MCk2; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk2; 
      L     910; 
      T     MD    90; 
MCk2: NOP   0; 
      L     0; 
      L     DB125.DBD  462; // 3. Tank
      <R    ; 
      JCN   MCk3; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk3; 
      L     910; 
      T     MD    90; 
MCk3: NOP   0; 

      L     #U.Seq.SFM[11].Sp; 
      L     #U.Seq.SFM[12].Sp; 
      OD    ; 
      L     #U.Seq.SFM[13].Sp; 
      OD    ; 
      L     0; 
      >R    ; 
      O     M    120.7; 
      JC    TSel; 
      A     #S2I.SFM11.I00; 
      L     905; // "Destination not Selected"
      T     MD    90; 
TSel: NOP   0; 

NETWORK
TITLE =Process Status Management

      NOP   0; 
// ---------------------------------------------------------------------------
// Signal Control

      OPN   DB   500; 
      L     #UnitNo; 
      L     32; //U Structure Length
      *I    ; 
      L     20; //DB Heading Offset
      +I    ; 
      SLD   3; 
      LAR2  ; 

// -------------------------------------------------
// Maintenance
      A     #U.Seq.Switch.Sw31; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.0]; //"PStatD".U[#UnitNo].MTNC
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
      A     DB125.DBX   26.2; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.7]; //"PStatD".U[#UnitNo].FULL
// -------------------------------------------------
// Filling
      A     DB125.DBX   26.1; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.0]; //"PStatD".U[#UnitNo].FILL   
// -------------------------------------------------
// Ready For Filling
      A     DB125.DBX   26.0; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.1]; //"PStatD".U[#UnitNo].RFFI 
// -------------------------------------------------
// Empty
      A     DB125.DBX   26.5; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.2]; //"PStatD".U[#UnitNo].EMTY 
// -------------------------------------------------
// Emptying
      A     DB125.DBX   26.4; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.3]; //"PStatD".U[#UnitNo].EMTI
// -------------------------------------------------
// Ready For Emptying
      A     DB125.DBX   26.3; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.4]; //"PStatD".U[#UnitNo].RFEM
// -------------------------------------------------
// Reserved
//      A     #ComXYZ
//      OPN   "PStatD"
//      =     DBX [AR2,P#1.5]             //"PStatD".U[#UnitNo].RESV
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used

// -------------------------------------------------
// PStat Function Call 

      CALL FC   500 (
           UnitNo                   := #UnitNo,
           PStatModVal              := DB225.DBD  234);

NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 





END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 123
TITLE =C02: Well Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C02E
VERSION : 1.2
CODE_VERSION1


VAR
  U : UDT 121;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
  ComCIP1 : BOOL ;	//CIP1 in use
  ComCIP3 : BOOL ;	//CIP3 in use
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     #U.Seq.User.Bit63; 
      CC    FB   129; // "C02Sim"
      A     #U.Seq.Sim; 
      =     #U.Seq.User.Bit63; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     MB   112; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB125.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    #U.Seq.Switch.Sw31; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   125; // C02Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// U31_AnI001 J6F_Druck
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB223.DBD  238; 

      SET   ; 
      =     DB223.DBX  141.5; 

// ----------------------------------------------------------
// QI_CO2_J6F_PH 
// ----------------------------------------------------------
      L     #U.Seq.SFM[15].Sp; 
      T     DB223.DBD  358; 

      SET   ; 
      =     DB223.DBX  261.5; 

// ----------------------------------------------------------
// U31_AnI003 spare
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB223.DBD  478; 

      SET   ; 
      =     DB223.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C02UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
      L     0.000000e+000; 
      T     DB225.DBD  362; 

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
      SET   ; 
      =     DB225.DBX  403.5; 

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C02UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// U31_SpI001 spare
// ----------------------------------------------------------
      CLR   ; // Only used in one well?    
      =     DB221.DBX   81.4; 
      =     DB221.DBX   81.5; 

// ----------------------------------------------------------
// U31_SpI002 spare
// ----------------------------------------------------------
      CLR   ; // Only used in one well?       
      =     DB221.DBX  141.4; 
      =     DB221.DBX  141.5; 

// ----------------------------------------------------------
// U31_SpI003 spare
// ----------------------------------------------------------
      CLR   ; // Only used in one well?       
      =     DB221.DBX  201.4; 
      =     DB221.DBX  201.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB227.DBX   80.7; 
      =     DB227.DBX   81.4; 

      CLR   ; 
      =     DB227.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB227.DBX  140.7; 
      =     DB227.DBX  141.4; 

      CLR   ; 
      =     DB227.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB227.DBX  200.7; 
      =     DB227.DBX  201.4; 

      CLR   ; 
      =     DB227.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// CO2J6FRV1 CO2 J6F RV1
// ----------------------------------------------------------
// starting value -----------------------
      A     DB220.DBX  263.4; 
      A     #GenRel; 
      =     DB226.DBX  203.2; 
      =     DB226.DBX  203.5; 

// enable alarm -------------------------
      A     DB226.DBX  203.5; 
      A     DB226.DBX  201.4; 
      AN    DB226.DBX  203.1; 
      AN    DB226.DBX  203.3; 
      AN    DB226.DBX  203.4; 
      =     DB226.DBX  203.0; 

// setpoint to controller ---------------
      L     #U.Seq.SFM[22].Sp; 
      T     DB226.DBD  234; 

// static value to controller ----------
      L     #U.Seq.SFM[63].Sp; 
      T     DB226.DBD  238; 

// process value to controller ----------
      L     DB223.DBD  266; 
      T     DB226.DBD  254; 

// low/high value to controller ---------
      L     DB223.DBD  270; 
      T     DB226.DBD  218; 

      L     DB223.DBD  274; 
      T     DB226.DBD  222; 

NETWORK
TITLE =Sequence organisation
// 
// SFM supply ----------------------------------------------------------------

// analog value to SFM J6F_Druck -----------------------
      L     DB223.DBD  146; 
      T     #U.Seq.SFM[19].Val; 

// analog value to SFM QI_CO2_J6F_PH -------------------
      L     DB223.DBD  266; 
      T     #U.Seq.SFM[22].Val; 

// analog value to SFM spare -----------------------
      L     DB223.DBD  386; 
      T     #U.Seq.SFM[63].Val; // !!! insert correct SFM !!! PH after CO2


NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB220.DBX  105.4; 
      =     DB220.DBX  185.4; 
      =     DB220.DBX  265.4; 
      =     DB220.DBX  345.4; 

// assign PID mode
      S     DB226.DBX  201.4; 
      S     DB226.DBX  201.5; 

MODE: SET   ; 

NETWORK
TITLE =J6F_G1 J6F_G1

      A     #GenRel; 
      A     DB220.DBX  106.7; 
      =     DB220.DBX  107.6; 
NETWORK
TITLE =CO2_J6FV2 Ansteuerung J6FV2

      A     #GenRel; 
      A     DB220.DBX  186.7; 
      =     DB220.DBX  187.6; 
NETWORK
TITLE =CO2_J6FV1 Ansteuerung J6FV1

      A     #GenRel; 
      A     DB220.DBX  266.7; 
      =     DB220.DBX  267.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 125
TITLE =C02: Well Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C02Comm
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 121;	
END_VAR
VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	//CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
  rUnitNo : REAL ;	
  DSTUnit : INT ;	//Destination Unit
  SRCUnit : INT ;	
  rUnitNo_1 : REAL ;	//Unit Number Real
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

      L     DB125.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB125.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB125.DBD   10; 
      L     DB125.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB125.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/
      CALL SFC   20 (
           SRCBLK                   := DB1995.Own,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.GEN);

      A     DB125.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB125.CIP,
           RET_VAL                  := #wRetVal);

//----------------------------------------
// Communication Well Management
//----------------------------------------
      L     #U.Seq.Prop.Index0; // Source
      ITD   ; 
      DTR   ; 
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #iUnit; 
      L     25; 
      ==I   ; 
      JCN   U025; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U025,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U025: NOP   0; 

      L     #iUnit; 
      L     26; 
      ==I   ; 
      JCN   U026; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U026,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U026: NOP   0; 

      L     #iUnit; 
      L     27; 
      ==I   ; 
      JCN   U027; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U027,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U027: NOP   0; 

      L     #iUnit; 
      L     28; 
      ==I   ; 
      JCN   U028; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U028,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U028: NOP   0; 

      L     #iUnit; 
      L     29; 
      ==I   ; 
      JCN   U029; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U029,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U029: NOP   0; 

      L     #iUnit; 
      L     30; 
      ==I   ; 
      JCN   U030; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U030,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U030: NOP   0; 

      L     #iUnit; 
      L     31; 
      ==I   ; 
      JCN   U031; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U031,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U031: NOP   0; 

      L     #iUnit; 
      L     32; 
      ==I   ; 
      JCN   U032; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U032,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U032: NOP   0; 

      L     #iUnit; 
      L     33; 
      ==I   ; 
      JCN   U033; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U033,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U033: NOP   0; 

      L     #iUnit; 
      L     34; 
      ==I   ; 
      JCN   U034; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U034,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB125.SRC);
U034: NOP   0; 


//----------------------------------------
// Communication Water Tank 
//----------------------------------------
// Current Tank ----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[10].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[10].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N201; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB125.DST,
           RET_VAL                  := #wRetVal);
      JU    N2x1; 
N201: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB125.DST);
N2x1: NOP   0; 
// Priority 1 -----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[11].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[11].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N202; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB125.DST1,
           RET_VAL                  := #wRetVal);
      JU    N2x2; 
N202: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB125.DST1);
N2x2: NOP   0; 

// Priority 2 ----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[12].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[12].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N203; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB125.DST2,
           RET_VAL                  := #wRetVal);
      JU    N2x3; 
N203: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB125.DST2);
N2x3: NOP   0; 

// Priority 3 ----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[13].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[13].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N204; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB125.DST3,
           RET_VAL                  := #wRetVal);
      JU    N2x4; 
N204: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB125.DST3);
N2x4: NOP   0; 

// Plan ----------------------------
      L     #UnitNo; 
      L     100; 
      +I    ; 
      T     #iUnit; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB125.PLN,
           RET_VAL                  := #wRetVal);


NETWORK
TITLE =external releases

      SET   ; 
      =     DB220.DBX  106.7; 
      =     DB220.DBX  186.7; 
      =     DB220.DBX  266.7; 
      =     DB220.DBX  346.7; 
NETWORK
TITLE =write own unit data

      SET   ; 
//-- CIP Communication ---------------------------------------
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B30; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB125.DBD  150; 
      T     #U.Seq.SFM[32].Val; 

//Temperature CIP Return
      L     DB125.DBD  146; 
      T     #U.Seq.SFM[30].Val; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := #U.Seq.SFM[36].Sp,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB125.DBX  171.7; 
      JCN   pfc; 
      L     #U.Seq.SFM[34].Sp; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB125.DBX  172.0; 
      JCN   ppc; 
      L     #U.Seq.SFM[35].Sp; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB125.DBX  171.6; 
      JCN   pxc; 
      L     #U.Seq.SFM[29].Sp; 
pxc:  NOP   0; 
      T     DB125.DBD  182; 

//CIP Return
      L     #U.Seq.SFM[28].Sp; 
      T     DB125.DBD  186; 
      L     DB125.DBD  138; 
      T     #U.Seq.SFM[28].Val; 

//CIP Prerun
      L     #U.Seq.SFM[27].Sp; 
      T     DB125.DBD  190; 
      L     DB125.DBD  142; 
      T     #U.Seq.SFM[27].Val; 

// Write Own Data to CIP
      L     DB125.DBD   10; 
      T     DB125.DBD  154; 

      L     DB125.DBW   14; 
      T     DB125.DBW  158; 

      L     DB125.DBW   16; 
      T     DB125.DBW  160; 

      L     DB125.DBW   18; 
      T     DB125.DBW  162; 

      L     DB125.DBW   20; 
      T     DB125.DBW  164; 

      L     DB125.DBW   22; 
      T     DB125.DBW  166; 

      A     DB125.DBX   24.0; 
      =     DB125.DBX  168.0; 

      A     DB125.DBX   24.1; 
      =     DB125.DBX  168.1; 

      A     DB125.DBX   24.2; 
      =     DB125.DBX  168.2; 

      A     DB125.DBX   24.3; 
      =     DB125.DBX  168.3; 

      A     DB125.DBX   24.4; 
      =     DB125.DBX  168.4; 

      A     DB125.DBX   24.5; 
      =     DB125.DBX  168.5; 

      A     DB125.DBX   24.6; 
      =     DB125.DBX  168.6; 

      A     DB125.DBX   24.7; 
      =     DB125.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB125.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB125.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "C02SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB125.DBX   26.5; 

//Full Signal
//A     "C02SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB125.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB125.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB125.DBX   27.0; //Emergency Stop OK

// Material
      L     #U.Seq.SFM[42].Sp; // Material
      T     DB125.DBD   30; 

      L     DB125.DBD  230; 
      T     #U.Seq.User.Real3; 

//----------------------------------------
// Communication Water Tank
//----------------------------------------

      L     #U.Seq.SFM[10].Sp; // Current Tank
      T     DB125.DBD   34; 

      L     #U.Seq.SFM[11].Sp; // Tank Priority 1
      T     DB125.DBD   38; 

      L     #U.Seq.SFM[12].Sp; // Tank Priority 2
      T     DB125.DBD   42; 

      L     #U.Seq.SFM[13].Sp; // Tank Priority 3
      T     DB125.DBD   46; 

NETWORK
TITLE = read from other unit data


//------------------------------------------------------

      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB125.DBD  222,
           Enable                   := #U.Seq.PO.B4,
           Down                     := FALSE,
           OriginDetect             := 5.000000e-001,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := #U.Seq.SFM[41],
           ValueOld                 := #U.Seq.User.Real0);


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 129
TITLE =C02: Well Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C02Sim
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 121;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     MW   114; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     #U.Seq.Sim; 
      =     DB220.DBX  105.3; 
      =     DB220.DBX  185.3; 
      =     DB220.DBX  265.3; 
      =     DB220.DBX  345.3; 


NETWORK
TITLE =Special Input

      A     #U.Seq.Sim; 
      =     DB221.DBX   81.3; 
      =     DB221.DBX  141.3; 
      =     DB221.DBX  201.3; 

NETWORK
TITLE =Counter

      A     #U.Seq.Sim; 
      A     M    101.0; 
      CLR   ; 
NETWORK
TITLE =Analog Input

      A     #U.Seq.Sim; 
      =     DB223.DBX  141.3; 
      =     DB223.DBX  261.3; 
      =     DB223.DBX  381.3; 
NETWORK
TITLE =Universal Value

      A     #U.Seq.Sim; 
      =     DB225.DBX  149.3; 
      =     DB225.DBX  277.3; 
      =     DB225.DBX  405.3; 
      =     DB225.DBX  533.3; 

NETWORK
TITLE =PID

      A     #U.Seq.Sim; 
      CLR   ; 
      =     DB226.DBX  201.3; 

NETWORK
TITLE =Message

      A     #U.Seq.Sim; 
//      =     "C02MsgD".msg001.Sim; 
//      =     "C02MsgD".msg002.Sim; 
//      =     "C02MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     #U.Seq.Sim; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 131
TITLE =C03: Local Well Transfer x
// NW  1 : phase and index evaluation
// NW  2 : phase  1: start position
// NW  3 : phase  3: Prerinse
// NW  4 : phase  4: Fill System
// NW  5 : phase  5: Transfer
// NW  6 : phase  8: Push Out
// NW  7 : phase 11: Postrinse
// NW  8 : phase 21: Prepare Line
// NW  9 : phase 22: Tank Selection
// NW 10 : end of sequence
// NW 11 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Process Time                        Duration        min
// 40 : Density                             Value           kg/l
// 42 : Material                            Value
// 43 : Destination                         Enumeration
// 44 : Standby                             Value
AUTHOR : Woermann
NAME : C03Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 131;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  ComWell : BOOL ;	//Communication With Local Well x 
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dUnitNo : DINT ;	//Unit Number 
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM26 : STRUCT 	//Cip Step On Condition
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Conductivity High
    I02 : BOOL ;	//Conductivity Low
    I03 : BOOL ;	//Time
    I04 : BOOL ;	//Amount
    I05 : BOOL ;	//Temperature High
    I06 : BOOL ;	//Temperature Low
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM27 : STRUCT 	//Cip Prerun
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM28 : STRUCT 	//Cip Return
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	//Drain
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM37 : STRUCT 	//Cip Pump Mode
    I00 : BOOL ;	//Off
    I01 : BOOL ;	//Flow
    I02 : BOOL ;	//Pressure
    I03 : BOOL ;	//Fix Speed
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM31 : STRUCT 	//Cip Distribution Circuit No
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Auto Select
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM39 : STRUCT 	//Q-Status
    I00 : BOOL ;	//Please select
    I01 : BOOL ;	//released
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	//Ignore
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	//locked
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM10 : STRUCT 	//Current Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM11 : STRUCT 	//1. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM12 : STRUCT 	//2. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM13 : STRUCT 	//3. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM23 : STRUCT 	//Chriwa 1
    I00 : BOOL ;	//Erstfiltart
    I01 : BOOL ;	//Aus
    I02 : BOOL ;	//Bereitschaft
    I03 : BOOL ;	//Stop
    I04 : BOOL ;	//Strung
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	//Betrieb
    I09 : BOOL ;	//Entspannen
    I10 : BOOL ;	//Absenken
    I11 : BOOL ;	//Splen Luft
    I12 : BOOL ;	//Splen Wasser/Luft
    I13 : BOOL ;	//Filterbettentleerung
    I14 : BOOL ;	//Splen Wasser
    I15 : BOOL ;	//Affllen
    I16 : BOOL ;	//Nicht definiert
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM24 : STRUCT 	//Chriwa 2
    I00 : BOOL ;	//Erstfiltart
    I01 : BOOL ;	//Aus
    I02 : BOOL ;	//Bereitschaft
    I03 : BOOL ;	//Stop
    I04 : BOOL ;	//Strung
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	//Betrieb
    I09 : BOOL ;	//Entspannen
    I10 : BOOL ;	//Absenken
    I11 : BOOL ;	//Splen Luft
    I12 : BOOL ;	//Splen Wasser/Luft
    I13 : BOOL ;	//Filterbettentleerung
    I14 : BOOL ;	//Splen Wasser
    I15 : BOOL ;	//Affllen
    I16 : BOOL ;	//Nicht definiert
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
  ComCIPDist : BOOL ;	//Communication with CIP Distribution
  ComVE : BOOL ;	//Comminication with unit Water Treatment
  ComWTank2 : BOOL ;	//Communication Water Tank Priority 2
  comWTank3 : BOOL ;	//Communication Water Tank Priority 3
  comWTank1 : BOOL ;	//Communication Water Tank Priority 1
  ComSRC : BOOL ;	//Communication With Well
  ComDST : BOOL ;	//Communication with Water Tank
  CurrSel : REAL ;	//Current Tank Selection SP
  ComPLN : BOOL ;	//Communication with Transfer Plan
END_VAR
BEGIN
NETWORK
TITLE = Phase and Index Evaluation

      CLR   ; 
      =     #RRel; 
      =     DB135.DBX   29.0; 

// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     46; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB135.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      L     MD   124; 
      L     DB135.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

      L     #U.Seq.SFM[42].Sp; 
      L     DB135.DBD  318; 
      ==D   ; 
      =     #ComSRC; 

      L     DB135.DBD  270; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #ComDST; 

      L     DB135.DBD  366; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #comWTank1; 

      L     DB135.DBD  414; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #ComWTank2; 

      L     DB135.DBD  462; // Destination Material
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      =     #comWTank3; 

      L     DB135.DBD  202; 
      L     MD   124; 
      ==D   ; 
      A     DB135.DBX  218.0; 
      =     #ComVE; // Water Treatment


// Load Source to SFM
      L     DB135.DBD  338; 
      T     #U.Seq.SFM[14].Sp; 

// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB135.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 

// ---------------------------------------------------------------------------
// index evaluation: Current Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[10].Sp,
           Indexes                  := #S2I.SFM10);

// index evaluation: 1. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[11].Sp,
           Indexes                  := #S2I.SFM11);

// index evaluation: 2. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[12].Sp,
           Indexes                  := #S2I.SFM12);

// index evaluation: 3. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[13].Sp,
           Indexes                  := #S2I.SFM13);

// index evaluation: Q-Status
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[39].Sp,
           Indexes                  := #S2I.SFM39);


// index evaluation: Chriwa 1 Status
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[23].Val,
           Indexes                  := #S2I.SFM23);
// index evaluation: Chriwa 2 Status
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[24].Val,
           Indexes                  := #S2I.SFM24);

// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: start position
      JU    X0; // phase  2:
      JU    X3; // phase  3: Prerinse
      JU    X4; // phase  4: Fill System
      JU    X5; // phase  5: Transfer
      JU    X6; // phase  6: Standby
      JU    X0; // phase  7:
      JU    X8; // phase  8: Push Out
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X11; // phase 11: Postrinse
      JU    X0; // phase 12:
      JU    X0; // phase 13:
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X0; // phase 18:
      JU    X0; // phase 19:
      JU    X0; // phase 20:
      JU    X21; // phase 21: Prepare Line
      JU    X22; // phase 22: Tank Selection
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 
// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 
      R     DB135.DBX   26.1; 

      L     0.000000e+000; 
      T     DB135.DBD   30; 
      T     DB135.DBD   34; 
      T     DB135.DBD   38; 
      T     DB135.DBD   42; 
      T     DB135.DBD   50; 
      T     DB135.DBD   54; 
      T     #U.Seq.SFM[42].Sp; // Material
      T     #U.Seq.SFM[10].Sp; // Current Tank
      T     #U.Seq.SFM[11].Sp; // Priority 1
      T     #U.Seq.SFM[12].Sp; // Priority 2
      T     #U.Seq.SFM[13].Sp; // Priority 3

      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   130 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   130 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 
NETWORK
TITLE =phase 3: Prerinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X3:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB135.DBX  363.2,
           P2Rel                    := DB135.DBX  411.2,
           P3Rel                    := DB135.DBX  459.2,
           CurrSel                  := #U.Seq.User.Real10);

      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; 

// ---------------------------------------------------------------------------
// messages 
      A     #S2I.SFM39.I01; // Released
      JCN   N301; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N301: NOP   0; 

      A     M    151.6; // Rinse Amount
      A     #S2I.SFM39.I00; // Please Select
      JCN   N302; 
      L     816; // LAB Release Required
      T     MD    90; 
N302: NOP   0; 


// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 
      =     M    131.6; 

// Presinse
      AN    #U.Seq.SFM[15].P; 
      =     #xTmp; 
      CALL FC   710 (
           RefVal                   := DB135.DBD  326,
           Active                   := #xTmp,
           Reset                    := #U.Seq.SFM[15].Res,
           Down                     := FALSE,
           CntVal                   := #U.Seq.SFM[15].Val,
           RefMem                   := #U.Seq.User.Real1);

// ---------------------------------------------------------------------------
// pause timer  .
      SET   ; 
      S     M    141.7; 
// ---------------------------------------------------------------------------
// communication
// Water Tank
      A     M    102.3; 
      =     DB135.DBX   26.3; 
// Well Management

// ---------------------------------------------------------------------------
// control modules 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A300; 
      JU    COMM; // subphase  0:
      JU    A301; // subphase  1: Gully VEE
      JU    A302; // subphase  2: Gully Befllung
// ---------------------------------------------------------------------------
A300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
// subphase 1: Gully VEE
A301: SET   ; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    131.6; 

      AN    M    151.6; // Rinse Amount
      A     M    103.3; 
      =     DB135.DBX   26.1; // Request Water

      CLR   ; 
      =     DB135.DBX   27.6; 

// -------------------------------------------------
// subphase actuator 
      AN    M    151.6; 
      A     M    103.3; 
      =     DB230.DBX  268.0; 
      =     DB230.DBX  188.0; 

// -------------------------------------------------
// subphase transition 
      A     M    151.6; 
      =     M    103.1; 
      JU    COMM; 
// subphase 2: Gully Befllung
A302: SET   ; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    131.6; 

// Well 
      A     DB135.DBX  218.0; 
      AN    M    151.6; // Rinse Amount
      A     #ComSRC; // Comms Well 
      A     M    103.3; 
      =     DB135.DBX   27.6; 

      A     DB135.DBX  218.1; 
      AN    M    151.6; // Rinse Amount
      A     #ComSRC; // Comms Well 
      A     M    103.3; 
      =     DB135.DBX   26.1; // Request Water

// -------------------------------------------------
// subphase actuator 
// Drain
      AN    DB135.DBX  218.1; 
      AN    M    151.6; 
      A     M    103.3; 
      =     DB230.DBX  268.0; 
      =     DB230.DBX  188.0; 

      A     DB135.DBX  218.1; 
      A     DB135.DBX   75.2; 
      AN    M    151.6; 
      A     M    103.3; 
      =     DB230.DBX  108.0; 

// -------------------------------------------------
// subphase transition 
      A     M    151.6; // Amount
      O     M    120.6; 
      A     #S2I.SFM39.I01; // Released
      AN    M    102.2; 
      =     M    103.1; 
      JU    COMM; 

NETWORK
TITLE =phase 4: Fill System 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X4:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 


// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A400; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 5: Transfer 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X5:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB135.DBX  363.2,
           P2Rel                    := DB135.DBX  411.2,
           P3Rel                    := DB135.DBX  459.2,
           CurrSel                  := #U.Seq.User.Real10);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      A     M    102.3; 
      =     DB135.DBX   26.3; 
// ---------------------------------------------------------------------------
// messages 


// ---------------------------------------------------------------------------
// timer & counter 

// Amount
      AN    #U.Seq.SFM[16].P; 
      =     #xTmp; 
      CALL FC   710 (
           RefVal                   := DB135.DBD  326,
           Active                   := #xTmp,
           Reset                    := #U.Seq.SFM[16].Res,
           Down                     := FALSE,
           CntVal                   := #U.Seq.SFM[16].Val,
           RefMem                   := #U.Seq.User.Real2);

      AN    #U.Seq.SFM[17].P; // TT Counter
      =     #xTmp; 
      CALL FC   710 (
           RefVal                   := DB135.DBD  326,
           Active                   := #xTmp,
           Reset                    := #U.Seq.SFM[17].Res,
           Down                     := FALSE,
           CntVal                   := #U.Seq.SFM[17].Val,
           RefMem                   := #U.Seq.User.Real4);

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      L     #U.Seq.User.Real10; 
      L     0.000000e+000; 
      ==R   ; 
      O     M    151.7; // Amount
      AN    M    102.2; 
      =     M    102.1; 
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y5; 
      L     1; 
      T     MW   116; 
Y5:   SET   ; 
// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase evaluation
      L     MW   110; 
      JL    A500; 
      JU    COMM; // subphase  0:
      JU    A501; // subphase  1: Waiting
      JU    A502; // subphase  2: Active
      JU    A503; // subphase  3: Tank Change
// ---------------------------------------------------------------------------
A500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A501: SET   ; 
      A     M    103.3; 
      =     DB135.DBX   26.0; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A(    ; 
      L     #U.Seq.User.Real10; 
      L     #U.Seq.SFM[10].Sp; 
      <>R   ; 
      )     ; 
      O(    ; 
// A     "C03ComD".SRC.Bit26
      A     DB135.DBX  266.0; 
      A     DB135.DBX  267.2; 
      A     DB135.DBX  314.3; 
      O     #S2I.SFM10.I00; 
      )     ; 
      A     #ComVE; // Water Treatment
      =     M    103.1; 

      JU    COMM; 

// subphase 2: Active
A502: SET   ; 

// Well 
      A     DB135.DBX  218.0; 
      A     #ComSRC; // Comms Well 
      A     M    103.3; 
      =     DB135.DBX   27.6; 

      A     DB135.DBX  266.0; 
      O     DB135.DBX  266.1; 
      A     DB135.DBX  218.1; 
      A     #ComSRC; // Comms Well 
      A     M    103.3; 
      =     DB135.DBX   26.1; // Request Water

// Water Tank
      A     DB135.DBX  314.3; // Well 
      O     DB135.DBX  314.4; // Well  
      A     DB135.DBX  218.1; // neu 20230420
      A     M    103.3; 
      =     DB135.DBX   26.4; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
// -------------------------------------------------
// subphase actuator 
//    A     "C03ComD".SRC.WfEm          // Well Managment
//      O     "C03ComD".SRC.Emti          // Well Managment
//      A     "SOSPH"
//      =     "C03ActD".C03_Act002.ACo

// Drain
      AN    DB135.DBX  218.1; 
      AN    M    151.6; 
      A     M    103.3; 
      CLR   ; 
      =     DB230.DBX  268.0; 
      =     DB230.DBX  188.0; 

// -------------------------------------------------
// subphase transition 
      L     #U.Seq.User.Real10; 
      L     #U.Seq.SFM[10].Sp; 
      <>R   ; 
      O     #S2I.SFM10.I00; 
      ON    #ComSRC; 
      ON    #ComVE; // Water Treatment
      =     M    103.1; 

      JU    COMM; 
// subphase 3: Tank Change
A503: SET   ; 
      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; // Current Tank

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    162.0; 

// -------------------------------------------------
// subphase actuator 
//      A     "U099ComD".Own.Bit26
//      A     "SOSPH"
//      =     "C03ActD".C03_Act001.ACo
// -------------------------------------------------
// subphase transition 
      AN    #S2I.SFM10.I00; 
      AN    M    102.2; 
      =     M    103.1; 
      JU    COMM; 

NETWORK
TITLE =phase 6: Standby
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 02 : Step Time                           Duration        h
X6:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB135.DBX  363.2,
           P2Rel                    := DB135.DBX  411.2,
           P3Rel                    := DB135.DBX  459.2,
           CurrSel                  := #U.Seq.User.Real10);

      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 
      R     DB135.DBX   26.1; 

      A     M    102.3; 
      =     DB135.DBX   27.2; 
// ---------------------------------------------------------------------------
// messages 
      AN    M    151.7; 
      A     M    150.1; // Max Standby Time
      JCN   N601; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N601: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 
      =     M    130.1; 
// ---------------------------------------------------------------------------
// pause timer
//      ON    "SOPH"
//      O     "SFM02D"
//      S     "SFM02P"                    // Step Time

      SET   ; 
      S     M    141.7; 

// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      =     DB135.DBX   27.7; // Bereit fr Rcksplen

// Check Partner
      AN    #ComSRC; 
      O(    ; 
      AN    DB135.DBX  314.3; 
      AN    DB135.DBX  314.4; 
      )     ; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      JCN   NC06; 
      L     904; // "Source Not Ready!
      T     MD    90; 
NC06: NOP   0; 

      A     #S2I.SFM23.I02; 
      A     #S2I.SFM24.I02; 
      JC    NM01; 
      L     913; // Wasseraufbereitung nicht bereit
      T     MD    90; 
NM01: NOP   0; 

// Rcksplen Wasseraufbereitung
      A     #S2I.SFM23.I00; 
      O     #S2I.SFM24.I00; 
      A     DB135.DBX  218.0; 
      A     #ComSRC; // Comms Well 
      A     M    103.3; 
      =     DB135.DBX   27.6; 
      =     DB135.DBX   26.1; // Request Water
      =     DB230.DBX  108.0; 

// ---------------------------------------------------------------------------
// control moduless

// ---------------------------------------------------------------------------
// transition condition 
      CLR   ; 
      =     #xTmp; 

      AN    #S2I.SFM10.I00; 
      AN    M    150.1; // Max Standby Time
      AN    M    151.7; 
      S     #xTmp; // AutoCont
      JCN   N6x2; 
      L     MW   104; 
      L     -1; 
      +I    ; 
      T     MW   106; 
N6x2: NOP   0; 

      A     M    150.1; // Max Standby Time
      AN    M    151.7; 
      A     M    120.6; 
      S     #xTmp; // ReqRestart
      JCN   N6y2; 
      L     MW   104; 
      L     -2; 
      +I    ; 
      T     MW   106; 
N6y2: NOP   0; 

      A     M    150.1; // Max Standby Time
      A     M    151.7; 
      S     #xTmp; // ReqEnd

      A     #xTmp; 
      AN    M    102.2; 
      A     #S2I.SFM23.I02; 
      A     #S2I.SFM24.I02; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A600; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A600: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 8: Push Out 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X8:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A800; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 11: Postrinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X11:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 21: Prepare Line 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X21:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      A     M    102.2; 
      JCN   N903; 
      L     DB135.DBD  330; 
      T     #U.Seq.SFM[22].Sp; 
N903: NOP   0; 
// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
      A     #ComSRC; 
      A     M    103.3; 
      =     DB135.DBX   26.0; // Wait for filling
      =     DB135.DBX   27.2; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      AN    M    102.2; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y21
//      L     1
//      T     "SOSubStepNew"
//Y21:  SET

// subphase evaluation
      L     MW   110; 
      JL    C100; 
      JU    COMM; // subphase  0:
      JU    C101; // subphase  1: Start Well
      JU    C102; // subphase  2: Check Partner
// ---------------------------------------------------------------------------
C100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Start Well
C101: SET   ; 
// Request Well start

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     DB135.DBX  314.3; // Well Ready   
      A     #ComSRC; 
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Check Partner
C102: SET   ; 
      A     M    103.3; 
      =     DB135.DBX   26.3; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      AN    DB135.DBX   75.2; // Swingbend drain Tank filling
      JCN   N801; 
      L     920; // Check connections (Swingbend)
      T     MD    90; 
N801: NOP   0; 

// -------------------------------------------------
// subphase transition 
      A     DB135.DBX   75.2; // Swingbend drain Tank filling
      A     DB135.DBX  314.3; // Well Ready 
      A     #ComSRC; // Communication Well Management
      A     #ComVE; // Water Treatment
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

NETWORK
TITLE =phase 22: Tank Selection 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X22:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   130 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// Load Source to SFM
      A     DB231.DBX   78.7; 
      JCN   BR2A; 
      L     4.001000e+003; // Well 2A
      JU    BR07; 
BR2A: A     DB231.DBX  138.7; 
      JCN   BR2B; 
      L     4.002000e+003; // Well 2B
      JU    BR07; 
BR2B: A     DB231.DBX  198.7; 
      JCN   BR03; 
      L     4.003000e+003; // Well 3
      JU    BR07; 
BR03: A     DB231.DBX  258.7; 
      JCN   BR07; 
      L     4.004000e+003; // Well 7
      JU    BR07; 
BR07: NOP   0; 
      T     #U.Seq.SFM[14].Sp; // Source



// ---------------------------------------------------------------------------
// messages 

      AN    #S2I.SFM11.I00; // Priority 1 Tank   
      A     #ComSRC; 
      JCN   N901; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N901: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      R     DB135.DBX   26.1; 
// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     M    120.6; 
      A     #ComSRC; 
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// pause timer unit parameter
// Comm with Transfer Plan Unit
      AN    DB135.DBX  509.0; 
      R     DB135.DBX   29.0; 

      L     DB135.DBD  510; 
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      AN    DB135.DBX  504.7; 
      AN    DB135.DBX   24.7; 
      =     #ComPLN; 

      A     DB135.DBX  509.0; 
      AN    DB135.DBX   29.0; 
      A     #ComPLN; 
      A     M    102.3; 
      JCN   CpDt; 
      SET   ; 
      =     DB135.DBX   29.0; 
// Menge
      L     DB135.DBD  514; 
      L     #U.Seq.SFM[16].E; 
      -R    ; 
      L     #U.Seq.SFM[16].Sp; 
      +R    ; 
      T     #U.Seq.SFM[16].Sp; 

// Tanks
      L     #U.Seq.SFM[11].Sp; 
      L     0.000000e+000; 
      ==R   ; 
      JCN   T1st; 
      L     DB135.DBD  518; 
      T     #U.Seq.SFM[11].Sp; 
T1st: NOP   0; 
      L     #U.Seq.SFM[12].Sp; 
      L     0.000000e+000; 
      ==R   ; 
      JCN   T2st; 
      L     DB135.DBD  518; 
      T     #U.Seq.SFM[12].Sp; 
T2st: NOP   0; 
      L     #U.Seq.SFM[13].Sp; 
      L     0.000000e+000; 
      ==R   ; 
      JCN   T3st; 
      L     DB135.DBD  518; 
      T     #U.Seq.SFM[13].Sp; 
T3st: NOP   0; 


CpDt: NOP   0; 


NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  
      AN    M    120.7; 
      S     M    131.7; 

// Check Selection / Material -----------------------------------------------
      L     0; 
      L     DB135.DBD  270; // 1. Tank
      <R    ; 
      JCN   MCk1; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      S     M    120.3; 
      JCN   MCk0; 
      L     910; 
      T     MD    80; 
MCk0: NOP   0; 
      L     0; 
      L     DB135.DBD  366; // 1. Tank
      <R    ; 
      JCN   MCk1; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk1; 
      L     910; 
      T     MD    90; 
MCk1: NOP   0; 
      L     0; 
      L     DB135.DBD  414; // 2. Tank
      <R    ; 
      JCN   MCk2; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk2; 
      L     910; 
      T     MD    90; 
MCk2: NOP   0; 
      L     0; 
      L     DB135.DBD  462; // 3. Tank
      <R    ; 
      JCN   MCk3; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk3; 
      L     910; 
      T     MD    90; 
MCk3: NOP   0; 

      L     #U.Seq.SFM[11].Sp; 
      L     #U.Seq.SFM[12].Sp; 
      OD    ; 
      L     #U.Seq.SFM[13].Sp; 
      OD    ; 
      L     0; 
      >R    ; 
      O     M    120.7; 
      JC    TSel; 
      A     #S2I.SFM11.I00; 
      L     905; // "Destination not Selected"
      T     MD    90; 
TSel: NOP   0; 

NETWORK
TITLE =Process Status Management

      NOP   0; 
// ---------------------------------------------------------------------------
// Signal Control

      OPN   DB   500; 
      L     #UnitNo; 
      L     32; //U Structure Length
      *I    ; 
      L     20; //DB Heading Offset
      +I    ; 
      SLD   3; 
      LAR2  ; 

// -------------------------------------------------
// Maintenance
      A     #U.Seq.Switch.Sw31; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.0]; //"PStatD".U[#UnitNo].MTNC
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
      A     DB135.DBX   26.2; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.7]; //"PStatD".U[#UnitNo].FULL
// -------------------------------------------------
// Filling
      A     DB135.DBX   26.1; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.0]; //"PStatD".U[#UnitNo].FILL   
// -------------------------------------------------
// Ready For Filling
      A     DB135.DBX   26.0; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.1]; //"PStatD".U[#UnitNo].RFFI 
// -------------------------------------------------
// Empty
      A     DB135.DBX   26.5; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.2]; //"PStatD".U[#UnitNo].EMTY 
// -------------------------------------------------
// Emptying
      A     DB135.DBX   26.4; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.3]; //"PStatD".U[#UnitNo].EMTI
// -------------------------------------------------
// Ready For Emptying
      A     DB135.DBX   26.3; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.4]; //"PStatD".U[#UnitNo].RFEM
// -------------------------------------------------
// Reserved
//      A     #ComXYZ
//      OPN   "PStatD"
//      =     DBX [AR2,P#1.5]             //"PStatD".U[#UnitNo].RESV
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used

// -------------------------------------------------
// PStat Function Call 

      CALL FC   500 (
           UnitNo                   := #UnitNo,
           PStatModVal              := DB235.DBD  234);

NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 


// ---------------------------------------------------------------------------
// Check Partner
      AN    #ComSRC; 
      O(    ; 
      AN    DB135.DBX  314.3; 
      AN    DB135.DBX  314.4; 
      )     ; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      JCN   NC03; 
      L     904; // "Source Not Ready!
      T     MD    90; 
NC03: NOP   0; 


      AN    DB135.DBX  266.0; // Water Tank Ready
      AN    DB135.DBX  266.1; 
      AN    #ComDST; 
      A     #S2I.SFM10.I00; 
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B22; 
      AN    #U.Seq.PO.B3; 
      AN    #CIP; 
      JCN   NC04; 
      L     903; // Destination not Ready
      T     MD    90; 
NC04: NOP   0; 



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 133
TITLE =C03: Local Well Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C03E
VERSION : 1.2
CODE_VERSION1


VAR
  U : UDT 131;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
  ComCIP1 : BOOL ;	//CIP1 in use
  ComCIP3 : BOOL ;	//CIP3 in use
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     #U.Seq.User.Bit63; 
      CC    FB   139; // "C03Sim"
      A     #U.Seq.Sim; 
      =     #U.Seq.User.Bit63; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     MB   112; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB135.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    #U.Seq.Switch.Sw31; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   135; // C03Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// U31_AnI001 J6F_Druck
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB233.DBD  238; 

      SET   ; 
      =     DB233.DBX  141.5; 

// ----------------------------------------------------------
// QI_CO2_J6F_PH 
// ----------------------------------------------------------
      L     #U.Seq.SFM[15].Sp; 
      T     DB233.DBD  358; 

      SET   ; 
      =     DB233.DBX  261.5; 

// ----------------------------------------------------------
// U31_AnI003 spare
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB233.DBD  478; 

      SET   ; 
      =     DB233.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C03UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C03UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C03UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C03UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// U31_SpI001 spare
// ----------------------------------------------------------
      CLR   ; // Only used in one well?    
      =     DB231.DBX   81.4; 
      =     DB231.DBX   81.5; 

// ----------------------------------------------------------
// U31_SpI002 spare
// ----------------------------------------------------------
      CLR   ; // Only used in one well?       
      =     DB231.DBX  141.4; 
      =     DB231.DBX  141.5; 

// ----------------------------------------------------------
// U31_SpI003 spare
// ----------------------------------------------------------
      CLR   ; // Only used in one well?       
      =     DB231.DBX  201.4; 
      =     DB231.DBX  201.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB237.DBX   80.7; 
      =     DB237.DBX   81.4; 

      CLR   ; 
      =     DB237.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB237.DBX  140.7; 
      =     DB237.DBX  141.4; 

      CLR   ; 
      =     DB237.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB237.DBX  200.7; 
      =     DB237.DBX  201.4; 

      CLR   ; 
      =     DB237.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// CO2J6FRV1 CO2 J6F RV1
// ----------------------------------------------------------
// starting value -----------------------
      A     DB230.DBX   22.6; // Insert Correct ACt!!!
      A     #GenRel; 
      =     DB236.DBX  203.2; 
      =     DB236.DBX  203.5; 

// enable alarm -------------------------
      A     DB236.DBX  203.5; 
      A     DB236.DBX  201.4; 
      AN    DB236.DBX  203.1; 
      AN    DB236.DBX  203.3; 
      AN    DB236.DBX  203.4; 
      =     DB236.DBX  203.0; 

// setpoint to controller ---------------
      L     #U.Seq.SFM[15].Sp; // pH
      T     DB236.DBD  234; 

// static value to controller ----------
      L     #U.Seq.SFM[15].Sp; //  pH
      T     DB236.DBD  238; 

// process value to controller ----------
      L     DB233.DBD  266; 
      T     DB236.DBD  254; 

// low/high value to controller ---------
      L     DB233.DBD  270; 
      T     DB236.DBD  218; 

      L     DB233.DBD  274; 
      T     DB236.DBD  222; 

NETWORK
TITLE =Sequence organisation
// 
// SFM supply ----------------------------------------------------------------

// analog value to SFM J6F_Druck -----------------------
      L     DB233.DBD  146; 
      T     #U.Seq.SFM[63].Val; 

// analog value to SFM QI_CO2_J6F_PH -------------------
      L     DB233.DBD  266; 
      T     #U.Seq.SFM[63].Val; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB233.DBD  386; 
      T     #U.Seq.SFM[63].Val; // !!! insert correct SFM !!!


// Amount from Well PLC04
      L     DB135.DBD  222; 
      T     #U.Seq.SFM[41].Val; 


NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB230.DBX  105.4; 
      =     DB230.DBX  185.4; 
      =     DB230.DBX  265.4; 

// assign PID mode
      S     DB236.DBX  201.4; 
      S     DB236.DBX  201.5; 

MODE: SET   ; 

NETWORK
TITLE =C03_Act001 spare

      A     #GenRel; 
      A     DB230.DBX  106.7; 
      =     DB230.DBX  107.6; 
NETWORK
TITLE =C03_Act002 spare

      A     #GenRel; 
      A     DB230.DBX  186.7; 
      =     DB230.DBX  187.6; 
NETWORK
TITLE =C03_Act003 spare

      A     #GenRel; 
      A     DB230.DBX  266.7; 
      =     DB230.DBX  267.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 135
TITLE =C03: Local Well Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C03Comm
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 131;	
END_VAR
VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	//CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
  rUnitNo : REAL ;	
  DSTUnit : INT ;	//Destination Unit
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

      L     DB135.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB135.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB135.DBD   10; 
      L     DB135.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// emergency OK -------------------------------------------------------------
      A     DB135.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/
      CALL SFC   20 (
           SRCBLK                   := DB1995.Own,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB135.GEN);

// ... CIP Unit ------------- /

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.CIP,
           RET_VAL                  := #wRetVal);

//----------------------------------------
// Communication Water Tank 
//----------------------------------------
// Current Tank ----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[10].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[10].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N201; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.DST,
           RET_VAL                  := #wRetVal);
      JU    N2x1; 
N201: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB135.DST);
N2x1: NOP   0; 
// Priority 1 -----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[11].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[11].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N202; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.DST1,
           RET_VAL                  := #wRetVal);
      JU    N2x2; 
N202: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB135.DST1);
N2x2: NOP   0; 

// Priority 2 ----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[12].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[12].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N203; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.DST2,
           RET_VAL                  := #wRetVal);
      JU    N2x3; 
N203: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB135.DST2);
N2x3: NOP   0; 

// Priority 3 ----------------------------
      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[13].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #U.Seq.SFM[13].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N204; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.DST3,
           RET_VAL                  := #wRetVal);
      JU    N2x4; 
N204: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB135.DST3);
N2x4: NOP   0; 

//----------------------------------------
// Communication Water Treatment 
//----------------------------------------
      L     21; 
      L     DB135.DBW   16; 
      ==I   ; 
      JCN   WTR2; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB135.DBW   14,
           SourceUnitNo             := 38,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.PARTNER,
           RET_VAL                  := #wRetVal);
WTR2: L     22; 
      ==I   ; 
      JCN   NWTR; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := DB135.DBW   14,
           SourceUnitNo             := 39,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.PARTNER,
           RET_VAL                  := #wRetVal);

NWTR: NOP   0; 

//----------------------------------------
// Communication Local Wells
//----------------------------------------
      L     #U.Seq.SFM[14].Sp; // Source
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      L     #iUnit; 
      L     1; 
      ==I   ; 
      JCN   U001; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U001,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB135.SRC);
U001: NOP   0; 

      L     #iUnit; 
      L     2; 
      ==I   ; 
      JCN   U002; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U002,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB135.SRC);
U002: NOP   0; 

      L     #iUnit; 
      L     3; 
      ==I   ; 
      JCN   U003; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U003,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB135.SRC);
U003: NOP   0; 

      L     #iUnit; 
      L     4; 
      ==I   ; 
      JCN   U004; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P04U004,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB135.SRC);
U004: NOP   0; 

// Plan ----------------------------
      L     #UnitNo; 
      L     100; 
      +I    ; 
      T     #iUnit; 

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB135.PLN,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =external releases

      SET   ; 
      =     DB230.DBX  106.7; 
      =     DB230.DBX  186.7; 
      =     DB230.DBX  266.7; 

NETWORK
TITLE =write own unit data

      SET   ; 
//-- CIP Communication ---------------------------------------
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B30; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB135.DBD  150; 
      T     #U.Seq.SFM[32].Val; 

//Temperature CIP Return
      L     DB135.DBD  146; 
      T     #U.Seq.SFM[30].Val; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := #U.Seq.SFM[36].Sp,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB135.DBX  171.7; 
      JCN   pfc; 
      L     #U.Seq.SFM[34].Sp; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB135.DBX  172.0; 
      JCN   ppc; 
      L     #U.Seq.SFM[35].Sp; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB135.DBX  171.6; 
      JCN   pxc; 
      L     #U.Seq.SFM[29].Sp; 
pxc:  NOP   0; 
      T     DB135.DBD  182; 

//CIP Return
      L     #U.Seq.SFM[28].Sp; 
      T     DB135.DBD  186; 
      L     DB135.DBD  138; 
      T     #U.Seq.SFM[28].Val; 

//CIP Prerun
      L     #U.Seq.SFM[27].Sp; 
      T     DB135.DBD  190; 
      L     DB135.DBD  142; 
      T     #U.Seq.SFM[27].Val; 

// Write Own Data to CIP
      L     DB135.DBD   10; 
      T     DB135.DBD  154; 

      L     DB135.DBW   14; 
      T     DB135.DBW  158; 

      L     DB135.DBW   16; 
      T     DB135.DBW  160; 

      L     DB135.DBW   18; 
      T     DB135.DBW  162; 

      L     DB135.DBW   20; 
      T     DB135.DBW  164; 

      L     DB135.DBW   22; 
      T     DB135.DBW  166; 

      A     DB135.DBX   24.0; 
      =     DB135.DBX  168.0; 

      A     DB135.DBX   24.1; 
      =     DB135.DBX  168.1; 

      A     DB135.DBX   24.2; 
      =     DB135.DBX  168.2; 

      A     DB135.DBX   24.3; 
      =     DB135.DBX  168.3; 

      A     DB135.DBX   24.4; 
      =     DB135.DBX  168.4; 

      A     DB135.DBX   24.5; 
      =     DB135.DBX  168.5; 

      A     DB135.DBX   24.6; 
      =     DB135.DBX  168.6; 

      A     DB135.DBX   24.7; 
      =     DB135.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB135.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB135.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "C03SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB135.DBX   26.5; 

//Full Signal
//A     "C03SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB135.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB135.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB135.DBX   27.0; //Emergency Stop OK

      L     #U.Seq.SFM[42].Sp; // Material
      T     DB135.DBD   30; 

      L     DB135.DBD  326; 
      T     #U.Seq.User.Real3; 

//----------------------------------------
// Communication Water Tank
//----------------------------------------


      L     #U.Seq.SFM[10].Sp; // Current Tank
      T     DB135.DBD   34; 

      L     #U.Seq.SFM[11].Sp; // Tank Priority 1
      T     DB135.DBD   38; 

      L     #U.Seq.SFM[12].Sp; // Tank Priority 2
      T     DB135.DBD   42; 

      L     #U.Seq.SFM[13].Sp; // Tank Priority 3
      T     DB135.DBD   46; 

      L     #U.Seq.SFM[14].Sp; // Source
      T     DB135.DBD   50; 

NETWORK
TITLE = read from other unit data




END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 139
TITLE =C03: Local Well Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C03Sim
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 131;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     MW   114; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     #U.Seq.Sim; 
      =     DB230.DBX  105.3; 
      =     DB230.DBX  185.3; 
      =     DB230.DBX  265.3; 


NETWORK
TITLE =Special Input

      A     #U.Seq.Sim; 
      =     DB231.DBX   81.3; 
      =     DB231.DBX  141.3; 
      =     DB231.DBX  201.3; 

NETWORK
TITLE =Counter

      A     #U.Seq.Sim; 
      A     M    101.0; 

NETWORK
TITLE =Analog Input

      A     #U.Seq.Sim; 
      =     DB233.DBX  141.3; 
      =     DB233.DBX  261.3; 
      =     DB233.DBX  381.3; 
NETWORK
TITLE =Universal Value

      A     #U.Seq.Sim; 
      =     DB235.DBX  149.3; 
      =     DB235.DBX  277.3; 
      =     DB235.DBX  405.3; 
      =     DB235.DBX  533.3; 

NETWORK
TITLE =PID

      A     #U.Seq.Sim; 
      =     DB236.DBX  201.3; 

NETWORK
TITLE =Message

      A     #U.Seq.Sim; 
      =     DB237.DBX   81.3; 
      =     DB237.DBX  141.3; 
      =     DB237.DBX  201.3; 

NETWORK
TITLE =VLT

      A     #U.Seq.Sim; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 141
TITLE =C04: Water Transfer Plant x
// NW  1 : phase and index evaluation
// NW  2 : phase  1: start position
// NW  3 : phase  3: Prerinse
// NW  4 : phase  4: Fill System
// NW  5 : phase  5: Transfer
// NW  6 : phase  8: Push Out
// NW  7 : phase 11: Postrinse
// NW  8 : phase 21: Prepare Line
// NW  9 : phase 22: Tank Selection
// NW 10 : phase 30: CIP Passive
// NW 11 : phase 31: CIP Start
// NW 12 : phase 32: CIP Push Out
// NW 13 : phase 34: CIP Rinsing
// NW 14 : phase 36: CIP Drain
// NW 15 : phase 40: CIP End
// NW 16 : end of sequence
// NW 17 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Process Time                        Duration        min
// 40 : Density                             Value           kg/l
// 42 : Material                            Value
// 43 : Source                              Value
// 44 : Standby                             Value
AUTHOR : Woermann
NAME : C04Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 141;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  ComSRC : BOOL ;	//Communication With Well Transfer x
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  wTmp : WORD ;	
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dUnitNo : DINT ;	//Unit Number 
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM26 : STRUCT 	//CIP Step On Condition
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Conductivity High
    I02 : BOOL ;	//Conductivity Low
    I03 : BOOL ;	//Time
    I04 : BOOL ;	//Amount
    I05 : BOOL ;	//Temperature High
    I06 : BOOL ;	//Temperature Low
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM27 : STRUCT 	//CIP Prerun
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM28 : STRUCT 	//CIP Return
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	//Drain
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM37 : STRUCT 	//CIP Pump Mode
    I00 : BOOL ;	//Off
    I01 : BOOL ;	//Flow
    I02 : BOOL ;	//Pressure
    I03 : BOOL ;	//Fix Speed
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM31 : STRUCT 	//CIP Distribution Circuit No
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Auto Select
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM39 : STRUCT 	//Q-Status
    I00 : BOOL ;	//Please select
    I01 : BOOL ;	//released
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	//Ignore
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	//locked
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM10 : STRUCT 	//Current Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM11 : STRUCT 	//1. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM12 : STRUCT 	//2. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM13 : STRUCT 	//3. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Water Tank 1
    I02 : BOOL ;	//Water Tank 2
    I03 : BOOL ;	//Water Tank 2
    I04 : BOOL ;	//Water Tank 3
    I05 : BOOL ;	//Water Tank 4
    I06 : BOOL ;	//Water Tank 5
    I07 : BOOL ;	//Water Tank 6
    I08 : BOOL ;	//Water Tank 7
    I09 : BOOL ;	//Water Tank 8
    I10 : BOOL ;	//WAter Tank 9
    I11 : BOOL ;	//Water Tank 10
    I12 : BOOL ;	//Water Tank 11
    I13 : BOOL ;	//Water Tank 12
    I14 : BOOL ;	//Water Tank 13
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM14 : STRUCT 	//3. Tank
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Yes
    I02 : BOOL ;	//No
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM18 : STRUCT 	//CIP Start / CIP Distribution Start
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//CIP 1
    I02 : BOOL ;	//CIP 2
    I03 : BOOL ;	//CIP 3
    I04 : BOOL ;	//Auto Select
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM24 : STRUCT 	//Confirm Connections
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Yes
    I02 : BOOL ;	//No
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
  ComDST : BOOL ;	//Communication Water Transfer to Packaging Plant
  ComCIPDist : BOOL ;	//Communication with CIP Distribution
  CurrSel : REAL ;	//Current Tank Selection SP
  comWTank1 : BOOL ;	//Communication Water Tank Priority 1
  comWTank2 : BOOL ;	//Communication Water Tank Priority 2
  comWTank3 : BOOL ;	//Communication Water Tank Priority 3
  RelInlet : BOOL ;	
  ComCIP1 : BOOL ;	//Communication With CIP1
  ComCIP2 : BOOL ;	//Communication With CIP2
  ComCIP3 : BOOL ;	//Communication With CIP3
  Empty : BOOL ;	
  ComDistCIP1 : BOOL ;	//Communication With CIP Distribution 1
  ComDistCIP2 : BOOL ;	//Communication With CIP Distribution 2
  ComDistCIP3 : BOOL ;	//Communication With CIP Distribution 3
  LineID : INT ;	// LineTank Com ID
END_VAR
BEGIN
NETWORK
TITLE = Phase and Index Evaluation

      CLR   ; 
      =     #RRel; 
      =     #xTmp; 
      =     DB145.DBX   29.5; 
      =     DB145.DBX   29.7; 
      =     DB145.DBX  173.7; 

      L     MB   112; 
      L     43; 
      -I    ; 
      JL    LIDE; 
      JU    ID43; 
      JU    LIDE; 
      JU    ID45; 
      JU    LIDE; 
      JU    ID47; 
      JU    LIDE; 
      JU    ID49; 
      JU    ID50; 
      JU    ID51; 
      JU    ID52; 
      JU    LIDE; 
      JU    ID54; 
      JU    LIDE; 
      JU    ID56; 
      JU    ID57; 
      JU    ID58; 
      JU    LIDE; 
LIDE: L     0; 
      JU    FIM1; 
ID43: L     1; 
      JU    FIM1; 
ID45: L     2; 
      JU    FIM1; 
ID47: L     4; 
      JU    FIM1; 
ID49: L     8; 
      JU    FIM1; 
ID50: L     16; 
      JU    FIM1; 
ID51: L     32; 
      JU    FIM1; 
ID52: L     64; 
      JU    FIM1; 
ID54: L     128; 
      JU    FIM1; 
ID56: L     256; 
      JU    FIM1; 
ID57: L     512; 
      JU    FIM1; 
ID58: L     1024; 
      JU    FIM1; 
FIM1: NOP   0; 
      T     #LineID; 

// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     60; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB145.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      L     MD   124; 
      L     DB145.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

      L     MD   124; 
      L     DB145.DBD  394; 
      ==D   ; 
      A     DB145.DBX  411.4; 
      =     #ComCIPDist; 

      L     DB145.DBW  400; 
      L     94; 
      ==I   ; 
      =     #ComDistCIP1; 

      L     DB145.DBW  400; 
      L     95; 
      ==I   ; 
      =     #ComDistCIP2; 

      L     DB145.DBW  400; 
      L     96; 
      ==I   ; 
      =     #ComDistCIP3; 

      L     DB145.DBW  112; 
      L     91; 
      ==I   ; 
      =     #ComCIP1; 

      L     DB145.DBW  112; 
      L     92; 
      ==I   ; 
      =     #ComCIP2; 

      L     DB145.DBW  112; 
      L     93; 
      ==I   ; 
      =     #ComCIP3; 


//---
      AN    M    120.7; 
      =     #ComSRC; 

      L     MD   124; 
      L     DB145.DBD  442; 
      ==D   ; 
      =     #ComDST; 

// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB145.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 

// ---------------------------------------------------------------------------
// index evaluation: Current Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[10].Sp,
           Indexes                  := #S2I.SFM10);

// index evaluation: 1. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[11].Sp,
           Indexes                  := #S2I.SFM11);

// index evaluation: 2. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[12].Sp,
           Indexes                  := #S2I.SFM12);

// index evaluation: 3. Tank
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[13].Sp,
           Indexes                  := #S2I.SFM13);

// index evaluation: Trap Filter
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[14].Sp,
           Indexes                  := #S2I.SFM14);

// index evaluation: Q-Status
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[39].Sp,
           Indexes                  := #S2I.SFM39);

// index evaluation: CIP Distribution Start
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[18].Sp,
           Indexes                  := #S2I.SFM18);


// Tank Priority Selection
      CALL FC   779 (
           P1Sel                    := #U.Seq.SFM[11].Sp,
           P2Sel                    := #U.Seq.SFM[12].Sp,
           P3Sel                    := #U.Seq.SFM[13].Sp,
           P1Rel                    := DB145.DBX  267.3,
           P2Rel                    := DB145.DBX  315.3,
           P3Rel                    := DB145.DBX  363.3,
           CurrSel                  := #U.Seq.User.Real10);


// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: start position
      JU    X0; // phase  2:
      JU    X3; // phase  3: Prerinse
      JU    X4; // phase  4: Fill System
      JU    X5; // phase  5: Transfer
      JU    X0; // phase  6:
      JU    X0; // phase  7:
      JU    X8; // phase  8: Push Out
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X11; // phase 11: Postrinse
      JU    X0; // phase 12:
      JU    X0; // phase 13:
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X0; // phase 18:
      JU    X19; // phase 19: Remove Filter Candles
      JU    X20; // phase 20: Replace Filter Candles
      JU    X21; // phase 21: Prepare Line
      JU    X22; // phase 22: Tank Selection
      JU    X0; // phase 23:
      JU    X0; // phase 24:
      JU    X0; // phase 25:
      JU    X0; // phase 26:
      JU    X0; // phase 27:
      JU    X0; // phase 28:
      JU    X0; // phase 29:
      JU    X30; // phase 30: CIP Active
      JU    X31; // phase 31: CIP Start
      JU    X32; // phase 32: CIP Prerun
      JU    X33; // phase 33: CIP Return
      JU    X34; // phase 34: CIP Rinsing
      JU    X35; // phase 35: CIP Emptying
      JU    X36; // phase 36: CIP Drain
      JU    X0; // phase 37:
      JU    X38; // phase 38: CIP Randvollstellung
      JU    X39; // phase 39: CIP Rinsing from RWT
      JU    X40; // phase 40: CIP End
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 

// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 

      A     M    102.0; 
      R     DB145.DBX   26.1; 
      L     0; 
      T     #U.Seq.SFM[10].Sp; 
      T     #U.Seq.SFM[11].Sp; 
      T     #U.Seq.SFM[12].Sp; 
      T     #U.Seq.SFM[13].Sp; 


      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   140 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   140 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 

NETWORK
TITLE =phase 3: Prerinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X3:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A300; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 4: Fill System 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X4:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A400; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 5: Transfer 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X5:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// Communication Water Tank
      L     #LineID; 
      L     DB145.DBD  242; 
      AW    ; 
      L     #LineID; 
      ==I   ; 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// Communication Water Tank
      A     M    103.3; 
      =     DB145.DBX   26.1; 

      A     DB145.DBX  218.4; 
      A     #RRel; 
      =     DB145.DBX   26.4; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      CLR   ; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y5; 
      L     1; 
      T     MW   116; 
Y5:   SET   ; 

// subphase evaluation
      L     MW   110; 
      JL    A500; 
      JU    COMM; // subphase  0:
      JU    A501; // subphase  1: Waiting
      JU    A502; // subphase  2: Active
      JU    A503; // subphase  3: Tank Change
// ---------------------------------------------------------------------------
A500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A501: SET   ; 
      A     M    103.3; 
      =     DB145.DBX   26.3; // Plant Comm
      =     DB145.DBX   26.0; // Tank Comm
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      L     #U.Seq.User.Real10; 
      L     #U.Seq.SFM[10].Sp; 
      <>R   ; 
      O     #S2I.SFM10.I00; 
      =     #xTmp; 

      A     #xTmp; 
      O     DB145.DBX   26.4; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
A502: SET   ; 


// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     #S2I.SFM14.I01; 
      A     M    103.3; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  268.0; 
      =     DB240.DBX  348.0; 

      A     #RRel; 
      A     M    102.3; 
      =     DB240.DBX  108.0; 

// -------------------------------------------------
// subphase transition 
      L     #U.Seq.User.Real10; 
      L     #U.Seq.SFM[10].Sp; 
      <>R   ; 
      O     #S2I.SFM10.I00; 
      =     #xTmp; 

      A     #xTmp; 
      ON    DB145.DBX   26.4; 
      =     M    103.1; 

      A     #xTmp; // Tankwechsel
      JC    COMM; 
      L     MW   118; 
      L     -1; 
      +I    ; 
      T     MW   116; 
      JU    COMM; 

// subphase 3: Tank Change
A503: SET   ; 
      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; // Current Tank

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      AN    #S2I.SFM10.I00; 
      AN    M    102.2; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 8: Push Out 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X8:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// Current Tank
      L     #U.Seq.User.Real10; 
      T     #U.Seq.SFM[10].Sp; 

// ---------------------------------------------------------------------------
// general functions 
      L     #LineID; 
      L     DB145.DBD  242; 
      AW    ; 
      L     #LineID; 
      ==I   ; 
      CLR   ; 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 

// ---------------------------------------------------------------------------
// pause timer
      AN    #ComSRC; 
      ON    M    102.3; 
      O     M    152.0; 
      S     M    142.0; 

      AN    M    102.3; 
      O     M    150.7; 
      S     M    140.7; 

// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      =     DB145.DBX   29.1; 

// ---------------------------------------------------------------------------
// control modules 

// ---------------------------------------------------------------------------
// transition condition 
      AN    #ComCIPDist; 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A800; 
      JU    COMM; // subphase  0:
      JU    A801; // subphase  1: Waiting
      JU    A802; // subphase  2: Active
      JU    A803; // subphase  3: Backwards
      JU    A804; // subphase  4: CIP Start
// ---------------------------------------------------------------------------
A800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A801: SET   ; 
      A     M    103.3; 
      =     DB145.DBX   26.3; 
      =     DB145.DBX   26.0; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      SET   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
A802: SET   ; 
      A     M    103.3; 
      =     DB145.DBX   26.4; 
      =     DB145.DBX   26.1; 
      =     DB145.DBX  173.7; // CIP Ende

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
      SET   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Backwards
A803: SET   ; 
      A     DB145.DBX  411.5; 
      A     DB145.DBX   75.4; 
      A     DB240.DBX  422.6; 
      O     DB240.DBX  502.6; 
      O     DB240.DBX  582.6; 
      A     #ComSRC; 
      A     M    103.3; 
      =     DB145.DBX   26.1; 

// -------------------------------------------------
// subphase timer & counter
      A     DB145.DBX  218.4; 
      A     M    103.0; 
      =     M    130.7; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     #RRel; 
      A     #ComCIPDist; 
      A     M    103.3; 
      =     DB145.DBX  173.6; // Req Common Drain 

      A     #RRel; 
      A     #ComCIPDist; 
      A     #ComDistCIP1; 
      A     M    103.3; 
      =     DB240.DBX  428.0; // CIP Distribution 1

      A     #RRel; 
      A     #ComCIPDist; 
      A     #ComDistCIP2; 
      A     M    103.3; 
      =     DB240.DBX  508.0; // CIP Distribution 2

      A     #RRel; 
      A     #ComCIPDist; 
      A     #ComDistCIP3; 
      A     M    103.3; 
      =     DB240.DBX  588.0; // CIP Distribution 3

// -------------------------------------------------
// subphase transition 
      A     M    150.7; // Substep Time Done
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

// subphase 4: CIP Start
A804: SET   ; 
// CIP Distribution Start
      L     #U.Seq.SFM[18].Sp; 
      L     1.000000e+000; // Auto select
      ==I   ; 
      JCN   CIPb; 
      L     MB   112; 
      L     43; 
      ==I   ; 
      JC    N5sd; 
      CALL FC   711 (
           StartType                := 6,
           Release                  := TRUE,
           CIPEqID                  := #iTmp);
      JU    Fin1; 
N5sd: NOP   0; 
      L     3095; 
      T     #iTmp; 
Fin1: NOP   0; 

      L     0; 
      L     #iTmp; 
      ==I   ; 
      JC    CIPb; 
      ITD   ; 
      DTR   ; 
      T     #U.Seq.SFM[18].Sp; // CIP Distribution Start
CIPb: NOP   0; 

//---
// CIP 1 Start
      L     #U.Seq.SFM[18].Sp; 
      L     3.094000e+003; // CIP 1 
      ==I   ; 
      JCN   X8a; 
      L     MD   124; 
      T     DB502.DBD  156; 
X8a:  NOP   0; 

//---
// CIP 2 Start
      L     #U.Seq.SFM[18].Sp; 
      L     3.095000e+003; // CIP 2 
      ==I   ; 
      JCN   X8b; 
      L     MD   124; 
      T     DB502.DBD  160; 
X8b:  NOP   0; 

//---
// CIP 3 Start
      L     #U.Seq.SFM[18].Sp; 
      L     3.096000e+003; // CIP 3 
      ==I   ; 
      JCN   X8c; 
      L     MD   124; 
      T     DB502.DBD  164; 
X8c:  NOP   0; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
// CIP Distribution Ready 
      A     #ComCIPDist; 
      =     M    103.1; 

      JU    COMM; 


NETWORK
TITLE =phase 11: Postrinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X11:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 19: Remove Filter Candles
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X19:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// index evaluation: Confirm Connections
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[24].Sp,
           Indexes                  := #S2I.SFM24);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
      A     #S2I.SFM24.I00; // Please Select
      JCN   x191; 
      L     929; // Confirm to Continue
      T     MD    90; 
x191: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// ---------------------------------------------------------------------------
// control modules 
// ---------------------------------------------------------------------------
// transition condition 
      A     #S2I.SFM24.I01; // Yes
      A     DB141.DBX   66.2; 
      A     M    120.6; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B900; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B900: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 20: Replace Filter Candles
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X20:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// index evaluation: Confirm Connections
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[24].Sp,
           Indexes                  := #S2I.SFM24);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      A     #S2I.SFM24.I01; // Yes
      R     DB141.DBX   66.2; 

// ---------------------------------------------------------------------------
// messages 
      A     #S2I.SFM24.I00; // Please Select
      JCN   x201; 
      L     929; // Confirm to Continue
      T     MD    90; 
x201: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// ---------------------------------------------------------------------------
// control modules 
// ---------------------------------------------------------------------------
// transition condition 
      A     #S2I.SFM24.I01; // Yes
      A     M    120.6; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C000; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 21: Prepare Line 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X21:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 22: Tank Selection 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X22:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
      AN    #S2I.SFM11.I00; // Priority 1 Tank
      JCN   N901; 
      L     919; // "Press Start to Continue"
      T     MD    90; 
N901: NOP   0; 

      A     #S2I.SFM11.I00; 
      JCN   N902; 
      L     906; // "Source not Selected"
      T     MD    90; 
N902: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      R     DB145.DBX   26.4; 
// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     M    120.6; 
      AN    #S2I.SFM11.I00; // Priority 1
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 30: CIP Active 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 05 : Substep Time                        Duration        s
// 22 : Pump Speed                          Value           %
X30:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.4; 
      S     M    140.4; // Substep Time

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y30
//      L     1
//      T     "SOSubStepNew"
//Y30:  SET

// subphase evaluation
      L     MW   110; 
      JL    D000; 
      JU    COMM; // subphase  0:
      JU    D001; // subphase  1: Standby
      JU    D002; // subphase  2: Active
      JU    D003; // subphase  3: Expulse
// ---------------------------------------------------------------------------
D000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Standby
D001: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
D002: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Expulse
D003: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 31: CIP Start 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X31:  SET   ; 

// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 


// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y31
//      L     1
//      T     "SOSubStepNew"
//Y31:  SET

// subphase evaluation
      L     MW   110; 
      JL    D100; 
      JU    COMM; // subphase  0:
      JU    D101; // subphase  1: Wait For CIP
      JU    D102; // subphase  2: Wait For Partner
// ---------------------------------------------------------------------------
D100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Wait For CIP
D101: SET   ; 

// CIP  Start
      L     0; 
      T     #iTmp; 

      L     #U.Seq.SFM[18].Sp; 
      L     1.000000e+000; // Auto select
      ==I   ; 
      JCN   CIPa; 


      L     MB   112; 
      L     43; 
      ==I   ; 
      JC    U43S; 
      CALL FC   711 (
           StartType                := 7,// Priority CIP 2, 1, 3 (Anlagen)
           Release                  := TRUE,
           CIPEqID                  := #iTmp);
      JU    NU43; 
U43S: L     3092; // KEG Only CIP 2
      T     #iTmp; 
NU43: NOP   0; 


      L     0; 
      L     #iTmp; 
      ==I   ; 
      JC    CIPa; 
      ITD   ; 
      DTR   ; 
      T     #U.Seq.SFM[18].Sp; // CIP  Start
CIPa: NOP   0; 

//---
// CIP 1 Start
      L     #U.Seq.SFM[18].Sp; 
      L     3.091000e+003; // CIP 1
      ==I   ; 
      JCN   X31a; 
      L     MD   124; 
      T     DB502.DBD    0; 
      T     DB502.DBD  156; 
X31a: NOP   0; 

//---
// CIP 2 Start
      L     #U.Seq.SFM[18].Sp; 
      L     3.092000e+003; // CIP 2
      ==I   ; 

      JCN   X31b; 
      L     MD   124; 
      T     DB502.DBD    4; 
      T     DB502.DBD  160; 
X31b: NOP   0; 

//---
// CIP 3 Start
      L     #U.Seq.SFM[18].Sp; 
      L     3.093000e+003; // CIP 3
      ==I   ; 
      JCN   X31c; 
      L     MD   124; 
      T     DB502.DBD    8; 
      T     DB502.DBD  164; 
X31c: NOP   0; 

// -------------------------------------------------
// subphase timer & counter

// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
// CIP Ready
      A     #ComCIP; 
      A     DB145.DBX  123.5; 
      A     DB145.DBX  120.0; 
// CIP Distribution Ready
      A     #ComCIPDist; 
      A     DB145.DBX  411.5; 
      A     DB145.DBX  408.0; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Wait For Partner
D102: SET   ; 

      A     M    103.0; 
      =     DB145.DBX   29.4; // Request Packaging Plant

// -------------------------------------------------
// subphase timer & counter

// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
      A     DB145.DBX  459.4; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 32: CIP Prerun
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 04 : Delay Level                         Duration        s
// 15 : Amount                              Value           m3
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
X32:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// Get Pushout Amount

      A     M    102.2; 
      JCN   N321; 
      L     #U.Seq.Prop.Val10; 
      L     #U.Seq.SFM[15].Sp; 
      +R    ; 
      T     #U.Seq.SFM[15].Sp; 
N321: NOP   0; 

// CIP Unit
      AN    #ComCIP; 
      ON    DB145.DBX  123.4; 
      ON    DB145.DBX  123.5; 
      JCN   x321; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x321: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB145.DBX  411.4; 
      ON    DB145.DBX  411.5; 
      JCN   x322; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x322: NOP   0; 

// Partner Unit
      AN    #ComDST; 
      ON    DB145.DBX  459.4; 
      ON    DB145.DBX  459.5; 
      JCN   x323; 
      R     #RRel; 
      L     903; // Partner Unit Not Ready!
      T     MD    90; 
x323: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB145.DBX  458.5,
           EmptyLevel               := TRUE,
           CIPPumpRun               := DB145.DBX  124.3,
           CIPReady                 := DB145.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

      A     DB145.DBX  124.3; 
      A     M    102.3; 
      =     DB145.DBX   29.2; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB145.DBX  171.4; 
      =     DB145.DBX  172.6; 
      =     DB145.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB145.DBX  171.5; 

// Prerun Pump
      A     DB145.DBX  459.5; 
      A     DB145.DBX  459.6; 
      A     DB145.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB145.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      =     DB145.DBX  173.4; 
      =     DB145.DBX   29.3; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     #ComCIP1; 
      A     M    102.3; 
      =     DB240.DBX  428.0; 

      A     #ComCIP2; 
      A     M    102.3; 
      =     DB240.DBX  508.0; 

      A     #ComCIP3; 
      A     M    102.3; 
      =     DB240.DBX  588.0; 

// Trap Filter
      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      CLR   ; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  348.0; 

      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      =     DB240.DBX  268.0; 

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"

// subphase evaluation
      L     MW   110; 
      JL    D200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 33: CIP Return 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 04 : Delay Level                         Duration        s
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 26 : CIP Step On Condition               Enumeration     min
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
X33:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Step On Condition
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[26].Sp,
           Indexes                  := #S2I.SFM26);

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// CIP Unit
      AN    #ComCIP; 
      ON    DB145.DBX  123.4; 
      ON    DB145.DBX  123.5; 
      JCN   x331; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x331: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB145.DBX  411.4; 
      ON    DB145.DBX  411.5; 
      JCN   x332; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x332: NOP   0; 

// Partner Unit
      AN    #ComDST; 
      ON    DB145.DBX  459.4; 
      ON    DB145.DBX  459.5; 
      JCN   x333; 
      R     #RRel; 
      L     903; // Partner Unit Not Ready!
      T     MD    90; 
x333: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB145.DBX  458.5,
           EmptyLevel               := TRUE,
           CIPPumpRun               := DB145.DBX  124.3,
           CIPReady                 := DB145.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);


      A     DB145.DBX  124.3; 
      A     M    102.3; 
      =     DB145.DBX   29.2; 

// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB145.DBX  171.4; 
      =     DB145.DBX  172.6; 
      =     DB145.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB145.DBX  171.5; 

// Prerun Pump
      A     DB145.DBX  459.5; 
      A     DB145.DBX  459.6; 
      A     DB145.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB145.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      =     DB145.DBX  173.4; 
      =     DB145.DBX   29.3; 

// Bypass Valve
      A     M    102.3; 
      =     DB145.DBX  173.5; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     #ComCIP1; 
      A     M    102.3; 
      =     DB240.DBX  428.0; 

      A     #ComCIP2; 
      A     M    102.3; 
      =     DB240.DBX  508.0; 

      A     #ComCIP3; 
      A     M    102.3; 
      =     DB240.DBX  588.0; 

// Trap Filter
      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      CLR   ; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  348.0; 

      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      =     DB240.DBX  268.0; 

// Bypass Valve Used in CIP Distribution
//      A     "SOPA"
//      =     "c04ActD".RV1_T13.ACo

//      A     "SOPH"
//      =     "c04ActD".T13_RR1.ACo

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"

// subphase evaluation
      L     MW   110; 
      JL    D300; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 34: CIP Rinsing 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 05 : Substep Time                        Duration        s
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
// 59 : Interval Counter                    Value           No.
X34:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// CIP Unit
      AN    #ComCIP; 
      ON    DB145.DBX  123.4; 
      ON    DB145.DBX  123.5; 
      JCN   x341; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x341: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB145.DBX  411.4; 
      ON    DB145.DBX  411.5; 
      JCN   x342; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x342: NOP   0; 

// Partner Unit
      AN    #ComDST; 
      ON    DB145.DBX  459.4; 
      ON    DB145.DBX  459.5; 
      JCN   x343; 
      R     #RRel; 
      L     903; // Partner Unit Not Ready!
      T     MD    90; 
x343: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB145.DBX  458.5,
           EmptyLevel               := TRUE,
           CIPPumpRun               := DB145.DBX  124.3,
           CIPReady                 := DB145.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

      A     DB145.DBX  124.3; 
      A     M    102.3; 
      =     DB145.DBX   29.2; 



// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.0; 
      S     M    140.0; // Step Time

      ON    M    102.3; 
      O     M    150.5; 
      S     M    140.5; // Delay Switchpoint

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB145.DBX  171.4; 
      =     DB145.DBX  172.7; 
      =     DB145.DBX  172.6; 

// Run Release
      A     #RRel; 
      =     DB145.DBX  171.5; 

// Prerun Pump
      A     DB145.DBX  459.5; 
      A     DB145.DBX  459.6; 
      A     DB145.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB145.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      =     DB145.DBX  173.4; 
      =     DB145.DBX   29.3; 

// Mit Ablauf
      AN    M    157.2; 
      A     M    102.0; 
      =     DB145.DBX   29.5; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     #ComCIP1; 
      A     M    102.3; 
      =     DB240.DBX  428.0; 

      A     #ComCIP2; 
      A     M    102.3; 
      =     DB240.DBX  508.0; 

      A     #ComCIP3; 
      A     M    102.3; 
      =     DB240.DBX  588.0; 

// Trap Filter
      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      CLR   ; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  348.0; 

      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      =     DB240.DBX  268.0; 

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y34; 
      L     1; 
      T     MW   116; 
Y34:  SET   ; 

      A     #SubStepMax; 
      AN    M    103.0; 
      JCN   Y34a; 
      L     #U.Seq.SFM[59].Val; // Increment Interval Counter
      L     1.000000e+000; 
      +R    ; 
      T     #U.Seq.SFM[59].Val; 
Y34a: SET   ; 
      A     M    102.2; 
      ON    M    102.0; 
      JCN   IntR; // Reset Interval Counter at Start and End Of Phase
      L     0.000000e+000; 
      T     #U.Seq.SFM[59].Val; 
IntR: NOP   0; 

// subphase evaluation
      L     MW   110; 
      JL    D400; 
      JU    COMM; // subphase  0:
      JU    D401; // subphase  1: Pause
      JU    D402; // subphase  2: Main
      JU    D403; // subphase  3: Expulse
      JU    D404; // subphase  4: Seat Lift
      JU    D400; // subphase  5:
      JU    D406; // subphase  6: Shaft Rinse
      JU    D407; // subphase  7: Drain
// ---------------------------------------------------------------------------
D400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Pause
D401: SET   ; 

      A     M    103.0; 
      R     DB145.DBX  173.3; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time
// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
      A     M    150.3; // Delay Level
      A     M    130.3; 
      O     M    150.4; // Substep Time Done   
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Main
D402: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 


// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done   
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Expulse
D403: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Seat Lift
D404: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      SET   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 6: Shaft Rinse
D406: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 
      =     DB240.DBX  668.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done    
      O     M    157.2; // Interval Counter Done
      =     M    103.1; 
      JU    COMM; 

// subphase 7: Drain
D407: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 
      R     DB145.DBX  173.6; // Req Drain RV1_RS
      R     DB145.DBX   29.6; // Req Common Drain 
      R     DB2990.DBX  268.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done    
      O     M    157.2; // Interval Counter Done
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 35: CIP Emptying 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 04 : Delay Empty                         Duration        s
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 26 : Step On Empty                       Enumeration     min
// 28 : CIP Return                          Enumeration     min
X35:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: Step On Empty
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[26].Sp,
           Indexes                  := #S2I.SFM26);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// CIP Unit
      AN    #ComCIP; 
      ON    DB145.DBX  123.4; 
      ON    DB145.DBX  123.5; 
      JCN   x351; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x351: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB145.DBX  411.4; 
      ON    DB145.DBX  411.5; 
      JCN   x352; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x352: NOP   0; 

// Partner Unit
      AN    #ComDST; 
      ON    DB145.DBX  459.4; 
      ON    DB145.DBX  459.5; 
      JCN   x353; 
      R     #RRel; 
      L     903; // Partner Unit Not Ready!
      T     MD    90; 
x353: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB145.DBX  458.5,
           EmptyLevel               := TRUE,
           CIPPumpRun               := DB145.DBX  124.3,
           CIPReady                 := DB145.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB145.DBX  171.4; 
      =     DB145.DBX  172.7; 
      CLR   ; 
      =     DB145.DBX  172.6; 

// Run Release
      A     #RRel; 
      =     DB145.DBX  171.5; 

// Prerun Pump
      A     DB145.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      CLR   ; 
      =     DB145.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      =     DB145.DBX  173.4; 
      =     DB145.DBX   29.3; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     #ComCIP1; 
      A     M    102.3; 
      =     DB240.DBX  428.0; 

      A     #ComCIP2; 
      A     M    102.3; 
      =     DB240.DBX  508.0; 

      A     #ComCIP3; 
      A     M    102.3; 
      =     DB240.DBX  588.0; 

// Trap Filter
      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      CLR   ; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  348.0; 

      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      =     DB240.DBX  268.0; 

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"


// subphase evaluation
      L     MW   110; 
      JL    D500; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 36: CIP Drain 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        Min
// 04 : Delay Empty                         Duration        #sec
X36:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     DB145.DBX  458.5; 
      A     M    102.0; 
      =     M    130.3; 


// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.3; 
      S     M    140.3; // Delay Empty

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     M    150.3; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    D600; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D600: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 38: CIP Randvollstellung
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 04 : Delay Level                         Duration        s
// 15 : Amount                              Value           m3
// 17 : Level                               Value           l
// 22 : Agitator Speed                      Value           %
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
X38:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// Get Pushout Amount

      A     M    102.2; 
      JCN   N381; 
      L     #U.Seq.Prop.Val10; 
      L     #U.Seq.SFM[15].Sp; 
      +R    ; 
      T     #U.Seq.SFM[15].Sp; 
N381: NOP   0; 

// CIP Unit
      AN    #ComCIP; 
      ON    DB145.DBX  123.4; 
      ON    DB145.DBX  123.5; 
      JCN   x381; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x381: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB145.DBX  411.4; 
      ON    DB145.DBX  411.5; 
      JCN   x382; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x382: NOP   0; 

// Partner Unit
      AN    #ComDST; 
      ON    DB145.DBX  459.4; 
      ON    DB145.DBX  459.5; 
      JCN   x383; 
      R     #RRel; 
      L     903; // Partner Unit Not Ready!
      T     MD    90; 
x383: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB145.DBX  458.5,
           EmptyLevel               := TRUE,
           CIPPumpRun               := DB145.DBX  124.3,
           CIPReady                 := DB145.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);

      A     DB145.DBX  124.3; 
      A     M    102.3; 
      =     DB145.DBX   29.2; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"
      A     M    102.3; 
      =     M    130.0; 
      =     M    131.6; 

      A     DB145.DBX  458.2; 
      A     M    102.3; 
      =     M    130.3; 

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB145.DBX  171.4; 
      =     DB145.DBX  172.6; 
      R     DB145.DBX  172.7; 

// Run Release
      A     #RRel; 
      =     DB145.DBX  171.5; 

// Prerun Pump
      A     DB145.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB145.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      CLR   ; 
      =     DB145.DBX  173.4; 
      =     DB145.DBX   29.3; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     #ComCIP1; 
      A     M    102.3; 
      =     DB240.DBX  428.0; 

      A     #ComCIP2; 
      A     M    102.3; 
      =     DB240.DBX  508.0; 

      A     #ComCIP3; 
      A     M    102.3; 
      =     DB240.DBX  588.0; 

// Trap Filter
      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      CLR   ; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  348.0; 

      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      =     DB240.DBX  268.0; 

// ---------------------------------------------------------------------------
// transition condition 
      A     M    150.3; 
      =     M    102.1; 


// Nach Randvollstellung nach "CIP Ende"
      L     #U.Seq.StepMax; // CIP Ende = letzter Schritt
      T     MW   106; 

// subphase evaluation
      L     MW   110; 
      JL    D800; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 39: CIP Rinsing from RWT
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 05 : Substep Time                        Duration        s
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
// 59 : Interval Counter                    Value           No.
X39:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// CIP Unit
      AN    #ComCIP; 
      ON    DB145.DBX  123.4; 
      ON    DB145.DBX  123.5; 
      JCN   x391; 
      R     #RRel; 
      L     949; // CIP Not Ready!
      T     MD    90; 
x391: NOP   0; 

// CIP Distribution Unit
      AN    #ComCIPDist; 
      ON    DB145.DBX  411.4; 
      ON    DB145.DBX  411.5; 
      JCN   x392; 
      R     #RRel; 
      L     949; // CIP Partner Not Ready!
      T     MD    90; 
x392: NOP   0; 

// Partner Unit
      AN    #ComDST; 
      ON    DB145.DBX  459.4; 
      ON    DB145.DBX  459.5; 
      JCN   x393; 
      R     #RRel; 
      L     903; // Partner Unit Not Ready!
      T     MD    90; 
x393: NOP   0; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := #U.Seq.SFM[26].Sp,
           EmptySig                 := DB145.DBX  458.5,
           EmptyLevel               := TRUE,
           CIPPumpRun               := DB145.DBX  124.3,
           CIPReady                 := DB145.DBX  123.5,
           Empty                    := #Empty,
           TransCondOK              := M    102.1,
           RRel                     := #RRel);


      A     DB145.DBX  124.3; 
      A     M    102.3; 
      =     DB145.DBX   29.2; 



// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// Done in "CIPUnitC"

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.0; 
      S     M    140.0; // Step Time

      ON    M    102.3; 
      O     M    150.5; 
      S     M    140.5; // Delay Switchpoint

// ---------------------------------------------------------------------------
// communication
// Active, Prerun & Return
      A     M    102.0; 
      =     DB145.DBX  171.4; 
      =     DB145.DBX  172.7; 
      =     DB145.DBX  172.6; 

// Run Release
      A     #RRel; 
      =     DB145.DBX  171.5; 

// Prerun Pump
      A     DB145.DBX  459.5; 
      A     DB145.DBX  172.6; 
      AN    #S2I.SFM37.I00; 
      A     #RRel; 
      =     DB145.DBX  173.3; 

// Return Pump
      AN    #Empty; 
      A     #RRel; 
      =     DB145.DBX  173.4; 
      =     DB145.DBX   29.3; 

// Mit Abluaf
      AN    M    157.2; 
      A     M    102.0; 
      =     DB145.DBX   29.5; 

// ---------------------------------------------------------------------------
// control modules (Own CM's) 
      A     #ComCIP1; 
      A     M    102.3; 
      =     DB240.DBX  428.0; 

      A     #ComCIP2; 
      A     M    102.3; 
      =     DB240.DBX  508.0; 

      A     #ComCIP3; 
      A     M    102.3; 
      =     DB240.DBX  588.0; 

// Trap Filter
      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      CLR   ; 
      =     DB240.DBX  188.0; 
      =     DB240.DBX  348.0; 

      A     #S2I.SFM14.I01; // Yes
      A     M    102.3; 
      =     DB240.DBX  268.0; 

// ---------------------------------------------------------------------------
// transition condition 
//      A     #SubStepMaxD
//      =     "SOPD"

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y39; 
      L     1; 
      T     MW   116; 
Y39:  SET   ; 

      A     #SubStepMax; 
      AN    M    103.0; 
      JCN   Y39a; 
      L     #U.Seq.SFM[59].Val; // Increment Interval Counter
      L     1.000000e+000; 
      +R    ; 
      T     #U.Seq.SFM[59].Val; 
Y39a: SET   ; 
      A     M    102.2; 
      ON    M    102.0; 
      JCN   In2R; // Reset Interval Counter at Start and End Of Phase
      L     0.000000e+000; 
      T     #U.Seq.SFM[59].Val; 
In2R: NOP   0; 

// subphase evaluation
      L     MW   110; 
      JL    D900; 
      JU    COMM; // subphase  0:
      JU    D901; // subphase  1: Pause
      JU    D902; // subphase  2: Main
      JU    D903; // subphase  3: Expulse
      JU    D904; // subphase  4: Seat Lift
      JU    D900; // subphase  5:
      JU    D906; // subphase  6: Shaft Rinse
      JU    D907; // subphase  7: Drain
// ---------------------------------------------------------------------------
D900: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Pause
D901: SET   ; 

      A     M    103.0; 
      R     DB145.DBX  173.3; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time
// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
      A     M    150.3; // Delay Level
      A     M    130.3; 
      O     M    150.4; // Substep Time Done   
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Main
D902: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 


// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done   
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Expulse
D903: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Seat Lift
D904: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      SET   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 6: Shaft Rinse
D906: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 
      =     DB240.DBX  668.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done    
      O     M    157.2; // Interval Counter Done
      =     M    103.1; 
      JU    COMM; 

// subphase 7: Drain
D907: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Substep Time

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 
      R     DB145.DBX  173.6; // Req Drain RV1_RS
      R     DB145.DBX   29.6; // Req Common Drain 
      R     DB2990.DBX  268.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Substep Time Done    
      O     M    157.2; // Interval Counter Done
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 40: CIP End 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X40:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   140 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
//      AN    "SOSTAl"
      A     M    102.3; 
      =     #RRel; 

// CIP Signals ---
      CALL FC   716 (
           StepOnSFMSP              := 0.000000e+000,
           EmptySig                 := FALSE,
           EmptyLevel               := FALSE,
           CIPPumpRun               := FALSE,
           CIPReady                 := FALSE,
           Empty                    := #xTmp,
           TransCondOK              := #xTmp,
           RRel                     := #RRel);

// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      =     DB145.DBX   29.7; 
      =     DB145.DBX  173.7; 

// ---------------------------------------------------------------------------
// transition condition 
      AN    #ComCIP; 
      AN    #ComCIPDist; 
      AN    #ComDST; 
      =     M    102.1; 


// subphase evaluation
      L     MW   110; 
      JL    E000; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
E000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// pause timer unit parameter


NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  

      L     #U.Seq.PrId; 
      L     DB1945.DBD   10; 
      ==D   ; 
      A(    ; 
      L     0; 
      >D    ; 
      )     ; 
      JCN   CIP1; 

      CALL SFC   20 (
           SRCBLK                   := DB145.ToCIP,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB502.ToCIP1);

CIP1: NOP   0; 

      L     #U.Seq.PrId; 
      L     DB1955.DBD   10; 
      ==D   ; 
      A(    ; 
      L     0; 
      >D    ; 
      )     ; 
      JCN   CIP2; 

      CALL SFC   20 (
           SRCBLK                   := DB145.ToCIP,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB502.ToCIP2);
CIP2: NOP   0; 

      L     #U.Seq.PrId; 
      L     DB1965.DBD   10; 
      ==D   ; 
      A(    ; 
      L     0; 
      >D    ; 
      )     ; 
      JCN   CIP3; 

      CALL SFC   20 (
           SRCBLK                   := DB145.ToCIP,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB502.ToCIP3);

CIP3: NOP   0; 


// Check Selection / Material -----------------------------------------------
      L     0; 
      L     DB145.DBD  222; // 1. Tank
      <R    ; 
      JCN   MCk1; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      S     M    120.3; 
      JCN   MCk0; 
      L     910; 
      T     MD    80; 
MCk0: NOP   0; 
      L     0; 
      L     DB145.DBD  270; // 1. Tank
      <R    ; 
      JCN   MCk1; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk1; 
      L     910; 
      T     MD    90; 
MCk1: NOP   0; 
      L     0; 
      L     DB145.DBD  318; // 2. Tank
      <R    ; 
      JCN   MCk2; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk2; 
      L     910; 
      T     MD    90; 
MCk2: NOP   0; 
      L     0; 
      L     DB145.DBD  366; // 3. Tank
      <R    ; 
      JCN   MCk3; 
      L     #U.Seq.SFM[42].Sp; 
      <>R   ; 
      JCN   MCk3; 
      L     910; 
      T     MD    90; 
MCk3: NOP   0; 

      L     #U.Seq.SFM[11].Sp; 
      L     #U.Seq.SFM[12].Sp; 
      OD    ; 
      L     #U.Seq.SFM[13].Sp; 
      OD    ; 
      L     0; 
      >R    ; 
      O     M    120.7; 
      O     #CIP; 
      JC    TSel; 
      L     906; // "Source not Selected"
      T     MD    90; 
TSel: NOP   0; 

NETWORK
TITLE =Process Status Management

      NOP   0; 
// ---------------------------------------------------------------------------
// Signal Control

      OPN   DB   500; 
      L     #UnitNo; 
      L     32; //U Structure Length
      *I    ; 
      L     20; //DB Heading Offset
      +I    ; 
      SLD   3; 
      LAR2  ; 

// -------------------------------------------------
// Maintenance
      A     #U.Seq.Switch.Sw31; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.0]; //"PStatD".U[#UnitNo].MTNC
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
      A     DB145.DBX   26.2; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.7]; //"PStatD".U[#UnitNo].FULL
// -------------------------------------------------
// Filling
      A     DB145.DBX   26.1; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.0]; //"PStatD".U[#UnitNo].FILL   
// -------------------------------------------------
// Ready For Filling
      A     DB145.DBX   26.0; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.1]; //"PStatD".U[#UnitNo].RFFI 
// -------------------------------------------------
// Empty
      A     DB145.DBX   26.5; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.2]; //"PStatD".U[#UnitNo].EMTY 
// -------------------------------------------------
// Emptying
      A     DB145.DBX   26.4; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.3]; //"PStatD".U[#UnitNo].EMTI
// -------------------------------------------------
// Ready For Emptying
      A     DB145.DBX   26.3; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.4]; //"PStatD".U[#UnitNo].RFEM
// -------------------------------------------------
// Reserved
//      A     #ComXYZ
//      OPN   "PStatD"
//      =     DBX [AR2,P#1.5]             //"PStatD".U[#UnitNo].RESV
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used

// -------------------------------------------------
// PStat Function Call 

      CALL FC   500 (
           UnitNo                   := #UnitNo,
           PStatModVal              := DB245.DBD  234);



NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 

// ---------------------------------------------------------------------------
// Check Partner
      AN    #S2I.SFM10.I00; 
      AN    #U.Seq.PO.B22; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      =     #xTmp; 


      AN    DB145.DBX  218.3; 
      AN    DB145.DBX  218.4; 
      A     #xTmp; 
      JCN   NC03; 
      L     904; // "Source Not Ready!
      T     MD    90; 
NC03: NOP   0; 

      AN    DB145.DBX  218.3; 
      ON    DB145.DBX  218.4; 
      AN    #ComSRC; 
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B22; 
      AN    #CIP; 
      JCN   NC06; 
      L     909; // Source for Material not found
      T     MD    90; 
NC06: NOP   0; 

      AN    #S2I.SFM14.I02; 
      AN    #U.Seq.Step0; 
      AN    #CIP; 
      CLR   ; 
      JCN   NC04; 
      L     903; // Partner not Ready
      T     MD    90; 
NC04: NOP   0; 

      AN    DB145.DBX  458.0; // Water Tank Ready
      AN    DB145.DBX  458.1; 
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B3; 
      AN    #CIP; 
      CLR   ; 
      JCN   NC05; 
      L     903; // Destination not Ready
      T     MD    90; 
NC05: NOP   0; 






END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 143
TITLE =C04: Water Transfer Plant x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C04E
VERSION : 1.2
CODE_VERSION1


VAR
  U : UDT 141;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
  ComCIP1 : BOOL ;	//CIP1 in use
  ComCIP3 : BOOL ;	//CIP3 in use
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     #U.Seq.User.Bit63; 
      CC    FB   149; // "C04Sim"
      A     #U.Seq.Sim; 
      =     #U.Seq.User.Bit63; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB145.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    #U.Seq.Switch.Sw31; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   145; // C04Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C04UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C04UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C04UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C04UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// RM_KEG_V14 KEG_V14
// ----------------------------------------------------------
      CLR   ; 
      =     DB241.DBX   81.4; 
      =     DB241.DBX   81.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB247.DBX   80.7; 
      =     DB247.DBX   81.4; 

      CLR   ; 
      =     DB247.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB247.DBX  140.7; 
      =     DB247.DBX  141.4; 

      CLR   ; 
      =     DB247.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB247.DBX  200.7; 
      =     DB247.DBX  201.4; 

      CLR   ; 
      =     DB247.DBX  202.7; 

NETWORK
TITLE =Sequence organisation


// SFM supply ----------------------------------------------------------------


NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB240.DBX  105.4; 
      =     DB240.DBX  185.4; 
      =     DB240.DBX  265.4; 
      =     DB240.DBX  345.4; 
      =     DB240.DBX  425.4; 
      =     DB240.DBX  505.4; 
      =     DB240.DBX  585.4; 
      =     DB240.DBX  665.4; 
      =     DB240.DBX  745.4; 
      =     DB240.DBX  825.4; 
MODE: SET   ; 

NETWORK
TITLE =Wasserpumpe

      A     #GenRel; 
      A     DB240.DBX  106.7; 
      =     DB240.DBX  107.6; 

NETWORK
TITLE =KEG_V11 KEG_V11

      AN    #CIP; 
      A     #GenRel; 
      A     DB240.DBX  186.7; 
      =     DB240.DBX  187.6; 
NETWORK
TITLE =KEG_V12 KEG_V12

      A     #GenRel; 
      A     DB240.DBX  266.7; 
      =     DB240.DBX  267.6; 
NETWORK
TITLE =KEG_V13 KEG_V13

      AN    #CIP; 
      A     #GenRel; 
      A     DB240.DBX  346.7; 
      =     DB240.DBX  347.6; 
NETWORK
TITLE =RV1_A5

      AN    DB240.DBX  502.6; 
      AN    DB240.DBX  582.6; 

      A     #GenRel; 
      A     DB240.DBX  426.7; 
      =     DB240.DBX  427.6; 

NETWORK
TITLE =RV2_A5

      AN    DB240.DBX  582.6; 
      AN    DB240.DBX  422.6; 

      A     #GenRel; 
      A     DB240.DBX  506.7; 
      =     DB240.DBX  507.6; 

NETWORK
TITLE =RV3_A5

      AN    DB240.DBX  422.6; 
      AN    DB240.DBX  502.6; 

      A     #GenRel; 
      A     DB240.DBX  586.7; 
      =     DB240.DBX  587.6; 

NETWORK
TITLE =VR_V1

      A     #GenRel; 
      A     DB240.DBX  666.7; 
      =     DB240.DBX  667.6; 

NETWORK
TITLE =VR_V8

      A     #GenRel; 
      A     DB240.DBX  746.7; 
      =     DB240.DBX  747.6; 

NETWORK
TITLE =A14_V14

      A     #GenRel; 
      A     DB240.DBX  826.7; 
      =     DB240.DBX  827.6; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 145
TITLE =C04: Water Transfer Plant x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C04Comm
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 141;	
END_VAR
VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	//CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
  rUnitNo : REAL ;	
  DSTUnit : INT ;	//Destination Unit
  SRCUnit : INT ;	
  STBYUnit : INT ;	
  rEquipmentID : REAL ;	
  dst0 : BOOL ;	//No Destination Selected
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

      L     DB145.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

      L     #EquipmentID; 
      ITD   ; 
      DTR   ; 
      T     #rEquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB145.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB145.DBD   10; 
      L     DB145.DBD  106; 
      ==D   ; 
      =     #ComCIP; 


NETWORK
TITLE =read other unit's data

      SET   ; 

// ... General Unit ----------/

      CALL SFC   20 (
           SRCBLK                   := DB1995.Own,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB145.GEN);

// emergency OK -------------------------------------------------------------
      A     DB145.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 


//----------------------------------------
// Communication Water Tank 
//----------------------------------------

// Current Tank ----------------------------

      L     #U.Seq.SFM[10].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N201; 

      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[10].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.SRC,
           RET_VAL                  := #wRetVal);
      JU    N2x1; 
N201: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB145.SRC);
N2x1: NOP   0; 

// Priority 1 -----------------------------

      L     #U.Seq.SFM[11].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N202; 


      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[11].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.SRC1,
           RET_VAL                  := #wRetVal);
      JU    N2x2; 
N202: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB145.SRC1);
N2x2: NOP   0; 

// Priority 2 ----------------------------

      L     #U.Seq.SFM[12].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N203; 


      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[12].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.SRC2,
           RET_VAL                  := #wRetVal);
      JU    N2x3; 
N203: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB145.SRC2);
N2x3: NOP   0; 

// Priority 3 ----------------------------

      L     #U.Seq.SFM[13].Sp; 
      L     0.000000e+000; 
      >R    ; 
      JCN   N204; 


      CALL FC   950 (
           EquipmentNo              := #U.Seq.SFM[13].Sp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.SRC3,
           RET_VAL                  := #wRetVal);
      JU    N2x4; 
N204: NOP   0; 
      L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB145.SRC3);
N2x4: NOP   0; 

//----------------------------------------
// Communication Packaging Plant
//----------------------------------------
      L     #U.Seq.Prop.Index0; // Destination
      ITD   ; 
      DTR   ; 
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);


      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.DST,
           RET_VAL                  := #wRetVal);

NETWORK
TITLE =external releases

      SET   ; 
      =     DB240.DBX  106.7; 
      =     DB240.DBX  186.7; 
      =     DB240.DBX  266.7; 
      =     DB240.DBX  346.7; 
      =     DB240.DBX  426.7; 
      =     DB240.DBX  506.7; 
      =     DB240.DBX  586.7; 
      =     DB240.DBX  666.7; 
      =     DB240.DBX  746.7; 
      =     DB240.DBX  826.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B30; // CIP Active (Slave)
      O(    ; 
      A     #U.Seq.PO.B3; // Prerinse
      L     DB145.DBD   10; 
      L     DB145.DBD  394; 
      ==I   ; 
      )     ; 
//    A     #ComCIP
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB145.DBD  150; 
      T     #U.Seq.SFM[32].Val; 

//Temperature CIP Return
      L     DB145.DBD  146; 
      T     #U.Seq.SFM[30].Val; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := #U.Seq.SFM[36].Sp,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB145.DBX  171.7; 
      JCN   pfc; 
      L     #U.Seq.SFM[34].Sp; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB145.DBX  172.0; 
      JCN   ppc; 
      L     #U.Seq.SFM[35].Sp; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB145.DBX  171.6; 
      JCN   pxc; 
      L     #U.Seq.SFM[29].Sp; 
pxc:  NOP   0; 
      T     DB145.DBD  182; 

// CIP Prerun Temperature
      L     #U.Seq.SFM[36].Sp; 
      T     DB145.DBD  182; 

//CIP Return
      L     #U.Seq.SFM[28].Sp; 
      T     DB145.DBD  186; 
      L     DB145.DBD  138; 
      T     #U.Seq.SFM[28].Val; 

//CIP Prerun
      L     #U.Seq.SFM[27].Sp; 
      T     DB145.DBD  190; 
      L     DB145.DBD  142; 
      T     #U.Seq.SFM[27].Val; 

// Write Own Data to CIP
      L     DB145.DBD   10; 
      T     DB145.DBD  154; 

      L     DB145.DBW   14; 
      T     DB145.DBW  158; 

      L     DB145.DBW   16; 
      T     DB145.DBW  160; 

      L     DB145.DBW   18; 
      T     DB145.DBW  162; 

      L     DB145.DBW   20; 
      T     DB145.DBW  164; 

      L     DB145.DBW   22; 
      T     DB145.DBW  166; 

      A     DB145.DBX   24.0; 
      =     DB145.DBX  168.0; 

      A     DB145.DBX   24.1; 
      =     DB145.DBX  168.1; 

      A     DB145.DBX   24.2; 
      =     DB145.DBX  168.2; 

      A     DB145.DBX   24.3; 
      =     DB145.DBX  168.3; 

      A     DB145.DBX   24.4; 
      =     DB145.DBX  168.4; 

      A     DB145.DBX   24.5; 
      =     DB145.DBX  168.5; 

      A     DB145.DBX   24.6; 
      =     DB145.DBX  168.6; 

      A     DB145.DBX   24.7; 
      =     DB145.DBX  168.7; 

// Copy Data to CIP
//      CALL  "BLKMOV"
//       SRCBLK :="C04ComD".ToCIP
//       RET_VAL:=#iRetVal
//       DSTBLK :="C04ComD".ToCIP

NCIP: NOP   0; 

//Empty Signal
//A     "C04SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB145.DBX   26.5; 

//Full Signal
//A     "C04SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB145.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB145.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB145.DBX   27.0; //Emergency Stop OK

      L     #U.Seq.SFM[42].Sp; // Material
      T     DB145.DBD   30; 

      L     #U.Seq.SFM[10].Sp; // Current Water Tank Selection
      T     DB145.DBD   34; 

      L     #U.Seq.SFM[11].Sp; // Priority 1
      T     DB145.DBD   38; 

      L     #U.Seq.SFM[12].Sp; // Priority 2
      T     DB145.DBD   42; 

      L     #U.Seq.SFM[13].Sp; // Priority 3
      T     DB145.DBD   46; 

      L     DB145.DBD  138; // CIP Amount
      T     DB145.DBD   54; // CIP Amount


NETWORK
TITLE = read from other unit data

      L     0; 
      T     #rTmp; 



// ... CIP / CIP Distribution ------------- /
      L     #U.Seq.PrId; 
      L     DB1945.DBD   10; 
      ==D   ; 
      A(    ; 
      L     0; 
      >D    ; 
      )     ; 
      JCN   CIP1; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 91,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 94,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.CIPDist,
           RET_VAL                  := #wRetVal);
      JU    NZ; 
CIP1: NOP   0; 


      L     #U.Seq.PrId; 
      L     DB1955.DBD   10; 
      ==D   ; 
      A(    ; 
      L     0; 
      >D    ; 
      )     ; 
      JCN   CIP2; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 92,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 95,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.CIPDist,
           RET_VAL                  := #wRetVal);
      JU    NZ; 
CIP2: NOP   0; 

      L     #U.Seq.PrId; 
      L     DB1965.DBD   10; 
      ==D   ; 
      A(    ; 
      L     0; 
      >D    ; 
      )     ; 
      JCN   CIP3; 
      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 93,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.CIP,
           RET_VAL                  := #wRetVal);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := 3,
           SourceUnitNo             := 96,
           IsTUnit                  := FALSE,
           DstComDRec               := DB145.CIPDist,
           RET_VAL                  := #wRetVal);
      JU    NZ; 
CIP3: NOP   0; 



// Zero the data 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB145.CIP);

      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB145.CIPDist);

NZ:   NOP   0; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 149
TITLE =C04: Water Transfer Plant x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C04Sim
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 141;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     #U.Seq.Sim; 
      =     DB240.DBX  105.3; 
      =     DB240.DBX  185.3; 
      =     DB240.DBX  265.3; 
      =     DB240.DBX  345.3; 
      =     DB240.DBX  425.3; 
      =     DB240.DBX  505.3; 
      =     DB240.DBX  585.3; 
      =     DB240.DBX  665.3; 
      =     DB240.DBX  745.3; 
      =     DB240.DBX  825.3; 
NETWORK
TITLE =Special Input

      A     #U.Seq.Sim; 
      =     DB241.DBX   81.3; 

NETWORK
TITLE =Counter

      A     #U.Seq.Sim; 
      A     M    101.0; 


      CLR   ; 
NETWORK
TITLE =Analog Input

      A     #U.Seq.Sim; 

NETWORK
TITLE =Universal Value

      A     #U.Seq.Sim; 
//      =     "C04UnVD".unv001.Sim; 
//      =     "C04UnVD".unv002.Sim; 
//      =     "C04UnVD".unv003.Sim; 
//      =     "C04UnVD".unv004.Sim; 

NETWORK
TITLE =PID

      A     #U.Seq.Sim; 

NETWORK
TITLE =Message

      A     #U.Seq.Sim; 
//      =     "C04MsgD".msg001.Sim; 
//      =     "C04MsgD".msg002.Sim; 
//      =     "C04MsgD".msg003.Sim; 

NETWORK
TITLE =VLT

      A     #U.Seq.Sim; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 151
TITLE =C05: Syrup Transfer x
// NW  1 : phase and index evaluation
// NW  2 : phase  1: start position
// NW  3 : phase  3: Prerinse
// NW  4 : phase  4: Fill System
// NW  5 : phase  5: Transfer
// NW  6 : phase  8: Push Out
// NW  7 : phase 11: Postrinse
// NW  8 : phase 18: Send Mole
// NW  9 : phase 19: Return Mole
// NW 10 : phase 21: Prepare Line
// NW 11 : phase 22: Tank Selection
// NW 12 : phase 30: CIP Active
// NW 13 : phase 31: CIP Start
// NW 14 : phase 32: CIP Push Out
// NW 15 : phase 34: CIP Rinsing
// NW 16 : phase 36: CIP Drain
// NW 17 : phase 40: CIP End
// NW 18 : end of sequence
// NW 19 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Process Time                        Duration        min
// 40 : Density                             Value           kg/l
// 42 : Material                            Value
// 43 : Source                              Value
// 44 : Standby                             Value
AUTHOR : Woermann
NAME : C05Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 151;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dUnitNo : DINT ;	//Unit Number 
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM26 : STRUCT 	//Cip Step On Condition
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Conductivity High
    I02 : BOOL ;	//Conductivity Low
    I03 : BOOL ;	//Time
    I04 : BOOL ;	//Amount
    I05 : BOOL ;	//Temperature High
    I06 : BOOL ;	//Temperature Low
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM27 : STRUCT 	//Cip Prerun
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM28 : STRUCT 	//Cip Return
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	//Drain
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM37 : STRUCT 	//Cip Pump Mode
    I00 : BOOL ;	//Off
    I01 : BOOL ;	//Flow
    I02 : BOOL ;	//Pressure
    I03 : BOOL ;	//Fix Speed
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM31 : STRUCT 	//Cip Distribution Circuit No
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Auto Select
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM13 : STRUCT 	//Cip Step On Condition
    I00 : BOOL ;	//Auto
    I01 : BOOL ;	//Schalter
    I02 : BOOL ;	//Auto und Schalter
    I03 : BOOL ;	//Auto oder Schalter
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
  ComXYZ : BOOL ;	
  ComSRC : BOOL ;	//Communication with SRC Syrup
  ComDST : BOOL ;	//Communication with DST
  ComWater : BOOL ;	//Communication with Water Transfer to Syrup
END_VAR
BEGIN
NETWORK
TITLE = Phase and Index Evaluation

      CLR   ; 
      =     #RRel; 
      =     DB155.DBX   27.2; 

// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     60; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB155.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      L     MD   124; 
      L     DB155.DBD  346; 
      ==D   ; 
//      A     #CIP
      =     #ComCIP; 

      L     MD   124; 
//      L     "UxxxComD".Own.PrId //!!! Fill in Communicating Unit Number
      ==D   ; 
      =     #ComXYZ; //!!! Fill in Shortname for Communicating Unit

// Source
      L     MD   124; 
      L     DB155.DBD  250; 
      ==D   ; 
      CLR   ; 
      A(    ; 
      L     #U.Seq.SFM[42].Sp; // Material
      L     DB155.DBD  270; 
      ==R   ; 
      )     ; 
      SET   ; 
      =     #ComSRC; 

// Destination
      AN    DB155.DBX  312.7; 
      SET   ; 
      =     #ComDST; 

// Water Transfer Syrup
      A     DB1595.DBX   26.3; // Run Release
      =     #ComWater; 

      O     M    120.7; 
      O     #CIP; 
      O     #ComWater; 
      JC    M902; 
      L     902; // Wasserversorgung berprfen!
      T     MD    90; 
M902: NOP   0; 

// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB155.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 

// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: start position
      JU    X0; // phase  2:
      JU    X3; // phase  3: Prerinse
      JU    X4; // phase  4: Fill System
      JU    X5; // phase  5: Transfer
      JU    X0; // phase  6:
      JU    X0; // phase  7:
      JU    X8; // phase  8: Push Out
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X11; // phase 11: Postrinse
      JU    X0; // phase 12:
      JU    X13; // phase 13: Ende
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X18; // phase 18: Send Mole
      JU    X19; // phase 19: Return Mole
      JU    X0; // phase 20:
      JU    X21; // phase 21: Prepare Line
      JU    X22; // phase 22: Tank Selection
      JU    X0; // phase 23:
      JU    X0; // phase 24:
      JU    X0; // phase 25:
      JU    X0; // phase 26:
      JU    X0; // phase 27:
      JU    X0; // phase 28:
      JU    X0; // phase 29:
      JU    X30; // phase 30: CIP Passive
      JU    X31; // phase 31: CIP Start
      JU    X32; // phase 32: CIP Push Out
      JU    X0; // phase 33:
      JU    X34; // phase 34: CIP Rinsing
      JU    X0; // phase 35:
      JU    X36; // phase 36: CIP Drain
      JU    X0; // phase 37:
      JU    X0; // phase 38:
      JU    X0; // phase 39:
      JU    X40; // phase 40: CIP End
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 

// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 
      R     #U.Seq.User.Bit12; 
      R     #U.Seq.User.Bit13; 

      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// MolchSignale fr Sirupraum
      A     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      =     DB250.DBX 3708.2; 

      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      =     DB250.DBX 3788.2; 
      =     DB250.DBX 1708.2; 

      A     DB250.DBX 3788.2; 
      A     M    102.3; 
      =     DB250.DBX 3948.0; 

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   150 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   150 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 
NETWORK
TITLE =phase 3: Prerinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X3:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A300; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 4: Fill System 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X4:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      SET   ; 
      AN    M    102.2; // Batch buffer full when mole in returned position
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A400; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 5: Transfer 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X5:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Step On Condition
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[13].Sp,
           Indexes                  := #S2I.SFM13);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// MolchSignale fr Sirupraum
      A     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      =     DB250.DBX 3708.2; 

      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      =     DB250.DBX 3788.2; 

      A     M    102.3; 
      =     DB250.DBX 3868.0; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 
      CLR   ; 

// ---------------------------------------------------------------------------
// transition condition 
      L     DB155.DBD  250; 
      L     MD   124; 

      O(    ; 
      A     DB155.DBX  269.0; 
      A     #S2I.SFM13.I00; 
      )     ; 
      O(    ; 
      A     #U.Seq.Switch.Sw1; // Start SR -> A7
      A     #S2I.SFM13.I01; 
      )     ; 
      O(    ; 
      A     #U.Seq.Switch.Sw1; // Start SR -> A7
      A     DB155.DBX  269.0; 
      A     #S2I.SFM13.I02; 
      )     ; 
      O(    ; 
      A     #U.Seq.Switch.Sw1; // Start SR -> A7
      O     DB155.DBX  269.0; 
      A     #S2I.SFM13.I03; 
      )     ; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y5; 
      L     1; 
      T     MW   116; 
Y5:   SET   ; 

// subphase evaluation
      L     MW   110; 
      JL    A500; 
      JU    COMM; // subphase  0:
      JU    A501; // subphase  1: Waiting
      JU    A502; // subphase  2: Active
      JU    A503; // subphase  3: Tank Change
// ---------------------------------------------------------------------------
A500: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Waiting
A501: SET   ; 
      A     M    103.3; 
      =     DB155.DBX   26.3; 
      =     DB155.DBX   26.0; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     DB155.DBX  314.1; 
//   A     "C05ComD".SRC.WfEm
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
A502: SET   ; 
      A     M    103.3; 
      =     DB155.DBX   26.4; 
      =     DB155.DBX   26.1; 
// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
//  AN    "C05ComD".SRC.Emti
// ON    "C05ComD".SRC.WfEm
      AN    DB155.DBX  314.1; 
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Tank Change
A503: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 8: Push Out 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X8:   SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      SET   ; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    A800; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
A800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 11: Postrinse 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X11:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// MolchSignale fr Sirupraum
      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      =     DB250.DBX 3788.2; 
      =     DB250.DBX 1708.2; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 13: Ende
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 20 : Flow                                Value           l/h
// 41 : Amount                              Value           kg
X13:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// MolchSignale fr Sirupraum
// Endposition
      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      A     M    103.3; 
      =     DB250.DBX 1708.0; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      L     DB155.DBD  346; 
      L     MD   124; 
      <>D   ; 
      O     DB155.DBX  360.7; 
      AN    M    102.2; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B300; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B300: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 18: Send Mole 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 05 : Step Time                           Duration        s
// 06 : Delay Time                          Duration        s
X18:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      AN    M    102.0; 
      R     #U.Seq.Switch.Sw1; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      AN    M    102.0; 
      R     #U.Seq.Switch.Sw1; 
// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      AN    M    102.3; 
      O     M    150.4; 
      S     M    140.4; // Step Time

      AN    M    102.3; 
      O     M    150.5; 
      S     M    140.5; // Delay Time

// ---------------------------------------------------------------------------
// communication
      A     M    102.3; 
      S     DB155.DBX   27.2; 

      A     M    102.0; 
      =     DB250.DBX 1628.0; 

// MolchSignale fr Sirupraum
      A     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      =     DB250.DBX 3708.2; 

      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      =     DB250.DBX 3788.2; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y18
//      L     1
//      T     "SOSubStepNew"
//Y18:  SET

// subphase evaluation
      L     MW   110; 
      JL    B800; 
      JU    COMM; // subphase  0:
      JU    B801; // subphase  1: Open Horns
      JU    B802; // subphase  2: Raise Baskets
      JU    B803; // subphase  3: Send Mole
      JU    B804; // subphase  4: Lower Baskets
      JU    B805; // subphase  5: Line Rinsing
      JU    B806; // subphase  6: Depressurise
      JU    B807; // subphase  7: End
// ---------------------------------------------------------------------------
B800: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Open Horns
B801: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     DB250.DBX  502.6; 
      A     DB250.DBX  582.6; 
      A     DB250.DBX  582.6; 
      A     DB250.DBX 1382.6; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay TIme
      AN    M    103.2; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Raise Baskets
B802: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     DB251.DBX  258.7; 
      A     DB251.DBX  858.7; 
      CLR   ; // Signale gehen nicht 
      A     DB250.DBX  342.6; 
      A     DB250.DBX 1142.6; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 

// Basktets
      A     M    102.3; 
      =     DB250.DBX  348.0; 
      =     DB250.DBX 1148.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay Time
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Send Mole
B803: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 

// Basktets
      A     M    102.3; 
      =     DB250.DBX  348.0; 
      =     DB250.DBX 1148.0; 

// Water
      A     M    103.3; 
      =     DB250.DBX  188.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay time
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Lower Baskets
B804: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     DB251.DBX  318.7; 
      A     DB251.DBX  918.7; 
      CLR   ; 
      A     DB250.DBX  422.6; 
      A     DB250.DBX 1222.6; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 

// Basktets
      A     M    102.3; 
      =     DB250.DBX  428.0; 
      =     DB250.DBX 1228.0; 

// Drain
      A     M    103.3; 
      =     DB250.DBX 1068.0; 

// Endposition
      A     M    103.3; 
      =     DB250.DBX 1708.0; 

// Water
      A     M    103.3; 
      =     DB250.DBX  188.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay Time
      =     M    103.1; 
      JU    COMM; 

// subphase 5: Line Rinsing
B805: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time
// -------------------------------------------------
// subphase actuator 

// Drain
      A     M    103.3; 
      =     DB250.DBX 1068.0; 

// Endposition
      A     M    103.3; 
      =     DB250.DBX 1708.0; 

// Water
      A     M    103.3; 
      =     DB250.DBX  188.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time
      =     M    103.1; 
      JU    COMM; 

// subphase 6: Depressurise
B806: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time
// -------------------------------------------------
// subphase actuator 

// Drain
      A     M    103.3; 
      =     DB250.DBX 1068.0; 

// Endposition
      A     M    103.3; 
      =     DB250.DBX 1708.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time
      =     M    103.1; 
      JU    COMM; 

// subphase 7: End
B807: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time
// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 19: Return Mole 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 05 : Step Time                           Duration        s
// 06 : Delay Time                          Duration        s
X19:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

      L     MB   112; 
      L     103; // No automict return with KEG
      <>I   ; 
      A     M    102.2; 
      S     #U.Seq.Switch.Sw2; 

      AN    M    102.0; 
      R     #U.Seq.Switch.Sw2; 


// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

      AN    M    102.0; 
      R     #U.Seq.User.Bit12; 
      R     #U.Seq.User.Bit13; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      AN    M    102.3; 
      O     M    150.4; 
      S     M    140.4; // Step Time

      AN    M    102.3; 
      O     M    150.5; 
      S     M    140.5; // Delay Time

// ---------------------------------------------------------------------------
// communication
// MolchSignale fr Sirupraum
      A     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      =     DB250.DBX 3708.2; 

      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      =     DB250.DBX 3788.2; 


// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #U.Seq.SPO.B1; // Subphase 1
      A     DB251.DBX  378.7; 
      A     DB251.DBX  438.7; 
      =     #xTmp; 

      A     #xTmp; 
      O     #SubStepMaxD; 
      AN    M    102.2; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y19
//      L     1
//      T     "SOSubStepNew"
//Y19:  SET

// subphase evaluation
      L     MW   110; 
      JL    B900; 
      JU    COMM; // subphase  0:
      JU    B901; // subphase  1: Check Mole Position
      JU    B902; // subphase  2: Open Horns
      JU    B903; // subphase  3: Raise Baskets
      JU    B904; // subphase  4: Return Mole
      JU    B905; // subphase  5: Lower Baskets
      JU    B906; // subphase  6: Line Rinsing
      JU    B907; // subphase  7: Depressurise
      JU    B908; // subphase  8: End
// ---------------------------------------------------------------------------
B900: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Check Mole Position
B901: SET   ; 

      AN    DB251.DBX  978.7; 
      AN    DB251.DBX 1038.7; 
      JCN   N901; 
      L     927; // Pig Not Found
      T     MD    90; 
N901: NOP   0; 
// -------------------------------------------------
// subphase timer & counter


// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
// Plant
//      A     "C05SpID".GOA_EKEG_3.Sig
//      A     "C05SpID".GOA_EKEG_4.Sig
//      O     "SOStart"
      A     #U.Seq.Switch.Sw2; 
      AN    M    103.2; 
      =     M    103.1; 

      JU    COMM; 

// subphase 2: Open Horns
B902: SET   ; 

// -------------------------------------------------
// subphase timer & counter

      A     DB250.DBX  502.6; 
      A     DB250.DBX  582.6; 
      A     DB250.DBX 1302.6; 
      A     DB250.DBX 1382.6; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay Time
      AN    M    103.2; 
      =     M    103.1; 

      JU    COMM; 

// subphase 3: Raise Baskets
B903: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     DB251.DBX  258.7; 
      A     DB251.DBX  858.7; 
      CLR   ; // Signale gehen nicht 
      A     DB250.DBX  342.6; 
      A     DB250.DBX 1142.6; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 


// Basktets
      A     M    102.3; 
      =     DB250.DBX  348.0; 
      =     DB250.DBX 1148.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay Time
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Return Mole
B904: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 


// Basktets
      A     M    102.3; 
      =     DB250.DBX  348.0; 
      =     DB250.DBX 1148.0; 

// Drain 
      A     M    103.3; 
      =     DB250.DBX  268.0; 

// C02
      A     M    103.3; 
      =     DB250.DBX  988.0; 
      =     DB250.DBX 1068.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay Time
      =     M    103.1; 
      JU    COMM; 

// subphase 5: Lower Baskets
B905: SET   ; 
// -------------------------------------------------
// subphase timer & counter
      A     DB251.DBX  318.7; 
      A     DB251.DBX  918.7; 
      CLR   ; 
      A     DB250.DBX  422.6; 
      A     DB250.DBX 1222.6; 
      A     M    103.0; 
      =     M    130.5; // Delay Time
// -------------------------------------------------
// subphase actuator 
// Horns
      A     M    103.0; 
      =     DB250.DBX  508.0; 
      =     DB250.DBX  588.0; 
      =     DB250.DBX 1308.0; 
      =     DB250.DBX 1388.0; 

// Basktets
      A     M    102.3; 
      =     DB250.DBX  428.0; 
      =     DB250.DBX 1228.0; 

// Drain 
      A     M    103.3; 
      =     DB250.DBX  268.0; 

// C02
      A     M    103.3; 
      =     DB250.DBX  988.0; 
      =     DB250.DBX 1068.0; 


// -------------------------------------------------
// subphase transition 
      A     M    150.5; // Delay Time  
      =     M    103.1; 
      JU    COMM; 

// subphase 6: Line Rinsing
B906: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time
// -------------------------------------------------
// Drain 
      A     M    103.3; 
      =     DB250.DBX  268.0; 

// C02
      A     M    103.3; 
      =     DB250.DBX  988.0; 
      =     DB250.DBX 1068.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time
      =     M    103.1; 
      JU    COMM; 

// subphase 7: Depressurise
B907: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time

// -------------------------------------------------
// subphase actuator 
// Drain 
      A     M    103.3; 
      =     DB250.DBX  268.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time   
      =     M    103.1; 
      JU    COMM; 

// subphase 8: End
B908: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time
// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time   
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 21: Prepare Line 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X21:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// MolchSignale fr Sirupraum
      A     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      =     DB250.DBX 3708.2; 

      A     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      =     DB250.DBX 3788.2; 

// ---------------------------------------------------------------------------
// messages 
      AN    #ComSRC; 
      JCN   N211; 
      L     904; // Source not Ready!
      T     MD    90; 
N211: NOP   0; 

// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #ComSRC; 
      A     #ComDST; 
      A     #ComWater; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 22: Tank Selection 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X22:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    C200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
C200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 30: CIP Passive
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 05 : Substep Time                        Duration        s
// 22 : Pump Speed                          Value           %
X30:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 4,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.4; 
      S     M    140.4; // Substep Time

// ---------------------------------------------------------------------------
// communication
      A     M    102.0; 
      =     DB155.DBX   26.0; 

      A     DB251.DBX 1338.7; 
      O     DB251.DBX 1518.7; 
      A     M    102.3; 
      =     DB155.DBX   26.1; 

// ---------------------------------------------------------------------------
// control modules 
      A     #ComCIP; 
      A     DB155.DBX  268.3; 
      A     M    102.3; 
      =     DB250.DBX  188.0; 

// ---------------------------------------------------------------------------
// transition condition 
      L     DB155.DBD  346; 
      L     MD   124; 
      <>D   ; 
      O     DB155.DBX  360.7; 
      AN    #ComCIP; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
      A     #SubStepMax; 
      JCN   Y30; 
      L     1; 
      T     MW   116; 
Y30:  SET   ; 

// subphase evaluation
      L     MW   110; 
      JL    D000; 
      JU    COMM; // subphase  0:
      JU    D001; // subphase  1: Standby
      JU    D002; // subphase  2: Active
      JU    D003; // subphase  3: Expulse 
      JU    D004; // subphase  4: Expulse 2
// ---------------------------------------------------------------------------
D000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Standby
D001: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      SET   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Active
D002: SET   ; 

// -------------------------------------------------
// subphase timer & counter

// -------------------------------------------------
// subphase actuator 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Expulse 
D003: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time

// -------------------------------------------------
// subphase actuator 
      A     DB155.DBX  268.3; 
      A     M    103.3; 
      =     DB5050.DBX  988.0; 
      R     DB5050.DBX 1068.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time Done
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Expulse 2
D004: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 
      =     M    130.4; // Step Time

// -------------------------------------------------
// subphase actuator 
      A     DB155.DBX  268.3; 
      A     M    103.3; 
      =     DB5050.DBX  268.0; 

// -------------------------------------------------
// subphase transition 
      A     M    150.4; // Step Time Done   
      =     M    103.1; 
      JU    COMM; 

NETWORK
TITLE =phase 31: CIP Start 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X31:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y31
//      L     1
//      T     "SOSubStepNew"
//Y31:  SET

// subphase evaluation
      L     MW   110; 
      JL    D100; 
      JU    COMM; // subphase  0:
      JU    D101; // subphase  1: Wait For CIP
      JU    D102; // subphase  2: Wait For Partner
// ---------------------------------------------------------------------------
D100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Wait For CIP
D101: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Wait For Partner
D102: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 32: CIP Push Out 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 26 : CIP Step On Condition               Enumeration     min
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
X32:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Step On Condition
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[26].Sp,
           Indexes                  := #S2I.SFM26);

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.0; 
      S     M    140.0; // Step Time

      ON    M    102.3; 
      O     M    150.5; 
      S     M    140.5; // Delay Switchpoint

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    D200; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D200: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 34: CIP Rinsing 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 01 : Step Time                           Duration        min
// 05 : Substep Time                        Duration        s
// 06 : Delay Switchpoint                   Duration        s
// 15 : Amount                              Value           m3
// 27 : CIP Prerun                          Enumeration     min
// 28 : CIP Return                          Enumeration     min
// 29 : CIP Pump Speed                      Value           %
// 30 : CIP Return Temperature              Value           C
// 32 : CIP Return Conductivity             Value           mS
// 34 : CIP Prerun Flow                     Value           m3/h
// 35 : CIP Prerun Pressure                 Value           bar
// 37 : CIP Pump Mode                       Enumeration     min
// 59 : Interval Counter                    Value           No.
X34:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// index evaluation: CIP Pump Mode
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[37].Sp,
           Indexes                  := #S2I.SFM37);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.0; 
      S     M    140.0; // Step Time

      ON    M    102.3; 
      O     M    150.4; 
      S     M    140.4; // Substep Time

      ON    M    102.3; 
      O     M    150.5; 
      S     M    140.5; // Delay Switchpoint

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// ---------------------------------------------------------------------------
// ---------------------------------------------------------------------------
// subphase repeat function
//      A     #SubStepMax
//      JCN  Y34
//      L     1
//      T     "SOSubStepNew"
//Y34:  SET

// subphase evaluation
      L     MW   110; 
      JL    D400; 
      JU    COMM; // subphase  0:
      JU    D401; // subphase  1: Pause
      JU    D402; // subphase  2: Main
      JU    D403; // subphase  3: Expulse
      JU    D404; // subphase  4: Seat Lift
      JU    D400; // subphase  5:
      JU    D406; // subphase  6: Shaft Rinse
      JU    D407; // subphase  7: Drain
// ---------------------------------------------------------------------------
D400: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

// subphase 1: Pause
D401: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 2: Main
D402: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 3: Expulse
D403: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 4: Seat Lift
D404: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 6: Shaft Rinse
D406: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 

// subphase 7: Drain
D407: SET   ; 

// -------------------------------------------------
// subphase timer & counter
      A     M    103.0; 

// -------------------------------------------------
// subphase actuator 
      A     M    103.3; 

// -------------------------------------------------
// subphase transition 
      CLR   ; 
      =     M    103.1; 
      JU    COMM; 
NETWORK
TITLE =phase 36: CIP Drain 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        Min
// 04 : Delay Empty                         Duration        #sec
X36:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
      ON    M    102.3; 
      O     M    150.3; 
      S     M    140.3; // Delay Empty

// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    D600; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D600: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =phase 40: CIP End 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
X40:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   150 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      A     #SubStepMaxD; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    E000; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
E000: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// pause timer unit parameter

// Request Mole Water
      O     DB250.DBX  182.6; 
      S     DB155.DBX   27.2; 

      AN    DB1595.DBX   26.4; // Molchwasser
      R     DB250.DBX  188.0; 

// Quelle
      L     DB155.DBW  254; 
      L     1000; 
      *I    ; 
      T     #iTmp; 

      L     0; 
      T     #U.Seq.SFM[14].Sp; 
      L     DB155.DBW  256; 
      <I    ; 
      JCN   ntru; 
      L     #iTmp; 
      +I    ; 
      ITD   ; 
      DTR   ; 
      T     #U.Seq.SFM[14].Sp; 
ntru: NOP   0; 


NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  
// Molchsignale  SR  
      A     DB251.DBX  558.7; 
      S     #U.Seq.Switch.Sw1; 

      A     #U.Seq.Switch.Sw1; 
      S     DB250.DBX  748.2; 

// Molch Schwenkbogen auf CIP
      A     DB251.DBX 1338.7; 
      O     DB251.DBX 1518.7; 
      S     DB250.DBX 2268.2; 

//Molch Bereit fr Produktion
      AN    DB250.DBX 2268.2; 
      AN    DB251.DBX 1278.7; 
      S     DB250.DBX 3868.2; 

//Molch im Sirupraum
      O     DB251.DBX  378.7; 
      O     DB251.DBX  438.7; 
      AN    DB251.DBX  978.7; 
      AN    DB251.DBX 1038.7; 
      S     DB250.DBX 3708.2; 
      S     DB250.DBX  908.2; 

//Molch an der Anlage
      O     DB251.DBX  978.7; 
      O     DB251.DBX 1038.7; 
      AN    DB251.DBX  378.7; 
      AN    DB251.DBX  438.7; 
      S     DB250.DBX 3788.2; 
      S     DB250.DBX  828.2; 

// Molch bereit fr CIP
      A     DB250.DBX 2268.2; 
      AN    DB251.DBX 1278.7; 
      =     DB250.DBX 3948.2; 

// Sirupanforderung
      A     DB155.DBX  314.1; 
      AN    #CIP; 
      =     DB250.DBX 4028.2; 

// Molchsignale  A
      A     DB251.DBX 1098.7; 
      A     DB251.DBX 1278.7; 
      FP    #U.Seq.User.Bit11; 
      S     #U.Seq.User.Bit12; // Freigabe Signal

      A     #U.Seq.User.Bit12; 
      A     M    100.7; 
      O     #U.Seq.Switch.Sw2; 
      =     DB250.DBX 1548.0; // Freigabe Anzeige

      A     #U.Seq.User.Bit12; 
      A     DB251.DBX 1158.7; 
      S     #U.Seq.User.Bit13; // Start Signal
      R     #U.Seq.User.Bit12; 

      A     #U.Seq.User.Bit13; 
      S     #U.Seq.Switch.Sw2; // Start Anzeige
      R     #U.Seq.User.Bit13; 

      AN    DB251.DBX 1098.7; 
      R     #U.Seq.User.Bit11; 
      R     #U.Seq.User.Bit12; 
      R     #U.Seq.User.Bit13; 



NETWORK
TITLE =Process Status Management

      NOP   0; 
// ---------------------------------------------------------------------------
// Signal Control

      OPN   DB   500; 
      L     #UnitNo; 
      L     32; //U Structure Length
      *I    ; 
      L     20; //DB Heading Offset
      +I    ; 
      SLD   3; 
      LAR2  ; 

// -------------------------------------------------
// Maintenance
      A     #U.Seq.Switch.Sw31; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.0]; //"PStatD".U[#UnitNo].MTNC
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
      A     DB155.DBX   26.2; 
      OPN   DB   500; 
      =     DBX [AR2,P#0.7]; //"PStatD".U[#UnitNo].FULL
// -------------------------------------------------
// Filling
      A     DB155.DBX   26.1; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.0]; //"PStatD".U[#UnitNo].FILL   
// -------------------------------------------------
// Ready For Filling
      A     DB155.DBX   26.0; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.1]; //"PStatD".U[#UnitNo].RFFI 
// -------------------------------------------------
// Empty
      A     DB155.DBX   26.5; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.2]; //"PStatD".U[#UnitNo].EMTY 
// -------------------------------------------------
// Emptying
      A     DB155.DBX   26.4; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.3]; //"PStatD".U[#UnitNo].EMTI
// -------------------------------------------------
// Ready For Emptying
      A     DB155.DBX   26.3; 
      OPN   DB   500; 
      =     DBX [AR2,P#1.4]; //"PStatD".U[#UnitNo].RFEM
// -------------------------------------------------
// Reserved
//      A     #ComXYZ
//      OPN   "PStatD"
//      =     DBX [AR2,P#1.5]             //"PStatD".U[#UnitNo].RESV
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used

// -------------------------------------------------
// PStat Function Call 

      CALL FC   500 (
           UnitNo                   := #UnitNo,
           PStatModVal              := DB255.DBD  234);

NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 153
TITLE =C05: Syrup Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C05E
VERSION : 1.2
CODE_VERSION1


VAR
  U : UDT 151;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
  ComCIP1 : BOOL ;	//CIP1 in use
  ComCIP3 : BOOL ;	//CIP3 in use
END_VAR
BEGIN
NETWORK
TITLE =General


      SET   ; 
// Simulation ---------------------------------------------------------------
      A     #U.Seq.User.Bit63; 
      CC    FB   159; // "C05Sim"
      A     #U.Seq.Sim; 
      =     #U.Seq.User.Bit63; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB150.DBW    0; 
      L     DB155.DBW   16; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB155.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    #U.Seq.Switch.Sw31; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   155; // U103Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C05UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C05UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C05UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C05UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// GOA_SKEG_31_oben GOA_SKEG_31_oben
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  261.4; 
      =     DB251.DBX  261.5; 

// ----------------------------------------------------------
// GOA_SKEG_32_unten GOA_SKEG_32_unten
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  321.4; 
      =     DB251.DBX  321.5; 

// ----------------------------------------------------------
// GOA_SKEG_1 GOA_SKEG_1
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  381.4; 
      =     DB251.DBX  381.5; 

// ----------------------------------------------------------
// GOA_SKEG_2 GOA_SKEG_2
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  441.4; 
      =     DB251.DBX  441.5; 

// ----------------------------------------------------------
// SK_KEG_Molch_Abbruch_DT MOLCH KEG Drucktaste Abbruch Sirupraum
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  501.4; 
      =     DB251.DBX  501.5; 

// ----------------------------------------------------------
// SK_KEG_START_Molch_LDT MOLCH KEG L-Drucktaste Start Sirupraum
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  561.4; 
      =     DB251.DBX  561.5; 

// ----------------------------------------------------------
// KEG_SK1_Handklappe KEG_SK1_Handklappe
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  621.4; 
      =     DB251.DBX  621.5; 

// ----------------------------------------------------------
// GOA_EKEG_31_oben GOA_EKEG_31_oben
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  861.4; 
      =     DB251.DBX  861.5; 

// ----------------------------------------------------------
// GOA_EKEG_32_unten GOA_EKEG_32_unten
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  921.4; 
      =     DB251.DBX  921.5; 

// ----------------------------------------------------------
// GOA_EKEG_3 GOA_EKEG_3
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX  981.4; 
      =     DB251.DBX  981.5; 

// ----------------------------------------------------------
// GOA_EKEG_4 GOA_EKEG_4
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1041.4; 
      =     DB251.DBX 1041.5; 

// ----------------------------------------------------------
// KEG_Freigabe_Molch_SS KEG_Freigabe_Molch_SS
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1101.4; 
      =     DB251.DBX 1101.5; 

// ----------------------------------------------------------
// KEG_Molch_Start_LDT_I KEG_Molch_Start_LDT
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1161.4; 
      =     DB251.DBX 1161.5; 

// ----------------------------------------------------------
// KEG_Stop_Molch_DT KEG_Stop_Molch_DT
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1221.4; 
      =     DB251.DBX 1221.5; 

// ----------------------------------------------------------
// GOA_EKEG_5 GOA Handklappe am Paneel KEG Anlage (CO2)
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1281.4; 
      =     DB251.DBX 1281.5; 

// ----------------------------------------------------------
// GOA_KEG_RR1 KEG RR Sirup Kreis 1 Schwenkbogen
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1341.4; 
      =     DB251.DBX 1341.5; 

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_22_24 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1401.4; 
      =     DB251.DBX 1401.5; 

// ----------------------------------------------------------
// GOA_KEG_RR3 KEG RR Sirup Kreis 3 Schwenkbogen
// ----------------------------------------------------------
      CLR   ; 
      =     DB251.DBX 1521.4; 
      =     DB251.DBX 1521.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB257.DBX   80.7; 
      =     DB257.DBX   81.4; 

      CLR   ; 
      =     DB257.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB257.DBX  140.7; 
      =     DB257.DBX  141.4; 

      CLR   ; 
      =     DB257.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB257.DBX  200.7; 
      =     DB257.DBX  201.4; 

      CLR   ; 
      =     DB257.DBX  202.7; 

NETWORK
TITLE =Sequence organisation


// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB250.DBX  185.4; 
      =     DB250.DBX  265.4; 
      =     DB250.DBX  345.4; 
      =     DB250.DBX  425.4; 
      =     DB250.DBX  505.4; 
      =     DB250.DBX  585.4; 
      =     DB250.DBX  665.4; 
      =     DB250.DBX  745.4; 
      =     DB250.DBX  825.4; 
      =     DB250.DBX  905.4; 
      =     DB250.DBX  985.4; 
      =     DB250.DBX 1065.4; 
      =     DB250.DBX 1145.4; 
      =     DB250.DBX 1225.4; 
      =     DB250.DBX 1305.4; 
      =     DB250.DBX 1385.4; 
      =     DB250.DBX 1545.4; 
      =     DB250.DBX 1625.4; 
      =     DB250.DBX 1705.4; 
      =     DB250.DBX 2265.4; 
      =     DB250.DBX 2425.4; 
      =     DB250.DBX 2505.4; 
      =     DB250.DBX 2585.4; 
      =     DB250.DBX 3705.4; 
      =     DB250.DBX 3785.4; 
      =     DB250.DBX 3865.4; 
      =     DB250.DBX 3945.4; 
      =     DB250.DBX 4025.4; 

MODE: SET   ; 

NETWORK
TITLE =KEG_MWV1 Ansteuerung KEG_MWV1

      AN    DB1595.DBX   27.1; 
      A     #GenRel; 
      A     DB250.DBX  186.7; 
      =     DB250.DBX  187.6; 

NETWORK
TITLE =SKEG_V2 Ansteuerung SKEG_V2

      A     #GenRel; 
      A     DB250.DBX  266.7; 
      =     DB250.DBX  267.6; 
NETWORK
TITLE =SKEG_V31 Ansteuerung SKEG_V31 (ohne RM)

      A     DB250.DBX  502.6; 
      A     DB250.DBX  582.6; 

      A     #GenRel; 
      A     DB250.DBX  346.7; 
      =     DB250.DBX  347.6; 

NETWORK
TITLE =SKEG_V32 Ansteuerung SKEG_V32 (ohne RM)

      A     #GenRel; 
      A     DB250.DBX  426.7; 
      =     DB250.DBX  427.6; 
NETWORK
TITLE =SKEG_V41 Ansteuerung SKEG_V41

      A     #GenRel; 
      A     DB250.DBX  506.7; 
      =     DB250.DBX  507.6; 
NETWORK
TITLE =SKEG_V42 Ansteuerung SKEG_V42

      A     #GenRel; 
      A     DB250.DBX  586.7; 
      =     DB250.DBX  587.6; 
NETWORK
TITLE =SK_KEG_Abbruch_Stoerung Lampe Abbruch IM SIRUPRAUM

      A     #GenRel; 
      A     DB250.DBX  666.7; 
      =     DB250.DBX  667.6; 
NETWORK
TITLE =SK_KEG_Molch_Start_LDT Lampe Start Molch IM SIRUPRAUM

      A     #GenRel; 
      A     DB250.DBX  746.7; 
      =     DB250.DBX  747.6; 
NETWORK
TITLE =SK_KEG_Molch_bei_KEG Lampe Molch an A11 IM SIRUPRAUM

      A     #GenRel; 
      A     DB250.DBX  826.7; 
      =     DB250.DBX  827.6; 
NETWORK
TITLE =SK_KEG_Molch_in_SK Lampe Molch im SK IM SIRUPRAUM

      A     #GenRel; 
      A     DB250.DBX  906.7; 
      =     DB250.DBX  907.6; 
NETWORK
TITLE =EKEG_V1 EKEG_V1

      A     #GenRel; 
      A     DB250.DBX  986.7; 
      =     DB250.DBX  987.6; 
NETWORK
TITLE =EKEG_V2 EKEG_V2

      A     #GenRel; 
      A     DB250.DBX 1066.7; 
      =     DB250.DBX 1067.6; 
NETWORK
TITLE =EKEG_V31_o_RM EKEG_V31_o_RM

      A     DB250.DBX 1302.6; 
      A     DB250.DBX 1382.6; 

      A     #GenRel; 
      A     DB250.DBX 1146.7; 
      =     DB250.DBX 1147.6; 
NETWORK
TITLE =EKEG_V32_o_RM EKEG_V32_o_RM

      A     #GenRel; 
      A     DB250.DBX 1226.7; 
      =     DB250.DBX 1227.6; 
NETWORK
TITLE =EKEG_V41 EKEG_V41

      A     #GenRel; 
      A     DB250.DBX 1306.7; 
      =     DB250.DBX 1307.6; 
NETWORK
TITLE =EKEG_V42 EKEG_V42

      A     #GenRel; 
      A     DB250.DBX 1386.7; 
      =     DB250.DBX 1387.6; 
NETWORK
TITLE =KEG_Molch_Start_LDT KEG_Molch_Start_LDT

      A     #GenRel; 
      A     DB250.DBX 1546.7; 
      =     DB250.DBX 1547.6; 
NETWORK
TITLE =A3_Schwenkbogen "1"=CIP  "0"=Produktion

      A     #GenRel; 
      A     DB250.DBX 2266.7; 
      =     DB250.DBX 2267.6; 
NETWORK
TITLE =KEG_Pos_Molch KEG_Pos_Molch

      A     #GenRel; 
      A     DB250.DBX 2426.7; 
      =     DB250.DBX 2427.6; 
NETWORK
TITLE =KEG_Laufzeit_Molch KEG_Laufzeit_Molch

      A     #GenRel; 
      A     DB250.DBX 2506.7; 
      =     DB250.DBX 2507.6; 
NETWORK
TITLE =KEG_Temperatur_erreicht KEG_Temperatur_erreicht

      A     #GenRel; 
      A     DB250.DBX 2586.7; 
      =     DB250.DBX 2587.6; 
NETWORK
TITLE =A3_Molch_Sirup "1"=Molch ist im Sirupraum

      A     #GenRel; 
      A     DB250.DBX 3706.7; 
      =     DB250.DBX 3707.6; 
NETWORK
TITLE =A3_Molch_Anlage "1"=Molch ist an der Anlage

      A     #GenRel; 
      A     DB250.DBX 3786.7; 
      =     DB250.DBX 3787.6; 
NETWORK
TITLE =A3_Molch_PRO "1"=Molch ist bereit fr Produktion

      A     #GenRel; 
      A     DB250.DBX 3866.7; 
      =     DB250.DBX 3867.6; 
NETWORK
TITLE =A3_Molch_CIP "1"=Molch ist bereit fr CIP

      A     #GenRel; 
      A     DB250.DBX 3946.7; 
      =     DB250.DBX 3947.6; 
NETWORK
TITLE =A3_Sirupanforderung 

      A     #GenRel; 
      A     DB250.DBX 4026.7; 
      =     DB250.DBX 4027.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 155
TITLE =C05: Syrup Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C05Comm
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 151;	
END_VAR
VAR_TEMP
  iRetVal : INT ;	//return value as integer
  wRetVal : WORD ;	//return value as word
  Run : BOOL ;	//Unit in "RUN" mode
  EStopOK : BOOL ;	//Emergency Stop OK   
  CIP : BOOL ;	//CIP Program Selected
  ComCIP : BOOL ;	//Communication with CIP Active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
  UnitNo : INT ;	//Unit Number
  EquipmentID : INT ;	//Equipment ID 
  Prid : DINT ;	//Process ID
  SFM36 : STRUCT 	//CIP Pump Mode
   I00 : BOOL ;	// Off
   I01 : BOOL ;	// Flow
   I02 : BOOL ;	// Pressure
   I03 : BOOL ;	// Fix Speed
   I04 : BOOL ;	
   I05 : BOOL ;	
   I06 : BOOL ;	
   I07 : BOOL ;	
   I08 : BOOL ;	
   I09 : BOOL ;	
   I10 : BOOL ;	
   I11 : BOOL ;	
   I12 : BOOL ;	
   I13 : BOOL ;	
   I14 : BOOL ;	
   I15 : BOOL ;	
   I16 : BOOL ;	
   I17 : BOOL ;	
   I18 : BOOL ;	
   I19 : BOOL ;	
   I20 : BOOL ;	
   I21 : BOOL ;	
   I22 : BOOL ;	
   I23 : BOOL ;	
   I24 : BOOL ;	
   I25 : BOOL ;	
   I26 : BOOL ;	
   I27 : BOOL ;	
   I28 : BOOL ;	
   I29 : BOOL ;	
   I30 : BOOL ;	
   I31 : BOOL ;	
  END_STRUCT ;	
  iPLC : INT ;	
  iUnit : INT ;	
  rUnitNo : REAL ;	
  DSTUnit : INT ;	//Destination Unit
  SRCUnit : INT ;	
  STBYUnit : INT ;	
  rEquipmentID : REAL ;	
END_VAR
BEGIN
NETWORK
TITLE =general

      SET   ; 

// unit & equipment number ---------------------------------------------------
      L     DB150.DBW    0; 
      L     DB155.DBW   16; 
      T     #UnitNo; 

      L     DB155.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// CIP ----------------------------------------------------------------------
      L     DB155.DBW   18; 
      L     0; 
      <I    ; 
      =     #CIP; 

// Communicating Units-------------------------------------------------------
      L     DB155.DBD   10; 
      L     DB155.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

// ... General Unit ----------/

      CALL SFC   20 (
           SRCBLK                   := DB1995.Own,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB155.GEN);

// emergency OK -------------------------------------------------------------
      A     DB155.DBX   75.0; //General Emergency Stop OK
      =     #EStopOK; 

NETWORK
TITLE =read other unit's data

      SET   ; 


//----------------------------------------
// Communication Packaging Plant
//----------------------------------------
      L     #U.Seq.Prop.Index0; // Source
      ITD   ; 
      DTR   ; 
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

      CALL FC   563 (
           ActReq                   := M    101.0,
           PLCNo                    := #iPLC,
           SourceUnitNo             := #iUnit,
           IsTUnit                  := FALSE,
           DstComDRec               := DB155.DST,
           RET_VAL                  := #wRetVal);


//----------------------------------------
// Communication Mixing Emptying
//----------------------------------------
      L     #U.Seq.SFM[14].Sp; // Source
      T     #rTmp; 

      CALL FC   950 (
           EquipmentNo              := #rTmp,
           PLCNo                    := #iPLC,
           UnitNo                   := #iUnit);

// Select
      L     DB1995.DBD  250; 
      L     DB155.DBD   10; 
      ==D   ; 
      AN    DB1995.DBX  264.7; 
      JC    MTE1; 
      L     DB1995.DBD  298; 
      L     DB155.DBD   10; 
      ==D   ; 
      AN    DB1995.DBX  312.7; 
      JC    MTE2; 
      L     DB1995.DBD  346; 
      L     DB155.DBD   10; 
      ==D   ; 
      AN    DB1995.DBX  360.7; 
      JC    MTE3; 
      L     DB1995.DBD  394; 
      L     DB155.DBD   10; 
      ==D   ; 
      AN    DB1995.DBX  408.7; 
      JC    MTE4; 
      L     DB1995.DBD 1066; 
      L     DB155.DBD   10; 
      ==D   ; 
      AN    DB1995.DBX 1080.7; 
      JC    KZES; 
      JU    ELS1; 
// Case
MTE1: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.MTE1,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.SRC);
      JU    FIN1; 
MTE2: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.MTE2,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.SRC);
      JU    FIN1; 
MTE3: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.MTE3,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.SRC);
      JU    FIN1; 
MTE4: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.MTE4,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.SRC);
      JU    FIN1; 
KZES: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U007,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.SRC);
      JU    FIN1; 
ELS1: L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB155.SRC);
FIN1: NOP   0; 

// Anlage
// Select
      L     #UnitNo; 
      L     103; 
      ==I   ; 
      JC    AN03; 
      L     #UnitNo; 
      L     105; 
      ==I   ; 
      JC    AN05; 
      L     #UnitNo; 
      L     107; 
      ==I   ; 
      JC    AN07; 
      L     #UnitNo; 
      L     109; 
      ==I   ; 
      JC    AN09; 
      L     #UnitNo; 
      L     112; 
      ==I   ; 
      JC    AN12; 
      L     #UnitNo; 
      L     114; 
      ==I   ; 
      JC    AN14; 
      JU    ELS2; 
// Case
AN03: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U153,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.P01ANL);
      JU    FIN2; 
AN05: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U155,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.P01ANL);
      JU    FIN2; 
AN07: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U157,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.P01ANL);
      JU    FIN2; 
AN09: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U159,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.P01ANL);
      JU    FIN2; 
AN12: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U162,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.P01ANL);
      JU    FIN2; 
AN14: NOP   0; 
      CALL SFC   20 (
           SRCBLK                   := DB1995.P01U164,
           RET_VAL                  := #iTmp,
           DSTBLK                   := DB155.P01ANL);
      JU    FIN2; 
ELS2: L     0; 
      T     #rTmp; 
      CALL SFC   21 (
           BVAL                     := #rTmp,
           RET_VAL                  := #iTmp,
           BLK                      := DB155.P01ANL);
FIN2: NOP   0; 

NETWORK
TITLE =external releases

      SET   ; 
      =     DB250.DBX  106.7; 
      =     DB250.DBX  186.7; 
      =     DB250.DBX  266.7; 
      =     DB250.DBX  346.7; 
      =     DB250.DBX  426.7; 
      =     DB250.DBX  506.7; 
      =     DB250.DBX  586.7; 
      =     DB250.DBX  666.7; 
      =     DB250.DBX  746.7; 
      =     DB250.DBX  826.7; 
      =     DB250.DBX  906.7; 
      =     DB250.DBX  986.7; 
      =     DB250.DBX 1066.7; 
      =     DB250.DBX 1146.7; 
      =     DB250.DBX 1226.7; 
      =     DB250.DBX 1306.7; 
      =     DB250.DBX 1386.7; 
      =     DB250.DBX 1466.7; 
      =     DB250.DBX 1546.7; 
      =     DB250.DBX 1626.7; 
      =     DB250.DBX 1706.7; 
      =     DB250.DBX 1786.7; 
      =     DB250.DBX 1866.7; 
      =     DB250.DBX 1946.7; 
      =     DB250.DBX 2026.7; 
      =     DB250.DBX 2106.7; 
      =     DB250.DBX 2186.7; 
      =     DB250.DBX 2266.7; 
      =     DB250.DBX 2346.7; 
      =     DB250.DBX 2426.7; 
      =     DB250.DBX 2506.7; 
      =     DB250.DBX 2586.7; 
      =     DB250.DBX 2666.7; 
      =     DB250.DBX 2746.7; 
      =     DB250.DBX 2826.7; 
      =     DB250.DBX 2906.7; 
      =     DB250.DBX 2986.7; 
      =     DB250.DBX 3066.7; 
      =     DB250.DBX 3146.7; 
      =     DB250.DBX 3226.7; 
      =     DB250.DBX 3306.7; 
      =     DB250.DBX 3386.7; 
      =     DB250.DBX 3466.7; 
      =     DB250.DBX 3546.7; 
      =     DB250.DBX 3626.7; 
      =     DB250.DBX 3706.7; 
      =     DB250.DBX 3786.7; 
      =     DB250.DBX 3866.7; 
      =     DB250.DBX 3946.7; 
      =     DB250.DBX 4026.7; 

NETWORK
TITLE =write own unit data

      SET   ; 

//-- CIP Communication ---------------------------------------
      AN    #U.Seq.Step0; 
      AN    #U.Seq.PO.B30; // CIP Active (Slave)
      A     #ComCIP; 
      JCN   NCIP; 
//Conductivity CIP Return
      L     DB155.DBD  150; 
      T     #U.Seq.SFM[32].Val; 

//Temperature CIP Return
      L     DB155.DBD  146; 
      T     #U.Seq.SFM[30].Val; 

//CIP Prerun Pump SP

      CALL FC    45 (
           SFM                      := #U.Seq.SFM[36].Sp,
           Indexes                  := #SFM36);


      L     0.000000e+000; 
      A     #SFM36.I01; 
      =     DB155.DBX  171.7; 
      JCN   pfc; 
      L     #U.Seq.SFM[34].Sp; 
pfc:  NOP   0; 
      A     #SFM36.I02; 
      =     DB155.DBX  172.0; 
      JCN   ppc; 
      L     #U.Seq.SFM[35].Sp; 
ppc:  NOP   0; 
      A     #SFM36.I03; 
      =     DB155.DBX  171.6; 
      JCN   pxc; 
      L     #U.Seq.SFM[29].Sp; 
pxc:  NOP   0; 
      T     DB155.DBD  182; 

//CIP Return
      L     #U.Seq.SFM[28].Sp; 
      T     DB155.DBD  186; 
      L     DB155.DBD  138; 
      T     #U.Seq.SFM[28].Val; 

//CIP Prerun
      L     #U.Seq.SFM[27].Sp; 
      T     DB155.DBD  190; 
      L     DB155.DBD  142; 
      T     #U.Seq.SFM[27].Val; 

// Write Own Data to CIP
      L     DB155.DBD   10; 
      T     DB155.DBD  154; 

      L     DB155.DBW   14; 
      T     DB155.DBW  158; 

      L     DB155.DBW   16; 
      T     DB155.DBW  160; 

      L     DB155.DBW   18; 
      T     DB155.DBW  162; 

      L     DB155.DBW   20; 
      T     DB155.DBW  164; 

      L     DB155.DBW   22; 
      T     DB155.DBW  166; 

      A     DB155.DBX   24.0; 
      =     DB155.DBX  168.0; 

      A     DB155.DBX   24.1; 
      =     DB155.DBX  168.1; 

      A     DB155.DBX   24.2; 
      =     DB155.DBX  168.2; 

      A     DB155.DBX   24.3; 
      =     DB155.DBX  168.3; 

      A     DB155.DBX   24.4; 
      =     DB155.DBX  168.4; 

      A     DB155.DBX   24.5; 
      =     DB155.DBX  168.5; 

      A     DB155.DBX   24.6; 
      =     DB155.DBX  168.6; 

      A     DB155.DBX   24.7; 
      =     DB155.DBX  168.7; 

// Copy Data to CIP
      CALL SFC   20 (
           SRCBLK                   := DB155.ToCIP,
           RET_VAL                  := #iRetVal,
           DSTBLK                   := DB155.ToCIP);

NCIP: NOP   0; 

//Empty Signal
//A     "C05SpID".SpI.Sig //!!!! Insert correct Empty Signal !!!
      CLR   ; 
      =     DB155.DBX   26.5; 

//Full Signal
//A     "C05SpID".SpI.Sig //!!!! Insert correct Full Signal !!!
      CLR   ; 
      =     DB155.DBX   26.2; 

//CIP Program Selected
      A     #CIP; 
      =     DB155.DBX   27.1; 

// Emergency Stop
      A     #EStopOK; //If needed add or replace with own SpI
      =     DB155.DBX   27.0; //Emergency Stop OK


NETWORK
TITLE = read from other unit data



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 159
TITLE =C05: Syrup Transfer x
AUTHOR : Woermann
FAMILY : BOTEC_F1
NAME : C05Sim
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 151;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  xTmp : BOOL ;	//Temporary BOOL (free for general use)    
  iTmp : INT ;	//Temporary INT (free for general use)    
  rTmp : REAL ;	//Temporary REAL (free for general use)    
  UnitNo : INT ;	//Unit Number    
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     #U.Seq.UnitNo; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

NETWORK
TITLE =Actuator

      A     #U.Seq.Sim; 
      =     DB250.DBX  105.3; 
      =     DB250.DBX  185.3; 
      =     DB250.DBX  265.3; 
      =     DB250.DBX  345.3; 
      =     DB250.DBX  425.3; 
      =     DB250.DBX  505.3; 
      =     DB250.DBX  585.3; 
      =     DB250.DBX  665.3; 
      =     DB250.DBX  745.3; 
      =     DB250.DBX  825.3; 
      =     DB250.DBX  905.3; 
      =     DB250.DBX  985.3; 
      =     DB250.DBX 1065.3; 
      =     DB250.DBX 1145.3; 
      =     DB250.DBX 1225.3; 
      =     DB250.DBX 1305.3; 
      =     DB250.DBX 1385.3; 
      =     DB250.DBX 1465.3; 
      =     DB250.DBX 1545.3; 
      =     DB250.DBX 1625.3; 
      =     DB250.DBX 1705.3; 
      =     DB250.DBX 1785.3; 
      =     DB250.DBX 1865.3; 
      =     DB250.DBX 1945.3; 
      =     DB250.DBX 2025.3; 
      =     DB250.DBX 2105.3; 
      =     DB250.DBX 2185.3; 
      =     DB250.DBX 2265.3; 
      =     DB250.DBX 2345.3; 
      =     DB250.DBX 2425.3; 
      =     DB250.DBX 2505.3; 
      =     DB250.DBX 2585.3; 
      =     DB250.DBX 2665.3; 
      =     DB250.DBX 2745.3; 
      =     DB250.DBX 2825.3; 
      =     DB250.DBX 2905.3; 
      =     DB250.DBX 2985.3; 
      =     DB250.DBX 3065.3; 
      =     DB250.DBX 3145.3; 
      =     DB250.DBX 3225.3; 
      =     DB250.DBX 3305.3; 
      =     DB250.DBX 3385.3; 
      =     DB250.DBX 3465.3; 
      =     DB250.DBX 3545.3; 
      =     DB250.DBX 3625.3; 
      =     DB250.DBX 3705.3; 
      =     DB250.DBX 3785.3; 
      =     DB250.DBX 3865.3; 
      =     DB250.DBX 3945.3; 
      =     DB250.DBX 4025.3; 

NETWORK
TITLE =Special Input

      A     #U.Seq.Sim; 
      =     DB251.DBX   81.3; 
      =     DB251.DBX  141.3; 
      =     DB251.DBX  201.3; 
      =     DB251.DBX  261.3; 
      =     DB251.DBX  321.3; 
      =     DB251.DBX  381.3; 
      =     DB251.DBX  441.3; 
      =     DB251.DBX  501.3; 
      =     DB251.DBX  561.3; 
      =     DB251.DBX  621.3; 
      =     DB251.DBX  681.3; 
      =     DB251.DBX  741.3; 
      =     DB251.DBX  801.3; 
      =     DB251.DBX  861.3; 
      =     DB251.DBX  921.3; 
      =     DB251.DBX  981.3; 
      =     DB251.DBX 1041.3; 
      =     DB251.DBX 1101.3; 
      =     DB251.DBX 1161.3; 
      =     DB251.DBX 1221.3; 
      =     DB251.DBX 1281.3; 
      =     DB251.DBX 1341.3; 
      =     DB251.DBX 1401.3; 
      =     DB251.DBX 1461.3; 
      =     DB251.DBX 1521.3; 


NETWORK
TITLE =Counter

      A     #U.Seq.Sim; 
      A     M    101.0; 
      CLR   ; 
NETWORK
TITLE =Analog Input

      A     #U.Seq.Sim; 

NETWORK
TITLE =Universal Value

      A     #U.Seq.Sim; 


NETWORK
TITLE =PID

      A     #U.Seq.Sim; 

NETWORK
TITLE =Message

      A     #U.Seq.Sim; 


NETWORK
TITLE =VLT

      A     #U.Seq.Sim; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 161
TITLE =C06: CIP Line x
// NW  1 : phase and index evaluation
// NW  2 : phase  1: start position
// NW  3 : phase  4: Filling
// NW  4 : phase  5: Storage
// NW  5 : phase  8: Emptying
// NW  6 : phase 20: Quality Check
// NW  7 : phase 21: Prepare Tank
// NW  8 : phase 23: Connect Tank
// NW  9 : phase 31: CIP Start
// NW 10 : phase 32: CIP Prerun
// NW 11 : phase 33: CIP Return
// NW 12 : phase 34: CIP Rinsing
// NW 13 : phase 35: CIP Emptying
// NW 14 : phase 36: CIP Drain
// NW 15 : phase 40: CIP End
// NW 16 : end of sequence
// NW 17 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Process Time                        Duration        min
// 40 : Density                             Value           kg/l
// 42 : Material                            Value
AUTHOR : Woermann
NAME : C06Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 161;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  ComXYZ : BOOL ;	//Communication With Unit XYZ
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  dUnitNo : DINT ;	//Unit Number 
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM25 : STRUCT 	//CIP Way
    I00 : BOOL ;	
    I01 : BOOL ;	//Water Tanks
    I02 : BOOL ;	//Packaging Plants
    I03 : BOOL ;	//CIP 1 Distribution
    I04 : BOOL ;	//CIP 3 Distribution
    I05 : BOOL ;	//Charcoal Filter
    I06 : BOOL ;	//Packaging Plant 5
    I07 : BOOL ;	//Packaging Plant 14
    I08 : BOOL ;	//CIP 2 Common
    I09 : BOOL ;	//KEG Plant / Wells
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM26 : STRUCT 	//Cip Step On Condition
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Conductivity High
    I02 : BOOL ;	//Conductivity Low
    I03 : BOOL ;	//Time
    I04 : BOOL ;	//Amount
    I05 : BOOL ;	//Temperature High
    I06 : BOOL ;	//Temperature Low
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM27 : STRUCT 	//Cip Prerun
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM28 : STRUCT 	//Cip Return
    I00 : BOOL ;	//None
    I01 : BOOL ;	//Recovered Water
    I02 : BOOL ;	//Caustic
    I03 : BOOL ;	
    I04 : BOOL ;	//Acid
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	//Fresh Water
    I13 : BOOL ;	//Warm Water
    I14 : BOOL ;	
    I15 : BOOL ;	//Drain
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM37 : STRUCT 	//Cip Pump Mode
    I00 : BOOL ;	//Off
    I01 : BOOL ;	//Flow
    I02 : BOOL ;	//Pressure
    I03 : BOOL ;	//Fix Speed
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM31 : STRUCT 	//Cip Distribution Circuit No
    I00 : BOOL ;	//Please Select
    I01 : BOOL ;	//Auto Select
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM39 : STRUCT 	//Q-Status
    I00 : BOOL ;	//Please select
    I01 : BOOL ;	//released
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	//Ignore
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	//locked
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
  ComDST : BOOL ;	//Communication Water Transfer to Packaging Plant
  ComCIPDist : BOOL ;	//Communication with CIP Distribution
  ReqInlet : BOOL ;	//Request Inlet
  RelOutlet : BOOL ;	//Release Outlet
  PStat : UDT 500;	
  Empty : BOOL ;	//Tank Empty
  ReqCTopUp : BOOL ;	//Request Caustic Top Up
  ReqATopUp : BOOL ;	//Request Acid Top Up
END_VAR
BEGIN
NETWORK
TITLE =Phase and Index Evaluation

      CLR   ; 
      =     #RRel; 
// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     37; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB165.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      L     MD   124; 
      L     DB165.DBD  106; 
      ==D   ; 
      =     #ComCIP; 

      L     MD   124; 
//      L     "UxxxComD".Own.PrId //!!! Fill in Communicating Unit Number
      ==D   ; 
      =     #ComXYZ; //!!! Fill in Shortname for Communicating Unit

// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB165.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 

// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: start position
      JU    X0; // phase  2:
      JU    X0; // phase  3:
      JU    X0; // phase  4:
      JU    X0; // phase  5
      JU    X0; // phase  6:
      JU    X0; // phase  7:
      JU    X0; // phase  8:
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X0; // phase 11:
      JU    X0; // phase 12:
      JU    X0; // phase 13:
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X0; // phase 18:
      JU    X0; // phase 19:
      JU    X0; // phase 20:
      JU    X0; // phase 21:
      JU    X0; // phase 22:
      JU    X0; // phase 23:
      JU    X0; // phase 24:
      JU    X0; // phase 25:
      JU    X0; // phase 26:
      JU    X0; // phase 27:
      JU    X0; // phase 28:
      JU    X0; // phase 29:
      JU    X0; // phase 30:
      JU    X31; // phase 31: CIP Active
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 

// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 

      L     0.000000e+000; 
      T     #U.Seq.User.Real11; 
      T     #U.Seq.User.Real12; 
      T     #U.Seq.User.Real13; 

      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// ---------------------------------------------------------------------------
// reset counter ------------------------------------------------------------
      AN    M    102.0; 
      S     DB262.DBX  181.4; 

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   160 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   160 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 
NETWORK
TITLE =phase 31: CIP Active 
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Watch Dog Time                      Duration        min
// 25 : CIP Way                             Enumeration
// 27 : Cip Prerun                          Enumeration
// 28 : Cip Return                          Enumeration
// 29 : Cip Pump Speed                      Value           %
// 30 : Cip Return Temperature              Value           C
// 32 : Cip Return Conductivity             Value           mS
// 33 : Cip Return Pump Speed               Value           %
// 34 : Cip Prerun Flow                     Value           m3/h
// 35 : Cip Prerun Pressure                 Value           bar
X31:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation
      CALL FC   160 (
           ChkType                  := 3,
           ChkOK                    := #ChkOK);

      AN    #ChkOK; 
      S     M    120.3; 

// ---------------------------------------------------------------------------
// index evaluation: CIP Way
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[25].Sp,
           Indexes                  := #S2I.SFM25);

// ---------------------------------------------------------------------------
// index evaluation: CIP Prerun
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[27].Sp,
           Indexes                  := #S2I.SFM27);

// ---------------------------------------------------------------------------
// index evaluation: CIP Return
      CALL FC    45 (
           SFM                      := #U.Seq.SFM[28].Sp,
           Indexes                  := #S2I.SFM28);

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
// CIP Active
      A     M    102.0; 
      =     DB165.DBX   27.4; 
// CIP Run Release
      A     #RRel; 
      =     DB165.DBX   27.5; 

// ---------------------------------------------------------------------------
// control modules 
// ---------------------------------------------------------------------------
// CIP Return ---
// ---------------------------------------------------------------------------
      L     DB165.DBD  138; 
      T     #U.Seq.SFM[28].Sp; 

// Circulation
      A     #S2I.SFM28.I16; 
      A     DB165.DBX  124.7; 
      A     #RRel; 
      =     DB260.DBX 2588.0; 

// Caustic
      A     #S2I.SFM28.I02; 
      A     DB165.DBX  124.7; 
      A     #RRel; 
      =     DB260.DBX  748.0; 

// Acid
      A     #S2I.SFM28.I04; 
      A     DB165.DBX  124.7; 
      A     #RRel; 
      =     DB260.DBX  828.0; 

// Hot Water
      A     #S2I.SFM28.I13; 
      A     DB165.DBX  124.7; 
      A     #RRel; 
      =     DB260.DBX  908.0; 

// Drain
      AN    DB260.DBX  748.0; 
      AN    DB260.DBX  828.0; 
      A     #S2I.SFM28.I15; 
      A     DB165.DBX  124.7; 
      A     #RRel; 
      =     DB260.DBX  988.0; 

      AN    DB1815.DBX   28.5; // Caustic Full --> Drain
      A     DB260.DBX  748.0; 
      R     DB260.DBX  748.0; 
      S     DB260.DBX  988.0; 

      AN    DB1825.DBX   28.5; // Acid Full --> Drain
      A     DB260.DBX  828.0; 
      R     DB260.DBX  828.0; 
      S     DB260.DBX  988.0; 

      AN    DB1835.DBX   28.5; // HWater Full --> Drain
      A     DB260.DBX  908.0; 
      R     DB260.DBX  908.0; 
      S     DB260.DBX  988.0; 


// Message Destination Not Ready
      A(    ; 
      AN    DB1815.DBX   28.5; 
      A     #S2I.SFM28.I01; 
      )     ; 
      O(    ; 
      AN    DB1825.DBX   28.5; 
      A     #S2I.SFM28.I02; 
      )     ; 
      O(    ; 
      AN    DB1835.DBX   28.5; 
      A     #S2I.SFM28.I03; 
      )     ; 
      O(    ; 
      AN    DB1845.DBX   28.5; 
      A     #S2I.SFM28.I04; 
      )     ; 
      A     DB165.DBX  125.0; // Run Release
      JCN   DNRM; 
      SET   ; 
      R     DB165.DBX   27.7; // Run Release
      L     903; // Destination Not Ready
      T     MD    90; 
DNRM: NOP   0; 

// ---------------------------------------------------------------------------
// CIP Prerun ---
// ---------------------------------------------------------------------------
      L     DB165.DBD  142; 
      T     #U.Seq.SFM[27].Sp; 

// Caustic
      A     DB1815.DBX   27.7; 
      A     DB165.DBX  124.6; 
      A     #S2I.SFM27.I02; 
      A     #RRel; 
      =     DB260.DBX  668.0; 

// Acid
      A     DB1825.DBX   27.7; 
      A     DB165.DBX  124.6; 
      A     #S2I.SFM27.I04; 
      A     #RRel; 
      =     DB260.DBX  588.0; 

// Hot Water
      A     DB1835.DBX   27.7; 
      A     DB165.DBX  124.6; 
      A     #S2I.SFM27.I13; 
      A     #RRel; 
      =     DB260.DBX  508.0; 

// Fresh Water
      A     DB1845.DBX   27.7; 
      A     DB165.DBX  124.6; 
      A     #S2I.SFM27.I12; 
      A     #RRel; 
      =     DB260.DBX  428.0; 

// Pump
      A     DB165.DBX  124.6; 
      A     DB165.DBX  125.3; 
      AN    #S2I.SFM27.I00; 
      A     #RRel; 
      =     DB260.DBX  108.0; 

      A     DB260.DBX  103.4; 
      A     M    102.3; 
      =     DB165.DBX   28.3; 

// Steam Valve
      A     DB263.DBX  138.6; 
      R     #U.Seq.User.Bit16; 

      A     DB263.DBX  138.5; 
      S     #U.Seq.User.Bit16; 

      L     #U.Seq.SFM[36].Sp; 
      L     0.000000e+000; 
      >R    ; 
      AN    #S2I.SFM27.I12; // Fresh Water
      AN    #U.Seq.User.Bit16; 
//      A     "C06ActD".RV_P1.VOn     // Probleme mit start / stop 
      A     #RRel; 
      =     DB260.DBX  348.0; 

// Message Source Not Ready
      AN    DB1815.DBX   27.7; 
      AN    DB1825.DBX   27.7; 
      AN    DB1835.DBX   27.7; 
      AN    DB1845.DBX   27.7; 
      A     DB165.DBX  124.6; 
      AN    #S2I.SFM27.I00; 
      JCN   SNRM; 
      SET   ; 
      R     DB165.DBX   27.5; 
      L     904; // Source Not Ready
      T     MD    90; 
SNRM: NOP   0; 

// ---------------------------------------------------------------------------
// CIP Way ---
// ---------------------------------------------------------------------------
      L     #U.Seq.SFM[25].Sp; 
      T     DB165.DBD   30; 

// ---------------------------------------------------------------------------
// transition condition 
      A     DB165.DBX  125.7; 
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    D100; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
D100: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 

NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// pause timer unit parameter


NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  

//Write Temperature CIP Prerun from Master CIP Unit
      L     DB165.DBD  134; 
      T     #U.Seq.SFM[36].Sp; 

NETWORK
TITLE =Process Status Management

      NOP   0; 

// ---------------------------------------------------------------------------
// Signal Control
// -------------------------------------------------
// Maintenance
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
// -------------------------------------------------
// Filling
// -------------------------------------------------
// Ready For Filling
// -------------------------------------------------
// Empty
// -------------------------------------------------
// Emptying
// -------------------------------------------------
// Ready For Emptying
// -------------------------------------------------
// Reserved
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used
// -------------------------------------------------
// PStat Function Call 
//      CALL  "PStat"
//       UnitNo     :=#UnitNo
//       PStatModVal:="C06UnVD".unv001.ValExt


NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 163
TITLE =C06: CIP Line x
AUTHOR : Woermann
NAME : C06Rel
VERSION : 0.1


VAR
  U : UDT 111;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     #U.Seq.User.Bit63; 
      CC    FB   169; // "C06Sim"
      A     #U.Seq.Sim; 
      =     #U.Seq.User.Bit63; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     MB   112; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     #U.Seq.ProgNo; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB165.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    #U.Seq.Switch.Sw31; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   165; // U091Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// RV1T1 Regler 2 RV 1 Temperatur 1
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB263.DBD  238; 

      SET   ; 
      =     DB263.DBX  141.5; 

// ----------------------------------------------------------
// TI_RR1 Temperatur CIP Rcklauf 1
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB263.DBD  358; 

      SET   ; 
      =     DB263.DBX  261.5; 

// ----------------------------------------------------------
// CS_RR1 Messbereich ist umschaltber
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB263.DBD  478; 

      SET   ; 
      =     DB263.DBX  381.5; 

// ----------------------------------------------------------
// FIT_RV1 Flow CIP Kreislauf 1
// ----------------------------------------------------------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB263.DBD  598; 

      SET   ; 
      =     DB263.DBX  501.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C06UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C06UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// FS_RR1_NEU 
// ----------------------------------------------------------
      AN    DB165.DBX   24.7; 
      A     DB165.DBX   24.0; 
      A     DB165.DBX  125.4; 
      =     DB261.DBX   81.4; 
      SET   ; 
      =     DB261.DBX   81.5; 

// ----------------------------------------------------------
// IDM_IMPULSE_RV_1FQS DURCHFLUSSMESSUNG KREISLAUF 1
// ----------------------------------------------------------
      CLR   ; 
//      =     "C06SpID".IDM_IMPULSE_RV_1FQS.EAl
//      =     "C06SpID".IDM_IMPULSE_RV_1FQS.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB267.DBX   80.7; 
      =     DB267.DBX   81.4; 

      CLR   ; 
      =     DB267.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB267.DBX  140.7; 
      =     DB267.DBX  141.4; 

      CLR   ; 
      =     DB267.DBX  142.7; 

NETWORK
TITLE =Counters 

      NOP   0; 

// ----------------------------------------------------------
// IDM_IMPULSE_RV_1FQI DURCHFLUSSMESSUNG KREISLAUF 1 (U91)
// ----------------------------------------------------------
      A     DB260.DBX  102.6; 
      =     DB262.DBX  183.5; 

      AN    DB260.DBX  102.5; 
      A     DB261.DBX  138.7; 
      =     DB262.DBX  179.0; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// RV1RV CIP 1
// ----------------------------------------------------------
// starting value -----------------------
      A     DB260.DBX  343.4; 
      A     #GenRel; 
      =     DB266.DBX  203.2; 
      =     DB266.DBX  203.5; 

// enable alarm -------------------------
      A     DB266.DBX  203.5; 
      A     DB266.DBX  201.4; 
      AN    DB266.DBX  203.1; 
      AN    DB266.DBX  203.3; 
      AN    DB266.DBX  203.4; 
      =     DB266.DBX  203.0; 

// setpoint to controller ---------------
      L     #U.Seq.SFM[36].Sp; // CIP Prerun Temperature
      L     DB165.DBD  134; 
      T     DB266.DBD  234; 

// static value to controller ----------
      L     #U.Seq.SFM[63].Sp; // !!! insert correct SFM !!!
      T     DB266.DBD  238; 

// process value to controller ----------
      L     DB263.DBD  146; 
      T     DB266.DBD  254; 

// low/high value to controller ---------
      L     DB263.DBD  150; 
      T     DB266.DBD  218; 

      L     DB263.DBD  154; 
      T     DB266.DBD  222; 

      L     DB263.DBD  506; 
      T     DB266.DBD  310; 
NETWORK
TITLE =Sequence organisation

// SFM supply ----------------------------------------------------------------

// analog value to SFM Regler 2 RV 1 Temperatur 1 -----------------------
      L     DB263.DBD  146; 
      T     #U.Seq.SFM[36].Val; // CIP Prerun Temperature

// analog value to SFM Temperatur CIP Rcklauf 1 -----------------------
      L     DB263.DBD  266; 
      T     #U.Seq.SFM[30].Val; // CIP Return Temperature

// analog value to SFM Messbereich ist umschaltber -----------------------
      L     DB263.DBD  386; 
      T     #U.Seq.SFM[32].Val; // CIP Return Conductivity

// analog value to SFM Flow CIP Kreislauf 1 -----------------------
      L     DB263.DBD  506; 
      T     #U.Seq.SFM[34].Val; // CIP Prerun Flow

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB260.DBX  105.4; 
      =     DB260.DBX  345.4; 
      =     DB260.DBX  425.4; 
      =     DB260.DBX  505.4; 
      =     DB260.DBX  585.4; 
      =     DB260.DBX  665.4; 
      =     DB260.DBX  745.4; 
      =     DB260.DBX  825.4; 
      =     DB260.DBX  905.4; 
      =     DB260.DBX  985.4; 
      =     DB260.DBX 2585.4; 
      =     DB260.DBX 2665.4; 
      =     DB260.DBX 2745.4; 

// assign PID mode
      S     DB266.DBX  201.4; 
      S     DB266.DBX  201.5; 


MODE: SET   ; 

NETWORK
TITLE =RV_P1 Reinigungsvorlaufpumpe Kreis 1

      O     DB260.DBX  422.6; 
      O     DB260.DBX  502.6; 
      O     DB260.DBX  582.6; 
      O     DB260.DBX  662.6; 
      O     DB260.DBX 2582.6; 

      AN    DB260.DBX  102.1; 
      AN    DB263.DBX  498.1; 
      AN    DB262.DBX  178.1; 

      A     #GenRel; 
      A     DB260.DBX  106.7; 
      =     DB260.DBX  107.6; 
NETWORK
TITLE =RV1_RV Regelventil CIP 1

//      A     "C06ActD".RV_P1.VOn
      AN    DB263.DBX  498.6; 
      AN    DB263.DBX  498.7; 
      AN    DB263.DBX  498.1; 
      AN    DB263.DBX  138.1; 
      A     #GenRel; 
      A     DB260.DBX  346.7; 
      =     DB260.DBX  347.6; 
NETWORK
TITLE =FW_V1 Frischwasservorlaufventil Kreis 1

      A     #GenRel; 
      A     DB260.DBX  426.7; 
      =     DB260.DBX  427.6; 
NETWORK
TITLE =HW_V1 Heisswasservorlaufventil Kreis 1

      A     #GenRel; 
      A     DB260.DBX  506.7; 
      =     DB260.DBX  507.6; 
NETWORK
TITLE =SV_V1 Surevorlaufventil Kreis 1

      AN    DB260.DBX  662.6; 

      A     #GenRel; 
      A     DB260.DBX  586.7; 
      =     DB260.DBX  587.6; 
NETWORK
TITLE =LV_V1 Laugevorlaufventil Kreis 1

      AN    DB260.DBX  582.6; 

      A     #GenRel; 
      A     DB260.DBX  666.7; 
      =     DB260.DBX  667.6; 
NETWORK
TITLE =LR_V1 Laugercklaufventil Kreis 1

      AN    DB260.DBX  822.6; 

      A     DB2811.DBX  138.7; 

      A     #GenRel; 
      A     DB260.DBX  746.7; 
      =     DB260.DBX  747.6; 
NETWORK
TITLE =SR_V1 Surercklaufventil Kreis 1

      AN    DB260.DBX  742.6; 

      A     DB2821.DBX  138.7; 

      A     #GenRel; 
      A     DB260.DBX  826.7; 
      =     DB260.DBX  827.6; 
NETWORK
TITLE =HWR_V1 Heisswasserrcklaufventil Kreis 1

      A     DB2831.DBX  138.7; 

      A     #GenRel; 
      A     DB260.DBX  906.7; 
      =     DB260.DBX  907.6; 
NETWORK
TITLE =GR_V1 Gullyventil Kreis 1

      A     #GenRel; 
      A     DB260.DBX  986.7; 
      =     DB260.DBX  987.6; 
NETWORK
TITLE =KV_V1 Kreislaufventil Kreis 1

      A     #GenRel; 
      A     DB260.DBX 2586.7; 
      =     DB260.DBX 2587.6; 
NETWORK
TITLE =CSRR1_MBU_A Leitwertsonde Rcklauf Kontakt A (Lauge)

      A     #GenRel; 
      A     DB260.DBX 2666.7; 
      =     DB260.DBX 2667.6; 
NETWORK
TITLE =CSRR1_MBU_B Leitwertsonde Rcklauf Kontakt B (Saure)

      A     #GenRel; 
      A     DB260.DBX 2746.7; 
      =     DB260.DBX 2747.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 171
TITLE =C07: Brunnen Transfer Plan
// NW  1 : phase and index evaluation
// NW  2 : phase  1: Startposition
// NW  3 : phase 19: Plananpassung
// NW  4 : end of sequence
// NW  5 : unit hold request
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 09 : Prozesszeit                         Dauer           min
// 10 : Aktueller Tank                      Equipment
// 11 : 1. Tank                             Equipment
// 12 : 2. Tank                             Equipment
// 13 : 3. Tank                             Equipment
// 14 : Quelle                              Equipment
// 16 : Menge                               Wert            m3
// 22 : pH                                  Wert            pH
// 23 : Chriwa Status 1                     Aufzhlung
// 24 : Chriwa Status 2                     Aufzhlung
// 42 : Material                            Material
AUTHOR : Woermann
NAME : C06Seq
VERSION : 0.1
CODE_VERSION1


VAR
  U : UDT 161;	
END_VAR
VAR_TEMP
  CIP : BOOL ;	//CIP active
  ComCIP : BOOL ;	//Communication With CIP Active 
  ComDST : BOOL ;	//Communication With DST OK (Same Mat)
  RRel : BOOL ;	//Run Release 
  EStopOK : BOOL ;	//emergency OK
  StepMax : BOOL ;	//StepMax (last) active
  SubStepMax : BOOL ;	//SubStepMax (last) active
  SubStepMaxD : BOOL ;	//SubStepMax (last) done
  ChkOK : BOOL ;	//SubStepMax (last) done
  xTmp : BOOL ;	//Temporary BOOL (free for general use) 
  iTmp : INT ;	//Temporary INT (free for general use) 
  dTmp : DINT ;	//Temporary DINT (free for general use)
  rTmp : REAL ;	//Temporary REAL (free for general use)
  UnitNo : INT ;	//Unit Number 
  EquipmentID : INT ;	//Equipment ID
  S2I : STRUCT 	//SFM to indexes
   SFM10 : STRUCT 	//Aktueller Tank
    I00 : BOOL ;	//Bitte auswhlen
    I01 : BOOL ;	
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM11 : STRUCT 	//1. Tank
    I00 : BOOL ;	//Bitte auswhlen
    I01 : BOOL ;	
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM12 : STRUCT 	//2. Tank
    I00 : BOOL ;	//Bitte auswhlen
    I01 : BOOL ;	
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM13 : STRUCT 	//3. Tank
    I00 : BOOL ;	//Bitte auswhlen
    I01 : BOOL ;	
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM14 : STRUCT 	//Quelle
    I00 : BOOL ;	//Bitte auswhlen
    I01 : BOOL ;	
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM23 : STRUCT 	//Chriwa Status 1
    I00 : BOOL ;	//Erstfiltrat
    I01 : BOOL ;	//Aus
    I02 : BOOL ;	//Bereitschaft
    I03 : BOOL ;	//Stop
    I04 : BOOL ;	//Strung
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	//Betrieb
    I09 : BOOL ;	//Entspannen
    I10 : BOOL ;	//Absenken
    I11 : BOOL ;	//Splen Luft
    I12 : BOOL ;	//Splen Wasser/Luft
    I13 : BOOL ;	//Filterbettentleerung
    I14 : BOOL ;	//Splen Wasser
    I15 : BOOL ;	//Auffllen
    I16 : BOOL ;	//Nicht definiert
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM24 : STRUCT 	//Chriwa Status 2
    I00 : BOOL ;	//Erstfiltrat
    I01 : BOOL ;	//Aus
    I02 : BOOL ;	//Bereitschaft
    I03 : BOOL ;	//Stop
    I04 : BOOL ;	//Strung
    I05 : BOOL ;	
    I06 : BOOL ;	
    I07 : BOOL ;	
    I08 : BOOL ;	//Betrieb
    I09 : BOOL ;	//Entspannen
    I10 : BOOL ;	//Absenken
    I11 : BOOL ;	//Splen Luft
    I12 : BOOL ;	//Splen Wasser/Luft
    I13 : BOOL ;	//Filterbettentleerung
    I14 : BOOL ;	//Splen Wasser
    I15 : BOOL ;	//Auffllen
    I16 : BOOL ;	//Nicht definiert
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
   SFM39 : STRUCT 	//Q-Status
    I00 : BOOL ;	//Bitte auswhlen
    I01 : BOOL ;	//freigegeben
    I02 : BOOL ;	
    I03 : BOOL ;	
    I04 : BOOL ;	
    I05 : BOOL ;	
    I06 : BOOL ;	//ignorieren
    I07 : BOOL ;	
    I08 : BOOL ;	
    I09 : BOOL ;	//gesperrt
    I10 : BOOL ;	
    I11 : BOOL ;	
    I12 : BOOL ;	
    I13 : BOOL ;	
    I14 : BOOL ;	
    I15 : BOOL ;	
    I16 : BOOL ;	
    I17 : BOOL ;	
    I18 : BOOL ;	
    I19 : BOOL ;	
    I20 : BOOL ;	
    I21 : BOOL ;	
    I22 : BOOL ;	
    I23 : BOOL ;	
    I24 : BOOL ;	
    I25 : BOOL ;	
    I26 : BOOL ;	
    I27 : BOOL ;	
    I28 : BOOL ;	
    I29 : BOOL ;	
    I30 : BOOL ;	
    I31 : BOOL ;	
   END_STRUCT ;	
  END_STRUCT ;	
END_VAR
BEGIN
NETWORK
TITLE = Phase and Index Evaluation

      CLR   ; 
      =     #RRel; 
      =     DB175.DBX   27.6; 

      L     0; 
      T     DB175.DBD   30; 
      T     DB175.DBD   34; 
      T     DB175.DBD   38; 
      T     DB175.DBD   42; 
      T     DB175.DBD   46; 

// ---------------------------------------------------------------------------
// write max used SFM's (last SFM number + 1) 
      L     43; 
      T     #U.SFMQuant; 

// ---------------------------------------------------------------------------
// unit & equipment number 
      L     MB   112; 
      T     #UnitNo; 

      L     DB175.DBW   14; 
      L     1000; 
      *I    ; 
      L     #UnitNo; 
      +I    ; 
      T     #EquipmentID; 

// ---------------------------------------------------------------------------
// CIP active 
      L     MW   114; 
      L     0; 
      <I    ; 
      =     #CIP; 

// ---------------------------------------------------------------------------
// communicating units 
      CLR   ; 
      =     #ComCIP; 

// ---------------------------------------------------------------------------
// process timer start
      SET   ; 
      =     M    131.0; 

// ---------------------------------------------------------------------------
// emergency OK 
      A     DB175.DBX   27.0; 
      =     #EStopOK; 

// define last (Sub)Step active
      L     #U.Seq.StepMax; 
      L     MW   104; 
      ==I   ; 
      =     #StepMax; 

      L     #U.Seq.SubStepMax; 
      L     MW   118; 
      ==I   ; 
      =     #SubStepMax; 

      A     #SubStepMax; 
      A     #U.Seq.SPD; 
      AN    M    103.2; 
      =     #SubStepMaxD; 


// ---------------------------------------------------------------------------
// phase evaluation
      L     MW   108; 
      JL    X0; 
      JU    X0; // phase  0:
      JU    X1; // phase  1: Startposition
      JU    X0; // phase  2:
      JU    X0; // phase  3: Vorsplen
      JU    X0; // phase  4: System befllen
      JU    X0; // phase  5: Transfer
      JU    X0; // phase  6: Standby
      JU    X0; // phase  7:
      JU    X0; // phase  8: Ausschub
      JU    X0; // phase  9:
      JU    X0; // phase 10:
      JU    X0; // phase 11: Nachsplen
      JU    X0; // phase 12:
      JU    X0; // phase 13:
      JU    X0; // phase 14:
      JU    X0; // phase 15:
      JU    X0; // phase 16:
      JU    X0; // phase 17:
      JU    X0; // phase 18:
      JU    X19; // phase 19: Plananpassung
X0:   SET   ; 
      S     M    108.7; // Error unknown phase
      JU    COMM; 
NETWORK
TITLE =phase 1: startposition

X1:   SET   ; 

// ---------------------------------------------------------------------------
// general functions 
// ---------------------------------------------------------------------------
// reset signals 
      A     M    102.2; 
      R     #U.Seq.Switch.Sw1; 
      R     #U.Seq.Switch.Sw2; 

      AN    M    102.0; 
      =     M    161.0; // Reset Process Timer 

      CALL FC   709 (// Reset "Simulation" And "Ignore" 
           UnitNo                   := #UnitNo,// Of All Control Modules 
           Enable                   := M    102.2);// At First Cycle of Startposition (Idle)

// ---------------------------------------------------------------------------
// start check --------------------------------------------------------------
      A     #CIP; 
      JC    M010; 

      CALL FC   170 (
           ChkType                  := 1,// production
           ChkOK                    := M    122.0);
      JU    COMM; 

M010: CALL FC   170 (
           ChkType                  := 2,// CIP
           ChkOK                    := M    122.0);
      JU    COMM; 
NETWORK
TITLE =phase 19: Plananpassung
//SFM   Use                                 Datatype        UoM
//----+-------------------------------------------------------------------------
// 00 : Schrittberwachzeit                 Dauer           min
// 16 : Menge                               Wert            kg
// 20 : Durchfluss                          Wert            m3/h
X19:  SET   ; 
// ---------------------------------------------------------------------------
// General CM evaluation

// ---------------------------------------------------------------------------
// general functions 
      AN    M    121.2; 
      A     M    102.3; 
      =     #RRel; 

// ---------------------------------------------------------------------------
// messages 
// ---------------------------------------------------------------------------
// timer & counter 
      A     M    102.0; 

// ---------------------------------------------------------------------------
// pause timer
// ---------------------------------------------------------------------------
// communication
      L     DB175.DBD  174; 
      L     #U.Seq.SFM[42].Sp; 
      ==R   ; 
      AN    DB175.DBX  168.7; 
      AN    DB175.DBX   24.7; 
      =     #ComDST; 

      A     #ComDST; 
      A     M    102.3; 
      S     DB175.DBX   29.0; // Request Data Copy
      AN    M    102.0; 
      O     M    102.2; 
      R     DB175.DBX   29.0; // Request Data Copy

      L     #U.Seq.SFM[42].Sp; // Mateial
      T     DB175.DBD   30; 
      L     #U.Seq.SFM[16].Sp; // Menge
      T     DB175.DBD   34; 
      L     #U.Seq.SFM[11].Sp; // Tank 1
      T     DB175.DBD   38; 
      L     #U.Seq.SFM[12].Sp; // Tank 2
      T     DB175.DBD   42; 
      L     #U.Seq.SFM[13].Sp; // Tank 3
      T     DB175.DBD   46; 

// ---------------------------------------------------------------------------
// control modules 
      A     M    102.3; 

// ---------------------------------------------------------------------------
// transition condition 
      L     #U.Seq.SFM[0].Val; 
      L     1.000000e+000; 
      >=R   ; 
      A     #ComDST; 
      A     DB175.DBX  173.0; // Data Copy Done
      =     M    102.1; 

// subphase evaluation
      L     MW   110; 
      JL    B900; 
      JU    COMM; // subphase  0:
// ---------------------------------------------------------------------------
B900: SET   ; 
      S     M    110.7; // Error unknown subphase
      JU    COMM; 
NETWORK
TITLE =End Of Sequence Organisation

COMM: SET   ; 

// ---------------------------------------------------------------------------
// pause timer unit parameter


NETWORK
TITLE =General Post Phase Controls

      NOP   0; 

// ---------------------------------------------------------------------------
// general postphase controls  


NETWORK
TITLE =Process Status Management

      NOP   0; 
// ---------------------------------------------------------------------------
// Signal Control
// -------------------------------------------------
// Maintenance
      A     #U.Seq.Switch.Sw31; 
      =     DB500.DBX 3892.0; 
// -------------------------------------------------
// CIP Required
// -------------------------------------------------
// CIP Active
// -------------------------------------------------
// CIP Clean
// -------------------------------------------------
// SIP Required
// -------------------------------------------------
// SIP Active
// -------------------------------------------------
// SIP Clean
// -------------------------------------------------
// Full
      A     DB175.DBX   26.2; 
      =     DB500.DBX 3892.7; 
// -------------------------------------------------
// Filling
      A     DB175.DBX   26.1; 
      =     DB500.DBX 3893.0; 
// -------------------------------------------------
// Ready For Filling
      A     DB175.DBX   26.0; 
      =     DB500.DBX 3893.1; 
// -------------------------------------------------
// Empty
      A     DB175.DBX   26.5; 
      =     DB500.DBX 3893.2; 
// -------------------------------------------------
// Emptying
      A     DB175.DBX   26.4; 
      =     DB500.DBX 3893.3; 
// -------------------------------------------------
// Ready For Emptying
      A     DB175.DBX   26.3; 
      =     DB500.DBX 3893.4; 
// -------------------------------------------------
// Reserved
      A     #ComDST; 
      =     DB500.DBX 3893.5; 
// -------------------------------------------------
// Production
// -------------------------------------------------
// Used

// -------------------------------------------------
// PStat Function Call 

      CALL FC   500 (
           UnitNo                   := #UnitNo,
           PStatModVal              := DB275.DBD  234);


NETWORK
TITLE =Unit Hold Request and Messages

      SET   ; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if maintenance
      AN    #U.Seq.Switch.Sw31; // maintenance !
      JC    NCO1; 
      S     M    120.3; 
      L     998; // "Unit in maintenance !"
      T     MD    90; 

// ---------------------------------------------------------------------------
// Set unit to "hold" if emergency stop
NCO1: A     #EStopOK; 
      JC    NCO2; 
      S     M    120.3; 
      L     999; // "Emergency stop !"
      T     MD    90; 
NCO2: NOP   0; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 173
TITLE =C07: Brunnen Transfer Plan
FAMILY : BOTEC_F1
NAME : U121E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// get unit number ----------------------------------------------------------
      L     DB170.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB171.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB175.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB171.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB   175; // C07Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB171.DBD 1118; // !!! insert correct SFM !!!
      T     DB273.DBD  238; 

      CLR   ; 
      =     DB273.DBX  141.5; 
      =     DB273.DBX  140.6; 
      =     DB273.DBX  140.7; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB171.DBD 1118; // !!! insert correct SFM !!!
      T     DB273.DBD  358; 

      CLR   ; 
      =     DB273.DBX  261.5; 
      =     DB273.DBX  260.6; 
      =     DB273.DBX  260.7; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB171.DBD 1118; // !!! insert correct SFM !!!
      T     DB273.DBD  478; 

      CLR   ; 
      =     DB273.DBX  381.5; 
      =     DB273.DBX  380.6; 
      =     DB273.DBX  380.7; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C07UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C07UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C07UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "C07UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB271.DBX   81.4; 
      =     DB271.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB271.DBX  141.4; 
      =     DB271.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB271.DBX  201.4; 
      =     DB271.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB271.DBX  261.4; 
      =     DB271.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB277.DBX   80.7; 
      =     DB277.DBX   81.4; 

      CLR   ; 
      =     DB277.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB277.DBX  140.7; 
      =     DB277.DBX  141.4; 

      CLR   ; 
      =     DB277.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB277.DBX  200.7; 
      =     DB277.DBX  201.4; 

      CLR   ; 
      =     DB277.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "C07ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB276.DBX  203.2; 
      =     DB276.DBX  203.5; 

// enable alarm -------------------------
      A     DB276.DBX  203.5; 
      A     DB276.DBX  201.4; 
      AN    DB276.DBX  203.1; 
      AN    DB276.DBX  203.3; 
      AN    DB276.DBX  203.4; 
      =     DB276.DBX  203.0; 

// setpoint to controller ---------------
      L     DB171.DBD 1118; // !!! insert correct SFM !!!
      T     DB276.DBD  234; 

// static value to controller ----------
      L     DB171.DBD 1118; // !!! insert correct SFM !!!
      T     DB276.DBD  238; 

// process value to controller ----------
      L     DB273.DBD   26; // !!! insert correct AnI !!!
      T     DB276.DBD  254; 

// low/high value to controller ---------
      L     DB273.DBD   30; // !!! insert correct AnI !!!
      T     DB276.DBD  218; 

      L     DB273.DBD   34; // !!! insert correct AnI !!!
      T     DB276.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB273.DBD  146; 
      T     DB171.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB273.DBD  266; 
      T     DB171.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB273.DBD  386; 
      T     DB171.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB173.DBX   43.1; 
      S     DB173.DBX   97.3; 

//      CALL  "SeO"          Called in Unit
//       UnitNo:=#UnitNo

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB276.DBX  201.4; 
      S     DB276.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 560
TITLE =
AUTHOR : RR
FAMILY : BOTEC_F1
NAME : OrLiMngA
VERSION : 1.0


VAR_TEMP
  RetVal : WORD ;	//return value
  ValDW : DWORD ;	
  ValOK : BOOL ;	
  SetValue : DWORD ;	
END_VAR
BEGIN
NETWORK
TITLE =Send-/Receive manager telegramtype 1


// Send manager telegramtype 1
      CALL FC   571 (
           RET_VAL                  := #RetVal);

      JBI   OKS1; // Jump, if all OK
// Error evaluation
      L     #RetVal; // Return value
      L     DB33.DBD   84; // Error number from answer
OKS1: NOP   0; 

// Receive manager telegramtype 1
      CALL FC   572 (
           RET_VAL                  := #RetVal);

      JBI   OKR1; // Jump, if all OK
// Error evaluation
      L     #RetVal; // Return value
      L     DB33.DBD   84; // Error number from answer
OKR1: NOP   0; 


NETWORK
TITLE =Order management

// Telegramtype 1

      CALL FC   560 (
           OrLiDB                   := DB   561,
           RET_VAL                  := #RetVal);

// Telegramtype 2

      CALL FC   560 (
           OrLiDB                   := DB   562,
           RET_VAL                  := #RetVal);

// Telegramtype 3

      CALL FC   560 (
           OrLiDB                   := DB   563,
           RET_VAL                  := #RetVal);

// Telegramtype 4

      CALL FC   560 (
           OrLiDB                   := DB   564,
           RET_VAL                  := #RetVal);

// Telegramtype 5

      CALL FC   560 (
           OrLiDB                   := DB   565,
           RET_VAL                  := #RetVal);


NETWORK
TITLE =Buffer diagnosis

      UC    FB   575; 


END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 581
TITLE =
AUTHOR : RR
FAMILY : BOTEC_F1
NAME : CrCA
VERSION : 2.1


VAR_TEMP
  RemotePLCNo : INT ;	//remote PLC number
  RetVal : WORD ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =coupling active bits initialize

      AN    M    101.4; 
      JC    NCRC; 
      R     DB580.DBX   23.4; // initialize active bits (reset)
      R     DB580.DBX   11.4; 
      R     DB580.DBX   47.4; 
      R     DB580.DBX   35.4; 
      R     DB580.DBX   71.4; 
      R     DB580.DBX   59.4; 
      R     DB580.DBX   95.4; 
      R     DB580.DBX   83.4; 
      R     DB580.DBX  119.4; 
      R     DB580.DBX  107.4; 
      R     DB580.DBX  143.4; 
      R     DB580.DBX  131.4; 
      R     DB580.DBX  167.4; 
      R     DB580.DBX  155.4; 
      R     DB580.DBX  191.4; 
      R     DB580.DBX  179.4; 

NCRC: SET   ; 
NETWORK
TITLE =read/write data from/to remote PLC

      NOP   0; 

// PLC01
      CALL FB   580 , DB   581 (
           RemotePLCNo              := #RemotePLCNo,
           RetVal                   := #RetVal);

// PLC02
      CALL FB   580 , DB   582 (
           RemotePLCNo              := #RemotePLCNo,
           RetVal                   := #RetVal);

// PLC03
      CALL FB   580 , DB   583 (
           RemotePLCNo              := #RemotePLCNo,
           RetVal                   := #RetVal);

// PLC04
      CALL FB   580 , DB   584 (
           RemotePLCNo              := #RemotePLCNo,
           RetVal                   := #RetVal);

// PLC05
//      CALL  "CCL" , "CCLP05D"
//       RemotePLCNo:=#RemotePLCNo
//       RetVal     :=#RetVal

// PLC06
//      CALL  "CCL" , "CCLP06D"
//       RemotePLCNo:=#RemotePLCNo
//       RetVal     :=#RetVal

// PLC07
//      CALL  "CCL" , "CCLP07D"
//       RemotePLCNo:=#RemotePLCNo
//       RetVal     :=#RetVal

// PLC08
//      CALL  "CCL" , "CCLP08D"
//       RemotePLCNo:=#RemotePLCNo
//       RetVal     :=#RetVal

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1000
TITLE =
FAMILY : BOTEC
NAME : UniA
VERSION : 2.0


VAR_TEMP
  UnitNo : INT ;	//unit number
END_VAR
BEGIN
NETWORK
TITLE =general

      L     DB1000.DBW    0; 
      T     #UnitNo; 

NETWORK
TITLE =analog input's

//      CALL  "AnI"
//       UnitNo:=#UnitNo
//       AnIRec:="U00AnID".AnI1
//       ValPer:=PEW1024

NETWORK
TITLE =PID controller assignment

//      CALL  "PID"
//       UnitNo:=#UnitNo
//       PIDRec:="U00PIDD".PID1
//       SpExt :"U01SeqD".Seq.SFM[x].Sp
//       PVal  :="U00AnID".AnI1.Val
//       OPer  :=PAW1024


//      CALL  "VLT"
//       UnitNo :=#UnitNo
//       VLTRec :="U00VLTD".VLT1
//       BasePEW:=PEW2048
//       COn    :="U00ActD".Act1.Out
//       SpExt  :="U00PIDD".PID1.OVal

NETWORK
TITLE =special input's

//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U00SpID".SpI1
//       SpIBit:=E256.0

NETWORK
TITLE =counter

//      CALL  "Cnt"
//       UnitNo:=#UnitNo
//       CntRec:="U00CntD".Cnt1
//       Imp   :="U00SpID".SpI1.Sig
NETWORK
TITLE =message
//
//
// reserved 

NETWORK
TITLE =sequence organisation call

      SET   ; 
// assignment counter values

//       CALL  "C2S"
//       UnitNo:=#UnitNo
//       CntRec:="U00CntD".Cnt1
//       Enable:="OrgS1"
//       SFMRec:="U00SeqD".Seq.SFM[x]

// assignment analog values

//      L     "U00AnID".AnI1.Val
//      T     "U00SeqD".Seq.SFM[x].Val

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =mode assignment actuators + PID-controllers

      AN    M    122.2; 
      JC    MODE; 

      AN    M    120.1; 
//      =     "U00ActD".Act1.Auto


MODE: SET   ; 
NETWORK
TITLE =actuator's


//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U00ActD".Act1
//       Typ   :=1
//       FBa   :=E0.0
//       FBa2  :=E0.0
//       Out   :=A0.0

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1010
TITLE =U001: Wassertank 01
FAMILY : BOTEC_F1
NAME : U001A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1010.DBW    0; 
      T     #UnitNo; 
      L     DB1010.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T1 AnI 001 Inhalt Tank 1
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2013.LI_T1,
           ValPer                   := DB302.DBW   64);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2015.unv001,
           ValExt                   := DB2015.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2015.unv002,
           ValExt                   := DB2015.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2015.unv003,
           ValExt                   := DB2015.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T1 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.LS_LLL_T1,
           SpIBit                   := I     70.0);

// LS_HL_T1 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.LS_HL_T1,
           SpIBit                   := I     69.5);

// RM_NI_T1_VV SpI 004 Vacuumventil Tank 1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.RM_NI_T1_VV,
           SpIBit                   := I    186.5);

// LS_LL_T1 SpI 005 (als Leermeldung ausgelegt)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.LS_LL_T1,
           SpIBit                   := I     69.6);

// RM_NI_T1_K4_AUF SpI 006 Klappe vor Filter Tank 1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.RM_NI_T1_K4_AUF,
           SpIBit                   := I    186.3);

// RM_NI_T1_K4_ZU SpI 007 Klappe vor Filter Tank 1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.RM_NI_T1_K4_ZU,
           SpIBit                   := I    186.4);

// RM_NI_T1_K2 SpI 008 Handklappe Tank 1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.RM_NI_T1_K2,
           SpIBit                   := I     71.1);

// RM_NI_T1_K3 SpI 010 Handklappe Tank 1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.RM_NI_T1_K3,
           SpIBit                   := I     71.2);

// LABOR_FREIG_T1 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2011.LABOR_FREIG_T1,
           SpIBit                   := I    258.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2017.msg001,
           MsgBit                   := DB2017.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2017.msg002,
           MsgBit                   := DB2017.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T1_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I317.0
// Output address: Q317.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.0,
           Out                      := Q    317.0);

NETWORK
TITLE =T1_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I319.0
// Output address: Q319.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.0,
           Out                      := Q    319.0);

NETWORK
TITLE =T1_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I321.0
// Output address: Q321.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.0,
           Out                      := Q    321.0);

NETWORK
TITLE =T1_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I323.0
// Output address: Q323.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.0,
           Out                      := Q    323.0);

NETWORK
TITLE =T1_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I325.0
// Output address: Q325.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.0,
           Out                      := Q    325.0);

NETWORK
TITLE =T1_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I327.0
// Output address: Q327.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.0,
           Out                      := Q    327.0);

NETWORK
TITLE =T1_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I329.0
// Output address: Q329.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.0,
           Out                      := Q    329.0);

NETWORK
TITLE =T1_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I331.0
// Output address: Q331.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.0,
           Out                      := Q    331.0);

NETWORK
TITLE =T1_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I333.0
// Output address: Q333.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    333.0,
           Out                      := Q    333.0);

NETWORK
TITLE =T1_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I335.0
// Output address: Q335.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.T1_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.0,
           Out                      := Q    335.0);

NETWORK
TITLE =RV1_T1  RV1_T1
// Act 015
// Box           : VS1-BB
// Input address : I296.0
// Output address: Q296.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.RV1_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.0,
           Out                      := Q    296.0);

NETWORK
TITLE =B6F_T1  B6F_T1
// Act 016
// Box           : VS1-BB
// Input address : I296.4
// Output address: Q296.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.B6F_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.4,
           Out                      := Q    296.4);

NETWORK
TITLE =H6F_T1  H6F_T1
// Act 017
// Box           : VS1-BB
// Input address : I296.3
// Output address: Q296.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.H6F_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.3,
           Out                      := Q    296.3);

NETWORK
TITLE =J6F_T1  J6F_T1
// Act 018
// Box           : VS1-BB
// Input address : I296.5
// Output address: Q296.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.J6F_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.5,
           Out                      := Q    296.5);

NETWORK
TITLE =L6F_T1  L6F_T1
// Act 019
// Box           : VS1-BB
// Input address : I296.6
// Output address: Q296.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.L6F_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.6,
           Out                      := Q    296.6);

NETWORK
TITLE =D6_T1  D6_T1
// Act 020
// Box           : VS1-BB
// Input address : I297.0
// Output address: Q297.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.D6_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.0,
           Out                      := Q    297.0);

NETWORK
TITLE =B6_T1  B6_T1
// Act 021
// Box           : VS1-BB
// Input address : I296.7
// Output address: Q296.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.B6_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.7,
           Out                      := Q    296.7);

NETWORK
TITLE =A_T1  A_T1
// Act 022
// Box           : VS1-BB
// Input address : I296.1
// Output address: Q296.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.A_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.1,
           Out                      := Q    296.1);

NETWORK
TITLE =B_T1  B_T1
// Act 023
// Box           : VS1-BB
// Input address : I296.2
// Output address: Q296.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.B_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    296.2,
           Out                      := Q    296.2);

NETWORK
TITLE =CF_T1  
// Act 024
// Box           : Ventilinsel 1
// Input address : I16.1
// Output address: Q16.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.CF_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.1,
           Out                      := Q     16.1);

NETWORK
TITLE =RW5_T1  Ansteuerung Befllventil
// Act 026
// Box           : Ventilinsel 1
// Input address : I16.0
// Output address: Q16.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.RW5_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.0,
           Out                      := Q     16.0);

NETWORK
TITLE =RW6_T1  RW6_T1
// Act 027
// Box           : VS1-BB
// Input address : I297.1
// Output address: Q297.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.RW6_T1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.1,
           Out                      := Q    297.1);

NETWORK
TITLE =VR_T1  VR_T1
// Act 029
// Box           : VS1-BB
// Output address: Q297.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.VR_T1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    297.2);

NETWORK
TITLE =T1_V3  
// Act 030
// Box           : Ventilinsel 5
// Input address : I340.2
// Output address: Q340.2
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U001ActD".T1_V3
//       Typ   :=0
//       FBa   :=#xTmp
//       FBa2  :="T1_V3GSC"
//       Out   :="T1_V3O"

NETWORK
TITLE =ML_LABORFREIGABE_T1  
// Act 031
// Box           : LT-CIP
// Output address: Q258.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2010.ML_LABORFREIGABE_T1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1011
TITLE =U001: Water Tank 1
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1011.DBX 1357.7; 
      CC    FB  1019; // "U001Sim"
      A     DB1011.DBX   17.3; 
      =     DB1011.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1010.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1015; // U001Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1015.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1011.Seq.SFM[15],
           ValueOld                 := DB1011.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1013.DBX   43.1; 
      S     DB1013.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1020
TITLE =U002: Wassertank 02
FAMILY : BOTEC_F1
NAME : U002A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1020.DBW    0; 
      T     #UnitNo; 
      L     DB1020.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T2 AnI 001 Inhalt Tank 2
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2023.LI_T2,
           ValPer                   := DB302.DBW   66);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2025.unv001,
           ValExt                   := DB2025.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2025.unv002,
           ValExt                   := DB2025.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2025.unv003,
           ValExt                   := DB2025.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T2 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2021.LS_LLL_T2,
           SpIBit                   := I     71.7);

// LS_HL_T2 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2021.LS_HL_T2,
           SpIBit                   := I     69.7);

// LS_LL_T2 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2021.LS_LL_T2,
           SpIBit                   := I     70.1);

// RM_NI_T2_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2021.RM_NI_T2_K2,
           SpIBit                   := I     61.6);

// RM_NI_T2_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2021.RM_NI_T2_K3,
           SpIBit                   := I     61.7);

// LABOR_FREIG_T2 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2021.LABOR_FREIG_T2,
           SpIBit                   := I    258.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2027.msg001,
           MsgBit                   := DB2027.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2027.msg002,
           MsgBit                   := DB2027.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T2_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.7
// Output address: Q316.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.7,
           Out                      := Q    316.7);

NETWORK
TITLE =T2_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.7
// Output address: Q318.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.7,
           Out                      := Q    318.7);

NETWORK
TITLE =T2_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.7
// Output address: Q320.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.7,
           Out                      := Q    320.7);

NETWORK
TITLE =T2_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.7
// Output address: Q322.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.7,
           Out                      := Q    322.7);

NETWORK
TITLE =T2_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.7
// Output address: Q324.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.7,
           Out                      := Q    324.7);

NETWORK
TITLE =T2_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.7
// Output address: Q326.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.7,
           Out                      := Q    326.7);

NETWORK
TITLE =T2_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.7
// Output address: Q328.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.7,
           Out                      := Q    328.7);

NETWORK
TITLE =T2_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.7
// Output address: Q330.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.7,
           Out                      := Q    330.7);

NETWORK
TITLE =T2_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.7
// Output address: Q332.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.7,
           Out                      := Q    332.7);

NETWORK
TITLE =T2_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.7
// Output address: Q334.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.T2_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.7,
           Out                      := Q    334.7);

NETWORK
TITLE =RV1_T2  RV1_T2
// Act 015
// Box           : VS1-BB
// Input address : I297.3
// Output address: Q297.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.RV1_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.3,
           Out                      := Q    297.3);

NETWORK
TITLE =B6F_T2  B6F_T2
// Act 016
// Box           : VS1-BB
// Input address : I297.7
// Output address: Q297.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.B6F_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.7,
           Out                      := Q    297.7);

NETWORK
TITLE =H6F_T2  H6F_T2
// Act 017
// Box           : VS1-BB
// Input address : I297.6
// Output address: Q297.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.H6F_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.6,
           Out                      := Q    297.6);

NETWORK
TITLE =J6F_T2  J6F_T2
// Act 018
// Box           : VS1-BB
// Input address : I298.0
// Output address: Q298.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.J6F_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.0,
           Out                      := Q    298.0);

NETWORK
TITLE =L6F_T2  L6F_T2
// Act 019
// Box           : VS1-BB
// Input address : I298.1
// Output address: Q298.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.L6F_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.1,
           Out                      := Q    298.1);

NETWORK
TITLE =D6_T2  D6_T2
// Act 020
// Box           : VS1-BB
// Input address : I298.3
// Output address: Q298.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.D6_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.3,
           Out                      := Q    298.3);

NETWORK
TITLE =B6_T2  B6_T2
// Act 021
// Box           : VS1-BB
// Input address : I298.2
// Output address: Q298.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.B6_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.2,
           Out                      := Q    298.2);

NETWORK
TITLE =A_T2  A_T2
// Act 022
// Box           : VS1-BB
// Input address : I297.4
// Output address: Q297.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.A_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.4,
           Out                      := Q    297.4);

NETWORK
TITLE =B_T2  B_T2
// Act 023
// Box           : VS1-BB
// Input address : I297.5
// Output address: Q297.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.B_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    297.5,
           Out                      := Q    297.5);

NETWORK
TITLE =CF_T2  
// Act 024
// Box           : Ventilinsel 1
// Input address : I16.2
// Output address: Q16.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.CF_T2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.2,
           Out                      := Q     16.2);

NETWORK
TITLE =VR_T2  VR_T2
// Act 029
// Box           : VS1-BB
// Output address: Q298.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.VR_T2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    298.4);

NETWORK
TITLE =ML_LABORFREIGABE_T2  
// Act 031
// Box           : LT-CIP
// Output address: Q258.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2020.ML_LABORFREIGABE_T2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.1);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1021
TITLE =U002: Water Tank 2
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1021.DBX 1357.7; 
      CC    FB  1029; // "WT02Sim"
      A     DB1021.DBX   17.3; 
      =     DB1021.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1020.DBW    0; 
      T     #UnitNo; 


// communication ------------------------------------------------------------
      UC    FB  1025; // WT02Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1025.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1021.Seq.SFM[15],
           ValueOld                 := DB1021.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1023.DBX   43.1; 
      S     DB1023.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1030
TITLE =U003: Wassertank 03
FAMILY : BOTEC_F1
NAME : U003A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1030.DBW    0; 
      T     #UnitNo; 
      L     DB1030.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T3 AnI 001 Inhalt Tank 3
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2033.LI_T3,
           ValPer                   := DB302.DBW   68);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2035.unv001,
           ValExt                   := DB2035.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2035.unv002,
           ValExt                   := DB2035.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2035.unv003,
           ValExt                   := DB2035.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T3 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2031.LS_LLL_T3,
           SpIBit                   := I     60.1);

// LS_HL_T3 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2031.LS_HL_T3,
           SpIBit                   := I     70.2);

// LS_LL_T3 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2031.LS_LL_T3,
           SpIBit                   := I     60.0);

// RM_NI_T3_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2031.RM_NI_T3_K2,
           SpIBit                   := I     60.6);

// RM_NI_T3_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2031.RM_NI_T3_K3,
           SpIBit                   := I     69.0);

// LABOR_FREIG_T3 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2031.LABOR_FREIG_T3,
           SpIBit                   := I    258.2);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2037.msg001,
           MsgBit                   := DB2037.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2037.msg002,
           MsgBit                   := DB2037.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T3_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.6
// Output address: Q316.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.6,
           Out                      := Q    316.6);

NETWORK
TITLE =T3_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.6
// Output address: Q318.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.6,
           Out                      := Q    318.6);

NETWORK
TITLE =T3_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.6
// Output address: Q320.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.6,
           Out                      := Q    320.6);

NETWORK
TITLE =T3_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.6
// Output address: Q322.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.6,
           Out                      := Q    322.6);

NETWORK
TITLE =T3_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.6
// Output address: Q324.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.6,
           Out                      := Q    324.6);

NETWORK
TITLE =T3_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.6
// Output address: Q326.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.6,
           Out                      := Q    326.6);

NETWORK
TITLE =T3_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.6
// Output address: Q328.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.6,
           Out                      := Q    328.6);

NETWORK
TITLE =T3_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.6
// Output address: Q330.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.6,
           Out                      := Q    330.6);

NETWORK
TITLE =T3_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.6
// Output address: Q332.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.6,
           Out                      := Q    332.6);

NETWORK
TITLE =T3_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.6
// Output address: Q334.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.T3_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.6,
           Out                      := Q    334.6);

NETWORK
TITLE =RV1_T3  RV1_T3 Ventil CIP Vorlauf Tank 3
// Act 015
// Box           : VS1-BB
// Input address : I298.5
// Output address: Q298.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.RV1_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.5,
           Out                      := Q    298.5);

NETWORK
TITLE =B6F_T3  B6F_T3
// Act 016
// Box           : VS1-BB
// Input address : I299.1
// Output address: Q299.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.B6F_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.1,
           Out                      := Q    299.1);

NETWORK
TITLE =H6F_T3  H6F_T3
// Act 017
// Box           : VS1-BB
// Input address : I299.0
// Output address: Q299.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.H6F_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.0,
           Out                      := Q    299.0);

NETWORK
TITLE =J6F_T3  J6F_T3
// Act 018
// Box           : VS1-BB
// Input address : I299.2
// Output address: Q299.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.J6F_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.2,
           Out                      := Q    299.2);

NETWORK
TITLE =L6F_T3  L6F_T3
// Act 019
// Box           : VS1-BB
// Input address : I299.3
// Output address: Q299.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.L6F_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.3,
           Out                      := Q    299.3);

NETWORK
TITLE =D6_T3  D6_T3
// Act 020
// Box           : VS1-BB
// Input address : I299.5
// Output address: Q299.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.D6_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.5,
           Out                      := Q    299.5);

NETWORK
TITLE =B6_T3  B6_T3
// Act 021
// Box           : VS1-BB
// Input address : I299.4
// Output address: Q299.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.B6_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.4,
           Out                      := Q    299.4);

NETWORK
TITLE =A_T3  A_T3
// Act 022
// Box           : VS1-BB
// Input address : I298.6
// Output address: Q298.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.A_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.6,
           Out                      := Q    298.6);

NETWORK
TITLE =B_T3  B_T3
// Act 023
// Box           : VS1-BB
// Input address : I298.7
// Output address: Q298.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.B_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    298.7,
           Out                      := Q    298.7);

NETWORK
TITLE =CF_T3  
// Act 024
// Box           : Ventilinsel 1
// Input address : I16.3
// Output address: Q16.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.CF_T3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.3,
           Out                      := Q     16.3);

NETWORK
TITLE =VR_T3  VR_T3
// Act 029
// Box           : VS1-BB
// Output address: Q299.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.VR_T3,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    299.6);

NETWORK
TITLE =ML_LABORFREIGABE_T3  
// Act 031
// Box           : LT-CIP
// Output address: Q258.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2030.ML_LABORFREIGABE_T3,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.2);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1031
TITLE =U003: Water Tank 3
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1031.DBX 1357.7; 
      CC    FB  1039; // "WT03Sim"
      A     DB1031.DBX   17.3; 
      =     DB1031.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1030.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1035; // WT03Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1035.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1031.Seq.SFM[15],
           ValueOld                 := DB1031.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1033.DBX   43.1; 
      S     DB1033.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1040
TITLE =U004: Wassertank 04
FAMILY : BOTEC_F1
NAME : U004A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1040.DBW    0; 
      T     #UnitNo; 
      L     DB1040.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T4 AnI 001 Inhalt Tank 4
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2043.LI_T4,
           ValPer                   := DB302.DBW   70);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2045.unv001,
           ValExt                   := DB2045.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2045.unv002,
           ValExt                   := DB2045.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2045.unv003,
           ValExt                   := DB2045.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T4 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2041.LS_LLL_T4,
           SpIBit                   := I     67.4);

// LS_HL_T4 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2041.LS_HL_T4,
           SpIBit                   := I     67.2);

// LS_LL_T4 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2041.LS_LL_T4,
           SpIBit                   := I     67.3);

// RM_NI_T4_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2041.RM_NI_T4_K2,
           SpIBit                   := I     60.7);

// RM_NI_T4_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2041.RM_NI_T4_K3,
           SpIBit                   := I     69.1);

// LABOR_FREIG_T4 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2041.LABOR_FREIG_T4,
           SpIBit                   := I    258.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2047.msg001,
           MsgBit                   := DB2047.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2047.msg002,
           MsgBit                   := DB2047.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T4_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.5
// Output address: Q316.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.5,
           Out                      := Q    316.5);

NETWORK
TITLE =T4_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.5
// Output address: Q318.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.5,
           Out                      := Q    318.5);

NETWORK
TITLE =T4_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.5
// Output address: Q320.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.5,
           Out                      := Q    320.5);

NETWORK
TITLE =T4_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.5
// Output address: Q322.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.5,
           Out                      := Q    322.5);

NETWORK
TITLE =T4_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.5
// Output address: Q324.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.5,
           Out                      := Q    324.5);

NETWORK
TITLE =T4_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.5
// Output address: Q326.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.5,
           Out                      := Q    326.5);

NETWORK
TITLE =T4_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.5
// Output address: Q328.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.5,
           Out                      := Q    328.5);

NETWORK
TITLE =T4_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.5
// Output address: Q330.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.5,
           Out                      := Q    330.5);

NETWORK
TITLE =T4_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.5
// Output address: Q332.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.5,
           Out                      := Q    332.5);

NETWORK
TITLE =T4_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.5
// Output address: Q334.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.T4_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.5,
           Out                      := Q    334.5);

NETWORK
TITLE =RV1_T4  RV1_T4 Ventil CIP Vorlauf Tank 4
// Act 015
// Box           : VS1-BB
// Input address : I299.7
// Output address: Q299.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.RV1_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    299.7,
           Out                      := Q    299.7);

NETWORK
TITLE =B6F_T4  B6F_T4
// Act 016
// Box           : VS1-BB
// Input address : I300.3
// Output address: Q300.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.B6F_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.3,
           Out                      := Q    300.3);

NETWORK
TITLE =H6F_T4  H6F_T4
// Act 017
// Box           : VS1-BB
// Input address : I300.2
// Output address: Q300.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.H6F_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.2,
           Out                      := Q    300.2);

NETWORK
TITLE =J6F_T4  J6F_T4
// Act 018
// Box           : VS1-BB
// Input address : I300.4
// Output address: Q300.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.J6F_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.4,
           Out                      := Q    300.4);

NETWORK
TITLE =L6F_T4  L6F_T4
// Act 019
// Box           : VS1-BB
// Input address : I300.5
// Output address: Q300.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.L6F_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.5,
           Out                      := Q    300.5);

NETWORK
TITLE =D6_T4  D6_T4
// Act 020
// Box           : VS1-BB
// Input address : I300.7
// Output address: Q300.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.D6_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.7,
           Out                      := Q    300.7);

NETWORK
TITLE =B6_T4  B6_T4
// Act 021
// Box           : VS1-BB
// Input address : I300.6
// Output address: Q300.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.B6_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.6,
           Out                      := Q    300.6);

NETWORK
TITLE =A_T4  A_T4
// Act 022
// Box           : VS1-BB
// Input address : I300.0
// Output address: Q300.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.A_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.0,
           Out                      := Q    300.0);

NETWORK
TITLE =B_T4  B_T4
// Act 023
// Box           : VS1-BB
// Input address : I300.1
// Output address: Q300.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.B_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    300.1,
           Out                      := Q    300.1);

NETWORK
TITLE =CF_T4  
// Act 024
// Box           : Ventilinsel 1
// Input address : I16.4
// Output address: Q16.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.CF_T4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.4,
           Out                      := Q     16.4);

NETWORK
TITLE =VR_T4  VR_T4
// Act 029
// Box           : VS1-BB
// Output address: Q301.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.VR_T4,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    301.0);

NETWORK
TITLE =ML_LABORFREIGABE_T4  
// Act 031
// Box           : LT-CIP
// Output address: Q258.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2040.ML_LABORFREIGABE_T4,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.3);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1041
TITLE =U004: Water Tank 4
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1041.DBX 1357.7; 
      CC    FB  1049; // "WT04Sim"
      A     DB1041.DBX   17.3; 
      =     DB1041.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1040.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1045; // WT04Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1045.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1041.Seq.SFM[15],
           ValueOld                 := DB1041.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1043.DBX   43.1; 
      S     DB1043.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1050
TITLE =U005: Wassertank 05
FAMILY : BOTEC_F1
NAME : U005A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1050.DBW    0; 
      T     #UnitNo; 
      L     DB1050.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T5 AnI 001 Inhalt Tank 5
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2053.LI_T5,
           ValPer                   := DB302.DBW   72);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2055.unv001,
           ValExt                   := DB2055.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2055.unv002,
           ValExt                   := DB2055.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2055.unv003,
           ValExt                   := DB2055.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T5 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2051.LS_LLL_T5,
           SpIBit                   := I     67.7);

// LS_HL_T5 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2051.LS_HL_T5,
           SpIBit                   := I     67.5);

// LS_LL_T5 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2051.LS_LL_T5,
           SpIBit                   := I     67.6);

// T5_K4 SpI 006 RM Handklappe
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U005SpID".T5_K4
//       SpIBit:="T5_K4"

// RM_NI_T5_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2051.RM_NI_T5_K2,
           SpIBit                   := I     61.0);

// RM_NI_T5_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2051.RM_NI_T5_K3,
           SpIBit                   := I     69.2);

// LABOR_FREIG_T5 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2051.LABOR_FREIG_T5,
           SpIBit                   := I    258.4);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2057.msg001,
           MsgBit                   := DB2057.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2057.msg002,
           MsgBit                   := DB2057.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T5_BH  
// Act 002
// Box           : Ventilinsel 5
// Input address : I339.0
// Output address: Q339.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_BH,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.0,
           Out                      := Q    339.0);

NETWORK
TITLE =T5_KEG  
// Act 003
// Box           : Ventilinsel 5
// Input address : I339.3
// Output address: Q339.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_KEG,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.3,
           Out                      := Q    339.3);

NETWORK
TITLE =T5_SK  
// Act 004
// Box           : Ventilinsel 5
// Input address : I338.2
// Output address: Q338.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_SK,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    338.2,
           Out                      := Q    338.2);

NETWORK
TITLE =T5_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.4
// Output address: Q316.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.4,
           Out                      := Q    316.4);

NETWORK
TITLE =T5_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.4
// Output address: Q318.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.4,
           Out                      := Q    318.4);

NETWORK
TITLE =T5_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.4
// Output address: Q320.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.4,
           Out                      := Q    320.4);

NETWORK
TITLE =T5_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.4
// Output address: Q322.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.4,
           Out                      := Q    322.4);

NETWORK
TITLE =T5_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.4
// Output address: Q324.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.4,
           Out                      := Q    324.4);

NETWORK
TITLE =T5_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.4
// Output address: Q326.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.4,
           Out                      := Q    326.4);

NETWORK
TITLE =T5_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.4
// Output address: Q328.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.4,
           Out                      := Q    328.4);

NETWORK
TITLE =T5_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.4
// Output address: Q330.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.4,
           Out                      := Q    330.4);

NETWORK
TITLE =T5_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.4
// Output address: Q332.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.4,
           Out                      := Q    332.4);

NETWORK
TITLE =T5_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.4
// Output address: Q334.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.T5_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.4,
           Out                      := Q    334.4);

NETWORK
TITLE =RV1_T5  RV1_T5 Ventil CIP Vorlauf Tank 5
// Act 015
// Box           : VS1-BB
// Input address : I301.1
// Output address: Q301.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.RV1_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.1,
           Out                      := Q    301.1);

NETWORK
TITLE =B6F_T5  B6F_T5
// Act 016
// Box           : VS1-BB
// Input address : I301.5
// Output address: Q301.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.B6F_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.5,
           Out                      := Q    301.5);

NETWORK
TITLE =H6F_T5  H6F_T5
// Act 017
// Box           : VS1-BB
// Input address : I301.4
// Output address: Q301.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.H6F_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.4,
           Out                      := Q    301.4);

NETWORK
TITLE =J6F_T5  J6F_T5
// Act 018
// Box           : VS1-BB
// Input address : I301.6
// Output address: Q301.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.J6F_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.6,
           Out                      := Q    301.6);

NETWORK
TITLE =L6F_T5  L6F_T5
// Act 019
// Box           : VS1-BB
// Input address : I301.7
// Output address: Q301.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.L6F_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.7,
           Out                      := Q    301.7);

NETWORK
TITLE =D6_T5  D6_T5
// Act 020
// Box           : VS1-BB
// Input address : I302.1
// Output address: Q302.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.D6_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.1,
           Out                      := Q    302.1);

NETWORK
TITLE =B6_T5  B6_T5
// Act 021
// Box           : VS1-BB
// Input address : I302.0
// Output address: Q302.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.B6_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.0,
           Out                      := Q    302.0);

NETWORK
TITLE =A_T5  A_T5
// Act 022
// Box           : VS1-BB
// Input address : I301.2
// Output address: Q301.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.A_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.2,
           Out                      := Q    301.2);

NETWORK
TITLE =B_T5  B_T5
// Act 023
// Box           : VS1-BB
// Input address : I301.3
// Output address: Q301.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.B_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    301.3,
           Out                      := Q    301.3);

NETWORK
TITLE =CF_T5  
// Act 024
// Box           : Ventilinsel 1
// Input address : I16.6
// Output address: Q16.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.CF_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.6,
           Out                      := Q     16.6);

NETWORK
TITLE =RW5_T5  RW5_T5
// Act 026
// Box           : VS1-BB
// Input address : I302.2
// Output address: Q302.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.RW5_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.2,
           Out                      := Q    302.2);

NETWORK
TITLE =RW6_T5  RW6_T5
// Act 027
// Box           : VS1-BB
// Input address : I302.3
// Output address: Q302.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.RW6_T5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.3,
           Out                      := Q    302.3);

NETWORK
TITLE =VR_T5  VR_T5
// Act 029
// Box           : VS1-BB
// Output address: Q302.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.VR_T5,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    302.4);

NETWORK
TITLE =ML_LABORFREIGABE_T5  
// Act 031
// Box           : LT-CIP
// Output address: Q258.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2050.ML_LABORFREIGABE_T5,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1051
TITLE =U005: Water Tank 5
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1051.DBX 1357.7; 
      CC    FB  1059; // "WT05Sim"
      A     DB1051.DBX   17.3; 
      =     DB1051.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1050.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1055; // WT05Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1055.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1051.Seq.SFM[15],
           ValueOld                 := DB1051.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1053.DBX   43.1; 
      S     DB1053.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1060
TITLE =U006: Wassertank 06
FAMILY : BOTEC_F1
NAME : U006A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1060.DBW    0; 
      T     #UnitNo; 
      L     DB1060.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T6 AnI 001 Inhalt Tank 6
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2063.LI_T6,
           ValPer                   := DB302.DBW   74);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2065.unv001,
           ValExt                   := DB2065.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2065.unv002,
           ValExt                   := DB2065.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2065.unv003,
           ValExt                   := DB2065.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T6 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2061.LS_LLL_T6,
           SpIBit                   := I     70.5);

// LS_HL_T6 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2061.LS_HL_T6,
           SpIBit                   := I     70.3);

// LS_LL_T6 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2061.LS_LL_T6,
           SpIBit                   := I     70.4);

// RM_NI_T6_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2061.RM_NI_T6_K2,
           SpIBit                   := I     61.1);

// RM_NI_T6_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2061.RM_NI_T6_K3,
           SpIBit                   := I     69.3);

// LABOR_FREIG_T6 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2061.LABOR_FREIG_T6,
           SpIBit                   := I    258.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2067.msg001,
           MsgBit                   := DB2067.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2067.msg002,
           MsgBit                   := DB2067.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T6_FW  
// Act 001
// Box           : Ventilinsel 5
// Input address : I338.4
// Output address: Q338.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_FW,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    338.4,
           Out                      := Q    338.4);

NETWORK
TITLE =T6_KEG  
// Act 003
// Box           : Ventilinsel 5
// Input address : I339.2
// Output address: Q339.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_KEG,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.2,
           Out                      := Q    339.2);

NETWORK
TITLE =T6_SK  
// Act 004
// Box           : Ventilinsel 5
// Input address : I338.1
// Output address: Q338.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_SK,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    338.1,
           Out                      := Q    338.1);

NETWORK
TITLE =T6_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.3
// Output address: Q316.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.3,
           Out                      := Q    316.3);

NETWORK
TITLE =T6_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.3
// Output address: Q318.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.3,
           Out                      := Q    318.3);

NETWORK
TITLE =T6_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.3
// Output address: Q320.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.3,
           Out                      := Q    320.3);

NETWORK
TITLE =T6_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.3
// Output address: Q322.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.3,
           Out                      := Q    322.3);

NETWORK
TITLE =T6_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.3
// Output address: Q324.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.3,
           Out                      := Q    324.3);

NETWORK
TITLE =T6_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.3
// Output address: Q326.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.3,
           Out                      := Q    326.3);

NETWORK
TITLE =T6_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.3
// Output address: Q328.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.3,
           Out                      := Q    328.3);

NETWORK
TITLE =T6_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.3
// Output address: Q330.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.3,
           Out                      := Q    330.3);

NETWORK
TITLE =T6_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.3
// Output address: Q332.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.3,
           Out                      := Q    332.3);

NETWORK
TITLE =T6_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.3
// Output address: Q334.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.T6_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.3,
           Out                      := Q    334.3);

NETWORK
TITLE =RV1_T6  RV1_T3 Ventil CIP Vorlauf Tank 6
// Act 015
// Box           : VS1-BB
// Input address : I302.5
// Output address: Q302.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.RV1_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.5,
           Out                      := Q    302.5);

NETWORK
TITLE =B6F_T6  B6F_T6
// Act 016
// Box           : VS1-BB
// Input address : I303.1
// Output address: Q303.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.B6F_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.1,
           Out                      := Q    303.1);

NETWORK
TITLE =H6F_T6  H6F_T6
// Act 017
// Box           : VS1-BB
// Input address : I303.0
// Output address: Q303.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.H6F_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.0,
           Out                      := Q    303.0);

NETWORK
TITLE =J6F_T6  J6F_T6
// Act 018
// Box           : VS1-BB
// Input address : I303.2
// Output address: Q303.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.J6F_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.2,
           Out                      := Q    303.2);

NETWORK
TITLE =L6F_T6  L6F_T6
// Act 019
// Box           : VS1-BB
// Input address : I303.3
// Output address: Q303.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.L6F_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.3,
           Out                      := Q    303.3);

NETWORK
TITLE =D6_T6  D6_T6
// Act 020
// Box           : VS1-BB
// Input address : I303.5
// Output address: Q303.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.D6_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.5,
           Out                      := Q    303.5);

NETWORK
TITLE =B6_T6  B6_T6
// Act 021
// Box           : VS1-BB
// Input address : I303.4
// Output address: Q303.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.B6_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.4,
           Out                      := Q    303.4);

NETWORK
TITLE =A_T6  A_T6
// Act 022
// Box           : VS1-BB
// Input address : I302.6
// Output address: Q302.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.A_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.6,
           Out                      := Q    302.6);

NETWORK
TITLE =B_T6  B_T6
// Act 023
// Box           : VS1-BB
// Input address : I302.7
// Output address: Q302.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.B_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    302.7,
           Out                      := Q    302.7);

NETWORK
TITLE =CF_T6  
// Act 024
// Box           : Ventilinsel 1
// Input address : I16.7
// Output address: Q16.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.CF_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.7,
           Out                      := Q     16.7);

NETWORK
TITLE =RW5_T6  RW5_T6
// Act 026
// Box           : VS1-BB
// Input address : I303.6
// Output address: Q303.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.RW5_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.6,
           Out                      := Q    303.6);

NETWORK
TITLE =RW6_T6  RW6_T6
// Act 027
// Box           : VS1-BB
// Input address : I303.7
// Output address: Q303.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.RW6_T6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    303.7,
           Out                      := Q    303.7);

NETWORK
TITLE =VR_T6  VR_T6
// Act 029
// Box           : VS2-BB
// Output address: Q304.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.VR_T6,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    304.0);

NETWORK
TITLE =ML_LABORFREIGABE_T6  
// Act 031
// Box           : LT-CIP
// Output address: Q258.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2060.ML_LABORFREIGABE_T6,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.5);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1061
TITLE =U006: Water Tank 6
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1061.DBX 1357.7; 
      CC    FB  1069; // "WT06Sim"
      A     DB1061.DBX   17.3; 
      =     DB1061.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1060.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1065; // WT06Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1065.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1061.Seq.SFM[15],
           ValueOld                 := DB1061.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1063.DBX   43.1; 
      S     DB1063.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1070
TITLE =U007: Wassertank 07
FAMILY : BOTEC_F1
NAME : U007A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1070.DBW    0; 
      T     #UnitNo; 
      L     DB1070.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T7 AnI 001 Inhalt Tank 7
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2073.LI_T7,
           ValPer                   := DB302.DBW   76);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2075.unv001,
           ValExt                   := DB2075.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2075.unv002,
           ValExt                   := DB2075.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2075.unv003,
           ValExt                   := DB2075.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T7 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2071.LS_LLL_T7,
           SpIBit                   := I     71.0);

// LS_HL_T7 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2071.LS_HL_T7,
           SpIBit                   := I     70.6);

// LS_LL_T7 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2071.LS_LL_T7,
           SpIBit                   := I     70.7);

// RM_NI_T7_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2071.RM_NI_T7_K2,
           SpIBit                   := I     61.2);

// RM_NI_T7_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2071.RM_NI_T7_K3,
           SpIBit                   := I     69.4);

// LABOR_FREIG_T7 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2071.LABOR_FREIG_T7,
           SpIBit                   := I    258.6);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2077.msg001,
           MsgBit                   := DB2077.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2077.msg002,
           MsgBit                   := DB2077.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T7_FW  
// Act 001
// Box           : Ventilinsel 5
// Input address : I338.3
// Output address: Q338.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_FW,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    338.3,
           Out                      := Q    338.3);

NETWORK
TITLE =T7_KEG  
// Act 003
// Box           : Ventilinsel 5
// Input address : I339.1
// Output address: Q339.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_KEG,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.1,
           Out                      := Q    339.1);

NETWORK
TITLE =T7_SK  
// Act 004
// Box           : Ventilinsel 5
// Input address : I338.0
// Output address: Q338.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_SK,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    338.0,
           Out                      := Q    338.0);

NETWORK
TITLE =T7_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.2
// Output address: Q316.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.2,
           Out                      := Q    316.2);

NETWORK
TITLE =T7_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.2
// Output address: Q318.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.2,
           Out                      := Q    318.2);

NETWORK
TITLE =T7_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.2
// Output address: Q320.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.2,
           Out                      := Q    320.2);

NETWORK
TITLE =T7_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.2
// Output address: Q322.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.2,
           Out                      := Q    322.2);

NETWORK
TITLE =T7_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.2
// Output address: Q324.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.2,
           Out                      := Q    324.2);

NETWORK
TITLE =T7_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.2
// Output address: Q326.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.2,
           Out                      := Q    326.2);

NETWORK
TITLE =T7_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.2
// Output address: Q328.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.2,
           Out                      := Q    328.2);

NETWORK
TITLE =T7_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.2
// Output address: Q330.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.2,
           Out                      := Q    330.2);

NETWORK
TITLE =T7_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.2
// Output address: Q332.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.2,
           Out                      := Q    332.2);

NETWORK
TITLE =T7_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.2
// Output address: Q334.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.T7_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.2,
           Out                      := Q    334.2);

NETWORK
TITLE =RV1_T7  RV1_T7 Ventil CIP Vorlauf Tank 7
// Act 015
// Box           : VS2-BB
// Input address : I304.1
// Output address: Q304.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.RV1_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.1,
           Out                      := Q    304.1);

NETWORK
TITLE =B6F_T7  B6F_T7
// Act 016
// Box           : VS2-BB
// Input address : I304.5
// Output address: Q304.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.B6F_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.5,
           Out                      := Q    304.5);

NETWORK
TITLE =H6F_T7  H6F_T7
// Act 017
// Box           : VS2-BB
// Input address : I304.4
// Output address: Q304.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.H6F_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.4,
           Out                      := Q    304.4);

NETWORK
TITLE =J6F_T7  J6F_T7
// Act 018
// Box           : VS2-BB
// Input address : I304.6
// Output address: Q304.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.J6F_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.6,
           Out                      := Q    304.6);

NETWORK
TITLE =L6F_T7  L6F_T7
// Act 019
// Box           : VS2-BB
// Input address : I304.7
// Output address: Q304.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.L6F_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.7,
           Out                      := Q    304.7);

NETWORK
TITLE =D6_T7  D6_T7
// Act 020
// Box           : VS2-BB
// Input address : I305.1
// Output address: Q305.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.D6_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.1,
           Out                      := Q    305.1);

NETWORK
TITLE =B6_T7  B6_T7
// Act 021
// Box           : VS2-BB
// Input address : I305.0
// Output address: Q305.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.B6_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.0,
           Out                      := Q    305.0);

NETWORK
TITLE =A_T7  A_T7
// Act 022
// Box           : VS2-BB
// Input address : I304.2
// Output address: Q304.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.A_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.2,
           Out                      := Q    304.2);

NETWORK
TITLE =B_T7  B_T7
// Act 023
// Box           : VS2-BB
// Input address : I304.3
// Output address: Q304.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.B_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    304.3,
           Out                      := Q    304.3);

NETWORK
TITLE =CF_T7  
// Act 024
// Box           : Ventilinsel 1
// Input address : I17.0
// Output address: Q17.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.CF_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     17.0,
           Out                      := Q     17.0);

NETWORK
TITLE =RW5_T7  RW5_T7
// Act 026
// Box           : VS2-BB
// Input address : I305.2
// Output address: Q305.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.RW5_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.2,
           Out                      := Q    305.2);

NETWORK
TITLE =RW6_T7  RW6_T7
// Act 027
// Box           : VS2-BB
// Input address : I305.3
// Output address: Q305.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.RW6_T7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.3,
           Out                      := Q    305.3);

NETWORK
TITLE =VR_T7  VR_T7
// Act 029
// Box           : VS2-BB
// Output address: Q305.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.VR_T7,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    305.4);

NETWORK
TITLE =ML_LABORFREIGABE_T7  
// Act 031
// Box           : LT-CIP
// Output address: Q258.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2070.ML_LABORFREIGABE_T7,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    258.6);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1071
TITLE =U007: Water Tank 7
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1071.DBX 1357.7; 
      CC    FB  1079; // "WT07Sim"
      A     DB1071.DBX   17.3; 
      =     DB1071.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1070.DBW    0; 
      T     #UnitNo; 


// communication ------------------------------------------------------------
      UC    FB  1075; // WT07Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1075.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1071.Seq.SFM[15],
           ValueOld                 := DB1071.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1073.DBX   43.1; 
      S     DB1073.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1080
TITLE =U008: Wassertank 08
FAMILY : BOTEC_F1
NAME : U008A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1080.DBW    0; 
      T     #UnitNo; 
      L     DB1080.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T8 AnI 001 Inhalt Tank 8
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2083.LI_T8,
           ValPer                   := DB302.DBW   78);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2085.unv001,
           ValExt                   := DB2085.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2085.unv002,
           ValExt                   := DB2085.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2085.unv003,
           ValExt                   := DB2085.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T8 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.LS_LLL_T8,
           SpIBit                   := I    184.7);

// LS_HL_T8 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.LS_HL_T8,
           SpIBit                   := I    184.5);

// RM_NI_T8_ML SpI 003 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.RM_NI_T8_ML,
           SpIBit                   := I    184.4);

// RM_NI_T8_VV SpI 004 RM Vacuumventil Tank 8 ZU=1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.RM_NI_T8_VV,
           SpIBit                   := I    184.6);

// LS_LL_T8 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.LS_LL_T8,
           SpIBit                   := I    185.7);

// RM_NI_T8_K4_AUF SpI 006 RM Klappe vor Filter Tank 8 AUF=1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.RM_NI_T8_K4_AUF,
           SpIBit                   := I    186.1);

// RM_NI_T8_K4_ZU SpI 007 RM Klappe vor Filter Tank 8 ZU=1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.RM_NI_T8_K4_ZU,
           SpIBit                   := I    184.3);

// RM_NI_T8_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.RM_NI_T8_K2,
           SpIBit                   := I    184.1);

// RM_NI_T8_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.RM_NI_T8_K3,
           SpIBit                   := I    184.2);

// LABOR_FREIG_T8 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2081.LABOR_FREIG_T8,
           SpIBit                   := I    259.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2087.msg001,
           MsgBit                   := DB2087.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2087.msg002,
           MsgBit                   := DB2087.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T8_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.1
// Output address: Q316.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.1,
           Out                      := Q    316.1);

NETWORK
TITLE =T8_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.1
// Output address: Q318.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.1,
           Out                      := Q    318.1);

NETWORK
TITLE =T8_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.1
// Output address: Q320.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.1,
           Out                      := Q    320.1);

NETWORK
TITLE =T8_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.1
// Output address: Q322.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.1,
           Out                      := Q    322.1);

NETWORK
TITLE =T8_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.1
// Output address: Q324.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.1,
           Out                      := Q    324.1);

NETWORK
TITLE =T8_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.1
// Output address: Q326.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.1,
           Out                      := Q    326.1);

NETWORK
TITLE =T8_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.1
// Output address: Q328.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.1,
           Out                      := Q    328.1);

NETWORK
TITLE =T8_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.1
// Output address: Q330.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.1,
           Out                      := Q    330.1);

NETWORK
TITLE =T8_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.1
// Output address: Q332.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.1,
           Out                      := Q    332.1);

NETWORK
TITLE =T8_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.1
// Output address: Q334.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.T8_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.1,
           Out                      := Q    334.1);

NETWORK
TITLE =RV1_T8  RV1_T8
// Act 015
// Box           : VS2-BB
// Input address : I305.5
// Output address: Q305.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.RV1_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.5,
           Out                      := Q    305.5);

NETWORK
TITLE =B6F_T8  B6F_T8
// Act 016
// Box           : VS2-BB
// Input address : I306.1
// Output address: Q306.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.B6F_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.1,
           Out                      := Q    306.1);

NETWORK
TITLE =H6F_T8  H6F_T8
// Act 017
// Box           : VS2-BB
// Input address : I306.0
// Output address: Q306.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.H6F_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.0,
           Out                      := Q    306.0);

NETWORK
TITLE =J6F_T8  J6F_T8
// Act 018
// Box           : VS2-BB
// Input address : I306.2
// Output address: Q306.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.J6F_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.2,
           Out                      := Q    306.2);

NETWORK
TITLE =L6F_T8  L6F_T8
// Act 019
// Box           : VS2-BB
// Input address : I306.3
// Output address: Q306.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.L6F_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.3,
           Out                      := Q    306.3);

NETWORK
TITLE =D6_T8  D6_T8
// Act 020
// Box           : VS2-BB
// Input address : I306.5
// Output address: Q306.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.D6_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.5,
           Out                      := Q    306.5);

NETWORK
TITLE =B6_T8  B6_T8
// Act 021
// Box           : VS2-BB
// Input address : I306.4
// Output address: Q306.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.B6_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.4,
           Out                      := Q    306.4);

NETWORK
TITLE =A_T8  A_T8
// Act 022
// Box           : VS2-BB
// Input address : I305.6
// Output address: Q305.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.A_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.6,
           Out                      := Q    305.6);

NETWORK
TITLE =B_T8  B_T8
// Act 023
// Box           : VS2-BB
// Input address : I305.7
// Output address: Q305.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.B_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    305.7,
           Out                      := Q    305.7);

NETWORK
TITLE =CF_T8  
// Act 024
// Box           : Ventilinsel 1
// Input address : I17.1
// Output address: Q17.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.CF_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     17.1,
           Out                      := Q     17.1);

NETWORK
TITLE =C_T8  
// Act 025
// Box           : VS2-BB
// Input address : I311.2
// Output address: Q311.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.C_T8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    311.2,
           Out                      := Q    311.2);

NETWORK
TITLE =VR_T8  VR_T8
// Act 029
// Box           : VS2-BB
// Output address: Q306.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.VR_T8,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    306.6);

NETWORK
TITLE =ML_LABORFREIGABE_T8  
// Act 031
// Box           : LT-CIP
// Output address: Q259.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2080.ML_LABORFREIGABE_T8,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    259.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1081
TITLE =U008: Water Tank 8
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1081.DBX 1357.7; 
      CC    FB  1089; // "WT08Sim"
      A     DB1081.DBX   17.3; 
      =     DB1081.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1080.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1085; // WT08Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1085.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1081.Seq.SFM[15],
           ValueOld                 := DB1081.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1083.DBX   43.1; 
      S     DB1083.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1090
TITLE =U009: Wassertank 09
FAMILY : BOTEC_F1
NAME : U009A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1090.DBW    0; 
      T     #UnitNo; 
      L     DB1090.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T9 AnI 001 Inhalt Tank 9
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2093.LI_T9,
           ValPer                   := DB302.DBW   80);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2095.unv001,
           ValExt                   := DB2095.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2095.unv002,
           ValExt                   := DB2095.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2095.unv003,
           ValExt                   := DB2095.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T9 SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.LS_LLL_T9,
           SpIBit                   := I    185.6);

// LS_HL_T9 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.LS_HL_T9,
           SpIBit                   := I    185.4);

// RM_NI_T9_ML SpI 003 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.RM_NI_T9_ML,
           SpIBit                   := I    185.3);

// RM_NI_T9_VV SpI 004 RM Vacuumventil Tank 9 ZU=1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.RM_NI_T9_VV,
           SpIBit                   := I    185.5);

// LS_LL_T9 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.LS_LL_T9,
           SpIBit                   := I    186.0);

// RM_NI_T9_K4_AUF SpI 006 RM Klappe vor Filter Tank 9 AUF=1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.RM_NI_T9_K4_AUF,
           SpIBit                   := I    186.2);

// RM_NI_T9_K4_ZU SpI 007 RM Klappe vor Filter Tank 9 ZU=1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.RM_NI_T9_K4_ZU,
           SpIBit                   := I    185.2);

// RM_NI_T9_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.RM_NI_T9_K2,
           SpIBit                   := I    185.0);

// RM_NI_T9_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.RM_NI_T9_K3,
           SpIBit                   := I    185.1);

// LABOR_FREIG_T9 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2091.LABOR_FREIG_T9,
           SpIBit                   := I    259.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2097.msg001,
           MsgBit                   := DB2097.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2097.msg002,
           MsgBit                   := DB2097.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T9_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I316.0
// Output address: Q316.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    316.0,
           Out                      := Q    316.0);

NETWORK
TITLE =T9_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I318.0
// Output address: Q318.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    318.0,
           Out                      := Q    318.0);

NETWORK
TITLE =T9_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I320.0
// Output address: Q320.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    320.0,
           Out                      := Q    320.0);

NETWORK
TITLE =T9_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I322.0
// Output address: Q322.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    322.0,
           Out                      := Q    322.0);

NETWORK
TITLE =T9_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I324.0
// Output address: Q324.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    324.0,
           Out                      := Q    324.0);

NETWORK
TITLE =T9_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I326.0
// Output address: Q326.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    326.0,
           Out                      := Q    326.0);

NETWORK
TITLE =T9_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I328.0
// Output address: Q328.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    328.0,
           Out                      := Q    328.0);

NETWORK
TITLE =T9_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I330.0
// Output address: Q330.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    330.0,
           Out                      := Q    330.0);

NETWORK
TITLE =T9_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I332.0
// Output address: Q332.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    332.0,
           Out                      := Q    332.0);

NETWORK
TITLE =T9_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I334.0
// Output address: Q334.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.T9_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    334.0,
           Out                      := Q    334.0);

NETWORK
TITLE =RV1_T9  RV1_T9
// Act 015
// Box           : VS2-BB
// Input address : I306.7
// Output address: Q306.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.RV1_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    306.7,
           Out                      := Q    306.7);

NETWORK
TITLE =B6F_T9  B6F_T9
// Act 016
// Box           : VS2-BB
// Input address : I307.3
// Output address: Q307.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.B6F_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.3,
           Out                      := Q    307.3);

NETWORK
TITLE =H6F_T9  H6F_T9
// Act 017
// Box           : VS2-BB
// Input address : I307.2
// Output address: Q307.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.H6F_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.2,
           Out                      := Q    307.2);

NETWORK
TITLE =J6F_T9  J6F_T9
// Act 018
// Box           : VS2-BB
// Input address : I307.4
// Output address: Q307.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.J6F_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.4,
           Out                      := Q    307.4);

NETWORK
TITLE =L6F_T9  L6F_T9
// Act 019
// Box           : VS2-BB
// Input address : I307.5
// Output address: Q307.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.L6F_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.5,
           Out                      := Q    307.5);

NETWORK
TITLE =D6_T9  D6_T9
// Act 020
// Box           : VS2-BB
// Input address : I307.7
// Output address: Q307.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.D6_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.7,
           Out                      := Q    307.7);

NETWORK
TITLE =B6_T9  B6_T9
// Act 021
// Box           : VS2-BB
// Input address : I307.6
// Output address: Q307.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.B6_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.6,
           Out                      := Q    307.6);

NETWORK
TITLE =A_T9  A_T9
// Act 022
// Box           : VS2-BB
// Input address : I307.0
// Output address: Q307.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.A_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.0,
           Out                      := Q    307.0);

NETWORK
TITLE =B_T9  B_T9
// Act 023
// Box           : VS2-BB
// Input address : I307.1
// Output address: Q307.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.B_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    307.1,
           Out                      := Q    307.1);

NETWORK
TITLE =CF_T9  
// Act 024
// Box           : Ventilinsel 1
// Input address : I17.2
// Output address: Q17.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.CF_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     17.2,
           Out                      := Q     17.2);

NETWORK
TITLE =C_T9  
// Act 025
// Box           : VS2-BB
// Input address : I311.3
// Output address: Q311.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.C_T9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    311.3,
           Out                      := Q    311.3);

NETWORK
TITLE =VR_T9  VR_T9
// Act 029
// Box           : VS2-BB
// Output address: Q308.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.VR_T9,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    308.0);

NETWORK
TITLE =ML_LABORFREIGABE_T9  
// Act 031
// Box           : LT-CIP
// Output address: Q259.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2090.ML_LABORFREIGABE_T9,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    259.1);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1091
TITLE =U009: Water Tank 9
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1091.DBX 1357.7; 
      CC    FB  1099; // "WT09Sim"
      A     DB1091.DBX   17.3; 
      =     DB1091.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1090.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1095; // WT09Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1095.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1091.Seq.SFM[15],
           ValueOld                 := DB1091.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1093.DBX   43.1; 
      S     DB1093.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1100
TITLE =U010: Wassertank 10
FAMILY : BOTEC_F1
NAME : U010A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1100.DBW    0; 
      T     #UnitNo; 
      L     DB1100.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T10 AnI 001 Niveau Tank 10
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2103.LI_T10,
           ValPer                   := DB302.DBW   82);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2105.unv001,
           ValExt                   := DB2105.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2105.unv002,
           ValExt                   := DB2105.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2105.unv003,
           ValExt                   := DB2105.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T10 SpI 001 LS- Tank 10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.LS_LLL_T10,
           SpIBit                   := I     51.1);

// LS_HL_T10 SpI 002 LS+ Tank 10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.LS_HL_T10,
           SpIBit                   := I     50.7);

// GOA_T10_ML SpI 003 Mannloch Tank 10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.GOA_T10_ML,
           SpIBit                   := I     50.6);

// GOA_VV_T10 SpI 004 Vacuumventil Tank 10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.GOA_VV_T10,
           SpIBit                   := I     50.5);

// LS_LL_T10 SpI 005 LS/ Tank 10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.LS_LL_T10,
           SpIBit                   := I     51.0);

// RM_NI_T10_K4_AUF SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.RM_NI_T10_K4_AUF,
           SpIBit                   := I     50.3);

// RM_NI_T10_K4_ZU SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.RM_NI_T10_K4_ZU,
           SpIBit                   := I     50.4);

// RM_NI_T10_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.RM_NI_T10_K2,
           SpIBit                   := I     50.1);

// RM_NI_T10_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.RM_NI_T10_K3,
           SpIBit                   := I     50.2);

// LABOR_FREIG_T10 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2101.LABOR_FREIG_T10,
           SpIBit                   := I    259.2);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2107.msg001,
           MsgBit                   := DB2107.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2107.msg002,
           MsgBit                   := DB2107.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T10_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I317.1
// Output address: Q317.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.1,
           Out                      := Q    317.1);

NETWORK
TITLE =T10_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I319.1
// Output address: Q319.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.1,
           Out                      := Q    319.1);

NETWORK
TITLE =T10_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I321.1
// Output address: Q321.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.1,
           Out                      := Q    321.1);

NETWORK
TITLE =T10_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I323.1
// Output address: Q323.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.1,
           Out                      := Q    323.1);

NETWORK
TITLE =T10_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I325.1
// Output address: Q325.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.1,
           Out                      := Q    325.1);

NETWORK
TITLE =T10_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I327.1
// Output address: Q327.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.1,
           Out                      := Q    327.1);

NETWORK
TITLE =T10_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I329.1
// Output address: Q329.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.1,
           Out                      := Q    329.1);

NETWORK
TITLE =T10_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I331.1
// Output address: Q331.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.1,
           Out                      := Q    331.1);

NETWORK
TITLE =T10_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I333.1
// Output address: Q333.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    333.1,
           Out                      := Q    333.1);

NETWORK
TITLE =T10_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I335.1
// Output address: Q335.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.T10_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.1,
           Out                      := Q    335.1);

NETWORK
TITLE =RV1_T10  RV1_T10
// Act 015
// Box           : VS2-BB
// Input address : I308.1
// Output address: Q308.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.RV1_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.1,
           Out                      := Q    308.1);

NETWORK
TITLE =B6F_T10  B6F_T10
// Act 016
// Box           : VS2-BB
// Input address : I308.5
// Output address: Q308.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.B6F_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.5,
           Out                      := Q    308.5);

NETWORK
TITLE =H6F_T10  H6F_T10
// Act 017
// Box           : VS2-BB
// Input address : I308.4
// Output address: Q308.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.H6F_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.4,
           Out                      := Q    308.4);

NETWORK
TITLE =J6F_T10  J6F_T10
// Act 018
// Box           : VS2-BB
// Input address : I308.6
// Output address: Q308.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.J6F_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.6,
           Out                      := Q    308.6);

NETWORK
TITLE =L6F_T10  L6F_T10
// Act 019
// Box           : VS2-BB
// Input address : I308.7
// Output address: Q308.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.L6F_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.7,
           Out                      := Q    308.7);

NETWORK
TITLE =D6_T10  D6_T10
// Act 020
// Box           : VS2-BB
// Input address : I309.1
// Output address: Q309.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.D6_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.1,
           Out                      := Q    309.1);

NETWORK
TITLE =B6_T10  B6_T10
// Act 021
// Box           : VS2-BB
// Input address : I309.0
// Output address: Q309.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.B6_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.0,
           Out                      := Q    309.0);

NETWORK
TITLE =A_T10  A_T10
// Act 022
// Box           : VS2-BB
// Input address : I308.2
// Output address: Q308.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.A_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.2,
           Out                      := Q    308.2);

NETWORK
TITLE =B_T10  B_T10
// Act 023
// Box           : VS2-BB
// Input address : I308.3
// Output address: Q308.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.B_T10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    308.3,
           Out                      := Q    308.3);

NETWORK
TITLE =CF_T10  
// Act 024
// Box           : Ventilinsel 1
// Input address : I17.3
// Output address: Q17.3
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U010ActD".CF_T10
//       Typ   :=0
//       FBa   :=#xTmp
//       FBa2  :="CF_T10GSC"
//       Out   :="CF_T10O"

NETWORK
TITLE =VVT10   Vacuumventil Tank 10
// Act 028
// Box           : 
// Input address : I50.5
// Output address: #DummyBool
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.VVT10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     50.5,
           Out                      := #DummyBool);

NETWORK
TITLE =VR_T10  VR_T10
// Act 029
// Box           : VS2-BB
// Output address: Q309.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.VR_T10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    309.2);

NETWORK
TITLE =ML_LABORFREIGABE_T10  
// Act 031
// Box           : LT-CIP
// Output address: Q259.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2100.ML_LABORFREIGABE_T10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    259.2);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1101
TITLE =U010: Water Tank 10
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1101.DBX 1357.7; 
      CC    FB  1109; // "WT10Sim"
      A     DB1101.DBX   17.3; 
      =     DB1101.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1100.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1105; // WT10Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1105.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1101.Seq.SFM[15],
           ValueOld                 := DB1101.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1103.DBX   43.1; 
      S     DB1103.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1110
TITLE =U011: Wassertank 11
FAMILY : BOTEC_F1
NAME : U011A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1110.DBW    0; 
      T     #UnitNo; 
      L     DB1110.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T11 AnI 001 Niveau Tank 11
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2113.LI_T11,
           ValPer                   := DB302.DBW   84);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2115.unv001,
           ValExt                   := DB2115.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2115.unv002,
           ValExt                   := DB2115.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2115.unv003,
           ValExt                   := DB2115.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T11 SpI 001 LS- Tank 11
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.LS_LLL_T11,
           SpIBit                   := I    187.6);

// LS_HL_T11 SpI 002 LS+ Tank 11
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.LS_HL_T11,
           SpIBit                   := I    187.4);

// GOA_T11_ML SpI 003 Mannloch Tank 11
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.GOA_T11_ML,
           SpIBit                   := I    187.3);

// GOA_T11_VV SpI 004 Vacuumventil Tank 11
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.GOA_T11_VV,
           SpIBit                   := I    187.2);

// LS_LL_T11 SpI 005 LS/ Tank 11
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.LS_LL_T11,
           SpIBit                   := I    187.5);

// RM_NI_T11_K4_AUF SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.RM_NI_T11_K4_AUF,
           SpIBit                   := I    187.0);

// RM_NI_T11_K4_ZU SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.RM_NI_T11_K4_ZU,
           SpIBit                   := I    187.1);

// RM_NI_T11_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.RM_NI_T11_K2,
           SpIBit                   := I    186.6);

// RM_NI_T11_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.RM_NI_T11_K3,
           SpIBit                   := I    186.7);

// LABOR_FREIG_T11 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2111.LABOR_FREIG_T11,
           SpIBit                   := I    259.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2117.msg001,
           MsgBit                   := DB2117.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2117.msg002,
           MsgBit                   := DB2117.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T11_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I317.2
// Output address: Q317.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.2,
           Out                      := Q    317.2);

NETWORK
TITLE =T11_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I319.2
// Output address: Q319.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.2,
           Out                      := Q    319.2);

NETWORK
TITLE =T11_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I321.2
// Output address: Q321.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.2,
           Out                      := Q    321.2);

NETWORK
TITLE =T11_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I323.2
// Output address: Q323.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.2,
           Out                      := Q    323.2);

NETWORK
TITLE =T11_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I325.2
// Output address: Q325.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.2,
           Out                      := Q    325.2);

NETWORK
TITLE =T11_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I327.2
// Output address: Q327.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.2,
           Out                      := Q    327.2);

NETWORK
TITLE =T11_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I329.2
// Output address: Q329.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.2,
           Out                      := Q    329.2);

NETWORK
TITLE =T11_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I331.2
// Output address: Q331.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.2,
           Out                      := Q    331.2);

NETWORK
TITLE =T11_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I333.2
// Output address: Q333.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    333.2,
           Out                      := Q    333.2);

NETWORK
TITLE =T11_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I335.2
// Output address: Q335.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.T11_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.2,
           Out                      := Q    335.2);

NETWORK
TITLE =RV1_T11  
// Act 015
// Box           : Ventilinsel 1
// Input address : I8.0
// Output address: Q8.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.RV1_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.0,
           Out                      := Q      8.0);

NETWORK
TITLE =B6F_T11  
// Act 016
// Box           : Ventilinsel 1
// Input address : I8.1
// Output address: Q8.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.B6F_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.1,
           Out                      := Q      8.1);

NETWORK
TITLE =H6F_T11  
// Act 017
// Box           : Ventilinsel 1
// Input address : I8.2
// Output address: Q8.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.H6F_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.2,
           Out                      := Q      8.2);

NETWORK
TITLE =J6F_T11  
// Act 018
// Box           : Ventilinsel 1
// Input address : I8.3
// Output address: Q8.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.J6F_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.3,
           Out                      := Q      8.3);

NETWORK
TITLE =L6F_T11  
// Act 019
// Box           : Ventilinsel 1
// Input address : I8.4
// Output address: Q8.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.L6F_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.4,
           Out                      := Q      8.4);

NETWORK
TITLE =D6_T11  
// Act 020
// Box           : Ventilinsel 1
// Input address : I8.5
// Output address: Q8.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.D6_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.5,
           Out                      := Q      8.5);

NETWORK
TITLE =B6_T11  
// Act 021
// Box           : Ventilinsel 1
// Input address : I8.6
// Output address: Q8.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.B6_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.6,
           Out                      := Q      8.6);

NETWORK
TITLE =A_T11  
// Act 022
// Box           : Ventilinsel 1
// Input address : I8.7
// Output address: Q8.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.A_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      8.7,
           Out                      := Q      8.7);

NETWORK
TITLE =B_T11  
// Act 023
// Box           : Ventilinsel 1
// Input address : I9.0
// Output address: Q9.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.B_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.0,
           Out                      := Q      9.0);

NETWORK
TITLE =CF_T11  
// Act 024
// Box           : Ventilinsel 1
// Input address : I17.4
// Output address: Q17.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.CF_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     17.4,
           Out                      := Q     17.4);

NETWORK
TITLE =C_T11  
// Act 025
// Box           : VS2-BB
// Input address : I311.4
// Output address: Q311.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.C_T11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    311.4,
           Out                      := Q    311.4);

NETWORK
TITLE =VVT11  Vacuumventil Tank 11
// Act 028
// Box           : VST1-9
// Output address: Q160.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.VVT11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    160.0);

NETWORK
TITLE =VR_T11  
// Act 029
// Box           : Ventilinsel 1
// Output address: Q9.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.VR_T11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q      9.1);

NETWORK
TITLE =ML_LABORFREIGABE_T11  
// Act 031
// Box           : LT-CIP
// Output address: Q259.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2110.ML_LABORFREIGABE_T11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    259.3);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1111
TITLE =U011: Water Tank 11
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1111.DBX 1357.7; 
      CC    FB  1119; // "WT11Sim"
      A     DB1111.DBX   17.3; 
      =     DB1111.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1110.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1115; // WT11Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1115.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1111.Seq.SFM[15],
           ValueOld                 := DB1111.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1113.DBX   43.1; 
      S     DB1113.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1120
TITLE =U012: Wassertank 12
FAMILY : BOTEC_F1
NAME : U012A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1120.DBW    0; 
      T     #UnitNo; 
      L     DB1120.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T12 AnI 001 Niveau Tank 12
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2123.LI_T12,
           ValPer                   := DB302.DBW   86);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2125.unv001,
           ValExt                   := DB2125.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2125.unv002,
           ValExt                   := DB2125.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2125.unv003,
           ValExt                   := DB2125.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T12 SpI 001 LS- Tank 12
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.LS_LLL_T12,
           SpIBit                   := I     48.7);

// LS_HL_T12 SpI 002 LS+ Tank 12
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.LS_HL_T12,
           SpIBit                   := I     48.5);

// GOA_T12_ML SpI 003 Mannloch Tank 12
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.GOA_T12_ML,
           SpIBit                   := I     48.4);

// GOA_T12_VV SpI 004 Vacuumventil Tank 12
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.GOA_T12_VV,
           SpIBit                   := I     48.3);

// LS_LL_T12 SpI 005 LS/ Tank 12
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.LS_LL_T12,
           SpIBit                   := I     48.6);

// RM_NI_T12_K4_AUF SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.RM_NI_T12_K4_AUF,
           SpIBit                   := I     48.1);

// RM_NI_T12_K4_ZU SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.RM_NI_T12_K4_ZU,
           SpIBit                   := I     48.2);

// RM_NI_T12_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.RM_NI_T12_K2,
           SpIBit                   := I    187.7);

// RM_NI_T12_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.RM_NI_T12_K3,
           SpIBit                   := I     48.0);

// LABOR_FREIG_T12 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2121.LABOR_FREIG_T12,
           SpIBit                   := I    259.4);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2127.msg001,
           MsgBit                   := DB2127.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2127.msg002,
           MsgBit                   := DB2127.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T12_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I317.3
// Output address: Q317.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.3,
           Out                      := Q    317.3);

NETWORK
TITLE =T12_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I319.3
// Output address: Q319.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.3,
           Out                      := Q    319.3);

NETWORK
TITLE =T12_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I321.3
// Output address: Q321.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.3,
           Out                      := Q    321.3);

NETWORK
TITLE =T12_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I323.3
// Output address: Q323.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.3,
           Out                      := Q    323.3);

NETWORK
TITLE =T12_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I325.3
// Output address: Q325.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.3,
           Out                      := Q    325.3);

NETWORK
TITLE =T12_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I327.3
// Output address: Q327.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.3,
           Out                      := Q    327.3);

NETWORK
TITLE =T12_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I329.3
// Output address: Q329.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.3,
           Out                      := Q    329.3);

NETWORK
TITLE =T12_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I331.3
// Output address: Q331.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.3,
           Out                      := Q    331.3);

NETWORK
TITLE =T12_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I333.3
// Output address: Q333.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    333.3,
           Out                      := Q    333.3);

NETWORK
TITLE =T12_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I335.3
// Output address: Q335.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.T12_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.3,
           Out                      := Q    335.3);

NETWORK
TITLE =RV1_T12  
// Act 015
// Box           : Ventilinsel 1
// Input address : I9.2
// Output address: Q9.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.RV1_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.2,
           Out                      := Q      9.2);

NETWORK
TITLE =B6F_T12  
// Act 016
// Box           : Ventilinsel 1
// Input address : I9.3
// Output address: Q9.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.B6F_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.3,
           Out                      := Q      9.3);

NETWORK
TITLE =H6F_T12  
// Act 017
// Box           : Ventilinsel 1
// Input address : I9.4
// Output address: Q9.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.H6F_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.4,
           Out                      := Q      9.4);

NETWORK
TITLE =J6F_T12  
// Act 018
// Box           : Ventilinsel 1
// Input address : I9.5
// Output address: Q9.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.J6F_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.5,
           Out                      := Q      9.5);

NETWORK
TITLE =L6F_T12  
// Act 019
// Box           : Ventilinsel 1
// Input address : I9.6
// Output address: Q9.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.L6F_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.6,
           Out                      := Q      9.6);

NETWORK
TITLE =D6_T12  
// Act 020
// Box           : Ventilinsel 1
// Input address : I9.7
// Output address: Q9.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.D6_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      9.7,
           Out                      := Q      9.7);

NETWORK
TITLE =B6_T12  
// Act 021
// Box           : Ventilinsel 1
// Input address : I10.0
// Output address: Q10.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.B6_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.0,
           Out                      := Q     10.0);

NETWORK
TITLE =A_T12  
// Act 022
// Box           : Ventilinsel 1
// Input address : I10.1
// Output address: Q10.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.A_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.1,
           Out                      := Q     10.1);

NETWORK
TITLE =B_T12  
// Act 023
// Box           : Ventilinsel 1
// Input address : I10.2
// Output address: Q10.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.B_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.2,
           Out                      := Q     10.2);

NETWORK
TITLE =CF_T12  
// Act 024
// Box           : Ventilinsel 1
// Input address : I17.5
// Output address: Q17.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.CF_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     17.5,
           Out                      := Q     17.5);

NETWORK
TITLE =C_T12  
// Act 025
// Box           : VS2-BB
// Input address : I311.5
// Output address: Q311.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.C_T12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    311.5,
           Out                      := Q    311.5);

NETWORK
TITLE =VVT12  Vacuumventil Tank 12
// Act 028
// Box           : VST1-9
// Output address: Q160.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.VVT12,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    160.1);

NETWORK
TITLE =VR_T12  
// Act 029
// Box           : Ventilinsel 1
// Output address: Q10.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.VR_T12,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     10.3);

NETWORK
TITLE =ML_LABORFREIGABE_T12  
// Act 031
// Box           : LT-CIP
// Output address: Q259.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2120.ML_LABORFREIGABE_T12,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    259.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1121
TITLE =U012: Water Tank 12
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

// Simulation ---------------------------------------------------------------
      A     DB1121.DBX 1357.7; 
      CC    FB  1129; // "WT12Sim"
      A     DB1121.DBX   17.3; 
      =     DB1121.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1120.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1125; // WT12Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1125.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1121.Seq.SFM[15],
           ValueOld                 := DB1121.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1123.DBX   43.1; 
      S     DB1123.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1130
TITLE =U013: Wassertank 13
FAMILY : BOTEC_F1
NAME : U013A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1130.DBW    0; 
      T     #UnitNo; 
      L     DB1130.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_T13 AnI 001 Niveau Tank 13
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2133.LI_T13,
           ValPer                   := DB302.DBW   88);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2135.unv001,
           ValExt                   := DB2135.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2135.unv002,
           ValExt                   := DB2135.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2135.unv003,
           ValExt                   := DB2135.DBD  490);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_T13 SpI 001 LS- Tank 13
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.LS_LLL_T13,
           SpIBit                   := I     50.0);

// LS_HL_T13 SpI 002 LS+ Tank 13
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.LS_HL_T13,
           SpIBit                   := I     49.6);

// GOA_T13_ML SpI 003 Mannloch Tank 13
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.GOA_T13_ML,
           SpIBit                   := I     49.5);

// GOA_T13_VV SpI 004 Vacuumventil Tank 13
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.GOA_T13_VV,
           SpIBit                   := I     49.4);

// LS_LL_T13 SpI 005 LS/ Tank 13
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.LS_LL_T13,
           SpIBit                   := I     49.7);

// RM_NI_T13_K4_AUF SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.RM_NI_T13_K4_AUF,
           SpIBit                   := I     49.2);

// RM_NI_T13_K4_ZU SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.RM_NI_T13_K4_ZU,
           SpIBit                   := I     49.3);

// RM_NI_T13_K2 SpI 008 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.RM_NI_T13_K2,
           SpIBit                   := I     49.0);

// RM_NI_T13_K3 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.RM_NI_T13_K3,
           SpIBit                   := I     49.1);

// LABOR_FREIG_T13 SpI 011 SCHLUESSELSCHALTER LABOR
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2131.LABOR_FREIG_T13,
           SpIBit                   := I    259.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2137.msg001,
           MsgBit                   := DB2137.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2137.msg002,
           MsgBit                   := DB2137.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =T13_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I317.4
// Output address: Q317.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.4,
           Out                      := Q    317.4);

NETWORK
TITLE =T13_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I319.4
// Output address: Q319.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.4,
           Out                      := Q    319.4);

NETWORK
TITLE =T13_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I321.4
// Output address: Q321.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.4,
           Out                      := Q    321.4);

NETWORK
TITLE =T13_A7  
// Act 008
// Box           : Ventilinsel 2
// Input address : I323.4
// Output address: Q323.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.4,
           Out                      := Q    323.4);

NETWORK
TITLE =T13_A8  
// Act 009
// Box           : Ventilinsel 3
// Input address : I325.4
// Output address: Q325.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.4,
           Out                      := Q    325.4);

NETWORK
TITLE =T13_A5  
// Act 010
// Box           : Ventilinsel 3
// Input address : I327.4
// Output address: Q327.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.4,
           Out                      := Q    327.4);

NETWORK
TITLE =T13_A11  
// Act 011
// Box           : Ventilinsel 3
// Input address : I329.4
// Output address: Q329.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.4,
           Out                      := Q    329.4);

NETWORK
TITLE =T13_A14  
// Act 012
// Box           : Ventilinsel 4
// Input address : I331.4
// Output address: Q331.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.4,
           Out                      := Q    331.4);

NETWORK
TITLE =T13_A15  
// Act 013
// Box           : Ventilinsel 4
// Input address : I333.4
// Output address: Q333.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_A15,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    333.4,
           Out                      := Q    333.4);

NETWORK
TITLE =T13_RR1  
// Act 014
// Box           : Ventilinsel 4
// Input address : I335.4
// Output address: Q335.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.T13_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.4,
           Out                      := Q    335.4);

NETWORK
TITLE =RV1_T13  
// Act 015
// Box           : Ventilinsel 1
// Input address : I10.4
// Output address: Q10.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.RV1_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.4,
           Out                      := Q     10.4);

NETWORK
TITLE =B6F_T13  
// Act 016
// Box           : Ventilinsel 1
// Input address : I10.5
// Output address: Q10.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.B6F_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.5,
           Out                      := Q     10.5);

NETWORK
TITLE =H6F_T13  
// Act 017
// Box           : Ventilinsel 1
// Input address : I10.6
// Output address: Q10.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.H6F_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.6,
           Out                      := Q     10.6);

NETWORK
TITLE =J6F_T13  
// Act 018
// Box           : Ventilinsel 1
// Input address : I10.7
// Output address: Q10.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.J6F_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     10.7,
           Out                      := Q     10.7);

NETWORK
TITLE =L6F_T13  
// Act 019
// Box           : Ventilinsel 1
// Input address : I11.0
// Output address: Q11.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.L6F_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     11.0,
           Out                      := Q     11.0);

NETWORK
TITLE =A_T13  
// Act 022
// Box           : Ventilinsel 1
// Input address : I11.3
// Output address: Q11.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.A_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     11.3,
           Out                      := Q     11.3);

NETWORK
TITLE =B_T13  
// Act 023
// Box           : Ventilinsel 1
// Input address : I11.4
// Output address: Q11.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.B_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     11.4,
           Out                      := Q     11.4);

NETWORK
TITLE =RW5_T13  
// Act 026
// Box           : Ventilinsel 1
// Input address : I11.6
// Output address: Q11.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.RW5_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     11.6,
           Out                      := Q     11.6);

NETWORK
TITLE =RW6_T13  
// Act 027
// Box           : Ventilinsel 1
// Input address : I11.7
// Output address: Q11.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.RW6_T13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     11.7,
           Out                      := Q     11.7);

NETWORK
TITLE =VVT13  Vacuumventil Tank 13
// Act 028
// Box           : VST1-9
// Output address: Q160.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.VVT13,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    160.2);

NETWORK
TITLE =VR_T13  
// Act 029
// Box           : Ventilinsel 1
// Output address: Q11.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.VR_T13,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     11.5);

NETWORK
TITLE =ML_LABORFREIGABE_T13  
// Act 031
// Box           : LT-CIP
// Output address: Q259.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2130.ML_LABORFREIGABE_T13,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    259.5);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1131
TITLE =U013: Water Tank 13
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1131.DBX 1357.7; 
      CC    FB  1139; // "WT13Sim"
      A     DB1131.DBX   17.3; 
      =     DB1131.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1130.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1135; // WT13Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1135.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1131.Seq.SFM[15],
           ValueOld                 := DB1131.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1133.DBX   43.1; 
      S     DB1133.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1210
TITLE =U021: Brunnen Transfer VE1
FAMILY : BOTEC_F1
NAME : U021A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1210.DBW    0; 
      T     #UnitNo; 
      L     DB1210.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2213.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2213.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2213.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2215.unv001,
           ValExt                   := DB2215.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2215.unv002,
           ValExt                   := DB2215.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2215.unv003,
           ValExt                   := DB2215.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2215.unv004,
           ValExt                   := DB2215.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// NI_VP1_Br2a_VE1 SpI 001 Paneel VP1 Brunnen 2a -> VE1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2211.NI_VP1_Br2a_VE1,
           SpIBit                   := I     80.1);

// NI_VP1_Br2b_VE1 SpI 002 Paneel VP1 Brunnen 2b -> VE1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2211.NI_VP1_Br2b_VE1,
           SpIBit                   := I     80.2);

// NI_VP1_Br3_VE1 SpI 003 Paneel VP1 Brunnen 3 -> VE1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2211.NI_VP1_Br3_VE1,
           SpIBit                   := I     80.4);

// NI_VP1_Br7_VE1 SpI 004 Paneel VP1 Brunnen 7 -> VE1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2211.NI_VP1_Br7_VE1,
           SpIBit                   := I     80.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2217.msg001,
           MsgBit                   := DB2217.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2217.msg002,
           MsgBit                   := DB2217.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2217.msg003,
           MsgBit                   := DB2217.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2216.PID01,
           SpExt                    := DB2216.DBD  234,
           PVal                     := DB2216.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RW6_G1  Gullyventil RW6
// Act 001
// Box           : VS2-BB
// Input address : I310.4
// Output address: Q310.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2210.RW6_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    310.4,
           Out                      := Q    310.4);

NETWORK
TITLE =VE1V1  VE1V1 --> Chriwa
// Act 002
// Box           : VS2-BB
// Input address : I310.5
// Output address: Q310.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2210.VE1V1,
           Typ                      := 23,
           FBa                      := I    310.5,
           FBa2                     := #xTmp,
           Out                      := Q    310.5);

NETWORK
TITLE =VE1V2  VE1V2 Gully
// Act 003
// Box           : VS2-BB
// Input address : I310.6
// Output address: Q310.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2210.VE1V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    310.6,
           Out                      := Q    310.6);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1211
TITLE =U021: Well Transfer VE1
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1211.DBX 1357.7; 
      CC    FB  1219; // "U021Sim"
      A     DB1211.DBX   17.3; 
      =     DB1211.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1210.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1215; // U021Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 


// Chriwa Status 1
      L     DB1381.DBD  482; 
      T     DB1211.DBD  482; 

// Chriwa Status 2
      L     DB1381.DBD  498; 
      T     DB1211.DBD  498; 

// sequencer ----------------------------------------------------------------
      A     DB1213.DBX   43.1; 
      S     DB1213.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1220
TITLE =U022: Brunnen Transfer VE2
FAMILY : BOTEC_F1
NAME : U022A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1220.DBW    0; 
      T     #UnitNo; 
      L     DB1220.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2223.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2223.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2223.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2225.unv001,
           ValExt                   := DB2225.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2225.unv002,
           ValExt                   := DB2225.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2225.unv003,
           ValExt                   := DB2225.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2225.unv004,
           ValExt                   := DB2225.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// NI_VP1_Br2a_VE2 SpI 001 Paneel VP1 Brunnen 2a -> VE2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2221.NI_VP1_Br2a_VE2,
           SpIBit                   := I     80.6);

// NI_VP1_Br2b_VE2 SpI 002 Paneel VP1 Brunnen 2b -> VE2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2221.NI_VP1_Br2b_VE2,
           SpIBit                   := I     80.7);

// NI_VP1_Br3_VE2 SpI 003 Paneel VP1 Brunnen 3 -> VE2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2221.NI_VP1_Br3_VE2,
           SpIBit                   := I     81.1);

// NI_VP1_Br7_VE2 SpI 004 Paneel VP1 Brunnen 7 -> VE2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2221.NI_VP1_Br7_VE2,
           SpIBit                   := I     81.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2227.msg001,
           MsgBit                   := DB2227.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2227.msg002,
           MsgBit                   := DB2227.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2227.msg003,
           MsgBit                   := DB2227.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2226.PID01,
           SpExt                    := DB2226.DBD  234,
           PVal                     := DB2226.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RW5_G1  Gullyventil RW5
// Act 001
// Box           : VS2-BB
// Input address : I310.3
// Output address: Q310.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2220.RW5_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    310.3,
           Out                      := Q    310.3);

NETWORK
TITLE =VE2V1  VE2V1 --> Chriwa
// Act 002
// Box           : VS2-BB
// Input address : I310.7
// Output address: Q310.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2220.VE2V1,
           Typ                      := 23,
           FBa                      := I    310.7,
           FBa2                     := #xTmp,
           Out                      := Q    310.7);

NETWORK
TITLE =VE2V2  VE2V2 Gully
// Act 003
// Box           : VS2-BB
// Input address : I311.0
// Output address: Q311.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2220.VE2V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    311.0,
           Out                      := Q    311.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1221
TITLE =U022: Well Transfer VE2
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1221.DBX 1357.7; 
      CC    FB  1229; // "U022Sim"
      A     DB1221.DBX   17.3; 
      =     DB1221.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1220.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1225; // U022Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 


// Chriwa Status 1
      L     DB1391.DBD  482; 
      T     DB1221.DBD  482; 

// Chriwa Status 2
      L     DB1391.DBD  498; 
      T     DB1221.DBD  498; 

// sequencer ----------------------------------------------------------------
      A     DB1223.DBX   43.1; 
      S     DB1223.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1250
TITLE =U025: Well Transfer A
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1250.DBW    0; 
      T     #UnitNo; 
      L     DB1250.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2253.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_A_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2253.QI_CO2_A_PH,
           ValPer                   := IW   220);

// QI_CO2_A_pH_KOR AnI 003 pH Brunnen A mit Offset
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2253.QI_CO2_A_pH_KOR,
           ValPer                   := IW   552);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2255.unv001,
           ValExt                   := DB2255.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2255.unv002,
           ValExt                   := DB2255.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2255.unv003,
           ValExt                   := DB2255.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2255.unv004,
           ValExt                   := DB2255.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2251.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2251.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2251.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2251.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2257.msg001,
           MsgBit                   := DB2257.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2257.msg002,
           MsgBit                   := DB2257.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2257.msg003,
           MsgBit                   := DB2257.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2ARV1 PID 001 CO2 A RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2256.CO2ARV1,
           SpExt                    := DB2256.DBD  234,
           PVal                     := DB2256.DBD  254,
           OPer                     := PQW  220);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A_G1  A_G1
// Act 001
// Box           : VS2-BB
// Output address: Q309.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2250.A_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.3,
           Out                      := Q    309.3);

NETWORK
TITLE =CO2_AV2  Ansteuerung AV2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2250.CO2_AV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.7);

NETWORK
TITLE =CO2_AV1  Ansteuerung AV1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2250.CO2_AV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.7);

NETWORK
TITLE =ARV1  CO2 A RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2250.ARV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1251
TITLE =U025: Well Transfer A
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1251.DBX 1357.7; 
      CC    FB  1259; // "U025Sim"
      A     DB1251.DBX   17.3; 
      =     DB1251.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1250.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1255; // U025Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1253.DBX   43.1; 
      S     DB1253.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1260
TITLE =U026: Well Transfer B
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1260.DBW    0; 
      T     #UnitNo; 
      L     DB1260.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2263.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_B_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2263.QI_CO2_B_PH,
           ValPer                   := IW   222);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2263.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2265.unv001,
           ValExt                   := DB2265.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2265.unv002,
           ValExt                   := DB2265.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2265.unv003,
           ValExt                   := DB2265.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2265.unv004,
           ValExt                   := DB2265.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// RM_NI_KF1_K1 SpI 001
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2261.RM_NI_KF1_K1,
           SpIBit                   := #xTmp);//"RM_NI_KF1_K1"

// RM_NI_KF1_K2 SpI 002
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2261.RM_NI_KF1_K2,
           SpIBit                   := #xTmp);//"RM_NI_KF1_K2"

// RM_NI_KF1_K3 SpI 003 PANEEL PTV1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2261.RM_NI_KF1_K3,
           SpIBit                   := I     54.6);


// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2261.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2267.msg001,
           MsgBit                   := DB2267.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2267.msg002,
           MsgBit                   := DB2267.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2267.msg003,
           MsgBit                   := DB2267.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2BRV1 PID 001 CO2 B RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2266.CO2BRV1,
           SpExt                    := DB2266.DBD  234,
           PVal                     := DB2266.DBD  254,
           OPer                     := PQW  222);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =B_G1  B_G1
// Act 001
// Box           : VS2-BB
// Output address: Q309.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2260.B_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.4,
           Out                      := Q    309.4);

NETWORK
TITLE =CO2_BV2  Ansteuerung BV2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2260.CO2_BV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.6);

NETWORK
TITLE =CO2_BV1  Ansteuerung BV1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2260.CO2_BV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.6);

NETWORK
TITLE =BRV1  CO2 B RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2260.BRV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1261
TITLE =U026: Well Transfer B
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1261.DBX 1357.7; 
      CC    FB  1269; // "U026Sim"
      A     DB1261.DBX   17.3; 
      =     DB1261.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1260.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1265; // U026Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1263.DBX   43.1; 
      S     DB1263.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1270
TITLE =U027: Well Transfer CF
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1270.DBW    0; 
      T     #UnitNo; 
      L     DB1270.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2273.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_CF_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2273.QI_CO2_CF_PH,
           ValPer                   := IW   550);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2273.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2275.unv001,
           ValExt                   := DB2275.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2275.unv002,
           ValExt                   := DB2275.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2275.unv003,
           ValExt                   := DB2275.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2275.unv004,
           ValExt                   := DB2275.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2271.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2271.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2271.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2271.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2277.msg001,
           MsgBit                   := DB2277.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2277.msg002,
           MsgBit                   := DB2277.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2277.msg003,
           MsgBit                   := DB2277.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2CFRV1 PID 001 CO2 CF RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2276.CO2CFRV1,
           SpExt                    := DB2276.DBD  234,
           PVal                     := DB2276.DBD  254,
           OPer                     := PQW  550);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =CF_G1  
// Act 001
// Box           : Ventilinsel 1
// Input address : I16.5
// Output address: Q16.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2270.CF_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     16.5,
           Out                      := Q     16.5);

NETWORK
TITLE =CO2_CFV2  
// Act 002
// Box           : CO2 Dosierung
// Output address: Q62.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2270.CO2_CFV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     62.3);

NETWORK
TITLE =CO2_CFV1  
// Act 003
// Box           : CO2 Dosierung
// Output address: Q62.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2270.CO2_CFV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     62.2);

NETWORK
TITLE =CFRV1  CO2 CF RV1
// Act 004
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2270.CFRV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1271
TITLE =U027: Well Transfer CF
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1271.DBX 1357.7; 
      CC    FB  1279; // "U027Sim"
      A     DB1271.DBX   17.3; 
      =     DB1271.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1270.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1275; // U027Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1273.DBX   43.1; 
      S     DB1273.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1280
TITLE =U028: Well Transfer C
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1280.DBW    0; 
      T     #UnitNo; 
      L     DB1280.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2283.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_C_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2283.QI_CO2_C_PH,
           ValPer                   := IW   548);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2283.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2285.unv001,
           ValExt                   := DB2285.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2285.unv002,
           ValExt                   := DB2285.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2285.unv003,
           ValExt                   := DB2285.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2285.unv004,
           ValExt                   := DB2285.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2281.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2281.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2281.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2281.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2287.msg001,
           MsgBit                   := DB2287.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2287.msg002,
           MsgBit                   := DB2287.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2287.msg003,
           MsgBit                   := DB2287.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2CRV1 PID 001 CO2 C RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2286.CO2CRV1,
           SpExt                    := DB2286.DBD  234,
           PVal                     := DB2286.DBD  254,
           OPer                     := PQW  548);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =C_G1  
// Act 001
// Box           : Ventilinsel 1
// Input address : I17.7
// Output address: Q17.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2280.C_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     17.7,
           Out                      := Q     17.7);

NETWORK
TITLE =CO2_CV2  
// Act 002
// Box           : CO2 Dosierung
// Output address: Q62.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2280.CO2_CV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     62.1);

NETWORK
TITLE =CO2_CV1  
// Act 003
// Box           : CO2 Dosierung
// Output address: Q62.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2280.CO2_CV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     62.0);

NETWORK
TITLE =CRV1  CO2 C RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2280.CRV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1281
TITLE =U028: Well Transfer C
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1281.DBX 1357.7; 
      CC    FB  1289; // "U028Sim"
      A     DB1281.DBX   17.3; 
      =     DB1281.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1280.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1285; // U028Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1283.DBX   43.1; 
      S     DB1283.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1290
TITLE =U029: Well Transfer B6F
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1290.DBW    0; 
      T     #UnitNo; 
      L     DB1290.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2293.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_B6F_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2293.QI_CO2_B6F_PH,
           ValPer                   := IW   216);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2293.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2295.unv001,
           ValExt                   := DB2295.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2295.unv002,
           ValExt                   := DB2295.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2295.unv003,
           ValExt                   := DB2295.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2295.unv004,
           ValExt                   := DB2295.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// RM_NI_KF2_K1 SpI 001 PANEEL PTV1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2291.RM_NI_KF2_K1,
           SpIBit                   := I     54.7);

// RM_NI_KF2_K2 SpI 002 PANEEL PTV1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2291.RM_NI_KF2_K2,
           SpIBit                   := I     55.0);

// RM_NI_KF2_K3 SpI 003 PANEEL PTV1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2291.RM_NI_KF2_K3,
           SpIBit                   := I     55.1);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2291.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2297.msg001,
           MsgBit                   := DB2297.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2297.msg002,
           MsgBit                   := DB2297.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2297.msg003,
           MsgBit                   := DB2297.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2B6FRV1 PID 001 CO2 B6F RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2296.CO2B6FRV1,
           SpExt                    := DB2296.DBD  234,
           PVal                     := DB2296.DBD  254,
           OPer                     := PQW  216);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =B6F_G1  B6F_G1
// Act 001
// Box           : VS2-BB
// Output address: Q309.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2290.B6F_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.6,
           Out                      := Q    309.6);

NETWORK
TITLE =CO2_B6FV2  Ansteuerung B6FV2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2290.CO2_B6FV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.0);

NETWORK
TITLE =CO2_B6FV1  Ansteuerung B6FV1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2290.CO2_B6FV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.0);

NETWORK
TITLE =B6FRV1  CO2 B6F RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2290.B6FRV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1291
TITLE =U029: Well Transfer B6F
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1291.DBX 1357.7; 
      CC    FB  1299; // "U029Sim"
      A     DB1291.DBX   17.3; 
      =     DB1291.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1290.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1295; // U029Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1293.DBX   43.1; 
      S     DB1293.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1300
TITLE =U030: Well Transfer H6
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1300.DBW    0; 
      T     #UnitNo; 
      L     DB1300.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2303.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_H6F_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2303.QI_CO2_H6F_PH,
           ValPer                   := IW   218);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2303.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2305.unv001,
           ValExt                   := DB2305.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2305.unv002,
           ValExt                   := DB2305.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2305.unv003,
           ValExt                   := DB2305.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2305.unv004,
           ValExt                   := DB2305.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2301.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2301.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2301.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2301.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2307.msg001,
           MsgBit                   := DB2307.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2307.msg002,
           MsgBit                   := DB2307.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2307.msg003,
           MsgBit                   := DB2307.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2H6FRV1 PID 001 CO2 H6F RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2306.CO2H6FRV1,
           SpExt                    := DB2306.DBD  234,
           PVal                     := DB2306.DBD  254,
           OPer                     := PQW  218);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =H6F_G1  H6F_G1
// Act 001
// Box           : VS2-BB
// Output address: Q309.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2300.H6F_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.5,
           Out                      := Q    309.5);

NETWORK
TITLE =CO2_H6FV2  Ansteuerung H6FV2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2300.CO2_H6FV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.1);

NETWORK
TITLE =CO2_H6FV1  Ansteuerung H6FV1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2300.CO2_H6FV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.1);

NETWORK
TITLE =H6RV1  CO2 H6 RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2300.H6RV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1301
TITLE =U030: Well Transfer H6
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1301.DBX 1357.7; 
      CC    FB  1309; // "U030Sim"
      A     DB1301.DBX   17.3; 
      =     DB1301.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1300.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1305; // U030Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1303.DBX   43.1; 
      S     DB1303.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1310
TITLE =U031: Well Transfer J6
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1310.DBW    0; 
      T     #UnitNo; 
      L     DB1310.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// J6F_Druck AnI 001 J6F_Druck
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2313.J6F_Druck,
           ValPer                   := #iTmp);

// QI_CO2_J6F_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2313.QI_CO2_J6F_PH,
           ValPer                   := IW   208);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2313.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2315.unv001,
           ValExt                   := DB2315.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2315.unv002,
           ValExt                   := DB2315.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2315.unv003,
           ValExt                   := DB2315.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2315.unv004,
           ValExt                   := DB2315.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2311.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2311.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2311.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2311.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2317.msg001,
           MsgBit                   := DB2317.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2317.msg002,
           MsgBit                   := DB2317.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2317.msg003,
           MsgBit                   := DB2317.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2J6FRV1 PID 001 CO2 J6F RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2316.CO2J6FRV1,
           SpExt                    := DB2316.DBD  234,
           PVal                     := DB2316.DBD  254,
           OPer                     := PQW  540);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =J6F_G1  J6F_G1
// Act 001
// Box           : VS2-BB
// Output address: Q309.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2310.J6F_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    309.7,
           Out                      := Q    309.7);

NETWORK
TITLE =CO2_J6FV2  Ansteuerung J6FV2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2310.CO2_J6FV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.2);

NETWORK
TITLE =CO2_J6FV1  Ansteuerung J6FV1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2310.CO2_J6FV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.2);

NETWORK
TITLE =J6FRV1  CO2 J6F RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2310.J6FRV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1311
TITLE =U031: Well Transfer J6
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
  DSTUnit : INT ;	//Destination Water Tank
  wRetVal : WORD ;	//return value as word
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1311.DBX 1357.7; 
      CC    FB  1319; // "U031Sim"
      A     DB1311.DBX   17.3; 
      =     DB1311.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1310.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1315; // U031Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1313.DBX   43.1; 
      S     DB1313.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1320
TITLE =U032: Well Transfer L6F
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1320.DBW    0; 
      T     #UnitNo; 
      L     DB1320.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2323.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_L6F_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2323.QI_CO2_L6F_PH,
           ValPer                   := IW   210);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2323.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2325.unv001,
           ValExt                   := DB2325.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2325.unv002,
           ValExt                   := DB2325.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2325.unv003,
           ValExt                   := DB2325.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2325.unv004,
           ValExt                   := DB2325.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2321.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2321.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2321.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2321.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2327.msg001,
           MsgBit                   := DB2327.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2327.msg002,
           MsgBit                   := DB2327.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2327.msg003,
           MsgBit                   := DB2327.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2L6FRV1 PID 001 CO2 L6F RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2326.CO2L6FRV1,
           SpExt                    := DB2326.DBD  234,
           PVal                     := DB2326.DBD  254,
           OPer                     := PQW  542);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =L6F_G1  L6F_G1
// Act 001
// Box           : VS2-BB
// Output address: Q310.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2320.L6F_G1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    310.0,
           Out                      := Q    310.0);

NETWORK
TITLE =CO2_L6FV2  Ansteuerung L6FV2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2320.CO2_L6FV2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.3);

NETWORK
TITLE =CO2_L6FV1  Ansteuerung L6FV1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2320.CO2_L6FV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.3);

NETWORK
TITLE =L6FRV1  CO2 L6F RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2320.L6FRV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1321
TITLE =U032: Well Transfer L6F
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1321.DBX 1357.7; 
      CC    FB  1329; // "U032Sim"
      A     DB1321.DBX   17.3; 
      =     DB1321.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1320.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1325; // U032Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1323.DBX   43.1; 
      S     DB1323.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1330
TITLE =U033: Well Transfer B6
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1330.DBW    0; 
      T     #UnitNo; 
      L     DB1330.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2333.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_B6_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2333.QI_CO2_B6_PH,
           ValPer                   := IW   214);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2333.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2335.unv001,
           ValExt                   := DB2335.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2335.unv002,
           ValExt                   := DB2335.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2335.unv003,
           ValExt                   := DB2335.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2335.unv004,
           ValExt                   := DB2335.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2331.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2331.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2331.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2331.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2337.msg001,
           MsgBit                   := DB2337.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2337.msg002,
           MsgBit                   := DB2337.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2337.msg003,
           MsgBit                   := DB2337.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2B6RV1 PID 001 CO2 B6 RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2336.CO2B6RV1,
           SpExt                    := DB2336.DBD  234,
           PVal                     := DB2336.DBD  254,
           OPer                     := PQW  546);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =B6_G1  B6_G1
// Act 001
// Box           : VS2-BB
// Output address: Q310.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2330.B6_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    310.1,
           Out                      := Q    310.1);

NETWORK
TITLE =CO2_B6V2  Ansteuerung B6V2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2330.CO2_B6V2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.5);

NETWORK
TITLE =CO2_B6V1  Ansteuerung B6V1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2330.CO2_B6V1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.5);

NETWORK
TITLE =B6RV1  CO2 B6 RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2330.B6RV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1331
TITLE =U033: Well Transfer B6
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1331.DBX 1357.7; 
      CC    FB  1339; // "U033Sim"
      A     DB1331.DBX   17.3; 
      =     DB1331.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1330.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1335; // U033Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1333.DBX   43.1; 
      S     DB1333.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1340
TITLE =U034: Well Transfer D6
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1340.DBW    0; 
      T     #UnitNo; 
      L     DB1340.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2343.C_AnI01,
           ValPer                   := #iTmp);

// QI_CO2_D6_PH AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2343.QI_CO2_D6_PH,
           ValPer                   := IW   212);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2343.AnI03,
           ValPer                   := #iTmp);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2345.unv001,
           ValExt                   := DB2345.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2345.unv002,
           ValExt                   := DB2345.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2345.unv003,
           ValExt                   := DB2345.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2345.unv004,
           ValExt                   := DB2345.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2341.SpI01,
           SpIBit                   := #xTmp);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2341.SpI02,
           SpIBit                   := #xTmp);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2341.SpI03,
           SpIBit                   := #xTmp);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2341.SpI04,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2347.msg001,
           MsgBit                   := DB2347.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2347.msg002,
           MsgBit                   := DB2347.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2347.msg003,
           MsgBit                   := DB2347.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// CO2D6RV1 PID 001 CO2 D6 RV1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2346.CO2D6RV1,
           SpExt                    := DB2346.DBD  234,
           PVal                     := DB2346.DBD  254,
           OPer                     := PQW  544);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =D6_G1  D6_G1
// Act 001
// Box           : VS2-BB
// Output address: Q310.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2340.D6_G1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    310.2,
           Out                      := Q    310.2);

NETWORK
TITLE =CO2_D6V2  Ansteuerung D6V2
// Act 002
// Box           : CO2 Dosierung
// Output address: Q61.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2340.CO2_D6V2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     61.4);

NETWORK
TITLE =CO2_D6V1  Ansteuerung D6V1
// Act 003
// Box           : CO2 Dosierung
// Output address: Q60.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2340.CO2_D6V1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     60.4);

NETWORK
TITLE =D6RV1  CO2 D6 RV1
// Act 004
// Box           : 
// Input address : #xtmp
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2340.D6RV1,
           Typ                      := 4,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1341
TITLE =U034: Well Transfer D6
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1341.DBX 1357.7; 
      CC    FB  1349; // "U034Sim"
      A     DB1341.DBX   17.3; 
      =     DB1341.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1340.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1345; // U034Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1343.DBX   43.1; 
      S     DB1343.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1380
TITLE =U038: Water Treatment 1
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1380.DBW    0; 
      T     #UnitNo; 
      L     DB1380.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// EW288 AnI 001 Chriwa Filter Durchflu Produkt
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2383.#EW288,
           ValPer                   := 0);//"EW288"

// EW290 AnI 002 Chriwa Filter Durchflu Splwasser
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2383.#EW290,
           ValPer                   := PIW  290);

// EW284 AnI 003 Chriwa Filter Leitwert
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2383.#EW284,
           ValPer                   := PIW  284);

// EW286 AnI 004 Chriwa Filter Trbung
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2383.#EW286,
           ValPer                   := PIW  286);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2385.unv001,
           ValExt                   := DB2385.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2385.unv002,
           ValExt                   := DB2385.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// CHRIWA_ANF_BRUNNENPUMPE SpI 001 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.CHRIWA_ANF_BRUNNENPUMPE,
           SpIBit                   := I    280.3);

// CHRIWA_BETRIEB SpI 002 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.CHRIWA_BETRIEB,
           SpIBit                   := I    280.2);

// CHRIWA_STOERUNG SpI 003 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.CHRIWA_STOERUNG,
           SpIBit                   := I    280.1);

// CHRIWA_LEBENSBIT SpI 004 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.CHRIWA_LEBENSBIT,
           SpIBit                   := I    280.0);

// KF1K1 SpI 005 KF1 K1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.KF1K1,
           SpIBit                   := #xTmp);

// KF1K2 SpI 006 KF1 K2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.KF1K2,
           SpIBit                   := #xTmp);

// KF1_K3 SpI 007 KF1 K3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2381.KF1_K3,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2387.msg001,
           MsgBit                   := DB2387.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2387.msg002,
           MsgBit                   := DB2387.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Chriwa_LS_Tank1  Chriwa Filter Tank 1 LS
// Act 005
// Box           : Chriwa
// Output address: Q280.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2380.Chriwa_LS_Tank1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    280.4);

NETWORK
TITLE =Chriwa_Freigabe_Ruecksp  Chriwa Filter Freigabe zum Rcksplen
// Act 006
// Box           : Chriwa
// Output address: Q280.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2380.Chriwa_Freigabe_Ruecksp,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    280.3);

NETWORK
TITLE =Chriwa_Brunnen_ok  Chriwa Filter Brunnen ok Meldung
// Act 007
// Box           : Chriwa
// Output address: Q280.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2380.Chriwa_Brunnen_ok,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    280.2);

NETWORK
TITLE =Chriwa_Tank_Befuell_Ein  Chriwa Filter Tank Befllung luft
// Act 008
// Box           : Chriwa
// Output address: Q280.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2380.Chriwa_Tank_Befuell_Ein,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    280.1);

NETWORK
TITLE =Chriwa_Lebensbit  Chriwa Filter 0,5Hz Lebensbit
// Act 009
// Box           : Chriwa
// Output address: Q280.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2380.Chriwa_Lebensbit,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    280.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1381
TITLE =U038: Water Treatment 1
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1381.DBX 1357.7; 
      CC    FB  1389; // "U038Sim"
      A     DB1381.DBX   17.3; 
      =     DB1381.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1380.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1381.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1385.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1381.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1385; // U038Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// EW288 Chriwa Filter Durchflu Produkt
// ----------------------------------------------------------
      L     IW   288; 
      ITD   ; 
      DTR   ; 
      T     DB2383.DBD  214; 
      SET   ; 
      =     DB2383.DBX  143.5; 

      SET   ; 
      =     DB2383.DBX  141.5; 

// ----------------------------------------------------------
// EW290 Chriwa Filter Durchflu Splwasser
// ----------------------------------------------------------
      L     IW   290; 
      ITD   ; 
      DTR   ; 
      T     DB2383.DBD  334; 
      SET   ; 
      =     DB2383.DBX  263.5; 

      SET   ; 
      =     DB2383.DBX  261.5; 

// ----------------------------------------------------------
// EW284 Chriwa Filter Leitwert
// ----------------------------------------------------------
      L     IW   284; 
      ITD   ; 
      DTR   ; 
      T     DB2383.DBD  454; 
      SET   ; 
      =     DB2383.DBX  383.5; 

      SET   ; 
      =     DB2383.DBX  381.5; 

// ----------------------------------------------------------
// EW286 Chriwa Filter Trbung
// ----------------------------------------------------------
      L     IW   286; 
      ITD   ; 
      DTR   ; 
      T     DB2383.DBD  574; 
      SET   ; 
      =     DB2383.DBX  503.5; 

      SET   ; 
      =     DB2383.DBX  501.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U038UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U038UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// CHRIWA_ANF_BRUNNENPUMPE Chriwa Filter
// ----------------------------------------------------------
      CLR   ; 
      =     DB2381.DBX   81.4; 
      =     DB2381.DBX   81.5; 

// ----------------------------------------------------------
// CHRIWA_BETRIEB Chriwa Filter
// ----------------------------------------------------------
      CLR   ; 
      =     DB2381.DBX  141.4; 
      =     DB2381.DBX  141.5; 

// ----------------------------------------------------------
// CHRIWA_STOERUNG Chriwa Filter
// ----------------------------------------------------------
      SET   ; 
      =     DB2381.DBX  201.4; 
      CLR   ; 
      =     DB2381.DBX  201.5; 

// ----------------------------------------------------------
// CHRIWA_LEBENSBIT Chriwa Filter
// ----------------------------------------------------------
      SET   ; 
      =     DB2381.DBX  261.4; 
      =     DB2381.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2387.DBX   80.7; 
      =     DB2387.DBX   81.4; 

      CLR   ; 
      =     DB2387.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2387.DBX  140.7; 
      =     DB2387.DBX  141.4; 

      CLR   ; 
      =     DB2387.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Chriwa Filter Durchflu Produkt -----------------------
      L     DB2383.DBD  146; 
      T     DB1381.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Chriwa Filter Durchflu Splwasser -----------------------
      L     DB2383.DBD  266; 
      T     DB1381.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Chriwa Filter Leitwert -----------------------
      L     DB2383.DBD  386; 
      T     DB1381.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Chriwa Filter Trbung -----------------------
      L     DB2383.DBD  506; 
      T     DB1381.DBD 1122; // !!! insert correct SFM !!!

// Chriwa Status 1
      A     I    292.0; // ERSTFILTRAT
      JC    M100; 
      A     I    292.1; // AUS
      JC    M101; 
      A     I    292.2; // BEREITSCHAFT
      JC    M102; 
      A     I    292.3; // STOP
      JC    M103; 
      A     I    292.4; // STRUNG
      JC    M104; 
      A     I    293.0; // BETRIEB
      JC    M108; 
      A     I    293.1; // ENTSPANNE
      JC    M109; 
      A     I    293.2; // ABSENKEN
      JC    M110; 
      A     I    293.3; // SPLEN LUFT
      JC    M111; 
      A     I    293.4; // SPLEN WASSER/LUFT
      JC    M112; 
      A     I    293.5; // FILTERBETTENTL.
      JC    M113; 
      A     I    293.6; // SPLEN WASSER
      JC    M114; 
      A     I    293.7; // AUFFLLEN
      JC    M115; 
      JU    ELS1; 
M100: L     0.000000e+000; // Do 0
      JU    FIN1; 
M101: L     1.000000e+000; // Do 1
      JU    FIN1; 
M102: L     2.000000e+000; // Do 2
      JU    FIN1; 
M103: L     3.000000e+000; // Do 3
      JU    FIN1; 
M104: L     4.000000e+000; // Do 4
      JU    FIN1; 
M108: L     8.000000e+000; // Do 8
      JU    FIN1; 
M109: L     9.000000e+000; // Do 9
      JU    FIN1; 
M110: L     1.000000e+001; // Do 10
      JU    FIN1; 
M111: L     1.100000e+001; // Do 11
      JU    FIN1; 
M112: L     1.200000e+001; // Do 12
      JU    FIN1; 
M113: L     1.300000e+001; // Do 13
      JU    FIN1; 
M114: L     1.400000e+001; // Do 14
      JU    FIN1; 
M115: L     1.500000e+001; // Do 15
      JU    FIN1; 
ELS1: L     1.600000e+001; // Do Else
FIN1: T     DB1381.DBD  482; 

// Chriwa Status 2
      A     I    294.0; // ERSTFILTRAT
      JC    M200; 
      A     I    294.1; // AUS
      JC    M201; 
      A     I    294.2; // BEREITSCHAFT
      JC    M202; 
      A     I    294.3; // STOP
      JC    M203; 
      A     I    294.4; // STRUNG
      JC    M204; 
      A     I    295.0; // BETRIEB
      JC    M208; 
      A     I    295.1; // ENTSPANNE
      JC    M209; 
      A     I    295.2; // ABSENKEN
      JC    M210; 
      A     I    295.3; // SPLEN LUFT
      JC    M211; 
      A     I    295.4; // SPLEN WASSER/LUFT
      JC    M212; 
      A     I    295.5; // FILTERBETTENTL.
      JC    M213; 
      A     I    295.6; // SPLEN WASSER
      JC    M214; 
      A     I    295.7; // AUFFLLEN
      JC    M215; 
      JU    ELS2; 
M200: L     0.000000e+000; // Do 0
      JU    FIN2; 
M201: L     1.000000e+000; // Do 1
      JU    FIN2; 
M202: L     2.000000e+000; // Do 2
      JU    FIN2; 
M203: L     3.000000e+000; // Do 3
      JU    FIN2; 
M204: L     4.000000e+000; // Do 4
      JU    FIN2; 
M208: L     8.000000e+000; // Do 8
      JU    FIN2; 
M209: L     9.000000e+000; // Do 9
      JU    FIN2; 
M210: L     1.000000e+001; // Do 10
      JU    FIN2; 
M211: L     1.100000e+001; // Do 11
      JU    FIN2; 
M212: L     1.200000e+001; // Do 12
      JU    FIN2; 
M213: L     1.300000e+001; // Do 13
      JU    FIN2; 
M214: L     1.400000e+001; // Do 14
      JU    FIN2; 
M215: L     1.500000e+001; // Do 15
      JU    FIN2; 
ELS2: L     1.600000e+001; // Do Else
FIN2: T     DB1381.DBD  498; 


// sequencer ----------------------------------------------------------------
      A     DB1383.DBX   43.1; 
      S     DB1383.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2380.DBX  105.4; 
      =     DB2380.DBX  185.4; 
      =     DB2380.DBX  265.4; 
      =     DB2380.DBX  425.4; 
      =     DB2380.DBX  505.4; 
      =     DB2380.DBX  585.4; 
      =     DB2380.DBX  665.4; 
      =     DB2380.DBX  745.4; 



MODE: SET   ; 

NETWORK
TITLE =RW5_G1 Gullyventil RW5

      A     #GenRel; 
      A     DB2380.DBX  106.7; 
      =     DB2380.DBX  107.6; 
NETWORK
TITLE =VE1V1 VE1V1 --> Chriwa

      A     #GenRel; 
      A     DB2380.DBX  186.7; 
      =     DB2380.DBX  187.6; 
NETWORK
TITLE =VE1V2 VE1V2 Gully

      A     #GenRel; 
      A     DB2380.DBX  266.7; 
      =     DB2380.DBX  267.6; 
NETWORK
TITLE =Chriwa_LS_Tank1 Chriwa Filter Tank 1 LS

      A     #GenRel; 
      A     DB2380.DBX  426.7; 
      =     DB2380.DBX  427.6; 
NETWORK
TITLE =Chriwa_Freigabe_Ruecksp Chriwa Filter Freigabe zum Rcksplen

      A     #GenRel; 
      A     DB2380.DBX  506.7; 
      =     DB2380.DBX  507.6; 
NETWORK
TITLE =Chriwa_Brunnen_ok Chriwa Filter Brunnen ok Meldung

      A     #GenRel; 
      A     DB2380.DBX  586.7; 
      =     DB2380.DBX  587.6; 
NETWORK
TITLE =Chriwa_Tank_Befuell_Ein Chriwa Filter Tank Befllung luft

      A     #GenRel; 
      A     DB2380.DBX  666.7; 
      =     DB2380.DBX  667.6; 
NETWORK
TITLE =Chriwa_Lebensbit Chriwa Filter 0,5Hz Lebensbit

      A     M    100.7; 
      =     DB2380.DBX  748.2; 

      A     #GenRel; 
      A     DB2380.DBX  746.7; 
      =     DB2380.DBX  747.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1390
TITLE =U039: Water Treatment 2
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1390.DBW    0; 
      T     #UnitNo; 
      L     DB1390.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// EW888 AnI 001 Chriwa Filter Durchflu Produkt
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2393.#EW888,
           ValPer                   := IW   888);

// EW890 AnI 002 Chriwa Filter Durchflu Splwasser
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2393.#EW890,
           ValPer                   := IW   890);

// EW884 AnI 003 Chriwa Filter Leitwert
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2393.#EW884,
           ValPer                   := IW   884);

// EW886 AnI 004 Chriwa Filter Trbung
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2393.#EW886,
           ValPer                   := IW   886);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2395.unv001,
           ValExt                   := DB2395.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2395.unv002,
           ValExt                   := DB2395.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// CHRIWA2_ANF_BRUNNENPUMPE SpI 001 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2391.CHRIWA2_ANF_BRUNNENPUMPE,
           SpIBit                   := I    880.3);

// CHRIWA2_BETRIEB SpI 002 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2391.CHRIWA2_BETRIEB,
           SpIBit                   := I    880.2);

// CHRIWA2_STOERUNG SpI 003 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2391.CHRIWA2_STOERUNG,
           SpIBit                   := I    880.1);

// CHRIWA2_LEBENSBIT SpI 004 Chriwa Filter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2391.CHRIWA2_LEBENSBIT,
           SpIBit                   := I    880.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2397.msg001,
           MsgBit                   := DB2397.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2397.msg002,
           MsgBit                   := DB2397.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Chriwa2_LS_Tank1  Chriwa Filter Tank 1 LS/
// Act 005
// Box           : Chriwa
// Output address: Q880.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2390.Chriwa2_LS_Tank1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    880.4);

NETWORK
TITLE =Chriwa2_Freigabe_Ruecksp  Chriwa Filter zum Rcksplen
// Act 006
// Box           : Chriwa
// Output address: Q880.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2390.Chriwa2_Freigabe_Ruecksp,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    880.3);

NETWORK
TITLE =Chriwa2_Brunnen_ok  Chriwa Filter Brunnen ok Meldung
// Act 007
// Box           : Chriwa
// Output address: Q880.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2390.Chriwa2_Brunnen_ok,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    880.2);

NETWORK
TITLE =Chriwa2_Tank_Befuell_Ein  Chriwa Filter Tank Befllung luft
// Act 008
// Box           : Chriwa
// Output address: Q880.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2390.Chriwa2_Tank_Befuell_Ein,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    880.1);

NETWORK
TITLE =Chriwa2_Lebensbit  Chriwa Filter 0,5Hz Lebensbit
// Act 009
// Box           : Chriwa
// Output address: Q880.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2390.Chriwa2_Lebensbit,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    880.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1391
TITLE =U039: Water Treatment 2
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1391.DBX 1357.7; 
      CC    FB  1399; // "U039Sim"
      A     DB1391.DBX   17.3; 
      =     DB1391.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1390.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1391.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1395.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1391.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1395; // U039Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// EW888 Chriwa Filter Durchflu Produkt
// ----------------------------------------------------------
      L     IW   888; 
      ITD   ; 
      DTR   ; 
      T     DB2393.DBD  214; 
      SET   ; 
      =     DB2393.DBX  143.5; 


      L     DB1391.DBD 1118; // !!! insert correct SFM !!!
      T     DB2393.DBD  238; 

      SET   ; 
      =     DB2393.DBX  141.5; 

// ----------------------------------------------------------
// EW890 Chriwa Filter Durchflu Splwasser
// ----------------------------------------------------------
      L     IW   890; 
      ITD   ; 
      DTR   ; 
      T     DB2393.DBD  334; 
      SET   ; 
      =     DB2393.DBX  263.5; 

      L     DB1391.DBD 1118; // !!! insert correct SFM !!!
      T     DB2393.DBD  358; 

      SET   ; 
      =     DB2393.DBX  261.5; 

// ----------------------------------------------------------
// EW884 Chriwa Filter Leitwert
// ----------------------------------------------------------
      L     IW   884; 
      ITD   ; 
      DTR   ; 
      T     DB2393.DBD  454; 
      SET   ; 
      =     DB2393.DBX  383.5; 

      L     DB1391.DBD 1118; // !!! insert correct SFM !!!
      T     DB2393.DBD  478; 

      SET   ; 
      =     DB2393.DBX  381.5; 

// ----------------------------------------------------------
// EW886 Chriwa Filter Trbung
// ----------------------------------------------------------
      L     IW   886; 
      ITD   ; 
      DTR   ; 
      T     DB2393.DBD  574; 
      SET   ; 
      =     DB2393.DBX  503.5; 

      L     DB1391.DBD 1118; // !!! insert correct SFM !!!
      T     DB2393.DBD  598; 

      SET   ; 
      =     DB2393.DBX  501.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U039UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U039UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// CHRIWA2_ANF_BRUNNENPUMPE Chriwa Filter
// ----------------------------------------------------------
      CLR   ; 
      =     DB2391.DBX   81.4; 
      =     DB2391.DBX   81.5; 

// ----------------------------------------------------------
// CHRIWA2_BETRIEB Chriwa Filter
// ----------------------------------------------------------
      CLR   ; 
      =     DB2391.DBX  141.4; 
      =     DB2391.DBX  141.5; 

// ----------------------------------------------------------
// CHRIWA2_STOERUNG Chriwa Filter
// ----------------------------------------------------------
      SET   ; 
      =     DB2391.DBX  201.4; 
      CLR   ; 
      =     DB2391.DBX  201.5; 

// ----------------------------------------------------------
// CHRIWA2_LEBENSBIT Chriwa Filter
// ----------------------------------------------------------
      SET   ; 
      =     DB2391.DBX  261.4; 
      =     DB2391.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2397.DBX   80.7; 
      =     DB2397.DBX   81.4; 

      CLR   ; 
      =     DB2397.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2397.DBX  140.7; 
      =     DB2397.DBX  141.4; 

      CLR   ; 
      =     DB2397.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Chriwa Filter Durchflu Produkt -----------------------
      L     DB2393.DBD  146; 
      T     DB1391.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Chriwa Filter Durchflu Splwasser -----------------------
      L     DB2393.DBD  266; 
      T     DB1391.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Chriwa Filter Leitwert -----------------------
      L     DB2393.DBD  386; 
      T     DB1391.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Chriwa Filter Trbung -----------------------
      L     DB2393.DBD  506; 
      T     DB1391.DBD 1122; // !!! insert correct SFM !!!


// Chriwa Status 1
      A     I    892.0; // ERSTFILTRAT
      JC    M100; 
      A     I    892.1; // AUS
      JC    M101; 
      A     I    892.2; // BEREITSCHAFT
      JC    M102; 
      A     I    892.3; // STOP
      JC    M103; 
      A     I    892.4; // STRUNG
      JC    M104; 
      A     I    893.0; // BETRIEB
      JC    M108; 
      A     I    893.1; // ENTSPANNE
      JC    M109; 
      A     I    893.2; // ABSENKEN
      JC    M110; 
      A     I    893.3; // SPLEN LUFT
      JC    M111; 
      A     I    893.4; // SPLEN WASSER/LUFT
      JC    M112; 
      A     I    893.5; // FILTERBETTENTL.
      JC    M113; 
      A     I    893.6; // SPLEN WASSER
      JC    M114; 
      A     I    893.7; // AUFFLLEN
      JC    M115; 
      JU    ELS1; 
M100: L     0.000000e+000; // Do 0
      JU    FIN1; 
M101: L     1.000000e+000; // Do 1
      JU    FIN1; 
M102: L     2.000000e+000; // Do 2
      JU    FIN1; 
M103: L     3.000000e+000; // Do 3
      JU    FIN1; 
M104: L     4.000000e+000; // Do 4
      JU    FIN1; 
M108: L     8.000000e+000; // Do 8
      JU    FIN1; 
M109: L     9.000000e+000; // Do 9
      JU    FIN1; 
M110: L     1.000000e+001; // Do 10
      JU    FIN1; 
M111: L     1.100000e+001; // Do 11
      JU    FIN1; 
M112: L     1.200000e+001; // Do 12
      JU    FIN1; 
M113: L     1.300000e+001; // Do 13
      JU    FIN1; 
M114: L     1.400000e+001; // Do 14
      JU    FIN1; 
M115: L     1.500000e+001; // Do 15
      JU    FIN1; 
ELS1: L     1.600000e+001; // Do Else
FIN1: T     DB1391.DBD  482; 

// Chriwa Status 2
      A     I    894.0; // ERSTFILTRAT
      JC    M200; 
      A     I    894.1; // AUS
      JC    M201; 
      A     I    894.2; // BEREITSCHAFT
      JC    M202; 
      A     I    894.3; // STOP
      JC    M203; 
      A     I    894.4; // STRUNG
      JC    M204; 
      A     I    895.0; // BETRIEB
      JC    M208; 
      A     I    895.1; // ENTSPANNE
      JC    M209; 
      A     I    895.2; // ABSENKEN
      JC    M210; 
      A     I    895.3; // SPLEN LUFT
      JC    M211; 
      A     I    895.4; // SPLEN WASSER/LUFT
      JC    M212; 
      A     I    895.5; // FILTERBETTENTL.
      JC    M213; 
      A     I    895.6; // SPLEN WASSER
      JC    M214; 
      A     I    895.7; // AUFFLLEN
      JC    M215; 
      JU    ELS2; 
M200: L     0.000000e+000; // Do 0
      JU    FIN2; 
M201: L     1.000000e+000; // Do 1
      JU    FIN2; 
M202: L     2.000000e+000; // Do 2
      JU    FIN2; 
M203: L     3.000000e+000; // Do 3
      JU    FIN2; 
M204: L     4.000000e+000; // Do 4
      JU    FIN2; 
M208: L     8.000000e+000; // Do 8
      JU    FIN2; 
M209: L     9.000000e+000; // Do 9
      JU    FIN2; 
M210: L     1.000000e+001; // Do 10
      JU    FIN2; 
M211: L     1.100000e+001; // Do 11
      JU    FIN2; 
M212: L     1.200000e+001; // Do 12
      JU    FIN2; 
M213: L     1.300000e+001; // Do 13
      JU    FIN2; 
M214: L     1.400000e+001; // Do 14
      JU    FIN2; 
M215: L     1.500000e+001; // Do 15
      JU    FIN2; 
ELS2: L     1.600000e+001; // Do Else
FIN2: T     DB1391.DBD  498; 


// sequencer ----------------------------------------------------------------
      A     DB1393.DBX   43.1; 
      S     DB1393.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2390.DBX  105.4; 
      =     DB2390.DBX  185.4; 
      =     DB2390.DBX  265.4; 
      =     DB2390.DBX  425.4; 
      =     DB2390.DBX  505.4; 
      =     DB2390.DBX  585.4; 
      =     DB2390.DBX  665.4; 
      =     DB2390.DBX  745.4; 



MODE: SET   ; 

NETWORK
TITLE =RW6_G1 Gullyventil RW6

      A     #GenRel; 
      A     DB2390.DBX  106.7; 
      =     DB2390.DBX  107.6; 
NETWORK
TITLE =VE2V1 VE2V1 --> Chriwa

      A     #GenRel; 
      A     DB2390.DBX  186.7; 
      =     DB2390.DBX  187.6; 
NETWORK
TITLE =VE2V2 VE2V2 Gully

      A     #GenRel; 
      A     DB2390.DBX  266.7; 
      =     DB2390.DBX  267.6; 
NETWORK
TITLE =Chriwa2_LS_Tank1 Chriwa Filter Tank 1 LS/

      A     #GenRel; 
      A     DB2390.DBX  426.7; 
      =     DB2390.DBX  427.6; 
NETWORK
TITLE =Chriwa2_Freigabe_Ruecksp Chriwa Filter zum Rcksplen

      A     #GenRel; 
      A     DB2390.DBX  506.7; 
      =     DB2390.DBX  507.6; 
NETWORK
TITLE =Chriwa2_Brunnen_ok Chriwa Filter Brunnen ok Meldung

      A     #GenRel; 
      A     DB2390.DBX  586.7; 
      =     DB2390.DBX  587.6; 
NETWORK
TITLE =Chriwa2_Tank_Befuell_Ein Chriwa Filter Tank Befllung luft

      A     #GenRel; 
      A     DB2390.DBX  666.7; 
      =     DB2390.DBX  667.6; 
NETWORK
TITLE =Chriwa2_Lebensbit Chriwa Filter 0,5Hz Lebensbit

      A     M    100.7; 
      =     DB2390.DBX  748.2; 

      A     #GenRel; 
      A     DB2390.DBX  746.7; 
      =     DB2390.DBX  747.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1400
TITLE =U040: Water Treatment General
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1400.DBW    0; 
      T     #UnitNo; 
      L     DB1400.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2405.unv001,
           ValExt                   := DB2405.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2405.unv002,
           ValExt                   := DB2405.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// RM_VEE_P1 SpI 001 UEBERGABEKONTAKTE VON LT
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2401.RM_VEE_P1,
           SpIBit                   := I    108.3);

// RM_VEE_P2 SpI 002 UEBERGABEKONTAKTE VON LT
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2401.RM_VEE_P2,
           SpIBit                   := I    108.4);

// BETR_BRUNNEN_7 SpI 003 MELDUNG VON VEE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2401.BETR_BRUNNEN_7,
           SpIBit                   := I     14.0);

// BETR_BRUNNEN_2B SpI 004 MELDUNG VON VEE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2401.BETR_BRUNNEN_2B,
           SpIBit                   := I     14.1);

// BETR_BRUNNEN_3 SpI 005 MELDUNG VON VEE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2401.BETR_BRUNNEN_3,
           SpIBit                   := I     14.2);

// BETR_BRUNNEN_2A SpI 006 MELDUNG VON VEE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2401.BETR_BRUNNEN_2A,
           SpIBit                   := I     14.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2407.msg001,
           MsgBit                   := DB2407.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2407.msg002,
           MsgBit                   := DB2407.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1401
TITLE =U040: Water Treatment General
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1401.DBX 1357.7; 
      CC    FB  1409; // "U040Sim"
      A     DB1401.DBX   17.3; 
      =     DB1401.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1400.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1401.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1405.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1401.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1405; // U040Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U040UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U040UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// RM_VEE_P1 UEBERGABEKONTAKTE VON LT
// ----------------------------------------------------------
      SET   ; 
      =     DB2401.DBX   81.4; 
      =     DB2401.DBX   81.5; 

// ----------------------------------------------------------
// RM_VEE_P2 UEBERGABEKONTAKTE VON LT
// ----------------------------------------------------------
      SET   ; 
      =     DB2401.DBX  141.4; 
      =     DB2401.DBX  141.5; 

// ----------------------------------------------------------
// BETR_BRUNNEN_7 MELDUNG VON VEE
// ----------------------------------------------------------
      SET   ; 
      =     DB2401.DBX  201.4; 
      =     DB2401.DBX  201.5; 

// ----------------------------------------------------------
// BETR_BRUNNEN_2B MELDUNG VON VEE
// ----------------------------------------------------------
      SET   ; 
      =     DB2401.DBX  261.4; 
      =     DB2401.DBX  261.5; 

// ----------------------------------------------------------
// BETR_BRUNNEN_3 MELDUNG VON VEE
// ----------------------------------------------------------
      SET   ; 
      =     DB2401.DBX  321.4; 
      =     DB2401.DBX  321.5; 

// ----------------------------------------------------------
// BETR_BRUNNEN_2A MELDUNG VON VEE
// ----------------------------------------------------------
      SET   ; 
      =     DB2401.DBX  381.4; 
      =     DB2401.DBX  381.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2407.DBX   80.7; 
      =     DB2407.DBX   81.4; 

      CLR   ; 
      =     DB2407.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2407.DBX  140.7; 
      =     DB2407.DBX  141.4; 

      CLR   ; 
      =     DB2407.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1403.DBX   43.1; 
      S     DB1403.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 




MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1430
TITLE =U043: Water Transfer Plant 3
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1430.DBW    0; 
      T     #UnitNo; 
      L     DB1430.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2435.unv001,
           ValExt                   := DB2435.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2435.unv002,
           ValExt                   := DB2435.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2435.unv003,
           ValExt                   := DB2435.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2435.unv004,
           ValExt                   := DB2435.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// RM_KEG_V14 SpI 001 KEG_V14
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2431.RM_KEG_V14,
           SpIBit                   := I     33.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2437.msg001,
           MsgBit                   := DB2437.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2437.msg002,
           MsgBit                   := DB2437.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2437.msg003,
           MsgBit                   := DB2437.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =KEG_RWP  KEG Reinwasserpumpe Freigabe (dummy)
// Act 001
// Box           : S6 U6.3
// Input address : I6.5
// Output address: Q6.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2430.Act1,
           Typ                      := 0,//3 (RM wechselt nicht)
           FBa                      := #xTmp,
           FBa2                     := I      6.5,
           Out                      := Q      6.5);

NETWORK
TITLE =KEG_V11  KEG_V11
// Act 002
// Box           : VS-KEG
// Input address : I32.6
// Output address: Q32.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2430.KEG_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     32.6,
           Out                      := Q     32.6);

NETWORK
TITLE =KEG_V12  KEG_V12
// Act 003
// Box           : VS-KEG
// Input address : I32.7
// Output address: Q32.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2430.KEG_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     32.7,
           Out                      := Q     32.7);

NETWORK
TITLE =KEG_V13  KEG_V13
// Act 004
// Box           : VS-KEG
// Input address : I33.0
// Output address: Q33.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2430.KEG_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     33.0,
           Out                      := Q     33.0);

NETWORK
TITLE =KEG_RV2  
// Act 006
// Box           : Ventilinsel 5
// Input address : I339.7
// Output address: Q339.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2430.KEG_RV2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.7,
           Out                      := Q    339.7);

NETWORK
TITLE =U43_Act010  
// Act 010
// Box           : 
// Output address: #DummyBool
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2430.U43_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1431
TITLE =U043: Water Transfer Plant 3
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1431.DBX 1357.7; 
      CC    FB  1439; // "U043Sim"
      A     DB1431.DBX   17.3; 
      =     DB1431.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1430.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1435; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1435.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1431.Seq.SFM[15],
           ValueOld                 := DB1431.DBD 1418);

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1435.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1431.Seq.SFM[15],
           ValueOld                 := DB1431.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1433.DBX   43.1; 
      S     DB1433.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1450
TITLE =U045: Water Transfer Plant 5
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1450.DBW    0; 
      T     #UnitNo; 
      L     DB1450.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2455.unv001,
           ValExt                   := DB2455.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2455.unv002,
           ValExt                   := DB2455.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2455.unv003,
           ValExt                   := DB2455.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2455.unv004,
           ValExt                   := DB2455.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U45_SpI001 SpI 001 spare
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U045SpID".U45_SpI001
//       SpIBit:=#xTmp

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2457.msg001,
           MsgBit                   := DB2457.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2457.msg002,
           MsgBit                   := DB2457.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2457.msg003,
           MsgBit                   := DB2457.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.Act1,
           Typ                      := 0,
           FBa                      := I    199.1,
           FBa2                     := #xTmp,
           Out                      := Q    199.1);

NETWORK
TITLE =A5_V11  Filter A5 V11
// Act 002
// Box           : VSA5
// Input address : I192.6
// Output address: Q192.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.A5_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    192.6,
           Out                      := Q    192.6);

NETWORK
TITLE =A5_V12  Filter A5 V12
// Act 003
// Box           : VSA5
// Input address : I192.7
// Output address: Q192.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.A5_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    192.7,
           Out                      := Q    192.7);

NETWORK
TITLE =A5_V13  Filter A5 V13
// Act 004
// Box           : VSA5
// Input address : I193.0
// Output address: Q193.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.A5_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    193.0,
           Out                      := Q    193.0);

NETWORK
TITLE =RV1_A5  
// Act 005
// Box           : Ventilinsel 3
// Input address : I327.5
// Output address: Q327.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.RV1_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.5,
           Out                      := Q    327.5);

NETWORK
TITLE =RV2_A5  
// Act 006
// Box           : Ventilinsel 3
// Input address : I327.6
// Output address: Q327.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.RV2_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.6,
           Out                      := Q    327.6);

NETWORK
TITLE =RV3_A5  
// Act 007
// Box           : Ventilinsel 3
// Input address : I327.7
// Output address: Q327.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.RV3_A5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    327.7,
           Out                      := Q    327.7);

NETWORK
TITLE =VR_V1  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.3
// Output address: Q336.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.VR_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.3,
           Out                      := Q    336.3);

NETWORK
TITLE =U45_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2450.U45_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1451
TITLE =U045: Water Transfer Plant 5
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1451.DBX 1357.7; 
      CC    FB  1459; // "U045Sim"
      A     DB1451.DBX   17.3; 
      =     DB1451.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1450.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1455; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1455.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1451.Seq.SFM[15],
           ValueOld                 := DB1451.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1453.DBX   43.1; 
      S     DB1453.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1470
TITLE =U047: Water Transfer Plant 7
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1470.DBW    0; 
      T     #UnitNo; 
      L     DB1470.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2475.unv001,
           ValExt                   := DB2475.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2475.unv002,
           ValExt                   := DB2475.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2475.unv003,
           ValExt                   := DB2475.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2475.unv004,
           ValExt                   := DB2475.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U47_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2471.U47_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2477.msg001,
           MsgBit                   := DB2477.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2477.msg002,
           MsgBit                   := DB2477.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2477.msg003,
           MsgBit                   := DB2477.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.Act1,
           Typ                      := 0,
           FBa                      := I     59.1,
           FBa2                     := #xTmp,
           Out                      := Q     59.1);

NETWORK
TITLE =A7_V11  Filter Anlage 7
// Act 002
// Box           : VSA7
// Input address : I24.6
// Output address: Q46.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.A7_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     24.6,
           Out                      := Q     46.6);

NETWORK
TITLE =A7_V12  Filter Anlage 7
// Act 003
// Box           : VSA7
// Input address : I24.7
// Output address: Q46.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.A7_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     24.7,
           Out                      := Q     46.7);

NETWORK
TITLE =A7_V13  Filter Anlage 7
// Act 004
// Box           : VSA7
// Input address : I25.0
// Output address: Q47.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.A7_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     25.0,
           Out                      := Q     47.0);

NETWORK
TITLE =RV1_A7  
// Act 005
// Box           : Ventilinsel 2
// Input address : I323.5
// Output address: Q323.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.RV1_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.5,
           Out                      := Q    323.5);

NETWORK
TITLE =RV2_A7  
// Act 006
// Box           : Ventilinsel 2
// Input address : I323.6
// Output address: Q323.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.RV2_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.6,
           Out                      := Q    323.6);

NETWORK
TITLE =RV3_A7  
// Act 007
// Box           : Ventilinsel 2
// Input address : I323.7
// Output address: Q323.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.RV3_A7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    323.7,
           Out                      := Q    323.7);

NETWORK
TITLE =VR_V3  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.5
// Output address: Q336.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.VR_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.5,
           Out                      := Q    336.5);

NETWORK
TITLE =U47_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2470.U47_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1471
TITLE =U047: Water Transfer Plant 7
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1471.DBX 1357.7; 
      CC    FB  1479; // "U047Sim"
      A     DB1471.DBX   17.3; 
      =     DB1471.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1470.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1475; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1475.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1471.Seq.SFM[15],
           ValueOld                 := DB1471.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1473.DBX   43.1; 
      S     DB1473.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1480
TITLE =U048: Water Transfer Plant 8
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1480.DBW    0; 
      T     #UnitNo; 
      L     DB1480.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2485.unv001,
           ValExt                   := DB2485.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2485.unv002,
           ValExt                   := DB2485.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2485.unv003,
           ValExt                   := DB2485.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2485.unv004,
           ValExt                   := DB2485.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U48_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2481.U48_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2487.msg001,
           MsgBit                   := DB2487.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2487.msg002,
           MsgBit                   := DB2487.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2487.msg003,
           MsgBit                   := DB2487.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Pumpe
// Act 005
// Box           : Ventilinsel 3
// Input address : I325.5
// Output address: Q325.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2480.Act1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =RV1_A8  
// Act 005
// Box           : Ventilinsel 3
// Input address : I325.5
// Output address: Q325.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2480.RV1_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.5,
           Out                      := Q    325.5);

NETWORK
TITLE =RV2_A8  
// Act 006
// Box           : Ventilinsel 3
// Input address : I325.6
// Output address: Q325.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2480.RV2_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.6,
           Out                      := Q    325.6);

NETWORK
TITLE =RV3_A8  
// Act 007
// Box           : Ventilinsel 3
// Input address : I325.7
// Output address: Q325.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2480.RV3_A8,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    325.7,
           Out                      := Q    325.7);

NETWORK
TITLE =VR_V2  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.4
// Output address: Q336.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2480.VR_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.4,
           Out                      := Q    336.4);

NETWORK
TITLE =U48_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2480.U48_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1481
TITLE =U048: Water Transfer Plant 8
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1481.DBX 1357.7; 
      CC    FB  1489; // "U048Sim"
      A     DB1481.DBX   17.3; 
      =     DB1481.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1480.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1485; // U048Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB1483.DBX   43.1; 
      S     DB1483.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1490
TITLE =U049: Water Transfer Plant 9
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1490.DBW    0; 
      T     #UnitNo; 
      L     DB1490.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2495.unv001,
           ValExt                   := DB2495.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2495.unv002,
           ValExt                   := DB2495.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2495.unv003,
           ValExt                   := DB2495.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2495.unv004,
           ValExt                   := DB2495.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U49_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2491.U49_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2497.msg001,
           MsgBit                   := DB2497.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2497.msg002,
           MsgBit                   := DB2497.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2497.msg003,
           MsgBit                   := DB2497.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.Act1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     41.1);

NETWORK
TITLE =A9_V11  Ventil Filter Anlage 9
// Act 002
// Box           : VSRR1-3
// Input address : I85.4
// Output address: Q85.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.A9_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.4,
           Out                      := Q     85.4);

NETWORK
TITLE =A9_V12  Ventil Filter Anlage 9
// Act 003
// Box           : VSRR1-3
// Input address : I85.5
// Output address: Q85.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.A9_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.5,
           Out                      := Q     85.5);

NETWORK
TITLE =A9_V13  Ventil Filter Anlage 9
// Act 004
// Box           : VSRR1-3
// Input address : I85.6
// Output address: Q85.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.A9_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.6,
           Out                      := Q     85.6);

NETWORK
TITLE =RV1_A9  
// Act 005
// Box           : Ventilinsel 2
// Input address : I319.5
// Output address: Q319.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.RV1_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.5,
           Out                      := Q    319.5);

NETWORK
TITLE =RV2_A9  
// Act 006
// Box           : Ventilinsel 2
// Input address : I319.6
// Output address: Q319.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.RV2_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.6,
           Out                      := Q    319.6);

NETWORK
TITLE =RV3_A9  
// Act 007
// Box           : Ventilinsel 2
// Input address : I319.7
// Output address: Q319.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.RV3_A9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    319.7,
           Out                      := Q    319.7);

NETWORK
TITLE =VR_V5  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.7
// Output address: Q336.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.VR_V5,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.7,
           Out                      := Q    336.7);

NETWORK
TITLE =U49_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2490.U49_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1491
TITLE =U049: Water Transfer Plant 9
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1491.DBX 1357.7; 
      CC    FB  1499; // "U049Sim"
      A     DB1491.DBX   17.3; 
      =     DB1491.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1490.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1495; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1495.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1491.Seq.SFM[15],
           ValueOld                 := DB1491.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1493.DBX   43.1; 
      S     DB1493.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1500
TITLE =U050: Water Transfer Plant 10
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1500.DBW    0; 
      T     #UnitNo; 
      L     DB1500.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2505.unv001,
           ValExt                   := DB2505.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2505.unv002,
           ValExt                   := DB2505.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2505.unv003,
           ValExt                   := DB2505.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2505.unv004,
           ValExt                   := DB2505.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U50_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2501.U50_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2507.msg001,
           MsgBit                   := DB2507.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2507.msg002,
           MsgBit                   := DB2507.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2507.msg003,
           MsgBit                   := DB2507.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.Act1,
           Typ                      := 0,
           FBa                      := I     41.5,
           FBa2                     := #xTmp,
           Out                      := Q     41.5);

NETWORK
TITLE =A10_V11  Ventil Filter Anlage 10
// Act 002
// Box           : VSRR1-3
// Input address : I85.1
// Output address: Q85.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.A10_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.1,
           Out                      := Q     85.1);

NETWORK
TITLE =A10_V12  Ventil Filter Anlage 10
// Act 003
// Box           : VSRR1-3
// Input address : I85.2
// Output address: Q85.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.A10_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.2,
           Out                      := Q     85.2);

NETWORK
TITLE =A10_V13  Ventil Filter Anlage 10
// Act 004
// Box           : VSRR1-3
// Input address : I85.3
// Output address: Q85.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.A10_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.3,
           Out                      := Q     85.3);

NETWORK
TITLE =RV1_A10  
// Act 005
// Box           : Ventilinsel 2
// Input address : I317.5
// Output address: Q317.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.RV1_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.5,
           Out                      := Q    317.5);

NETWORK
TITLE =RV2_A10  
// Act 006
// Box           : Ventilinsel 2
// Input address : I317.6
// Output address: Q317.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.RV2_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.6,
           Out                      := Q    317.6);

NETWORK
TITLE =RV3_A10  
// Act 007
// Box           : Ventilinsel 2
// Input address : I317.7
// Output address: Q317.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.RV3_A10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    317.7,
           Out                      := Q    317.7);

NETWORK
TITLE =VR_V6  
// Act 008
// Box           : Ventilinsel 4
// Input address : I337.0
// Output address: Q337.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.VR_V6,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    337.0,
           Out                      := Q    337.0);

NETWORK
TITLE =U50_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2500.U50_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1501
TITLE =U050: Water Transfer Plant 10
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1501.DBX 1357.7; 
      CC    FB  1509; // "U050Sim"
      A     DB1501.DBX   17.3; 
      =     DB1501.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1500.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1505; // U050Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1505.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1501.Seq.SFM[15],
           ValueOld                 := DB1501.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1503.DBX   43.1; 
      S     DB1503.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1510
TITLE =U051: Water Transfer Plant 11
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1510.DBW    0; 
      T     #UnitNo; 
      L     DB1510.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2515.unv001,
           ValExt                   := DB2515.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2515.unv002,
           ValExt                   := DB2515.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2515.unv003,
           ValExt                   := DB2515.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2515.unv004,
           ValExt                   := DB2515.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U51_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2511.U51_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2517.msg001,
           MsgBit                   := DB2517.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2517.msg002,
           MsgBit                   := DB2517.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2517.msg003,
           MsgBit                   := DB2517.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.Act1,
           Typ                      := 0,
           FBa                      := I    171.1,
           FBa2                     := #xTmp,
           Out                      := Q    171.1);

NETWORK
TITLE =A11_V11  A11 V11
// Act 002
// Box           : VSA11
// Input address : I174.6
// Output address: Q174.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.A11_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    174.6,
           Out                      := Q    174.6);

NETWORK
TITLE =A11_V12  A11 V12
// Act 003
// Box           : VSA11
// Input address : I174.7
// Output address: Q174.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.A11_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    174.7,
           Out                      := Q    174.7);

NETWORK
TITLE =A11_V13  A11 V13
// Act 004
// Box           : VSA11
// Input address : I175.0
// Output address: Q175.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.A11_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    175.0,
           Out                      := Q    175.0);

NETWORK
TITLE =RV1_A11  
// Act 005
// Box           : Ventilinsel 3
// Input address : I329.5
// Output address: Q329.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.RV1_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.5,
           Out                      := Q    329.5);

NETWORK
TITLE =RV2_A11  
// Act 006
// Box           : Ventilinsel 3
// Input address : I329.6
// Output address: Q329.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.RV2_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.6,
           Out                      := Q    329.6);

NETWORK
TITLE =RV3_A11  
// Act 007
// Box           : Ventilinsel 3
// Input address : I329.7
// Output address: Q329.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.RV3_A11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    329.7,
           Out                      := Q    329.7);

NETWORK
TITLE =VR_V10  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.2
// Output address: Q336.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.VR_V10,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.2,
           Out                      := Q    336.2);

NETWORK
TITLE =VR_V7  
// Act 009
// Box           : Ventilinsel 4
// Input address : I337.1
// Output address: Q337.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.VR_V7,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    337.1,
           Out                      := Q    337.1);

NETWORK
TITLE =U51_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2510.U51_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1511
TITLE =U051: Water Transfer Plant 11
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1511.DBX 1357.7; 
      CC    FB  1519; // "U051Sim"
      A     DB1511.DBX   17.3; 
      =     DB1511.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1510.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1515; // U051Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1515.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1511.Seq.SFM[15],
           ValueOld                 := DB1511.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1513.DBX   43.1; 
      S     DB1513.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1520
TITLE =U052: Water Transfer Plant 12
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1520.DBW    0; 
      T     #UnitNo; 
      L     DB1520.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2525.unv001,
           ValExt                   := DB2525.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2525.unv002,
           ValExt                   := DB2525.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2525.unv003,
           ValExt                   := DB2525.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2525.unv004,
           ValExt                   := DB2525.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U52_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2521.U52_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2527.msg001,
           MsgBit                   := DB2527.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2527.msg002,
           MsgBit                   := DB2527.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2527.msg003,
           MsgBit                   := DB2527.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.Act1,
           Typ                      := 0,
           FBa                      := I    271.1,
           FBa2                     := #xTmp,
           Out                      := Q    271.1);

NETWORK
TITLE =A12_V11  A12 V11
// Act 002
// Box           : VSA12
// Input address : I260.6
// Output address: Q260.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.A12_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    260.6,
           Out                      := Q    260.6);

NETWORK
TITLE =A12_V12  A12 V12
// Act 003
// Box           : VSA12
// Input address : I260.7
// Output address: Q260.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.A12_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    260.7,
           Out                      := Q    260.7);

NETWORK
TITLE =A12_V13  A12 V13
// Act 004
// Box           : VSA12
// Input address : I261.0
// Output address: Q261.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.A12_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    261.0,
           Out                      := Q    261.0);

NETWORK
TITLE =RV1_A12  
// Act 005
// Box           : Ventilinsel 2
// Input address : I321.5
// Output address: Q321.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.RV1_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.5,
           Out                      := Q    321.5);

NETWORK
TITLE =RV2_A12  
// Act 006
// Box           : Ventilinsel 2
// Input address : I321.6
// Output address: Q321.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.RV2_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.6,
           Out                      := Q    321.6);

NETWORK
TITLE =RV3_A12  
// Act 007
// Box           : Ventilinsel 2
// Input address : I321.7
// Output address: Q321.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.RV3_A12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    321.7,
           Out                      := Q    321.7);

NETWORK
TITLE =VR_V4  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.6
// Output address: Q336.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.VR_V4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.6,
           Out                      := Q    336.6);

NETWORK
TITLE =U52_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2520.U52_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1521
TITLE =U052: Water Transfer Plant 12
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1521.DBX 1357.7; 
      CC    FB  1529; // "U052Sim"
      A     DB1521.DBX   17.3; 
      =     DB1521.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1520.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1525; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1525.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1521.Seq.SFM[15],
           ValueOld                 := DB1521.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1523.DBX   43.1; 
      S     DB1523.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1540
TITLE =U054: Water Transfer Plant 14
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1540.DBW    0; 
      T     #UnitNo; 
      L     DB1540.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2545.unv001,
           ValExt                   := DB2545.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2545.unv002,
           ValExt                   := DB2545.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2545.unv003,
           ValExt                   := DB2545.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2545.unv004,
           ValExt                   := DB2545.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U54_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2541.U54_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2547.msg001,
           MsgBit                   := DB2547.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2547.msg002,
           MsgBit                   := DB2547.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2547.msg003,
           MsgBit                   := DB2547.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.Act1,
           Typ                      := 0,
           FBa                      := I      6.0,
           FBa2                     := #xTmp,
           Out                      := Q      6.0);

NETWORK
TITLE =A14_V11  
// Act 002
// Box           : VSA14
// Input address : I96.6
// Output address: Q96.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.A14_V11,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     96.6,
           Out                      := Q     96.6);

NETWORK
TITLE =A14_V12  
// Act 003
// Box           : VSA14
// Input address : I96.7
// Output address: Q96.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.A14_V12,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     96.7,
           Out                      := Q     96.7);

NETWORK
TITLE =A14_V13  
// Act 004
// Box           : VSA14
// Input address : I97.0
// Output address: Q97.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.A14_V13,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     97.0,
           Out                      := Q     97.0);

NETWORK
TITLE =RV1_A14  
// Act 005
// Box           : Ventilinsel 4
// Input address : I331.5
// Output address: Q331.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.RV1_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.5,
           Out                      := Q    331.5);

NETWORK
TITLE =RV2_A14  
// Act 006
// Box           : Ventilinsel 4
// Input address : I331.6
// Output address: Q331.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.RV2_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.6,
           Out                      := Q    331.6);

NETWORK
TITLE =RV3_A14  
// Act 007
// Box           : Ventilinsel 4
// Input address : I331.7
// Output address: Q331.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.RV3_A14,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    331.7,
           Out                      := Q    331.7);

NETWORK
TITLE =VR_V9  
// Act 008
// Box           : Ventilinsel 4
// Input address : I336.1
// Output address: Q336.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.VR_V9,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    336.1,
           Out                      := Q    336.1);

NETWORK
TITLE =VR_V8  
// Act 009
// Box           : Ventilinsel 4
// Input address : I336.0
// Output address: Q336.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.VR_V8,
           Typ                      := 0,//1
           FBa                      := #xTmp,
           FBa2                     := I    336.0,
           Out                      := Q    336.0);

NETWORK
TITLE =A14_V14  
// Act 010
// Box           : VSA14
// Input address : I97.1
// Output address: Q97.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2540.A14_V14,
           Typ                      := 0,//1
           FBa                      := #xTmp,
           FBa2                     := I     97.1,
           Out                      := Q     97.1);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1541
TITLE =U054: Water Transfer Plant 14
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1541.DBX 1357.7; 
      CC    FB  1549; // "U054Sim"
      A     DB1541.DBX   17.3; 
      =     DB1541.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1540.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1545; // U054Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1545.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1541.Seq.SFM[15],
           ValueOld                 := DB1541.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1543.DBX   43.1; 
      S     DB1543.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Werte an Mixer



END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1550
TITLE =U055: Water Transfer Plant 15
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1550.DBW    0; 
      T     #UnitNo; 
      L     DB1550.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2555.unv001,
           ValExt                   := DB2555.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2555.unv002,
           ValExt                   := DB2555.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2555.unv003,
           ValExt                   := DB2555.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2555.unv004,
           ValExt                   := DB2555.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U55_SpI001 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2551.U55_SpI001,
           SpIBit                   := #xTmp);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2557.msg001,
           MsgBit                   := DB2557.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2557.msg002,
           MsgBit                   := DB2557.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2557.msg003,
           MsgBit                   := DB2557.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =Act1  Wasserpumpe
// Act 001
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2550.Act1,
           Typ                      := 3,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =RV1_A15  
// Act 005
// Box           : Ventilinsel 4
// Input address : I333.5
// Output address: Q333.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2550.RV1_A15,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    333.5,
           Out                      := Q    333.5);

NETWORK
TITLE =RV2_A15  
// Act 006
// Box           : Ventilinsel 4
// Input address : I333.6
// Output address: Q333.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2550.RV2_A15,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    333.6,
           Out                      := Q    333.6);

NETWORK
TITLE =RV3_A15  
// Act 007
// Box           : Ventilinsel 4
// Input address : I333.7
// Output address: Q333.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2550.RV3_A15,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    333.7,
           Out                      := Q    333.7);

NETWORK
TITLE =U55_Act010  spare
// Act 010
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2550.U55_Act010,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1551
TITLE =U055: Water Transfer Plant 15
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1551.DBX 1357.7; 
      CC    FB  1559; // "U055Sim"
      A     DB1551.DBX   17.3; 
      =     DB1551.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1550.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  1555; // U055Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1555.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1551.Seq.SFM[15],
           ValueOld                 := DB1551.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1553.DBX   43.1; 
      S     DB1553.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1560
TITLE =U056: Fresh Water Transfer
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1560.DBW    0; 
      T     #UnitNo; 
      L     DB1560.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2565.unv001,
           ValExt                   := DB2565.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2565.unv002,
           ValExt                   := DB2565.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2565.unv003,
           ValExt                   := DB2565.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2565.unv004,
           ValExt                   := DB2565.DBD  618);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2567.msg001,
           MsgBit                   := DB2567.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2567.msg002,
           MsgBit                   := DB2567.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2567.msg003,
           MsgBit                   := DB2567.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =FW_P1  FWP1 Pumpe Frischwasser
// Act 001
// Box           : S6 U6.3
// Input address : I6.7
// Output address: Q6.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2560.FW_P1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      6.7,
           Out                      := Q      6.7);

NETWORK
TITLE =FW_RV2  
// Act 006
// Box           : Ventilinsel 5
// Input address : I339.5
// Output address: Q339.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2560.FW_RV2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.5,
           Out                      := Q    339.5);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1561
TITLE =U056: Fresh Water Transfer
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1561.DBX 1357.7; 
      CC    FB  1569; // "U056Sim"
      A     DB1561.DBX   17.3; 
      =     DB1561.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1560.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1561.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1565.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1561.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1565; // U056Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U056UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U056UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U056UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U056UnVD".unv004.ValExt

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2567.DBX   80.7; 
      =     DB2567.DBX   81.4; 

      CLR   ; 
      =     DB2567.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2567.DBX  140.7; 
      =     DB2567.DBX  141.4; 

      CLR   ; 
      =     DB2567.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2567.DBX  200.7; 
      =     DB2567.DBX  201.4; 

      CLR   ; 
      =     DB2567.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1563.DBX   43.1; 
      S     DB1563.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2560.DBX  105.4; 
      =     DB2560.DBX  505.4; 


MODE: SET   ; 

NETWORK
TITLE =FW_P1 FWP1 Pumpe Frischwasser

      A     #GenRel; 
      A     DB2560.DBX  106.7; 
      =     DB2560.DBX  107.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1570
TITLE =U057: Water Transfer Brewhouse
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1570.DBW    0; 
      T     #UnitNo; 
      L     DB1570.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2575.unv001,
           ValExt                   := DB2575.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2575.unv002,
           ValExt                   := DB2575.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2575.unv003,
           ValExt                   := DB2575.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2575.unv004,
           ValExt                   := DB2575.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// AB_SH_DT_LAMPEN_PRUEFEN SpI 002 AUSSENBEDIENUNG SUDHAUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2571.AB_SH_DT_LAMPEN_PRUEFEN,
           SpIBit                   := I     14.5);

// AB_SH_LDT_WASSER_OPUMP SpI 003 AUSSENBEDIENUNG SUDHAUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2571.AB_SH_LDT_WASSER_OPUMP,
           SpIBit                   := I     14.6);

// AB_SH_LDT_WASSER_MPUMP SpI 004 AUSSEN SUDHAUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2571.AB_SH_LDT_WASSER_MPUMP,
           SpIBit                   := I     15.3);

// AB_SH_DT_START SpI 005 AUSSENBEDIENUNG SUDHAUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2571.AB_SH_DT_START,
           SpIBit                   := I     15.6);

// AB_SH_DT_STOP SpI 006 AUSSENBEDIENUNG SUDHAUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2571.AB_SH_DT_STOP,
           SpIBit                   := I     15.7);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2577.msg001,
           MsgBit                   := DB2577.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2577.msg002,
           MsgBit                   := DB2577.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2577.msg003,
           MsgBit                   := DB2577.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =SH_P1  SHP1
// Act 001
// Box           : S6 U6.3
// Input address : I6.4
// Output address: Q6.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2570.SH_P1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      6.4,
           Out                      := Q      6.4);

NETWORK
TITLE =AB_SH_LAMPE_LDT_WASSOP  Lampe AUSSEN SUDHAUS (ohne Pumpe)
// Act 002
// Box           : S6 U6.3
// Output address: Q14.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2570.AB_SH_LAMPE_LDT_WASSOP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     14.6);

NETWORK
TITLE =AB_SH_LAMPE_FREIGWASSER  Lampe AUSSENBEDIENUNG SUDHAUS (Freigabe
// Act 003
// Box           : S6 U6.3
// Output address: Q14.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2570.AB_SH_LAMPE_FREIGWASSER,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     14.7);

NETWORK
TITLE =AB_SH_LAMPE_LDT_WASSMP  Lampe AUSSENBEDIENUNG SUDHAUS (mit Pumpe
// Act 004
// Box           : S6 U6.3
// Output address: Q15.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2570.AB_SH_LAMPE_LDT_WASSMP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     15.0);

NETWORK
TITLE =BH_RV2  
// Act 006
// Box           : Ventilinsel 5
// Input address : I339.6
// Output address: Q339.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2570.BH_RV2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.6,
           Out                      := Q    339.6);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1571
TITLE =U057: Water Transfer Brewhouse
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1571.DBX 1357.7; 
      CC    FB  1579; // "U057Sim"
      A     DB1571.DBX   17.3; 
      =     DB1571.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1570.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1571.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1575.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1571.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1575; // U057Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U057UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U057UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U057UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U057UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// AB_SH_DT_LAMPEN_PRUEFEN AUSSENBEDIENUNG SUDHAUS
// ----------------------------------------------------------
      CLR   ; 
//      =     "U057SpID".AB_SH_DT_LAMPEN_PRUEFEN.EAl
//      =     "U057SpID".AB_SH_DT_LAMPEN_PRUEFEN.Pre

// ----------------------------------------------------------
// AB_SH_LDT_WASSER_OPUMP AUSSENBEDIENUNG SUDHAUS
// ----------------------------------------------------------
      CLR   ; 
//      =     "U057SpID".AB_SH_LDT_WASSER_OPUMP.EAl
//      =     "U057SpID".AB_SH_LDT_WASSER_OPUMP.Pre

// ----------------------------------------------------------
// AB_SH_LDT_WASSER_MPUMP AUSSENBEDIENUNG SUDHAUS
// ----------------------------------------------------------
      CLR   ; 
//      =     "U057SpID".AB_SH_LDT_WASSER_MPUMP.EAl
//      =     "U057SpID".AB_SH_LDT_WASSER_MPUMP.Pre

// ----------------------------------------------------------
// AB_SH_DT_START AUSSENBEDIENUNG SUDHAUS
// ----------------------------------------------------------
      CLR   ; 
//      =     "U057SpID".AB_SH_DT_START.EAl
//      =     "U057SpID".AB_SH_DT_START.Pre

// ----------------------------------------------------------
// AB_SH_DT_STOP AUSSENBEDIENUNG SUDHAUS
// ----------------------------------------------------------
      CLR   ; 
//      =     "U057SpID".AB_SH_DT_STOP.EAl
//      =     "U057SpID".AB_SH_DT_STOP.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2577.DBX   80.7; 
      =     DB2577.DBX   81.4; 

      CLR   ; 
      =     DB2577.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2577.DBX  140.7; 
      =     DB2577.DBX  141.4; 

      CLR   ; 
      =     DB2577.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2577.DBX  200.7; 
      =     DB2577.DBX  201.4; 

      CLR   ; 
      =     DB2577.DBX  202.7; 

NETWORK
TITLE =Sequence organisation


// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1573.DBX   43.1; 
      S     DB1573.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2570.DBX  105.4; 
      =     DB2570.DBX  185.4; 
      =     DB2570.DBX  265.4; 
      =     DB2570.DBX  345.4; 

      =     DB2570.DBX  425.4; 
      =     DB2570.DBX  505.4; 




MODE: SET   ; 

NETWORK
TITLE =SH_P1 SHP1

      A     #GenRel; 
      A     DB2570.DBX  106.7; 
      =     DB2570.DBX  107.6; 
NETWORK
TITLE =AB_SH_LAMPE_LDT_WASSOP Lampe AUSSEN SUDHAUS (ohne Pumpe)

      A     #GenRel; 
      A     DB2570.DBX  426.7; 
      =     DB2570.DBX  427.6; 
NETWORK
TITLE =AB_SH_LAMPE_FREIGWASSER Lampe AUSSENBEDIENUNG SUDHAUS (Freigabe)

      A     #GenRel; 
      A     DB2570.DBX  506.7; 
      =     DB2570.DBX  507.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1580
TITLE =U058: Water Transfer Syrup
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1580.DBW    0; 
      T     #UnitNo; 
      L     DB1580.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// SRW_PIC1 AnI 001 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2583.SRW_PIC1,
           ValPer                   := IW   516);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2585.unv001,
           ValExt                   := DB2585.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2585.unv002,
           ValExt                   := DB2585.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2585.unv003,
           ValExt                   := DB2585.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2585.unv004,
           ValExt                   := DB2585.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SW_FS1 SpI 002 Flussschalter Wasserpumpe Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2581.SW_FS1,
           SpIBit                   := I    188.0);

// WAS_Anforderung SpI 003 Anforderung Wasser
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2581.WAS_Anforderung,
           SpIBit                   := DB1585.DBX   26.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2587.msg001,
           MsgBit                   := DB2587.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2587.msg002,
           MsgBit                   := DB2587.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2587.msg003,
           MsgBit                   := DB2587.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// SR_P1_PID PID 001 Druckregelung Sirupwasser SR.P1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2586.SR_P1_PID,
           SpExt                    := DB2586.DBD  234,
           PVal                     := DB2586.DBD  254,
           OPer                     := PQW  516);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =SR_P1  Wasserpumpe Sirupraum
// Act 001
// Box           : VSSK
// Input address : I73.7
// Output address: Q53.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2580.SR_P1,
           Typ                      := 3,
           FBa                      := I     73.7,
           FBa2                     := #xTmp,
           Out                      := Q     53.7);

NETWORK
TITLE =WAS_Bereit  Wasser kann agefordert werden
// Act 002
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Wasser.Bereit
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2580.WAS_Bereit,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX    2.0);

NETWORK
TITLE =WAS_Pumpe_laeuft  Die Wasserpumpe laeuft
// Act 003
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Wasser.Pumpe_laeuft
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2580.WAS_Pumpe_laeuft,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX    2.1);

NETWORK
TITLE =SK_RV2  
// Act 006
// Box           : Ventilinsel 5
// Input address : I339.4
// Output address: Q339.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2580.SK_RV2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    339.4,
           Out                      := Q    339.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1581
TITLE =U058: Water Transfer Syrup
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1581.DBX 1357.7; 
      CC    FB  1589; // "U058Sim"
      A     DB1581.DBX   17.3; 
      =     DB1581.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1580.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1581.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1585.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1581.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1585; // U058Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// SRW_PIC1 
// ----------------------------------------------------------
      L     DB1581.DBD 1118; // !!! insert correct SFM !!!
      T     DB2583.DBD  238; 

      SET   ; 
      =     DB2583.DBX  141.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U058UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U058UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U058UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U058UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SW_FS1 Flussschalter Wasserpumpe Sirupraum
// ----------------------------------------------------------
      A     DB2580.DBX  102.6; 
      =     DB2581.DBX  141.4; 
      =     DB2581.DBX  141.5; 

// ----------------------------------------------------------
// WAS_Anforderung Anforderung Wasser
// ----------------------------------------------------------
      CLR   ; 
      =     DB2581.DBX  201.4; 
      =     DB2581.DBX  201.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2587.DBX   80.7; 
      =     DB2587.DBX   81.4; 

      CLR   ; 
      =     DB2587.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2587.DBX  140.7; 
      =     DB2587.DBX  141.4; 

      CLR   ; 
      =     DB2587.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2587.DBX  200.7; 
      =     DB2587.DBX  201.4; 

      CLR   ; 
      =     DB2587.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// SR_P1_PID Druckregelung Sirupwasser SR.P1
// ----------------------------------------------------------
// starting value -----------------------
      A     DB2580.DBX  102.6; 
      A     #GenRel; 
      =     DB2586.DBX  203.2; 
      =     DB2586.DBX  203.5; 

// enable alarm -------------------------
      A     DB2586.DBX  203.5; 
      A     DB2586.DBX  201.4; 
      AN    DB2586.DBX  203.1; 
      AN    DB2586.DBX  203.3; 
      AN    DB2586.DBX  203.4; 
      =     DB2586.DBX  203.0; 

// setpoint to controller ---------------
      L     DB1581.DBD  446; 
      T     DB2586.DBD  234; 

// static value to controller ----------
      L     DB1581.DBD  446; 
      T     DB2586.DBD  238; 

// process value to controller ----------
      L     DB2583.DBD  146; 
      T     DB2586.DBD  254; 

// low/high value to controller ---------
      L     DB2583.DBD  150; 
      T     DB2586.DBD  218; 

      L     DB2583.DBD  154; 
      T     DB2586.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM  -----------------------
      L     DB2583.DBD  146; 
      T     DB1581.DBD  450; 

// sequencer ----------------------------------------------------------------
      A     DB1583.DBX   43.1; 
      S     DB1583.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2580.DBX  105.4; 
      =     DB2580.DBX  185.4; 
      =     DB2580.DBX  265.4; 
      =     DB2580.DBX  505.4; 

// assign PID mode
      S     DB2586.DBX  201.4; 
      S     DB2586.DBX  201.5; 


MODE: SET   ; 

NETWORK
TITLE =SR_P1 Wasserpumpe Sirupraum

      A     #GenRel; 
      A     DB2580.DBX  106.7; 
      =     DB2580.DBX  107.6; 
NETWORK
TITLE =WAS_Bereit Wasser kann agefordert werden

      A     #GenRel; 
      A     DB2580.DBX  186.7; 
      =     DB2580.DBX  187.6; 
NETWORK
TITLE =WAS_Pumpe_laeuft Die Wasserpumpe laeuft

      A     #GenRel; 
      A     DB2580.DBX  266.7; 
      =     DB2580.DBX  267.6; 
NETWORK
TITLE =SK_RV2 

      A     #GenRel; 
      A     DB2580.DBX  506.7; 
      =     DB2580.DBX  507.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1590
TITLE =U059: Molchwasser
FAMILY : BOTEC_F1
NAME : U059A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1590.DBW    0; 
      T     #UnitNo; 
      L     DB1590.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// C_UnV001 UnV 001 Prozessstatuss
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2595.C_UnV001,
           ValExt                   := DB2595.DBD  234);

// C_UnV002 UnV 002 spare
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2595.C_UnV002,
           ValExt                   := DB2595.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SKP1 SpI 004 GOA
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2591.GOA_SKP1,
           SpIBit                   := I    264.2);

// GOA_SRGV SpI 005 GOA Molchw. Gully
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2591.GOA_SRGV,
           SpIBit                   := I    264.4);

NETWORK
TITLE =messages 

      NOP   0; 
// C_Msg002 Msg 002 spare
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2597.C_Msg002,
           MsgBit                   := DB2597.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
NETWORK
TITLE =MW_GK1  MOLCHE SR Reserve
// Act 003
// Box           : VS-SRA
// Input address : I191.0
// Output address: Q191.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2590.MW_GK1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    191.0,
           Out                      := Q    191.0);

NETWORK
TITLE =VR_MWV  MOLCHE SR
// Act 004
// Box           : VS-SRA
// Input address : I191.1
// Output address: Q191.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2590.VR_MWV,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    191.1,
           Out                      := Q    191.1);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1591
TITLE =U059: Molchwasser
FAMILY : BOTEC_F1
NAME : U059E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1591.DBX 1357.7; 
      CC    FB  1599; // "U059Sim"
      A     DB1591.DBX   17.3; 
      =     DB1591.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1590.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1591.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1595.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1591.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1595; // U059Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// C_UnV001 Prozessstatuss
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U059UnVD".C_UnV001.ValExt

// ----------------------------------------------------------
// C_UnV002 spare
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U059UnVD".C_UnV002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// GOA_SKP1 GOA
// ----------------------------------------------------------
      SET   ; 
      =     DB2591.DBX  261.4; 
      =     DB2591.DBX  261.5; 

// ----------------------------------------------------------
// GOA_SRGV GOA Molchw. Gully
// ----------------------------------------------------------
      SET   ; 
      =     DB2591.DBX  321.4; 
      =     DB2591.DBX  321.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// C_Msg002 spare
// ----------------------------------------------------------
      SET   ; 
      R     DB2597.DBX  140.7; 
      =     DB2597.DBX  141.4; 

      CLR   ; 
      =     DB2597.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1593.DBX   43.1; 
      S     DB1593.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2590.DBX  265.4; 
      =     DB2590.DBX  345.4; 



MODE: SET   ; 

NETWORK
TITLE =MW_GK1 MOLCHE SR Reserve

      A     #GenRel; 
      A     DB2590.DBX  266.7; 
      =     DB2590.DBX  267.6; 
NETWORK
TITLE =VR_MWV MOLCHE SR

      A     #GenRel; 
      A     DB2590.DBX  346.7; 
      =     DB2590.DBX  347.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1630
TITLE =U063: Abfllanlage  3
FAMILY : BOTEC_F1
NAME : U063A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1630.DBW    0; 
      T     #UnitNo; 
      L     DB1630.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// KEG_MIXER_KZE_NIVEAU AnI 001 KEG Mixer/KZE Niveau Steriltank 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2633.KEG_MIXER_KZE_NIVEAU,
           ValPer                   := PIW  954);

// KEG_MIXER_KZE_SORTE AnI 002 KEG Mixer/KZE Sortennummer Produkt
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2633.KEG_MIXER_KZE_SORTE,
           ValPer                   := PIW  952);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2635.unv001,
           ValExt                   := DB2635.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2635.unv002,
           ValExt                   := DB2635.DBD  362);

// KEG_MIXER_PROGRAMMNR UnV 003 Preselection 1/2/3 GES./GES.without KZE/KZE
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2635.KEG_MIXER_PROGRAMMNR,
           ValExt                   := DB2635.DBD  490);

// KEG_MIXER_TANKNUMMER UnV 004 Tank number clean water tank [1..9]
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2635.KEG_MIXER_TANKNUMMER,
           ValExt                   := DB2635.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// KEG_MIXER_CIP_BEREIT SpI 003 KEG Mixer/KZE CIP Bereit
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_CIP_BEREIT,
           SpIBit                   := I    946.1);

// KEG_MIXER_VOLL SpI 004 KEG Mixer/KZE Vollmeldung
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_VOLL,
           SpIBit                   := I    946.2);

// KEG_MIXER_LEER SpI 005 KEG Mixer/KZE Leermeldung
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_LEER,
           SpIBit                   := I    946.3);

// KEG_FUELLER_CIP_BEREIT SpI 007 KEG Fller CIP Bereitschaft
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_FUELLER_CIP_BEREIT,
           SpIBit                   := I    986.1);

// KEG_FUELLER_LIFEBIT SpI 009 KEG Fller Lebensbit
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_FUELLER_LIFEBIT,
           SpIBit                   := I    986.0);

// KEG_MIXER_LIFEBIT SpI 010 KEG Mixer Lebensbit
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_LIFEBIT,
           SpIBit                   := I    946.0);

// KEG_MIXER_FRG_CIP_PUMPE SpI 013 KEG Mixer/KZE Freigabe CIP Pumpe
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_FRG_CIP_PUMPE,
           SpIBit                   := I    946.4);

// KEG_MIXER_FRG_UEBERBR SpI 018 KEG Mixer/KZE Freigabe berbrckt (Schlsselschalter)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_FRG_UEBERBR,
           SpIBit                   := I    948.1);

// KEG_MIXER_ZEITHALT SpI 019 KEG Mixer/KZE Zeithalt
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2631.KEG_MIXER_ZEITHALT,
           SpIBit                   := I    946.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2637.msg001,
           MsgBit                   := DB2637.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2637.msg002,
           MsgBit                   := DB2637.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2637.msg003,
           MsgBit                   := DB2637.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
NETWORK
TITLE =KEG_MIXER_FREIGABE_EIN  KEG Mixer/KZE Freigabe ist eingeschaltet
// Act 001
// Box           : KEG Mixer
// Output address: Q948.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_FREIGABE_EIN,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    948.1);

NETWORK
TITLE =KEG_FUELLER_UML_FW  KEG Fller CIP Umlauf Frischwasser
// Act 004
// Box           : KEG Fller
// Output address: Q987.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_UML_FW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    987.0);

NETWORK
TITLE =KEG_FUELLER_UML_HW  KEG Fller CIP Umlauf HW
// Act 005
// Box           : KEG Fller
// Output address: Q987.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_UML_HW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    987.1);

NETWORK
TITLE =KEG_FUELLER_UML_LAUGE  KEG Fller CIP Umlauf Lauge
// Act 006
// Box           : KEG Fller
// Output address: Q987.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_UML_LAUGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    987.2);

NETWORK
TITLE =KEG_FUELLER_UML_SAEURE  KEG Fller CIP Umlauf Sure
// Act 007
// Box           : KEG Fller
// Output address: Q987.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_UML_SAEURE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    987.3);

NETWORK
TITLE =KEG_FUELLER_UML_RW  KEG Fller CIP Umlauf Reinwasser
// Act 008
// Box           : KEG Fller
// Output address: Q987.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_UML_RW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    987.4);

NETWORK
TITLE =KEG_FUELLER_BUS_UEBERW  KEG Fller Bus berwachung
// Act 009
// Box           : KEG Fller
// Output address: Q987.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_BUS_UEBERW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    987.7);

NETWORK
TITLE =KEG_FUELLER_BEFUELL  KEG Fller Fllmaschine mit CIP Medium beflle
// Act 010
// Box           : KEG Fller
// Output address: Q986.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_BEFUELL,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    986.2);

NETWORK
TITLE =KEG_MIXER_UML_FW  KEG Mixer/KZE CIP Umlauf Frischwasser
// Act 013
// Box           : KEG Mixer
// Output address: Q947.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_UML_FW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    947.0);

NETWORK
TITLE =KEG_FUELLER_AUSSCH  KEG Fller Fllmaschine mit Luft ausschieben/en
// Act 014
// Box           : KEG Fller
// Output address: Q986.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_AUSSCH,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    986.3);

NETWORK
TITLE =KEG_MIXER_UML_RW  KEG Mixer/KZE CIP Umlauf Reinwasser
// Act 017
// Box           : KEG Mixer
// Output address: Q947.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_UML_RW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    947.4);

NETWORK
TITLE =KEG_MIXER_CIP_LAUGE  KEG Mixer/KZE CIP Programm mit Lauge angewhlt
// Act 020
// Box           : KEG Mixer
// Output address: Q946.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_CIP_LAUGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    946.7);

NETWORK
TITLE =KEG_RR2  CIP Rcklaufventil Kreis 2 KEG Anlage
// Act 021
// Box           : VS-RRA
// Input address : I201.4
// Output address: Q201.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.4,
           Out                      := Q    201.4);

NETWORK
TITLE =KEG_MIXER_UML_LAUGE  KEG Mixer/KZE CIP Umlauf Lauge
// Act 024
// Box           : KEG Mixer
// Output address: Q947.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_UML_LAUGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    947.2);

NETWORK
TITLE =KEG_MIXER_UML_SAEURE  KEG Mixer/KZE CIP Umlauf Sure
// Act 025
// Box           : KEG Mixer
// Output address: Q947.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_UML_SAEURE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    947.3);

NETWORK
TITLE =KEG_MIXER_UML_HW  KEG Mixer/KZE CIP Umlauf HW
// Act 026
// Box           : KEG Mixer
// Output address: Q947.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_UML_HW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    947.1);

NETWORK
TITLE =KEG_MIXER_FLUTEN  KEG Mixer/KZE Mixer fluten fr Standdesinfektion
// Act 027
// Box           : KEG Mixer
// Output address: Q946.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_FLUTEN,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    946.2);

NETWORK
TITLE =KEG_MIXER_AUSPUMPEN  KEG Mixer/KZE PDL auspumpen
// Act 030
// Box           : KEG Mixer
// Output address: Q946.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_AUSPUMPEN,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    946.3);

NETWORK
TITLE =KEG_FUELLER_CIP_ENDE  KEG Fller CIP Ende
// Act 032
// Box           : KEG Fller
// Output address: Q986.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_FUELLER_CIP_ENDE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    986.1);

NETWORK
TITLE =KEG_MIXER_CIP_ENDE  KEG Mixer/KZE CIP Ende
// Act 033
// Box           : KEG Mixer
// Output address: Q946.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_CIP_ENDE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    946.1);

NETWORK
TITLE =KEG_MIXER_CIP_PPE_LAEUFT  KEG Mixer/KZE CIP Pumpe luft
// Act 034
// Box           : KEG Mixer
// Output address: Q946.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.KEG_MIXER_CIP_PPE_LAEUFT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    946.4);

NETWORK
TITLE =Act036  Spare
// Act 036
// Box           : KEG Mixer
// Output address: #DummyBool
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2630.Act036,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #DummyBool);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1631
TITLE =U063: Abfllanlage  3
FAMILY : BOTEC_F1
NAME : U063E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1631.DBX 1357.7; 
      CC    FB  1639; // "U063Sim"
      A     DB1631.DBX   17.3; 
      =     DB1631.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1630.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1631.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1635.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1631.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1635; // U063Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// KEG_MIXER_KZE_NIVEAU KEG Mixer/KZE Niveau Steriltank 
// ----------------------------------------------------------
      L     DB1631.DBD 1118; // !!! insert correct SFM !!!
      T     DB2633.DBD  238; 

      SET   ; 
      =     DB2633.DBX  141.5; 

// ----------------------------------------------------------
// KEG_MIXER_KZE_SORTE KEG Mixer/KZE Sortennummer Produkt
// ----------------------------------------------------------
      L     DB1631.DBD 1118; // !!! insert correct SFM !!!
      T     DB2633.DBD  358; 

      SET   ; 
      =     DB2633.DBX  261.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U063UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U063UnVD".unv002.ValExt

// ----------------------------------------------------------
// KEG_MIXER_PROGRAMMNR Preselection 1/2/3 GES./GES.without KZE/KZE
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U063UnVD".KEG_MIXER_PROGRAMMNR.ValExt

// ----------------------------------------------------------
// KEG_MIXER_TANKNUMMER Tank number clean water tank [1..9]
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U063UnVD".KEG_MIXER_TANKNUMMER.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// KEG_MIXER_CIP_BEREIT KEG Mixer/KZE CIP Bereit
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_CIP_BEREIT.EAl
//      =     "U063SpID".KEG_MIXER_CIP_BEREIT.Pre

// ----------------------------------------------------------
// KEG_MIXER_VOLL KEG Mixer/KZE Vollmeldung
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_VOLL.EAl
//      =     "U063SpID".KEG_MIXER_VOLL.Pre

// ----------------------------------------------------------
// KEG_MIXER_LEER KEG Mixer/KZE Leermeldung
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_LEER.EAl
//      =     "U063SpID".KEG_MIXER_LEER.Pre

// ----------------------------------------------------------
// KEG_FUELLER_CIP_BEREIT KEG Fller CIP Bereitschaft
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_FUELLER_CIP_BEREIT.EAl
//      =     "U063SpID".KEG_FUELLER_CIP_BEREIT.Pre

// ----------------------------------------------------------
// KEG_FUELLER_LIFEBIT KEG Fller Lebensbit
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_FUELLER_LIFEBIT.EAl
//      =     "U063SpID".KEG_FUELLER_LIFEBIT.Pre

// ----------------------------------------------------------
// KEG_MIXER_LIFEBIT KEG Mixer Lebensbit
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_LIFEBIT.EAl
//      =     "U063SpID".KEG_MIXER_LIFEBIT.Pre

// ----------------------------------------------------------
// KEG_MIXER_FRG_CIP_PUMPE KEG Mixer/KZE Freigabe CIP Pumpe
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_FRG_CIP_PUMPE.EAl
//      =     "U063SpID".KEG_MIXER_FRG_CIP_PUMPE.Pre

// ----------------------------------------------------------
// KEG_MIXER_FRG_UEBERBR KEG Mixer/KZE Freigabe berbrckt (Schlsselschalter)
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_FRG_UEBERBR.EAl
//      =     "U063SpID".KEG_MIXER_FRG_UEBERBR.Pre

// ----------------------------------------------------------
// KEG_MIXER_ZEITHALT KEG Mixer/KZE Zeithalt
// ----------------------------------------------------------
//      CLR   
//      =     "U063SpID".KEG_MIXER_ZEITHALT.EAl
//      =     "U063SpID".KEG_MIXER_ZEITHALT.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2637.DBX   80.7; 
      =     DB2637.DBX   81.4; 

      CLR   ; 
      =     DB2637.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2637.DBX  140.7; 
      =     DB2637.DBX  141.4; 

      CLR   ; 
      =     DB2637.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2637.DBX  200.7; 
      =     DB2637.DBX  201.4; 

      CLR   ; 
      =     DB2637.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM KEG Mixer/KZE Niveau Steriltank  -----------------------
      L     DB2633.DBD  146; 
      T     DB1631.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM KEG Mixer/KZE Sortennummer Produkt -----------------------
      L     DB2633.DBD  266; 
      T     DB1631.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1633.DBX   43.1; 
      S     DB1633.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2630.DBX  105.4; 
      =     DB2630.DBX  345.4; 
      =     DB2630.DBX  425.4; 
      =     DB2630.DBX  505.4; 
      =     DB2630.DBX  585.4; 
      =     DB2630.DBX  665.4; 
      =     DB2630.DBX  745.4; 
      =     DB2630.DBX  825.4; 
      =     DB2630.DBX 1065.4; 
      =     DB2630.DBX 1145.4; 
      =     DB2630.DBX 1385.4; 
      =     DB2630.DBX 1625.4; 
      =     DB2630.DBX 1705.4; 
      =     DB2630.DBX 1945.4; 
      =     DB2630.DBX 2025.4; 
      =     DB2630.DBX 2105.4; 
      =     DB2630.DBX 2185.4; 
      =     DB2630.DBX 2425.4; 
      =     DB2630.DBX 2585.4; 
      =     DB2630.DBX 2665.4; 
      =     DB2630.DBX 2745.4; 
      =     DB2630.DBX 2905.4; 



MODE: SET   ; 

NETWORK
TITLE =KEG_MIXER_FREIGABE_EIN KEG Mixer/KZE Freigabe ist eingeschaltet

      A     #GenRel; 
      A     DB2630.DBX  106.7; 
      =     DB2630.DBX  107.6; 
NETWORK
TITLE =KEG_FUELLER_UML_FW KEG Fller CIP Umlauf Frischwasser

      A     #GenRel; 
      A     DB2630.DBX  346.7; 
      =     DB2630.DBX  347.6; 
NETWORK
TITLE =KEG_FUELLER_UML_HW KEG Fller CIP Umlauf HW

      A     #GenRel; 
      A     DB2630.DBX  426.7; 
      =     DB2630.DBX  427.6; 
NETWORK
TITLE =KEG_FUELLER_UML_LAUGE KEG Fller CIP Umlauf Lauge

      A     #GenRel; 
      A     DB2630.DBX  506.7; 
      =     DB2630.DBX  507.6; 
NETWORK
TITLE =KEG_FUELLER_UML_SAEURE KEG Fller CIP Umlauf Sure

      A     #GenRel; 
      A     DB2630.DBX  586.7; 
      =     DB2630.DBX  587.6; 
NETWORK
TITLE =KEG_FUELLER_UML_RW KEG Fller CIP Umlauf Reinwasser

      A     #GenRel; 
      A     DB2630.DBX  666.7; 
      =     DB2630.DBX  667.6; 
NETWORK
TITLE =KEG_FUELLER_BUS_UEBERW KEG Fller Bus berwachung

      A     #GenRel; 
      A     DB2630.DBX  746.7; 
      =     DB2630.DBX  747.6; 
NETWORK
TITLE =KEG_FUELLER_BEFUELL KEG Fller Fllmaschine mit CIP Medium befl

      A     #GenRel; 
      A     DB2630.DBX  826.7; 
      =     DB2630.DBX  827.6; 
NETWORK
TITLE =KEG_MIXER_UML_FW KEG Mixer/KZE CIP Umlauf Frischwasser

      A     #GenRel; 
      A     DB2630.DBX 1066.7; 
      =     DB2630.DBX 1067.6; 
NETWORK
TITLE =KEG_FUELLER_AUSSCH KEG Fller Fllmaschine mit Luft ausschieben/

      A     #GenRel; 
      A     DB2630.DBX 1146.7; 
      =     DB2630.DBX 1147.6; 
NETWORK
TITLE =KEG_MIXER_UML_RW KEG Mixer/KZE CIP Umlauf Reinwasser

      A     #GenRel; 
      A     DB2630.DBX 1386.7; 
      =     DB2630.DBX 1387.6; 
NETWORK
TITLE =KEG_MIXER_CIP_LAUGE KEG Mixer/KZE CIP Programm mit Lauge angewh

      A     #GenRel; 
      A     DB2630.DBX 1626.7; 
      =     DB2630.DBX 1627.6; 
NETWORK
TITLE =KEG_RR2 CIP Rcklaufventil Kreis 2 KEG Anlage

      A     #GenRel; 
      A     DB2630.DBX 1706.7; 
      =     DB2630.DBX 1707.6; 
NETWORK
TITLE =KEG_MIXER_UML_LAUGE KEG Mixer/KZE CIP Umlauf Lauge

      A     #GenRel; 
      A     DB2630.DBX 1946.7; 
      =     DB2630.DBX 1947.6; 
NETWORK
TITLE =KEG_MIXER_UML_SAEURE KEG Mixer/KZE CIP Umlauf Sure

      A     #GenRel; 
      A     DB2630.DBX 2026.7; 
      =     DB2630.DBX 2027.6; 
NETWORK
TITLE =KEG_MIXER_UML_HW KEG Mixer/KZE CIP Umlauf HW

      A     #GenRel; 
      A     DB2630.DBX 2106.7; 
      =     DB2630.DBX 2107.6; 
NETWORK
TITLE =KEG_MIXER_FLUTEN KEG Mixer/KZE Mixer fluten fr Standdesinfektio

      A     #GenRel; 
      A     DB2630.DBX 2186.7; 
      =     DB2630.DBX 2187.6; 
NETWORK
TITLE =KEG_MIXER_AUSPUMPEN KEG Mixer/KZE PDL auspumpen

      A     #GenRel; 
      A     DB2630.DBX 2426.7; 
      =     DB2630.DBX 2427.6; 
NETWORK
TITLE =KEG_FUELLER_CIP_ENDE KEG Fller CIP Ende

      A     #GenRel; 
      A     DB2630.DBX 2586.7; 
      =     DB2630.DBX 2587.6; 
NETWORK
TITLE =KEG_MIXER_CIP_ENDE KEG Mixer/KZE CIP Ende

      A     #GenRel; 
      A     DB2630.DBX 2666.7; 
      =     DB2630.DBX 2667.6; 
NETWORK
TITLE =KEG_MIXER_CIP_PPE_LAEUFT KEG Mixer/KZE CIP Pumpe luft

      A     #GenRel; 
      A     DB2630.DBX 2746.7; 
      =     DB2630.DBX 2747.6; 
NETWORK
TITLE =Act036 Spare

      A     #GenRel; 
      A     DB2630.DBX 2906.7; 
      =     DB2630.DBX 2907.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1650
TITLE =U065: Abfllanlage  5
FAMILY : BOTEC_F1
NAME : U065A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1650.DBW    0; 
      T     #UnitNo; 
      L     DB1650.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// A5_TI1 AnI 001 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2653.A5_TI1,
           ValPer                   := PIW  512);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2655.unv001,
           ValExt                   := DB2655.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2655.unv002,
           ValExt                   := DB2655.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2655.unv003,
           ValExt                   := DB2655.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2655.unv004,
           ValExt                   := DB2655.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// A5_FS1 SpI 001 Anlage 5 Strmungswchter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_FS1,
           SpIBit                   := I    195.0);

// A5_FUELLER_LAEUFT SpI 002 Koppelsignal von Fller 5 Fller luft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_FUELLER_LAEUFT,
           SpIBit                   := I    196.1);

// A5_MIXER_CIP_BEREIT SpI 003 Koppelsignal von Mixer 5 CIP-Bereitschaft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_MIXER_CIP_BEREIT,
           SpIBit                   := I    198.0);

// A5_MIXER_VOLL SpI 004 Koppelsignal von Mixer 5 Mixer voll
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_MIXER_VOLL,
           SpIBit                   := I    198.1);

// A5_MIXER_LEER SpI 005 Koppelsignal von Mixer 5 Mixer leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_MIXER_LEER,
           SpIBit                   := I    198.2);

// A5_MIXER_Anforderung SpI 006 Koppelsignal von Mixer 5 Anforderung Nachsp.
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_MIXER_Anforderung,
           SpIBit                   := I    198.3);

// A5_FUELLER_CIP_BEREIT SpI 007 Koppelsignal von Fller 5 CIP-Bereitschaft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_FUELLER_CIP_BEREIT,
           SpIBit                   := I    196.0);

// F5_WATCHDOG SpI 009 Koppelsignal von Fller 5 WATCHDOG
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.F5_WATCHDOG,
           SpIBit                   := I    197.7);

// M5_WATCHDOG SpI 010 Koppelsignal von Mixer 5 WATCHDOG
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.M5_WATCHDOG,
           SpIBit                   := I    199.7);

// A5_FUELLER_LEER SpI 011 Koppelsignal von Fller 5 Fller leer (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_FUELLER_LEER,
           SpIBit                   := I    196.2);

// A5_FUELLER_VOLL SpI 012 Koppelsignal von Fller 5 Fller voll (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_FUELLER_VOLL,
           SpIBit                   := I    196.3);

// A5_RINSER_CIP_BEREIT SpI 013 Koppelsignal von Rinser 5 CIP-Bereitschaft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_RINSER_CIP_BEREIT,
           SpIBit                   := I    172.0);

// A5_RINSER_LAEUFT SpI 014 Koppelsignal von Rinser 5 Rinser luft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_RINSER_LAEUFT,
           SpIBit                   := I    172.1);

// R5_WATCHDOG SpI 015 Koppelsignal von Rinser 5 WATCHDOG
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.R5_WATCHDOG,
           SpIBit                   := I    173.7);

// GOA503 SpI 017 MOLCH A5 GOA503
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.GOA503,
           SpIBit                   := I    194.2);

// A5_FUELLER_KLARSPUELEN SpI 018 Koppelsignal von Fller 5 Klarsplen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2651.A5_FUELLER_KLARSPUELEN,
           SpIBit                   := I    196.4);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2657.msg001,
           MsgBit                   := DB2657.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2657.msg002,
           MsgBit                   := DB2657.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2657.msg003,
           MsgBit                   := DB2657.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A5_RP1  Rcklaufpumpe Anlage 5
// Act 001
// Box           : S6 U6.3
// Input address : I5.2
// Output address: Q5.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.A5_RP1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      5.2,
           Out                      := Q      5.2);

NETWORK
TITLE =F5_Maschine_Start  Fller A5 Maschine Start
// Act 002
// Box           : Fller5
// Output address: Q196.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Maschine_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.0);

NETWORK
TITLE =F5_Maschine_Stop  Fller A5 Maschine Stop
// Act 003
// Box           : Fller5
// Output address: Q196.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Maschine_Stop,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =R5_START  Rinser A5 Maschine Start
// Act 004
// Box           : Rinser5
// Output address: Q172.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.R5_START,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    172.0);

NETWORK
TITLE =R5_STOP  Rinser A5 Maschine Stop
// Act 005
// Box           : Rinser5
// Output address: Q172.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.R5_STOP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =R5_Kreislauf_ohne_aussen  Rinser CIP-Kreis ohne pulsierenden
// Act 006
// Box           : Rinser5
// Output address: Q172.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.R5_Kreislauf_ohne_aussen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    172.3);

NETWORK
TITLE =R5_Kreislauf_mit_aussen  Rinser CIP-Kreis mit pulsierenden
// Act 007
// Box           : Rinser5
// Output address: Q172.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.R5_Kreislauf_mit_aussen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    172.4);

NETWORK
TITLE =R5_Grundstellung  Rinser A5 Maschine Grundstellung (Impuls)
// Act 008
// Box           : Rinser5
// Output address: Q172.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.R5_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    172.2);

NETWORK
TITLE =R5_Drainagestellung  Rinser A5 Drainagestellung (Impuls)
// Act 009
// Box           : Rinser5
// Output address: Q172.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.R5_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    172.5);

NETWORK
TITLE =F5_Kreislauf_o_puls  Fller CIP-Kreis ohne pulsierenden Ablauf
// Act 010
// Box           : Fller5
// Output address: Q196.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Kreislauf_o_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.2);

NETWORK
TITLE =F5_Kreislauf_m_puls  Fller CIP-Kreis mit pulsierenden Ablauf
// Act 011
// Box           : Fller5
// Output address: Q196.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Kreislauf_m_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.3);

NETWORK
TITLE =F5_Randvollstellung  Fller A5 Randvollstellung Standdesinfektio
// Act 012
// Box           : Fller5
// Output address: Q196.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.4);

NETWORK
TITLE =F5_Klarspuelen_o_CIP_Beh  Fller A5 Klarsplen ohne CIP-Behlter
// Act 013
// Box           : Fller5
// Output address: Q196.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Klarspuelen_o_CIP_Beh,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.5);

NETWORK
TITLE =F5_Ausschub_m_Sterilluft  Fller Ausschubprogramm mit Sterilluft
// Act 014
// Box           : Fller5
// Output address: Q196.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Ausschub_m_Sterilluft,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.6);

NETWORK
TITLE =F5_Ausschub_m_CO2  Fller A5 Ausschubprogramm mit CO2
// Act 015
// Box           : Fller5
// Output address: Q196.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Ausschub_m_CO2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    196.7);

NETWORK
TITLE =F5_Grundstellung  Fller A5 Maschine Grundstellung (Impuls)
// Act 016
// Box           : Fller5
// Output address: Q197.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    197.0);

NETWORK
TITLE =F5_Drainagestellung  Fller A5 Drainagestellung (Impuls)
// Act 017
// Box           : Fller5
// Output address: Q197.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    197.1);

NETWORK
TITLE =F5_Bypass  Fller A5 Bypass (Impuls)
// Act 018
// Box           : Fller5
// Output address: Q197.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.F5_Bypass,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    197.2);

NETWORK
TITLE =A5_RR1  Reinigungsrcklauf Anlage 5 zu Kreis 1
// Act 020
// Box           : VSRR1-3
// Input address : I84.0
// Output address: Q84.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.A5_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.0,
           Out                      := Q     84.0);

NETWORK
TITLE =A5_RR2  Reinigungsrcklauf Anlage 5 zu Kreis 2
// Act 021
// Box           : VSRR1-3
// Input address : I84.1
// Output address: Q84.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.A5_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.1,
           Out                      := Q     84.1);

NETWORK
TITLE =A5_RR3  Reinigungsrcklauf Anlage 5 zu Kreis 3
// Act 022
// Box           : VSRR1-3
// Input address : I84.2
// Output address: Q84.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.A5_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.2,
           Out                      := Q     84.2);

NETWORK
TITLE =M5_Grundstellung  Mixer A5 Grundstellung (Impuls)
// Act 023
// Box           : Mixer5
// Output address: Q198.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.0);

NETWORK
TITLE =M5_Drainagestellung  Mixer A5 Drainagestellung (Impuls)
// Act 024
// Box           : Mixer5
// Output address: Q198.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.1);

NETWORK
TITLE =M5_Ausspritzen_o_Ablauf  MixerAusspritzen ohne Ablauf
// Act 025
// Box           : Mixer5
// Output address: Q198.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Ausspritzen_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.2);

NETWORK
TITLE =M5_Ausspritzen_m_Ablauf  Mixer A5 Ausspritzen mit Ablauf (Impuls
// Act 026
// Box           : Mixer5
// Output address: Q198.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Ausspritzen_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.3);

NETWORK
TITLE =M5_Fluten_o_Ablauf  Mixer A5 Fluten ohne Ablauf (Impuls)
// Act 027
// Box           : Mixer5
// Output address: Q198.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Fluten_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.4);

NETWORK
TITLE =M5_Fluten_m_Ablauf  Mixer A5 Fluten mit Ablauf (Impuls)
// Act 028
// Box           : Mixer5
// Output address: Q198.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Fluten_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.5);

NETWORK
TITLE =M5_Randvollstellung  Mixer A5 Randvollstellung (Impuls)
// Act 029
// Box           : Mixer5
// Output address: Q198.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.6);

NETWORK
TITLE =M5_Abpumpen  Mixer A5 Abpumpen (Impuls)
// Act 030
// Box           : Mixer5
// Output address: Q198.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Abpumpen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    198.7);

NETWORK
TITLE =M5_Klarspuelen  Mixer A5 Klarsplen
// Act 031
// Box           : Mixer5
// Output address: Q199.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2650.M5_Klarspuelen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    199.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1651
TITLE =U065: Packaging Plant 5
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1651.DBX 1357.7; 
      CC    FB  1659; // "U065Sim"
      A     DB1651.DBX   17.3; 
      =     DB1651.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1650.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1651.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1655.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1651.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1655; // U065Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// A5_TI1 
// ----------------------------------------------------------
//      L     ID   352
//      T     "U065AnID".A5_TI1.ValRaw
      SET   ; 
      R     DB2653.DBX  143.5; 

      L     DB1651.DBD 1118; // !!! insert correct SFM !!!
      T     DB2653.DBD  238; 

      SET   ; 
      =     DB2653.DBX  141.5; 


NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U065UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U065UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U065UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U065UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// A5_MIXER_CIP_BEREIT Koppelsignal von Mixer 5 CIP-Bereitschaft (Dauersignal)
// ----------------------------------------------------------
      A     DB2650.DBX  102.6; 
      =     DB2651.DBX   81.4; 
      SET   ; 
      =     DB2651.DBX   81.5; 


// ----------------------------------------------------------
// A5_MIXER_VOLL Koppelsignal von Mixer 5 Mixer voll
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_MIXER_VOLL.EAl
//      =     "U065SpID".A5_MIXER_VOLL.Pre

// ----------------------------------------------------------
// A5_MIXER_LEER Koppelsignal von Mixer 5 Mixer leer
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_MIXER_LEER.EAl
//      =     "U065SpID".A5_MIXER_LEER.Pre

// ----------------------------------------------------------
// A5_MIXER_Anforderung Koppelsignal von Mixer 5 Anforderung Nachsp.
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_MIXER_Anforderung.EAl
//      =     "U065SpID".A5_MIXER_Anforderung.Pre

// ----------------------------------------------------------
// M5_WATCHDOG Koppelsignal von Mixer 5 WATCHDOG
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".M5_WATCHDOG.EAl
//      =     "U065SpID".M5_WATCHDOG.Pre

// ----------------------------------------------------------
// A5_SS_FRG_MOLCH Anlage 5 Schlsselschalter Freigabe Molch
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_SS_FRG_MOLCH.EAl
//      =     "U065SpID".A5_SS_FRG_MOLCH.Pre

// ----------------------------------------------------------
// E195_7 Anlage 5 Reserve 7 Ende Ventilschrank A5
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".E195_7.EAl
//      =     "U065SpID".E195_7.Pre

// ----------------------------------------------------------
// A5_LDT_PROD 
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_LDT_PROD.EAl
//      =     "U065SpID".A5_LDT_PROD.Pre

// ----------------------------------------------------------
// A5_LDT_QUITT_CIP 
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_LDT_QUITT_CIP.EAl
//      =     "U065SpID".A5_LDT_QUITT_CIP.Pre

// ----------------------------------------------------------
// A5_DT_START 
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_DT_START.EAl
//      =     "U065SpID".A5_DT_START.Pre

// ----------------------------------------------------------
// A5_FUELLER_LAEUFT Koppelsignal von Fller 5 Fller luft (Dauersignal)
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_FUELLER_LAEUFT.EAl
//      =     "U065SpID".A5_FUELLER_LAEUFT.Pre

// ----------------------------------------------------------
// A5_FUELLER_LEER Koppelsignal von Fller 5 Fller leer (Impuls)
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_FUELLER_LEER.EAl
//      =     "U065SpID".A5_FUELLER_LEER.Pre

// ----------------------------------------------------------
// A5_FUELLER_VOLL Koppelsignal von Fller 5 Fller voll (Impuls)
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_FUELLER_VOLL.EAl
//      =     "U065SpID".A5_FUELLER_VOLL.Pre

// ----------------------------------------------------------
// A5_FUELLER_KLARSPUELEN Koppelsignal von Fller 5 Klarsplen
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_FUELLER_KLARSPUELEN.EAl
//      =     "U065SpID".A5_FUELLER_KLARSPUELEN.Pre

// ----------------------------------------------------------
// F5_WATCHDOG Koppelsignal von Fller 5 WATCHDOG
// ----------------------------------------------------------
//      CLR                                
//     =     "U065SpID".F5_WATCHDOG.EAl
//     =     "U065SpID".F5_WATCHDOG.Pre

// ----------------------------------------------------------
// A5_RINSER_LAEUFT Koppelsignal von Rinser 5 Rinser luft (Dauersignal)
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".A5_RINSER_LAEUFT.EAl
//      =     "U065SpID".A5_RINSER_LAEUFT.Pre

// ----------------------------------------------------------
// R5_WATCHDOG Koppelsignal von Rinser 5 WATCHDOG
// ----------------------------------------------------------
//      CLR   
//      =     "U065SpID".R5_WATCHDOG.EAl
//      =     "U065SpID".R5_WATCHDOG.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2657.DBX   80.7; 
      =     DB2657.DBX   81.4; 

      CLR   ; 
      =     DB2657.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2657.DBX  140.7; 
      =     DB2657.DBX  141.4; 

      CLR   ; 
      =     DB2657.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2657.DBX  200.7; 
      =     DB2657.DBX  201.4; 

      CLR   ; 
      =     DB2657.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB2653.DBD  146; 
      T     DB1651.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1653.DBX   43.1; 
      S     DB1653.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2650.DBX  105.4; 
      =     DB2650.DBX  185.4; 
      S     DB2650.DBX  265.4; 
      =     DB2650.DBX  345.4; 
      S     DB2650.DBX  425.4; 
      =     DB2650.DBX  505.4; 
      =     DB2650.DBX  585.4; 
      =     DB2650.DBX  665.4; 
      =     DB2650.DBX  745.4; 
      =     DB2650.DBX  825.4; 
      =     DB2650.DBX  905.4; 
      =     DB2650.DBX  985.4; 
      =     DB2650.DBX 1065.4; 
      =     DB2650.DBX 1145.4; 
      =     DB2650.DBX 1225.4; 
      =     DB2650.DBX 1305.4; 
      =     DB2650.DBX 1385.4; 
      =     DB2650.DBX 1465.4; 
      =     DB2650.DBX 1545.4; 
      =     DB2650.DBX 1625.4; 
      =     DB2650.DBX 1705.4; 
      =     DB2650.DBX 1785.4; 
      =     DB2650.DBX 1865.4; 
      =     DB2650.DBX 1945.4; 
      =     DB2650.DBX 2025.4; 
      =     DB2650.DBX 2105.4; 
      =     DB2650.DBX 2185.4; 
      =     DB2650.DBX 2265.4; 
      =     DB2650.DBX 2345.4; 
      =     DB2650.DBX 2425.4; 
      =     DB2650.DBX 2505.4; 




MODE: SET   ; 

NETWORK
TITLE =A5_RP1 Rcklaufpumpe Anlage 5

//      A     "U065SpID".A5_FS1.Sig
      AN    DB2651.DBX   78.1; 

      A     #GenRel; 
      A     DB2650.DBX  106.7; 
      =     DB2650.DBX  107.6; 
NETWORK
TITLE =A5_V11 Filter A5 V11

      A     #GenRel; 
      A     DB2650.DBX  186.7; 
      =     DB2650.DBX  187.6; 
NETWORK
TITLE =U65_Act003 spare

      A     #GenRel; 
      A     DB2650.DBX  266.7; 
      =     DB2650.DBX  267.6; 

      AN    DB2650.DBX  263.4; 
      =     Q    196.1; 
NETWORK
TITLE =U65_Act004 spare

      A     #GenRel; 
      A     DB2650.DBX  346.7; 
      =     DB2650.DBX  347.6; 
NETWORK
TITLE =U65_Act005 spare

      A     #GenRel; 
      A     DB2650.DBX  426.7; 
      =     DB2650.DBX  427.6; 

      AN    DB2650.DBX  423.4; 
      =     Q    172.1; 
NETWORK
TITLE =U65_Act006 spare

      A     #GenRel; 
      A     DB2650.DBX  506.7; 
      =     DB2650.DBX  507.6; 
NETWORK
TITLE =U65_Act007 spare

      A     #GenRel; 
      A     DB2650.DBX  586.7; 
      =     DB2650.DBX  587.6; 
NETWORK
TITLE =U65_Act008 spare

      A     #GenRel; 
      A     DB2650.DBX  666.7; 
      =     DB2650.DBX  667.6; 
NETWORK
TITLE =U65_Act009 spare

      A     #GenRel; 
      A     DB2650.DBX  746.7; 
      =     DB2650.DBX  747.6; 
NETWORK
TITLE =U65_Act010 spare

      A     #GenRel; 
      A     DB2650.DBX  826.7; 
      =     DB2650.DBX  827.6; 
NETWORK
TITLE =U65_Act011 spare

      A     #GenRel; 
      A     DB2650.DBX  906.7; 
      =     DB2650.DBX  907.6; 
NETWORK
TITLE =U65_Act012 spare

      A     #GenRel; 
      A     DB2650.DBX  986.7; 
      =     DB2650.DBX  987.6; 
NETWORK
TITLE =M5_Grundstellung Mixer A5 Grundstellung (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1226.7; 
      =     DB2650.DBX 1227.6; 
NETWORK
TITLE =M5_Drainagestellung Mixer A5 Drainagestellung (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1306.7; 
      =     DB2650.DBX 1307.6; 
NETWORK
TITLE =M5_Ausspritzen_o_Ablauf MixerAusspritzen ohne Ablauf

      A     #GenRel; 
      A     DB2650.DBX 1386.7; 
      =     DB2650.DBX 1387.6; 
NETWORK
TITLE =M5_Ausspritzen_m_Ablauf Mixer A5 Ausspritzen mit Ablauf (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1466.7; 
      =     DB2650.DBX 1467.6; 
NETWORK
TITLE =M5_Fluten_o_Ablauf Mixer A5 Fluten ohne Ablauf (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1546.7; 
      =     DB2650.DBX 1547.6; 
NETWORK
TITLE =M5_Fluten_m_Ablauf Mixer A5 Fluten mit Ablauf (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1626.7; 
      =     DB2650.DBX 1627.6; 
NETWORK
TITLE =M5_Randvollstellung Mixer A5 Randvollstellung (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1706.7; 
      =     DB2650.DBX 1707.6; 
NETWORK
TITLE =M5_Abpumpen Mixer A5 Abpumpen (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 1786.7; 
      =     DB2650.DBX 1787.6; 
NETWORK
TITLE =M5_Klarspuelen Mixer A5 Klarsplen

      A     #GenRel; 
      A     DB2650.DBX 1866.7; 
      =     DB2650.DBX 1867.6; 
NETWORK
TITLE =M5_Freigabe_P506 Mixer A5 Freigabe P506 Wasserzufhrpumpe

      A     #GenRel; 
      A     DB2650.DBX 1946.7; 
      =     DB2650.DBX 1947.6; 
NETWORK
TITLE =A5_GOA501 Mixer A5 GOA501 Paneel CIP

      A     #GenRel; 
      A     DB2650.DBX 2026.7; 
      =     DB2650.DBX 2027.6; 
NETWORK
TITLE =M5_Molch_Start Mixer A5 Impuls Molch im Sirupraum startet

      A     #GenRel; 
      A     DB2650.DBX 2106.7; 
      =     DB2650.DBX 2107.6; 
NETWORK
TITLE =A5_GOA502 Mixer A5 GOA502 Paneel CIP

      A     #GenRel; 
      A     DB2650.DBX 2186.7; 
      =     DB2650.DBX 2187.6; 
NETWORK
TITLE =A5_GOA503 Mixer A5 GOA503 Paneel CIP

      A     #GenRel; 
      A     DB2650.DBX 2266.7; 
      =     DB2650.DBX 2267.6; 
NETWORK
TITLE =R5_Grundstellung Rinser A5 Maschine Grundstellung (Impuls)

      A     #GenRel; 
      A     DB2650.DBX 2346.7; 
      =     DB2650.DBX 2347.6; 
NETWORK
TITLE =M5_MOLCH_ENDPOSITION Mixer A5 Molch in Endposition

      A     #GenRel; 
      A     DB2650.DBX 2426.7; 
      =     DB2650.DBX 2427.6; 
NETWORK
TITLE =F5_Maschine_Start Fller A5 Maschine Start

      A     #GenRel; 
      A     DB2650.DBX 2506.7; 
      =     DB2650.DBX 2507.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1670
TITLE =U067: Abfllanlage  7
FAMILY : BOTEC_F1
NAME : U067A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1670.DBW    0; 
      T     #UnitNo; 
      L     DB1670.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2675.unv001,
           ValExt                   := DB2675.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2675.unv002,
           ValExt                   := DB2675.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2675.unv003,
           ValExt                   := DB2675.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2675.unv004,
           ValExt                   := DB2675.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// FS_A7FS1 SpI 001 STROEMUNGSSCHALTER A7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.FS_A7FS1,
           SpIBit                   := I     27.0);

// A7_FUELLER_LAEUFT SpI 002 Fueller 7 laeuft
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_FUELLER_LAEUFT,
           SpIBit                   := I     76.1);

// A7_MIXER_CIP_BEREIT SpI 003 Mixer Anlage 7 CIP-Bereit
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_MIXER_CIP_BEREIT,
           SpIBit                   := I     78.0);

// A7_MIXER_VOLL SpI 004 Mixer Anlage 7 voll
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_MIXER_VOLL,
           SpIBit                   := I     78.2);

// A7_MIXER_LEER SpI 005 Mixer Anlage 7 leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_MIXER_LEER,
           SpIBit                   := I     78.1);

// A7_MIXER_ANF_SIRUP SpI 006 Mixer Anlage 7 Anforderung Sirup
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_MIXER_ANF_SIRUP,
           SpIBit                   := I     78.3);

// A7_FUELLER_CIP_BEREIT SpI 007 Fueller 7 CIP-Bereit
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_FUELLER_CIP_BEREIT,
           SpIBit                   := I     76.0);

// A7_SS_FRG_MOLCH SpI 009 Anlage 7 Schlsselschalter Freigabe Molch
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_SS_FRG_MOLCH,
           SpIBit                   := I     27.4);

// A7_FUELLER_LEER SpI 011 Fueller 7 leer (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_FUELLER_LEER,
           SpIBit                   := I     76.2);

// GOA_703 SpI 012 Meldung an Fueller/Mixer Anl.7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_FUELLER_VOLL,
           SpIBit                   := I     76.3);//"GOA_703"

// A7_RINSER_CIP_BEREIT SpI 013 Rinser Anlage 7 CIP-Bereit
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_RINSER_CIP_BEREIT,
           SpIBit                   := I     77.0);

// A7_RINSER_LAEUFT SpI 014 Rinser Anlage 7 laeuft
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.A7_RINSER_LAEUFT,
           SpIBit                   := I     77.1);

// EA7_K1_Handklappe SpI 015 Handklappe Fueller 7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2671.EA7_K1_Handklappe,
           SpIBit                   := I     27.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2677.msg001,
           MsgBit                   := DB2677.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2677.msg002,
           MsgBit                   := DB2677.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2677.msg003,
           MsgBit                   := DB2677.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A7_RRP1  CIP Rcklaufpumpe Anlage 7
// Act 001
// Box           : VSA7
// Input address : I25.7
// Output address: Q47.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.A7_RRP1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     25.7,
           Out                      := Q     47.7);

NETWORK
TITLE =F7_Maschine_Start  Fueller 7 Start
// Act 002
// Box           : FRM-A7
// Output address: Q54.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Maschine_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.0);

NETWORK
TITLE =F7_Maschine_Stop  Fueller 7 Stop
// Act 003
// Box           : FRM-A7
// Output address: Q54.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Maschine_Stop,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =R7_START_IMPULS  Rinser 7 Start
// Act 004
// Box           : FRM-A7
// Output address: Q56.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.R7_START_IMPULS,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     56.0);

NETWORK
TITLE =R7_STOP  Rinser 7 Stop
// Act 005
// Box           : FRM-A7
// Output address: Q56.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.R7_STOP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =R7_Kreislauf_ohne_aussen  Prog.schritt 15 CIP Krsl.o.ausse.
// Act 006
// Box           : FRM-A7
// Output address: Q56.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.R7_Kreislauf_ohne_aussen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     56.3);

NETWORK
TITLE =R7_Kreislauf_mit_aussen  Prog.schritt 16 CIP Krsl.m.ausse.
// Act 007
// Box           : FRM-A7
// Output address: Q56.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.R7_Kreislauf_mit_aussen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     56.4);

NETWORK
TITLE =R7_Grundstellung  Prog.schritt 1 Grundstellung
// Act 008
// Box           : FRM-A7
// Output address: Q56.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.R7_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     56.2);

NETWORK
TITLE =R7_Drainagestellung  Prog.schritt 2 Drainagestellung
// Act 009
// Box           : FRM-A7
// Output address: Q56.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.R7_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     56.5);

NETWORK
TITLE =F7_Kreislauf_o_puls  Prog.schritt 15 CIP Krsl.o.ausse.
// Act 010
// Box           : FRM-A7
// Output address: Q54.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Kreislauf_o_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.2);

NETWORK
TITLE =F7_Kreislauf_m_puls  Prog.schritt 16 CIP Krsl.m.ausse.
// Act 011
// Box           : FRM-A7
// Output address: Q54.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Kreislauf_m_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.3);

NETWORK
TITLE =F7_Randvollstellung  Prog.schritt 17 Randv./Standdes.
// Act 012
// Box           : FRM-A7
// Output address: Q54.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.4);

NETWORK
TITLE =F7_Klarspuelen_o_CIP_Beh  Prog.schritt 19 Klarsp.o.CIP Beh
// Act 013
// Box           : FRM-A7
// Output address: Q54.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Klarspuelen_o_CIP_Beh,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.5);

NETWORK
TITLE =F7_Ausschub_m_Sterilluft  Prog.schritt 20 Ausschub m.Steri
// Act 014
// Box           : FRM-A7
// Output address: Q54.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Ausschub_m_Sterilluft,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.6);

NETWORK
TITLE =F7_Ausschub_m_CO2  Prog.schritt 21 Ausschub m.CO2
// Act 015
// Box           : FRM-A7
// Output address: Q54.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Ausschub_m_CO2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     54.7);

NETWORK
TITLE =F7_Grundstellung  Prog.schritt 1 Grundstellung
// Act 016
// Box           : FRM-A7
// Output address: Q55.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     55.0);

NETWORK
TITLE =F7_Drainagestellung  Prog.schritt 2 Drainagestellung
// Act 017
// Box           : FRM-A7
// Output address: Q55.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     55.1);

NETWORK
TITLE =F7_Bypass  Prog.schritt 30 Bypass
// Act 018
// Box           : FRM-A7
// Output address: Q55.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.F7_Bypass,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     55.2);

NETWORK
TITLE =A7_RR1  A7RR1 Ventil CIP Rcklauf Kreis 1 Anlage 7
// Act 020
// Box           : VSRR6-11
// Input address : I28.0
// Output address: Q28.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.A7_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     28.0,
           Out                      := Q     28.0);

NETWORK
TITLE =A7_RR2  A7RR2 Ventil CIP Rcklauf Kreis 2 Anlage 7
// Act 021
// Box           : VSRR6-11
// Input address : I28.1
// Output address: Q28.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.A7_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     28.1,
           Out                      := Q     28.1);

NETWORK
TITLE =A7_RR3  A7RR3 Ventil CIP Rcklauf Kreis 3 Anlage 7
// Act 022
// Box           : VSRR6-11
// Input address : I28.2
// Output address: Q28.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.A7_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     28.2,
           Out                      := Q     28.2);

NETWORK
TITLE =M7_Grundstellung  Prog.schritt 101 Grundstellung
// Act 023
// Box           : FRM-A7
// Output address: Q58.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.0);

NETWORK
TITLE =M7_Drainagestellung  Prog.schritt 102 Darinage
// Act 024
// Box           : FRM-A7
// Output address: Q58.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.1);

NETWORK
TITLE =M7_Ausspritzen_o_Ablauf  Prog.schritt 113 Ausspr.o.Ablauf
// Act 025
// Box           : FRM-A7
// Output address: Q58.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Ausspritzen_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.2);

NETWORK
TITLE =M7_Ausspritzen_m_Ablauf  Prog.schritt 114 Ausspr.m.Ablauf
// Act 026
// Box           : FRM-A7
// Output address: Q58.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Ausspritzen_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.3);

NETWORK
TITLE =M7_Fluten_o_Ablauf  Prog.schritt 115 Fluten o.Ablauf
// Act 027
// Box           : FRM-A7
// Output address: Q58.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Fluten_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.4);

NETWORK
TITLE =M7_Fluten_m_Ablauf  Prog.schritt 116 Fluten m.Ablauf
// Act 028
// Box           : FRM-A7
// Output address: Q58.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Fluten_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.5);

NETWORK
TITLE =M7_Randvollstellung  Prog.schritt 117 Randvollstellung
// Act 029
// Box           : FRM-A7
// Output address: Q58.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.6);

NETWORK
TITLE =M7_Abpumpen  Prog.schritt 118 Abpumpen
// Act 030
// Box           : FRM-A7
// Output address: Q58.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Abpumpen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     58.7);

NETWORK
TITLE =M7_Klarspuelen  Prog.schritt 119 Klarspuelen
// Act 031
// Box           : FRM-A7
// Output address: Q59.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2670.M7_Klarspuelen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1671
TITLE =U067: Packaging Plant 7
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1671.DBX 1357.7; 
      CC    FB  1679; // "U067Sim"
      A     DB1671.DBX   17.3; 
      =     DB1671.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1670.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1671.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1675.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1671.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1675; // U067Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U067UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U067UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U067UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U067UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// A7_FUELLER_LAEUFT Fueller 7 laeuft
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_FUELLER_LAEUFT.EAl
//      =     "U067SpID".A7_FUELLER_LAEUFT.Pre

// ----------------------------------------------------------
// A7_MIXER_CIP_BEREIT Mixer Anlage 7 CIP-Bereit
// ----------------------------------------------------------
//      A     #CIP
//      =     "U067SpID".A7_MIXER_CIP_BEREIT.EAl
//      =     "U067SpID".A7_MIXER_CIP_BEREIT.Pre

// ----------------------------------------------------------
// A7_MIXER_VOLL Mixer Anlage 7 voll
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_MIXER_VOLL.EAl
//      =     "U067SpID".A7_MIXER_VOLL.Pre

// ----------------------------------------------------------
// A7_MIXER_LEER Mixer Anlage 7 leer
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_MIXER_LEER.EAl
//      =     "U067SpID".A7_MIXER_LEER.Pre

// ----------------------------------------------------------
// A7_MIXER_ANF_SIRUP Mixer Anlage 7 Anforderung Sirup
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_MIXER_ANF_SIRUP.EAl
//      =     "U067SpID".A7_MIXER_ANF_SIRUP.Pre

// ----------------------------------------------------------
// A7_SS_FRG_MOLCH Anlage 7 Schlsselschalter Freigabe Molch
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_SS_FRG_MOLCH.EAl
//      =     "U067SpID".A7_SS_FRG_MOLCH.Pre

// ----------------------------------------------------------
// A7_FUELLER_CIP_BEREIT Fueller 7 CIP-Bereit
// ----------------------------------------------------------
//      A     #CIP
//      =     "U067SpID".A7_FUELLER_CIP_BEREIT.EAl
//      =     "U067SpID".A7_FUELLER_CIP_BEREIT.Pre

// ----------------------------------------------------------
// A7_FUELLER_LEER Fueller 7 leer (Impuls)
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_FUELLER_LEER.EAl
//      =     "U067SpID".A7_FUELLER_LEER.Pre

// ----------------------------------------------------------
// A7_RINSER_CIP_BEREIT Rinser Anlage 7 CIP-Bereit
// ----------------------------------------------------------
//      A     #CIP
//      =     "U067SpID".A7_RINSER_CIP_BEREIT.EAl
//      =     "U067SpID".A7_RINSER_CIP_BEREIT.Pre

// ----------------------------------------------------------
// A7_RINSER_LAEUFT Rinser Anlage 7 laeuft
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".A7_RINSER_LAEUFT.EAl
//      =     "U067SpID".A7_RINSER_LAEUFT.Pre

// ----------------------------------------------------------
// EA7_K1_Handklappe Handklappe Fueller 7
// ----------------------------------------------------------
//      CLR   
//      =     "U067SpID".EA7_K1_Handklappe.EAl
//      =     "U067SpID".EA7_K1_Handklappe.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2677.DBX   80.7; 
      =     DB2677.DBX   81.4; 

      CLR   ; 
      =     DB2677.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2677.DBX  140.7; 
      =     DB2677.DBX  141.4; 

      CLR   ; 
      =     DB2677.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2677.DBX  200.7; 
      =     DB2677.DBX  201.4; 

      CLR   ; 
      =     DB2677.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1673.DBX   43.1; 
      S     DB1673.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2670.DBX  105.4; 
      =     DB2670.DBX  185.4; 
      S     DB2670.DBX  265.4; 
      =     DB2670.DBX  345.4; 
      S     DB2670.DBX  425.4; 
      =     DB2670.DBX  505.4; 
      =     DB2670.DBX  585.4; 
      =     DB2670.DBX  665.4; 
      =     DB2670.DBX  745.4; 
      =     DB2670.DBX  825.4; 
      =     DB2670.DBX  905.4; 
      =     DB2670.DBX  985.4; 
      =     DB2670.DBX 1065.4; 
      =     DB2670.DBX 1145.4; 
      =     DB2670.DBX 1225.4; 
      =     DB2670.DBX 1305.4; 
      =     DB2670.DBX 1385.4; 
      =     DB2670.DBX 1465.4; 
      =     DB2670.DBX 1625.4; 
      =     DB2670.DBX 1705.4; 
      =     DB2670.DBX 1785.4; 

      =     DB2670.DBX 1865.4; 
      =     DB2670.DBX 1945.4; 
      =     DB2670.DBX 2025.4; 
      =     DB2670.DBX 2105.4; 
      =     DB2670.DBX 2185.4; 
      =     DB2670.DBX 2265.4; 
      =     DB2670.DBX 2345.4; 
      =     DB2670.DBX 2425.4; 
      =     DB2670.DBX 2505.4; 




MODE: SET   ; 

NETWORK
TITLE =A7_RRP1 CIP Rcklaufpumpe Anlage 7

//      A     "U067SpID".FS_A7FS1.Sig
      AN    DB2671.DBX   78.1; 

      A     #GenRel; 
      A     DB2670.DBX  106.7; 
      =     DB2670.DBX  107.6; 
NETWORK
TITLE =F7_Maschine_Start Fueller 7 Start

      A     #GenRel; 
      A     DB2670.DBX  186.7; 
      =     DB2670.DBX  187.6; 
NETWORK
TITLE =F7_Maschine_Stop Fueller 7 Stop

      A     #GenRel; 
      A     DB2670.DBX  266.7; 
      =     DB2670.DBX  267.6; 

      AN    DB2670.DBX  263.4; 
      =     Q     54.1; 
NETWORK
TITLE =R7_START_IMPULS Rinser 7 Start

      A     #GenRel; 
      A     DB2670.DBX  346.7; 
      =     DB2670.DBX  347.6; 


NETWORK
TITLE =R7_STOP Rinser 7 Stop

      A     #GenRel; 
      A     DB2670.DBX  426.7; 
      =     DB2670.DBX  427.6; 

      AN    DB2670.DBX  423.4; 
      =     Q     56.1; 

NETWORK
TITLE =R7_Grundstellung Prog.schritt 1 Grundstellung

      A     #GenRel; 
      A     DB2670.DBX  506.7; 
      =     DB2670.DBX  507.6; 
NETWORK
TITLE =R7_Kreislauf_ohne_aussen Prog.schritt 15 CIP Krsl.o.ausse.

      A     #GenRel; 
      A     DB2670.DBX  586.7; 
      =     DB2670.DBX  587.6; 
NETWORK
TITLE =R7_Kreislauf_mit_aussen Prog.schritt 16 CIP Krsl.m.ausse.

      A     #GenRel; 
      A     DB2670.DBX  666.7; 
      =     DB2670.DBX  667.6; 
NETWORK
TITLE =R7_Drainagestellung Prog.schritt 2 Drainagestellung

      A     #GenRel; 
      A     DB2670.DBX  746.7; 
      =     DB2670.DBX  747.6; 
NETWORK
TITLE =F7_Kreislauf_o_puls Prog.schritt 15 CIP Krsl.o.ausse.

      A     #GenRel; 
      A     DB2670.DBX  826.7; 
      =     DB2670.DBX  827.6; 
NETWORK
TITLE =F7_Kreislauf_m_puls Prog.schritt 16 CIP Krsl.m.ausse.

      A     #GenRel; 
      A     DB2670.DBX  906.7; 
      =     DB2670.DBX  907.6; 
NETWORK
TITLE =F7_Randvollstellung Prog.schritt 17 Randv./Standdes.

      A     #GenRel; 
      A     DB2670.DBX  986.7; 
      =     DB2670.DBX  987.6; 
NETWORK
TITLE =F7_Klarspuelen_o_CIP_Beh Prog.schritt 19 Klarsp.o.CIP Beh

      A     #GenRel; 
      A     DB2670.DBX 1066.7; 
      =     DB2670.DBX 1067.6; 
NETWORK
TITLE =F7_Ausschub_m_Sterilluft Prog.schritt 20 Ausschub m.Steri

      A     #GenRel; 
      A     DB2670.DBX 1146.7; 
      =     DB2670.DBX 1147.6; 
NETWORK
TITLE =F7_Ausschub_m_CO2 Prog.schritt 21 Ausschub m.CO2

      A     #GenRel; 
      A     DB2670.DBX 1226.7; 
      =     DB2670.DBX 1227.6; 
NETWORK
TITLE =F7_Grundstellung Prog.schritt 1 Grundstellung

      A     #GenRel; 
      A     DB2670.DBX 1306.7; 
      =     DB2670.DBX 1307.6; 
NETWORK
TITLE =F7_Drainagestellung Prog.schritt 2 Drainagestellung

      A     #GenRel; 
      A     DB2670.DBX 1386.7; 
      =     DB2670.DBX 1387.6; 
NETWORK
TITLE =F7_Bypass Prog.schritt 30 Bypass

      A     #GenRel; 
      A     DB2670.DBX 1466.7; 
      =     DB2670.DBX 1467.6; 
NETWORK
TITLE =A7_RR1 A7RR1 Ventil CIP Rcklauf Kreis 1 Anlage 7

      A     #GenRel; 
      A     DB2670.DBX 1626.7; 
      =     DB2670.DBX 1627.6; 
NETWORK
TITLE =A7_RR2 A7RR2 Ventil CIP Rcklauf Kreis 2 Anlage 7

      A     #GenRel; 
      A     DB2670.DBX 1706.7; 
      =     DB2670.DBX 1707.6; 
NETWORK
TITLE =A7_RR3 A7RR3 Ventil CIP Rcklauf Kreis 3 Anlage 7

      A     #GenRel; 
      A     DB2670.DBX 1786.7; 
      =     DB2670.DBX 1787.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1680
TITLE =U068: Packaging Plant 8
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1680.DBW    0; 
      T     #UnitNo; 
      L     DB1680.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2685.unv001,
           ValExt                   := DB2685.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2685.unv002,
           ValExt                   := DB2685.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2685.unv003,
           ValExt                   := DB2685.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2685.unv004,
           ValExt                   := DB2685.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// DT_STOP_FUELLER_8 SpI 002 Anlage 8 Taster STOP
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.DT_STOP_FUELLER_8,
           SpIBit                   := I    113.4);

// DT_START_FUELLER_8 SpI 003 Anlage 8 Taster START
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.DT_START_FUELLER_8,
           SpIBit                   := I    113.5);

// A8_LAMPENTEST SpI 011 Anlage 8 Taster Lampen prfen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.A8_LAMPENTEST,
           SpIBit                   := I    112.7);

// A8_A8V1_HAND SpI 024 Anlage 8 Schalter Handansteuerung Ventil A8V1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.A8_A8V1_HAND,
           SpIBit                   := I    113.0);

// A8_A8V2_HAND SpI 025 Anlage 8 Schalter Handansteuerung Ventil A8V2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.A8_A8V2_HAND,
           SpIBit                   := I    113.1);

// A8_A8V3_HAND SpI 026 Anlage 8 Schalter Handansteuerung Ventil A8V3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.A8_A8V3_HAND,
           SpIBit                   := I    113.2);

// A8_ANFORD_WASSER SpI 027 Anlage 8 Schalter Anforderung Wasser (RWPA8)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.A8_ANFORD_WASSER,
           SpIBit                   := I    113.3);

// A8_SS_HAND SpI 028 Anlage 8 Schlsselschalter Hand
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2681.A8_SS_HAND,
           SpIBit                   := I    113.6);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2687.msg001,
           MsgBit                   := DB2687.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2687.msg002,
           MsgBit                   := DB2687.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2687.msg003,
           MsgBit                   := DB2687.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RWP_A8  RWPA8 Anlage 8 Befllpumpe
// Act 001
// Box           : VSA8
// Input address : I112.3
// Output address: Q44.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.RWP_A8,
           Typ                      := 3,
           FBa                      := I    112.3,
           FBa2                     := #xTmp,
           Out                      := Q     44.3);

NETWORK
TITLE =A8_V1  A8V1 Anlage 8 Ventil Filter
// Act 002
// Box           : VSA8
// Input address : I112.0
// Output address: Q44.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.A8_V1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    112.0,
           Out                      := Q     44.0);

NETWORK
TITLE =A8_V2  A8V2 Anlage 8 Ventil Filter
// Act 003
// Box           : VSA8
// Input address : I112.1
// Output address: Q44.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.A8_V2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    112.1,
           Out                      := Q     44.1);

NETWORK
TITLE =A8_V3  A8V3 Anlage 8 Ventil Filter
// Act 004
// Box           : VSA8
// Input address : I112.2
// Output address: Q44.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.A8_V3,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    112.2,
           Out                      := Q     44.2);

NETWORK
TITLE =LA_A8_V1  Anlage 8 Lampe A8V1
// Act 005
// Box           : VSA8
// Output address: Q45.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.LA_A8_V1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     45.0);

NETWORK
TITLE =LA_A8_V2  Anlage 8 Lampe A8V2
// Act 006
// Box           : VSA8
// Output address: Q45.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.LA_A8_V2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     45.1);

NETWORK
TITLE =LA_A8_V3  Anlage 8 Lampe A8V3
// Act 007
// Box           : VSA8
// Output address: Q45.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.LA_A8_V3,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     45.2);

NETWORK
TITLE =LA_A8_RWPA8  Anlage 8 Lampe RWPA8
// Act 008
// Box           : VSA8
// Output address: Q45.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.LA_A8_RWPA8,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     45.3);

NETWORK
TITLE =LA_A8_PROD  Anlage 8 Lampe Produktion
// Act 009
// Box           : VSA8
// Output address: Q45.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.LA_A8_PROD,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     45.6);

NETWORK
TITLE =LA_A8_CIP  Anlage 8 Lampe CIP
// Act 010
// Box           : VSA8
// Output address: Q45.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.LA_A8_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     45.7);

NETWORK
TITLE =A8_RR1  A8RR1 CIP Rcklaufventil Kreis 1 Anlage 8
// Act 020
// Box           : VS-RRA
// Input address : I200.0
// Output address: Q200.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.A8_RR1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    200.0,
           Out                      := Q    200.0);

NETWORK
TITLE =A8_RR2  A8RR2 CIP Rcklaufventil Kreis 2 Anlage 8
// Act 021
// Box           : VS-RRA
// Input address : I200.1
// Output address: Q200.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.A8_RR2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    200.1,
           Out                      := Q    200.1);

NETWORK
TITLE =A8_RR3  A8RR3 CIP Rcklaufventil Kreis 3 Anlage 8
// Act 022
// Box           : VS-RRA
// Input address : I200.2
// Output address: Q200.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2680.A8_RR3,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    200.2,
           Out                      := Q    200.2);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1681
TITLE =U068: Packaging Plant 8
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1681.DBX 1357.7; 
      CC    FB  1689; // "U068Sim"
      A     DB1681.DBX   17.3; 
      =     DB1681.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1680.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1681.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1685.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1681.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1685; // U068Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U068UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U068UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U068UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U068UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// DT_STOP_FUELLER_8 Anlage 8 Taster STOP
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX  141.4; 
      =     DB2681.DBX  141.5; 

// ----------------------------------------------------------
// DT_START_FUELLER_8 Anlage 8 Taster START
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX  201.4; 
      =     DB2681.DBX  201.5; 

// ----------------------------------------------------------
// A8_LAMPENTEST Anlage 8 Taster Lampen prfen
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX  681.4; 
      =     DB2681.DBX  681.5; 

// ----------------------------------------------------------
// A8_A8V1_HAND Anlage 8 Schalter Handansteuerung Ventil A8V1
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX 1461.4; 
      =     DB2681.DBX 1461.5; 

// ----------------------------------------------------------
// A8_A8V2_HAND Anlage 8 Schalter Handansteuerung Ventil A8V2
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX 1521.4; 
      =     DB2681.DBX 1521.5; 

// ----------------------------------------------------------
// A8_A8V3_HAND Anlage 8 Schalter Handansteuerung Ventil A8V3
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX 1581.4; 
      =     DB2681.DBX 1581.5; 

// ----------------------------------------------------------
// A8_ANFORD_WASSER Anlage 8 Schalter Anforderung Wasser (RWPA8)
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX 1641.4; 
      =     DB2681.DBX 1641.5; 

// ----------------------------------------------------------
// A8_SS_HAND Anlage 8 Schlsselschalter Hand
// ----------------------------------------------------------
      CLR   ; 
      =     DB2681.DBX 1701.4; 
      =     DB2681.DBX 1701.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2687.DBX   80.7; 
      =     DB2687.DBX   81.4; 

      CLR   ; 
      =     DB2687.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2687.DBX  140.7; 
      =     DB2687.DBX  141.4; 

      CLR   ; 
      =     DB2687.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2687.DBX  200.7; 
      =     DB2687.DBX  201.4; 

      CLR   ; 
      =     DB2687.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1683.DBX   43.1; 
      S     DB1683.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2680.DBX  105.4; 
      =     DB2680.DBX  185.4; 
      =     DB2680.DBX  265.4; 
      =     DB2680.DBX  345.4; 
      =     DB2680.DBX  425.4; 
      =     DB2680.DBX  505.4; 
      =     DB2680.DBX  585.4; 
      =     DB2680.DBX  665.4; 
      =     DB2680.DBX  745.4; 
      =     DB2680.DBX  825.4; 
      =     DB2680.DBX 1625.4; 
      =     DB2680.DBX 1705.4; 
      =     DB2680.DBX 1785.4; 



MODE: SET   ; 

NETWORK
TITLE =RWP_A8 RWPA8 Anlage 8 Befllpumpe

      A     #GenRel; 
      A     DB2680.DBX  106.7; 
      =     DB2680.DBX  107.6; 
NETWORK
TITLE =A8_V1 A8V1 Anlage 8 Ventil Filter

      A     #GenRel; 
      A     DB2680.DBX  186.7; 
      =     DB2680.DBX  187.6; 
NETWORK
TITLE =A8_V2 A8V2 Anlage 8 Ventil Filter

      A     #GenRel; 
      A     DB2680.DBX  266.7; 
      =     DB2680.DBX  267.6; 
NETWORK
TITLE =A8_V3 A8V3 Anlage 8 Ventil Filter

      A     #GenRel; 
      A     DB2680.DBX  346.7; 
      =     DB2680.DBX  347.6; 
NETWORK
TITLE =LA_A8_V1 Anlage 8 Lampe A8V1

      A     #GenRel; 
      A     DB2680.DBX  426.7; 
      =     DB2680.DBX  427.6; 
NETWORK
TITLE =LA_A8_V2 Anlage 8 Lampe A8V2

      A     #GenRel; 
      A     DB2680.DBX  506.7; 
      =     DB2680.DBX  507.6; 
NETWORK
TITLE =LA_A8_V3 Anlage 8 Lampe A8V3

      A     #GenRel; 
      A     DB2680.DBX  586.7; 
      =     DB2680.DBX  587.6; 
NETWORK
TITLE =LA_A8_RWPA8 Anlage 8 Lampe RWPA8

      A     #GenRel; 
      A     DB2680.DBX  666.7; 
      =     DB2680.DBX  667.6; 
NETWORK
TITLE =LA_A8_PROD Anlage 8 Lampe Produktion

      A     #GenRel; 
      A     DB2680.DBX  746.7; 
      =     DB2680.DBX  747.6; 
NETWORK
TITLE =LA_A8_CIP Anlage 8 Lampe CIP

      A     #GenRel; 
      A     DB2680.DBX  826.7; 
      =     DB2680.DBX  827.6; 
NETWORK
TITLE =A8_RR1 A8RR1 CIP Rcklaufventil Kreis 1 Anlage 8

      A     #GenRel; 
      A     DB2680.DBX 1626.7; 
      =     DB2680.DBX 1627.6; 
NETWORK
TITLE =A8_RR2 A8RR2 CIP Rcklaufventil Kreis 2 Anlage 8

      A     #GenRel; 
      A     DB2680.DBX 1706.7; 
      =     DB2680.DBX 1707.6; 
NETWORK
TITLE =A8_RR3 A8RR3 CIP Rcklaufventil Kreis 3 Anlage 8

      A     #GenRel; 
      A     DB2680.DBX 1786.7; 
      =     DB2680.DBX 1787.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1690
TITLE =U069: Abfllanlage  9
FAMILY : BOTEC_F1
NAME : U069A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1690.DBW    0; 
      T     #UnitNo; 
      L     DB1690.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// HWWT1_TT01 AnI 001 Heiwasser-Wrmetauscher1 TT01
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2693.HWWT1_TT01,
           ValPer                   := PIW  236);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2695.unv001,
           ValExt                   := DB2695.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2695.unv002,
           ValExt                   := DB2695.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2695.unv003,
           ValExt                   := DB2695.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2695.unv004,
           ValExt                   := DB2695.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// A9_FS1 SpI 001 gendert 07.11.01 A11 FS1 Stmungswchter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.A9_FS1,
           SpIBit                   := I    177.0);

// TS_HL_ANL9 SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.TS_HL_ANL9,
           SpIBit                   := I     62.0);

// GOA_903 SpI 004 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.GOA_903,
           SpIBit                   := I    176.2);

// LDT_A9_PRODUKT SpI 008 AB FUELLER 9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.LDT_A9_PRODUKT,
           SpIBit                   := I     52.3);

// LDT_A9_CIP SpI 009 AB FUELLER 9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.LDT_A9_CIP,
           SpIBit                   := I     52.4);

// DT_A9_START SpI 010 AB FUELLER 9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.DT_A9_START,
           SpIBit                   := I     52.5);

// DT_A9_STOP SpI 011 AB FUELLER 9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.DT_A9_STOP,
           SpIBit                   := I     52.6);

// DT_LAMPEN_PRUEFEN_A9_L10 SpI 012 AB FUELLER 9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.DT_LAMPEN_PRUEFEN_A9_L10,
           SpIBit                   := I     53.6);

// QUITT_A9_LA10 SpI 013 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.QUITT_A9_LA10,
           SpIBit                   := I     53.7);

// BETRIEB_F9 SpI 014 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.BETRIEB_F9,
           SpIBit                   := I     62.4);

// BETRIEB_MIX_LKASKADE_F9 SpI 015 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.BETRIEB_MIX_LKASKADE_F9,
           SpIBit                   := I     62.6);

// M9_Produkt_kommt SpI 016 Meldung von Mixer9 fr Heiabfllung-Ausschub
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.M9_Produkt_kommt,
           SpIBit                   := I     40.7);

// F9_TEMPERATUR_ERREICHT SpI 017 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.F9_TEMPERATUR_ERREICHT,
           SpIBit                   := I     41.0);

// F9_TEMPERATUR_MIN_LMAX SpI 018 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.F9_TEMPERATUR_MIN_LMAX,
           SpIBit                   := I     41.1);

// F9_ANF_PRODUKTPUMPE SpI 019 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.F9_ANF_PRODUKTPUMPE,
           SpIBit                   := I     41.2);

// F9_PRODUKTIONSENDE SpI 020 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.F9_PRODUKTIONSENDE,
           SpIBit                   := I     41.3);

// F9_BETRIEBSBEREIT SpI 021 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.F9_BETRIEBSBEREIT,
           SpIBit                   := I     41.4);

// RM_RWPA9 SpI 022 SIGNAL VON MIXER F9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.RM_RWPA9,
           SpIBit                   := I    122.5);

// MIX_WEGFREIGABE_9_L9 SpI 023 SIGNAL VON MIXER A9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.MIX_WEGFREIGABE_9_L9,
           SpIBit                   := I    122.6);

// MIX_WEGFREIGABE_9_L10 SpI 024 SIGNAL VON MIXER A9/10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.MIX_WEGFREIGABE_9_L10,
           SpIBit                   := I    122.7);

// MIX_ANFORDERUNG_PUMPE SpI 025 SIGNAL VON MIXER F9/F10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.MIX_ANFORDERUNG_PUMPE,
           SpIBit                   := I    122.4);

// LS_LLL_A9 SpI 034 SIGNAL VON FUELLER 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2691.LS_LLL_A9,
           SpIBit                   := I     62.2);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2697.msg001,
           MsgBit                   := DB2697.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2697.msg002,
           MsgBit                   := DB2697.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2697.msg003,
           MsgBit                   := DB2697.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A9_UV1  Bypass CIP Anlage 9
// Act 019
// Box           : VSRVK1..3
// Input address : I82.4
// Output address: Q82.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.A9_UV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     82.4,
           Out                      := Q     82.4);

NETWORK
TITLE =A9_RR1  Reinigungsrcklauf Anlage 9 zu Kreis 1
// Act 020
// Box           : VSRR1-3
// Input address : I84.3
// Output address: Q84.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.A9_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.3,
           Out                      := Q     84.3);

NETWORK
TITLE =A9_RR2  Reinigungsrcklauf Anlage 9 zu Kreis 2
// Act 021
// Box           : VSRR1-3
// Input address : I84.4
// Output address: Q84.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.A9_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.4,
           Out                      := Q     84.4);

NETWORK
TITLE =A9_RR3  Reinigungsrcklauf Anlage 9 zu Kreis 3
// Act 022
// Box           : VSRR1-3
// Input address : I84.5
// Output address: Q84.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.A9_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.5,
           Out                      := Q     84.5);

NETWORK
TITLE =LA_LDS_A9_V11  AB FUELLER 9/10
// Act 023
// Box           : S8 U8.2
// Input address : I52.0
// Output address: Q111.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.LA_LDS_A9_V11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     52.0,
           Out                      := Q    111.5);

NETWORK
TITLE =LA_LDS_A9_V12  AB FUELLER 9/10
// Act 024
// Box           : S8 U8.2
// Input address : I52.1
// Output address: Q111.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.LA_LDS_A9_V12,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     52.1,
           Out                      := Q    111.6);

NETWORK
TITLE =LA_LDS_A9_V13  AB FUELLER 9/10
// Act 025
// Box           : S8 U8.2
// Input address : I52.2
// Output address: Q111.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.LA_LDS_A9_V13,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     52.2,
           Out                      := Q    111.7);

NETWORK
TITLE =RUECKL_ROEHRE_SPUELF9  SIGNAL AN FUELLER 9
// Act 026
// Box           : S8 U8.2
// Output address: Q40.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.RUECKL_ROEHRE_SPUELF9,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     40.6);

NETWORK
TITLE =RUECKL_ROEHRE_SPUELF10  SIGNAL AN FUELLER 10
// Act 027
// Box           : S8 U8.2
// Output address: Q40.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.RUECKL_ROEHRE_SPUELF10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     40.7);

NETWORK
TITLE =UMSCHALTSIGN_MIX_F9_10  SIGNAL AN MIXER F9/10
// Act 029
// Box           : S8 U8.2
// Output address: Q41.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.UMSCHALTSIGN_MIX_F9_10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     41.2);

NETWORK
TITLE =STOP_SIGNALMIX_F9_10  SIGNAL AN MIXER F9/10
// Act 030
// Box           : S8 U8.2
// Output address: Q41.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.STOP_SIGNALMIX_F9_10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     41.3);

NETWORK
TITLE =HF9V2_OFFEN_MIX_F9_10  SIGNAL AN MIXER F9/10
// Act 031
// Box           : S8 U8.2
// Output address: Q41.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.HF9V2_OFFEN_MIX_F9_10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     41.4);

NETWORK
TITLE =LA_LDT_A9_CIP  AB FUELLER 9/10
// Act 035
// Box           : S8 U8.2
// Output address: Q42.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.LA_LDT_A9_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.6);

NETWORK
TITLE =LA_A9_TSH  AB FUELLER 9/10
// Act 036
// Box           : S8 U8.2
// Output address: Q42.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.LA_A9_TSH,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.7);

NETWORK
TITLE =HEISSABFUELUNG_OK_F9  SIGNAL VON TU AN FUELLER 9
// Act 037
// Box           : S8 U8.2
// Output address: Q43.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.HEISSABFUELUNG_OK_F9,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.6);

NETWORK
TITLE =LA_LDT_A9PRODUKT  AB FUELLER 9/10
// Act 038
// Box           : S8 U8.2
// Output address: Q43.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.LA_LDT_A9PRODUKT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.7);

NETWORK
TITLE =F9_LEERDRUECKEN  SIGNAL VON TU AN FUELLER 9
// Act 039
// Box           : S8 U8.2
// Output address: Q120.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.F9_LEERDRUECKEN,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    120.0);

NETWORK
TITLE =F9_AUF_KREISLAUF  SIGNAL VON TU AN FUELLER 9
// Act 040
// Box           : S8 U8.2
// Output address: Q120.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2690.F9_AUF_KREISLAUF,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    120.1);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1691
TITLE =U069: Packaging Plant 9
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1691.DBX 1357.7; 
      CC    FB  1699; // "U069Sim"
      A     DB1691.DBX   17.3; 
      =     DB1691.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1690.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1691.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1695.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1691.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1695; // U069Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// HWWT1_TT01 Heiwasser-Wrmetauscher1 TT01
// ----------------------------------------------------------
      L     DB1691.DBD 1118; // !!! insert correct SFM !!!
      T     DB2693.DBD  238; 

//      SET   
//      =     "U069AnID".HWWT1_TT01.EAlHH

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U069UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U069UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U069UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U069UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LLL_A9 SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".LS_LLL_A9.EAl
//      =     "U069SpID".LS_LLL_A9.Pre

// ----------------------------------------------------------
// TS_HL_ANL9 
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".TS_HL_ANL9.EAl
//      =     "U069SpID".TS_HL_ANL9.Pre

// ----------------------------------------------------------
// A9_SS_FRG_MOLCH Anlage 9 Schlsselschalter Freigabe Molch
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".A9_SS_FRG_MOLCH.EAl
//      =     "U069SpID".A9_SS_FRG_MOLCH.Pre

// ----------------------------------------------------------
// LDT_A9_PRODUKT AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".LDT_A9_PRODUKT.EAl
//      =     "U069SpID".LDT_A9_PRODUKT.Pre

// ----------------------------------------------------------
// LDT_A9_CIP AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".LDT_A9_CIP.EAl
//      =     "U069SpID".LDT_A9_CIP.Pre

// ----------------------------------------------------------
// DT_A9_START AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".DT_A9_START.EAl
//      =     "U069SpID".DT_A9_START.Pre

// ----------------------------------------------------------
// DT_A9_STOP AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".DT_A9_STOP.EAl
//      =     "U069SpID".DT_A9_STOP.Pre

// ----------------------------------------------------------
// DT_LAMPEN_PRUEFEN_A9_L10 AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".DT_LAMPEN_PRUEFEN_A9_L10.EAl
//      =     "U069SpID".DT_LAMPEN_PRUEFEN_A9_L10.Pre

// ----------------------------------------------------------
// QUITT_A9_LA10 
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".QUITT_A9_LA10.EAl
//      =     "U069SpID".QUITT_A9_LA10.Pre

// ----------------------------------------------------------
// BETRIEB_F9 SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".BETRIEB_F9.EAl
//      =     "U069SpID".BETRIEB_F9.Pre

// ----------------------------------------------------------
// BETRIEB_MIX_LKASKADE_F9 SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".BETRIEB_MIX_LKASKADE_F9.EAl
//      =     "U069SpID".BETRIEB_MIX_LKASKADE_F9.Pre

// ----------------------------------------------------------
// M9_Produkt_kommt Meldung von Mixer9 fr Heiabfllung-Ausschub
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".M9_Produkt_kommt.EAl
//      =     "U069SpID".M9_Produkt_kommt.Pre

// ----------------------------------------------------------
// F9_TEMPERATUR_ERREICHT SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".F9_TEMPERATUR_ERREICHT.EAl
//      =     "U069SpID".F9_TEMPERATUR_ERREICHT.Pre

// ----------------------------------------------------------
// F9_TEMPERATUR_MIN_LMAX SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".F9_TEMPERATUR_MIN_LMAX.EAl
//      =     "U069SpID".F9_TEMPERATUR_MIN_LMAX.Pre

// ----------------------------------------------------------
// F9_ANF_PRODUKTPUMPE SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".F9_ANF_PRODUKTPUMPE.EAl
//      =     "U069SpID".F9_ANF_PRODUKTPUMPE.Pre

// ----------------------------------------------------------
// F9_PRODUKTIONSENDE SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".F9_PRODUKTIONSENDE.EAl
//      =     "U069SpID".F9_PRODUKTIONSENDE.Pre

// ----------------------------------------------------------
// F9_BETRIEBSBEREIT SIGNAL VON FUELLER 9
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".F9_BETRIEBSBEREIT.EAl
//      =     "U069SpID".F9_BETRIEBSBEREIT.Pre

// ----------------------------------------------------------
// RM_RWPA9 SIGNAL VON MIXER F9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".RM_RWPA9.EAl
//      =     "U069SpID".RM_RWPA9.Pre

// ----------------------------------------------------------
// MIX_WEGFREIGABE_9_L9 SIGNAL VON MIXER A9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".MIX_WEGFREIGABE_9_L9.EAl
//      =     "U069SpID".MIX_WEGFREIGABE_9_L9.Pre

// ----------------------------------------------------------
// MIX_WEGFREIGABE_9_L10 SIGNAL VON MIXER A9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".MIX_WEGFREIGABE_9_L10.EAl
//      =     "U069SpID".MIX_WEGFREIGABE_9_L10.Pre

// ----------------------------------------------------------
// MIX_ANFORDERUNG_PUMPE SIGNAL VON MIXER F9/F10
// ----------------------------------------------------------
//      CLR   
//      =     "U069SpID".MIX_ANFORDERUNG_PUMPE.EAl
//      =     "U069SpID".MIX_ANFORDERUNG_PUMPE.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2697.DBX   80.7; 
      =     DB2697.DBX   81.4; 

      CLR   ; 
      =     DB2697.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2697.DBX  140.7; 
      =     DB2697.DBX  141.4; 

      CLR   ; 
      =     DB2697.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2697.DBX  200.7; 
      =     DB2697.DBX  201.4; 

      CLR   ; 
      =     DB2697.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Heiwasser-Wrmetauscher1 TT01 -----------------------
      L     DB2693.DBD  146; 
      T     DB1691.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1693.DBX   43.1; 
      S     DB1693.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2690.DBX 1545.4; 
      =     DB2690.DBX 1625.4; 
      =     DB2690.DBX 1705.4; 
      =     DB2690.DBX 1785.4; 
      =     DB2690.DBX 1865.4; 
      =     DB2690.DBX 1945.4; 
      =     DB2690.DBX 2025.4; 
      =     DB2690.DBX 2105.4; 
      =     DB2690.DBX 2185.4; 
      =     DB2690.DBX 2265.4; 
      =     DB2690.DBX 2345.4; 
      =     DB2690.DBX 2425.4; 
      =     DB2690.DBX 2505.4; 
      =     DB2690.DBX 2585.4; 
      =     DB2690.DBX 2665.4; 
      =     DB2690.DBX 2745.4; 
      =     DB2690.DBX 2825.4; 
      =     DB2690.DBX 2905.4; 
      =     DB2690.DBX 2985.4; 
      =     DB2690.DBX 3065.4; 
      =     DB2690.DBX 3145.4; 
      =     DB2690.DBX 3225.4; 



MODE: SET   ; 

NETWORK
TITLE =A9_RR1 Reinigungsrcklauf Anlage 9 zu Kreis 1

      A     #GenRel; 
      A     DB2690.DBX 1626.7; 
      =     DB2690.DBX 1627.6; 
NETWORK
TITLE =A9_RR2 Reinigungsrcklauf Anlage 9 zu Kreis 2

      A     #GenRel; 
      A     DB2690.DBX 1706.7; 
      =     DB2690.DBX 1707.6; 
NETWORK
TITLE =A9_RR3 Reinigungsrcklauf Anlage 9 zu Kreis 3

      A     #GenRel; 
      A     DB2690.DBX 1786.7; 
      =     DB2690.DBX 1787.6; 
NETWORK
TITLE =LA_LDS_A9_V11 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2690.DBX 1866.7; 
      =     DB2690.DBX 1867.6; 
NETWORK
TITLE =LA_LDS_A9_V12 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2690.DBX 1946.7; 
      =     DB2690.DBX 1947.6; 
NETWORK
TITLE =LA_LDS_A9_V13 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2690.DBX 2026.7; 
      =     DB2690.DBX 2027.6; 
NETWORK
TITLE =RUECKL_ROEHRE_SPUELF9 SIGNAL AN FUELLER 9

      A     #GenRel; 
      A     DB2690.DBX 2106.7; 
      =     DB2690.DBX 2107.6; 
NETWORK
TITLE =RUECKL_ROEHRE_SPUELF10 SIGNAL AN FUELLER 10

      A     #GenRel; 
      A     DB2690.DBX 2186.7; 
      =     DB2690.DBX 2187.6; 
NETWORK
TITLE =FREIGVORLP_MIX_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2266.7; 
      =     DB2690.DBX 2267.6; 
NETWORK
TITLE =UMSCHALTSIGN_MIX_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2346.7; 
      =     DB2690.DBX 2347.6; 
NETWORK
TITLE =STOP_SIGNALMIX_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2426.7; 
      =     DB2690.DBX 2427.6; 
NETWORK
TITLE =HF9V2_OFFEN_MIX_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2506.7; 
      =     DB2690.DBX 2507.6; 
NETWORK
TITLE =FREIGVORLP_KASK_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2586.7; 
      =     DB2690.DBX 2587.6; 
NETWORK
TITLE =UMSCHALTSIGN_KASK_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2666.7; 
      =     DB2690.DBX 2667.6; 
NETWORK
TITLE =STOP_SIGNALKASK_F9_10 SIGNAL AN MIXER F9/10

      A     #GenRel; 
      A     DB2690.DBX 2746.7; 
      =     DB2690.DBX 2747.6; 
NETWORK
TITLE =LA_LDT_A9_CIP AB FUELLER 9/10

      A     #GenRel; 
      A     DB2690.DBX 2826.7; 
      =     DB2690.DBX 2827.6; 
NETWORK
TITLE =LA_A9_TSH AB FUELLER 9/10

      A     #GenRel; 
      A     DB2690.DBX 2906.7; 
      =     DB2690.DBX 2907.6; 
NETWORK
TITLE =HEISSABFUELUNG_OK_F9 SIGNAL VON TU AN FUELLER 9

      A     #GenRel; 
      A     DB2690.DBX 2986.7; 
      =     DB2690.DBX 2987.6; 
NETWORK
TITLE =LA_LDT_A9PRODUKT AB FUELLER 9/10

      A     #GenRel; 
      A     DB2690.DBX 3066.7; 
      =     DB2690.DBX 3067.6; 
NETWORK
TITLE =F9_LEERDRUECKEN SIGNAL VON TU AN FUELLER 9

      A     #GenRel; 
      A     DB2690.DBX 3146.7; 
      =     DB2690.DBX 3147.6; 
NETWORK
TITLE =F9_AUF_KREISLAUF SIGNAL VON TU AN FUELLER 9

      A     #GenRel; 
      A     DB2690.DBX 3226.7; 
      =     DB2690.DBX 3227.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1700
TITLE =U070: Abfllanlage 10
FAMILY : BOTEC_F1
NAME : U070A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1700.DBW    0; 
      T     #UnitNo; 
      L     DB1700.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2705.unv001,
           ValExt                   := DB2705.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2705.unv002,
           ValExt                   := DB2705.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2705.unv003,
           ValExt                   := DB2705.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2705.unv004,
           ValExt                   := DB2705.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_A10 SpI 001 LS_LLL_A10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.LS_LLL_A10,
           SpIBit                   := I     62.3);

// TS_HL_ANL10 SpI 002 TS_HL_ANL10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.TS_HL_ANL10,
           SpIBit                   := I     62.1);

// DT_A10_START SpI 003 DT_A10_START
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.DT_A10_START,
           SpIBit                   := I     53.4);

// DT_A10_STOP SpI 004 DT_A10_STOP
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.DT_A10_STOP,
           SpIBit                   := I     53.5);

// BETRIEB_F10 SpI 005 BETRIEB_F10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.BETRIEB_F10,
           SpIBit                   := I     62.5);

// BETRIEB_MIX_LKASKADE_F10 SpI 006 BETRIEB_MIX_LKASKADE_F10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.BETRIEB_MIX_LKASKADE_F10,
           SpIBit                   := I     62.7);

// KASK_ANFORDERUNG_PUMPE SpI 007 KASK_ANFORDERUNG_PUMPE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.KASK_ANFORDERUNG_PUMPE,
           SpIBit                   := I    123.3);

// RM_RWPA10 SpI 008 RM_RWPA10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.RM_RWPA10,
           SpIBit                   := I    123.4);

// KAS_WEGFREIGABE_10_L9 SpI 009 KAS_WEGFREIGABE_10_L9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.KAS_WEGFREIGABE_10_L9,
           SpIBit                   := I    123.5);

// KAS_WEGFREIGABE_10_L10 SpI 010 KAS_WEGFREIGABE_10_L10
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2701.KAS_WEGFREIGABE_10_L10,
           SpIBit                   := I    123.6);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2707.msg001,
           MsgBit                   := DB2707.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2707.msg002,
           MsgBit                   := DB2707.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2707.msg003,
           MsgBit                   := DB2707.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A10_RR1  Reinigungsrcklauf Anlage 10 zu Kreis 1
// Act 020
// Box           : VSRR1-3
// Input address : I84.6
// Output address: Q84.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.A10_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.6,
           Out                      := Q     84.6);

NETWORK
TITLE =A10_RR2  Reinigungsrcklauf Anlage 10 zu Kreis 2
// Act 021
// Box           : VSRR1-3
// Input address : I84.7
// Output address: Q84.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.A10_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     84.7,
           Out                      := Q     84.7);

NETWORK
TITLE =A10_RR3  Reinigungsrcklauf Anlage 10 zu Kreis 3
// Act 022
// Box           : VSRR1-3
// Input address : I85.0
// Output address: Q85.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.A10_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.0,
           Out                      := Q     85.0);

NETWORK
TITLE =LA_LDS_A10V13  LA_LDS_A10V13
// Act 023
// Box           : S8 U8.2
// Input address : I53.1
// Output address: Q110.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_LDS_A10V13,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     53.1,
           Out                      := Q    110.0);

NETWORK
TITLE =LA_LDT_A10PRODUKT  LA_LDT_A10PRODUKT
// Act 024
// Box           : S8 U8.2
// Input address : I53.2
// Output address: Q110.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_LDT_A10PRODUKT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     53.2,
           Out                      := Q    110.1);

NETWORK
TITLE =LA_LDT_A10CIP  LA_LDT_A10CIP
// Act 025
// Box           : S8 U8.2
// Input address : I53.3
// Output address: Q110.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_LDT_A10CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     53.3,
           Out                      := Q    110.2);

NETWORK
TITLE =LA_A10TSH  LA_A10TSH
// Act 026
// Box           : S8 U8.2
// Output address: Q110.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_A10TSH,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    110.3);

NETWORK
TITLE =LA_STOERUNG_CIP  LA_STOERUNG_CIP
// Act 027
// Box           : S8 U8.2
// Output address: Q110.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_STOERUNG_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    110.4);

NETWORK
TITLE =LA_ALARML9_10  LA_ALARML9_10
// Act 028
// Box           : S8 U8.2
// Output address: Q110.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_ALARML9_10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    110.5);

NETWORK
TITLE =LA_LDS_A10V11  LA_LDS_A10V11
// Act 029
// Box           : S8 U8.2
// Input address : I52.7
// Output address: Q110.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_LDS_A10V11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     52.7,
           Out                      := Q    110.6);

NETWORK
TITLE =LA_LDS_A10V12  LA_LDS_A10V12
// Act 030
// Box           : S8 U8.2
// Input address : I53.0
// Output address: Q110.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.LA_LDS_A10V12,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I     53.0,
           Out                      := Q    110.7);

NETWORK
TITLE =UMSCHALTSIGN_KASK_F9_10  UMSCHALTSIGN_KASK_F9_10
// Act 031
// Box           : S8 U8.2
// Output address: Q41.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.UMSCHALTSIGN_KASK_F9_10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     41.6);

NETWORK
TITLE =STOP_SIGNALKASK_F9_10  STOP_SIGNALKASK_F9_10
// Act 032
// Box           : S8 U8.2
// Output address: Q41.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2700.STOP_SIGNALKASK_F9_10,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     41.7);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1701
TITLE =U070: Packaging Plant 10
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1701.DBX 1357.7; 
      CC    FB  1709; // "U070Sim"
      A     DB1701.DBX   17.3; 
      =     DB1701.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1700.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1701.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1705.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1701.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1705; // U070Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U070UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U070UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U070UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U070UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LLL_A10 SIGNAL VON FUELLER 10
// ----------------------------------------------------------
//      A     "U070SeqD".Seq.Step0
//      =     "U070SpID".LS_LLL_A10.EAl
//      SET   
//      =     "U070SpID".LS_LLL_A10.Pre

// ----------------------------------------------------------
// TS_HL_ANL10 
// ----------------------------------------------------------
//      A     "U070SeqD".Seq.Step0
//      =     "U070SpID".TS_HL_ANL10.EAl
//      SET   
//      =     "U070SpID".TS_HL_ANL10.Pre

// ----------------------------------------------------------
// DT_A10_START AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".DT_A10_START.EAl
//      =     "U070SpID".DT_A10_START.Pre

// ----------------------------------------------------------
// DT_A10_STOP AB FUELLER 9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".DT_A10_STOP.EAl
//      =     "U070SpID".DT_A10_STOP.Pre

// ----------------------------------------------------------
// BETRIEB_F10 SIGNAL VON FUELLER 10
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".BETRIEB_F10.EAl
//      =     "U070SpID".BETRIEB_F10.Pre

// ----------------------------------------------------------
// BETRIEB_MIX_LKASKADE_F10 SIGNAL VON FUELLER 10
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".BETRIEB_MIX_LKASKADE_F10.EAl
//      =     "U070SpID".BETRIEB_MIX_LKASKADE_F10.Pre

// ----------------------------------------------------------
// KASK_ANFORDERUNG_PUMPE SIGNAL VON KASKADE
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".KASK_ANFORDERUNG_PUMPE.EAl
//      =     "U070SpID".KASK_ANFORDERUNG_PUMPE.Pre

// ----------------------------------------------------------
// RM_RWPA10 SIGNAL VON MIXER F9/10
// ----------------------------------------------------------
      A     DB1701.DBX 1230.3; 
      A     DB1701.DBX 1262.3; 
      =     DB2701.DBX  501.4; 
      =     DB2701.DBX  501.5; 

// ----------------------------------------------------------
// KAS_WEGFREIGABE_10_L9 SIGNAL VON KASKADE F9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".KAS_WEGFREIGABE_10_L9.EAl
//      =     "U070SpID".KAS_WEGFREIGABE_10_L9.Pre

// ----------------------------------------------------------
// KAS_WEGFREIGABE_10_L10 SIGNAL VON KASKADE F9/10
// ----------------------------------------------------------
//      CLR   
//      =     "U070SpID".KAS_WEGFREIGABE_10_L10.EAl
//      =     "U070SpID".KAS_WEGFREIGABE_10_L10.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2707.DBX   80.7; 
      =     DB2707.DBX   81.4; 

      CLR   ; 
      =     DB2707.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2707.DBX  140.7; 
      =     DB2707.DBX  141.4; 

      CLR   ; 
      =     DB2707.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2707.DBX  200.7; 
      =     DB2707.DBX  201.4; 

      CLR   ; 
      =     DB2707.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1703.DBX   43.1; 
      S     DB1703.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2700.DBX 1625.4; 
      =     DB2700.DBX 1705.4; 
      =     DB2700.DBX 1785.4; 
      =     DB2700.DBX 1865.4; 
      =     DB2700.DBX 1945.4; 
      =     DB2700.DBX 2025.4; 
      =     DB2700.DBX 2105.4; 
      =     DB2700.DBX 2185.4; 
      =     DB2700.DBX 2265.4; 
      =     DB2700.DBX 2345.4; 
      =     DB2700.DBX 2425.4; 
      =     DB2700.DBX 2505.4; 
      =     DB2700.DBX 2585.4; 

MODE: SET   ; 

NETWORK
TITLE =A10_RR1 Reinigungsrcklauf Anlage 10 zu Kreis 1

      A     #GenRel; 
      A     DB2700.DBX 1626.7; 
      =     DB2700.DBX 1627.6; 
NETWORK
TITLE =A10_RR2 Reinigungsrcklauf Anlage 10 zu Kreis 2

      A     #GenRel; 
      A     DB2700.DBX 1706.7; 
      =     DB2700.DBX 1707.6; 
NETWORK
TITLE =A10_RR3 Reinigungsrcklauf Anlage 10 zu Kreis 3

      A     #GenRel; 
      A     DB2700.DBX 1786.7; 
      =     DB2700.DBX 1787.6; 
NETWORK
TITLE =LA_LDS_A10V13 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 1866.7; 
      =     DB2700.DBX 1867.6; 
NETWORK
TITLE =LA_LDT_A10PRODUKT AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 1946.7; 
      =     DB2700.DBX 1947.6; 
NETWORK
TITLE =LA_LDT_A10CIP AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 2026.7; 
      =     DB2700.DBX 2027.6; 
NETWORK
TITLE =LA_A10TSH AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 2106.7; 
      =     DB2700.DBX 2107.6; 
NETWORK
TITLE =LA_STOERUNG_CIP AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 2186.7; 
      =     DB2700.DBX 2187.6; 
NETWORK
TITLE =LA_ALARML9_10 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 2266.7; 
      =     DB2700.DBX 2267.6; 
NETWORK
TITLE =LA_LDS_A10V11 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 2346.7; 
      =     DB2700.DBX 2347.6; 
NETWORK
TITLE =LA_LDS_A10V12 AB FUELLER 9/10

      A     #GenRel; 
      A     DB2700.DBX 2426.7; 
      =     DB2700.DBX 2427.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1710
TITLE =U071: Abfllanlage 11
FAMILY : BOTEC_F1
NAME : U071A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1710.DBW    0; 
      T     #UnitNo; 
      L     DB1710.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2715.unv001,
           ValExt                   := DB2715.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2715.unv002,
           ValExt                   := DB2715.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2715.unv003,
           ValExt                   := DB2715.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2715.unv004,
           ValExt                   := DB2715.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// A9_FS1 SpI 001 gendert 07.11.01 A11 FS1 Stmungswchter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A9_FS1,
           SpIBit                   := I    177.0);

// A11_Fueller_laeuft SpI 002 Fller 11 luft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Fueller_laeuft,
           SpIBit                   := I    168.1);

// A11_Mixer_CIP_Bereit SpI 003 Mixer A 11 CIP-Bereitschaft (Dauersign)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Mixer_CIP_Bereit,
           SpIBit                   := I    170.0);

// A11_Mixer_voll SpI 004 Mixer A 11 voll
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Mixer_voll,
           SpIBit                   := I    170.2);

// A11_Mixer_leer SpI 005 Mixer A 11 leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Mixer_leer,
           SpIBit                   := I    170.1);

// A11_Mixer_Anf_Sirup SpI 006 Mixer A 11 Anforderung Sirup
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Mixer_Anf_Sirup,
           SpIBit                   := I    170.3);

// A11_Fueller_CIP_Bereit SpI 007 Fller 11 CIP-Bereitschaft (Dauer)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Fueller_CIP_Bereit,
           SpIBit                   := I    168.0);

// A11_Fueller_leer SpI 011 Fller 11 leer (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.A11_Fueller_leer,
           SpIBit                   := I    168.2);

// All_Fueller_voll SpI 012 Fller 11 voll (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2711.All_Fueller_voll,
           SpIBit                   := I    168.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2717.msg001,
           MsgBit                   := DB2717.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2717.msg002,
           MsgBit                   := DB2717.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2717.msg003,
           MsgBit                   := DB2717.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A11_RP1  A11RP1 Anlage 11 Reinigungsrcklaufpumpe
// Act 001
// Box           : S6 U6.3
// Input address : I6.3
// Output address: Q6.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.A11_RP1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      6.3,
           Out                      := Q      6.3);

NETWORK
TITLE =F11_Maschine_Start  Fller 11 Maschine_Start
// Act 002
// Box           : FM-A11
// Output address: Q168.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Maschine_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.0);

NETWORK
TITLE =F11_Maschine_Stop  Fller 11 Maschine_Stop
// Act 003
// Box           : FM-A11
// Output address: Q168.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Maschine_Stop,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =F11_CIP_Kreislauf_o_puls  Fller 11 CIP-Kreisl. ohne puls
// Act 010
// Box           : FM-A11
// Output address: Q168.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_CIP_Kreislauf_o_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.2);

NETWORK
TITLE =F11_CIP_Kreislauf_m_puls  Fller 11 CIP-Kreisl. mit puls
// Act 011
// Box           : FM-A11
// Output address: Q168.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_CIP_Kreislauf_m_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.3);

NETWORK
TITLE =F11_Randvollstellung  Fller 11 Randvollstellung Desinfektion
// Act 012
// Box           : FM-A11
// Output address: Q168.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.4);

NETWORK
TITLE =F11_Klarspuel_o_CIP_Beh  Fller 11 Klarsplen ohne CIP-Behlter
// Act 013
// Box           : FM-A11
// Output address: Q168.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Klarspuel_o_CIP_Beh,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.5);

NETWORK
TITLE =F11_Ausschub_m_Steriluft  Fller 11 Ausschub mit Sterrielluft
// Act 014
// Box           : FM-A11
// Output address: Q168.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Ausschub_m_Steriluft,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.6);

NETWORK
TITLE =F11_Ausschub_m_CO2  Fller 11 Ausschub mit CO2
// Act 015
// Box           : FM-A11
// Output address: Q168.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Ausschub_m_CO2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    168.7);

NETWORK
TITLE =F11_Grundstellung_IMP  F11_Grungstellung_IMPULS
// Act 016
// Box           : FM-A11
// Output address: Q169.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Grundstellung_IMP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    169.0);

NETWORK
TITLE =F11_Drainagestellung_IMP  F11_Drainagestellung_IMPULS
// Act 017
// Box           : FM-A11
// Output address: Q169.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Drainagestellung_IMP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    169.1);

NETWORK
TITLE =F11_Bypass_IMP  F11_BYPASS_IMPULS
// Act 018
// Box           : FM-A11
// Output address: Q169.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.F11_Bypass_IMP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    169.2);

NETWORK
TITLE =A11_RR1  A11RR1 Ventil CIP Rcklauf Kreis 1 Anlage 11
// Act 020
// Box           : VSRR6-11
// Input address : I28.3
// Output address: Q28.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.A11_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     28.3,
           Out                      := Q     28.3);

NETWORK
TITLE =A11_RR2  A11RR2 Ventil CIP Rcklauf Kreis 2 Anlage 11
// Act 021
// Box           : VSRR6-11
// Input address : I28.4
// Output address: Q28.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.A11_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     28.4,
           Out                      := Q     28.4);

NETWORK
TITLE =A11_RR3  A11RR3 Ventil CIP Rcklauf Kreis 3 Anlage 11
// Act 022
// Box           : VSRR6-11
// Input address : I28.5
// Output address: Q28.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.A11_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     28.5,
           Out                      := Q     28.5);

NETWORK
TITLE =M11_Grundstellung_IMP  Mixer A11 Sign. als Impuls
// Act 023
// Box           : FM-A11
// Output address: Q170.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Grundstellung_IMP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.0);

NETWORK
TITLE =M11_Drainagestellung_IMP  Mixer A11 Sign. als Impuls
// Act 024
// Box           : FM-A11
// Output address: Q170.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Drainagestellung_IMP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.1);

NETWORK
TITLE =M11_Ausspritzen_o_Ablauf  Mixer A11 Sign. als Impuls
// Act 025
// Box           : FM-A11
// Output address: Q170.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Ausspritzen_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.2);

NETWORK
TITLE =M11_Ausspritzen_m_Ablauf  Mixer A11 Sign. als Impuls
// Act 026
// Box           : FM-A11
// Output address: Q170.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Ausspritzen_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.3);

NETWORK
TITLE =M11_Fluten_o_Ablauf  Mixer A11 Sign. als Impuls
// Act 027
// Box           : FM-A11
// Output address: Q170.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Fluten_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.4);

NETWORK
TITLE =M11_Fluten_m_Ablauf  Mixer A11 Sign. als Impuls
// Act 028
// Box           : FM-A11
// Output address: Q170.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Fluten_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.5);

NETWORK
TITLE =M11_Randvollstellung  Mixer A11 Sign. als Impuls
// Act 029
// Box           : FM-A11
// Output address: Q170.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.6);

NETWORK
TITLE =M11_Abpumpen  Mixer A11 Sign. als Impuls
// Act 030
// Box           : FM-A11
// Output address: Q170.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Abpumpen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    170.7);

NETWORK
TITLE =M11_Klarspuelen  Mixer A11
// Act 031
// Box           : FM-A11
// Output address: Q171.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.M11_Klarspuelen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.0);

NETWORK
TITLE =VNI_MOLCH_verr_A11  SIGNAL AN VNI Molch verriegelt an Anlage11
// Act 043
// Box           : AB-SK
// Output address: Q183.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.VNI_MOLCH_verr_A11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.5);

NETWORK
TITLE =VNI_MOLCH_Sender_A11  VNI Molch an Sendestation (SK)
// Act 044
// Box           : AB-SK
// Output address: Q183.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.VNI_MOLCH_Sender_A11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.6);

NETWORK
TITLE =VNI_MOLCH_Empfang_A11  VNI Molch an Empfangsstation (M11)
// Act 045
// Box           : AB-SK
// Output address: Q183.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2710.VNI_MOLCH_Empfang_A11,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.7);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1711
TITLE =U071: Packaging Plant 11
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1711.DBX 1357.7; 
      CC    FB  1719; // "U071Sim"
      A     DB1711.DBX   17.3; 
      =     DB1711.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1710.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1711.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1715.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1711.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1715; // U071Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U071UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U071UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U071UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U071UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// A11_Fueller_laeuft Fller 11 luft (Dauersignal)
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".A11_Fueller_laeuft.EAl
//      =     "U071SpID".A11_Fueller_laeuft.Pre

// ----------------------------------------------------------
// A11_Mixer_CIP_Bereit Mixer A 11 CIP-Bereitschaft (Dauersign)
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".A11_Mixer_CIP_Bereit.EAl
//      =     "U071SpID".A11_Mixer_CIP_Bereit.Pre

// ----------------------------------------------------------
// A11_Mixer_voll Mixer A 11 voll
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".A11_Mixer_voll.EAl
//      =     "U071SpID".A11_Mixer_voll.Pre

// ----------------------------------------------------------
// A11_Mixer_leer Mixer A 11 leer
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".A11_Mixer_leer.EAl
//      =     "U071SpID".A11_Mixer_leer.Pre

// ----------------------------------------------------------
// A11_Mixer_Anf_Sirup Mixer A 11 Anforderung Sirup
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".A11_Mixer_Anf_Sirup.EAl
//      =     "U071SpID".A11_Mixer_Anf_Sirup.Pre

// ----------------------------------------------------------
// A11_Fueller_leer Fller 11 leer (Impuls)
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".A11_Fueller_leer.EAl
//      =     "U071SpID".A11_Fueller_leer.Pre

// ----------------------------------------------------------
// All_Fueller_voll Fller 11 voll (Impuls)
// ----------------------------------------------------------
//      CLR   
//      =     "U071SpID".All_Fueller_voll.EAl
//      =     "U071SpID".All_Fueller_voll.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2717.DBX   80.7; 
      =     DB2717.DBX   81.4; 

      CLR   ; 
      =     DB2717.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2717.DBX  140.7; 
      =     DB2717.DBX  141.4; 

      CLR   ; 
      =     DB2717.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2717.DBX  200.7; 
      =     DB2717.DBX  201.4; 

      CLR   ; 
      =     DB2717.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1713.DBX   43.1; 
      S     DB1713.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2710.DBX  105.4; 
      =     DB2710.DBX  185.4; 
      S     DB2710.DBX  265.4; 
      =     DB2710.DBX  825.4; 
      =     DB2710.DBX  905.4; 
      =     DB2710.DBX  985.4; 
      =     DB2710.DBX 1065.4; 
      =     DB2710.DBX 1145.4; 
      =     DB2710.DBX 1225.4; 
      =     DB2710.DBX 1305.4; 
      =     DB2710.DBX 1385.4; 
      =     DB2710.DBX 1465.4; 
      =     DB2710.DBX 1625.4; 
      =     DB2710.DBX 1705.4; 
      =     DB2710.DBX 1785.4; 

      =     DB2710.DBX 1865.4; 
      =     DB2710.DBX 1945.4; 
      =     DB2710.DBX 2025.4; 
      =     DB2710.DBX 2105.4; 
      =     DB2710.DBX 2185.4; 
      =     DB2710.DBX 2265.4; 
      =     DB2710.DBX 2345.4; 
      =     DB2710.DBX 2425.4; 
      =     DB2710.DBX 2505.4; 

      =     DB2710.DBX 3465.4; 
      =     DB2710.DBX 3545.4; 
      =     DB2710.DBX 3625.4; 



MODE: SET   ; 

NETWORK
TITLE =A11_RP1 A11RP1 Anlage 11 Reinigungsrcklaufpumpe

//      A     "U071SpID".A9_FS1.Sig
      AN    DB2711.DBX   78.1; 

      A     #GenRel; 
      A     DB2710.DBX  106.7; 
      =     DB2710.DBX  107.6; 
NETWORK
TITLE =F11_Maschine_Start Fller 11 Maschine_Start

      A     #GenRel; 
      A     DB2710.DBX  186.7; 
      =     DB2710.DBX  187.6; 
NETWORK
TITLE =F11_Maschine_Stop Fller 11 Maschine_Stop

      A     #GenRel; 
      A     DB2710.DBX  266.7; 
      =     DB2710.DBX  267.6; 

      AN    DB2710.DBX  263.4; 
      =     Q    168.1; 
NETWORK
TITLE =F11_CIP_Kreislauf_o_puls Fller 11 CIP-Kreisl. ohne puls

      A     #GenRel; 
      A     DB2710.DBX  826.7; 
      =     DB2710.DBX  827.6; 
NETWORK
TITLE =F11_CIP_Kreislauf_m_puls Fller 11 CIP-Kreisl. mit puls

      A     #GenRel; 
      A     DB2710.DBX  906.7; 
      =     DB2710.DBX  907.6; 
NETWORK
TITLE =F11_Randvollstellung Fller 11 Randvollstellung Desinfektion

      A     #GenRel; 
      A     DB2710.DBX  986.7; 
      =     DB2710.DBX  987.6; 
NETWORK
TITLE =F11_Klarspuel_o_CIP_Beh Fller 11 Klarsplen ohne CIP-Behlter

      A     #GenRel; 
      A     DB2710.DBX 1066.7; 
      =     DB2710.DBX 1067.6; 
NETWORK
TITLE =F11_Ausschub_m_Steriluft Fller 11 Ausschub mit Sterrielluft

      A     #GenRel; 
      A     DB2710.DBX 1146.7; 
      =     DB2710.DBX 1147.6; 
NETWORK
TITLE =F11_Ausschub_m_CO2 Fller 11 Ausschub mit CO2

      A     #GenRel; 
      A     DB2710.DBX 1226.7; 
      =     DB2710.DBX 1227.6; 
NETWORK
TITLE =F11_Grundstellung_IMP F11_Grungstellung_IMPULS

      A     #GenRel; 
      A     DB2710.DBX 1306.7; 
      =     DB2710.DBX 1307.6; 
NETWORK
TITLE =F11_Drainagestellung_IMP F11_Drainagestellung_IMPULS

      A     #GenRel; 
      A     DB2710.DBX 1386.7; 
      =     DB2710.DBX 1387.6; 
NETWORK
TITLE =F11_Bypass_IMP F11_BYPASS_IMPULS

      A     #GenRel; 
      A     DB2710.DBX 1466.7; 
      =     DB2710.DBX 1467.6; 
NETWORK
TITLE =A11_RR1 A11RR1 Ventil CIP Rcklauf Kreis 1 Anlage 11

      A     #GenRel; 
      A     DB2710.DBX 1626.7; 
      =     DB2710.DBX 1627.6; 
NETWORK
TITLE =A11_RR2 A11RR2 Ventil CIP Rcklauf Kreis 2 Anlage 11

      A     #GenRel; 
      A     DB2710.DBX 1706.7; 
      =     DB2710.DBX 1707.6; 
NETWORK
TITLE =A11_RR3 A11RR3 Ventil CIP Rcklauf Kreis 3 Anlage 11

      A     #GenRel; 
      A     DB2710.DBX 1786.7; 
      =     DB2710.DBX 1787.6; 
NETWORK
TITLE =VNI_MOLCH_verr_A11 SIGNAL AN VNI Molch verriegelt an Anlage11

      A     #GenRel; 
      A     DB2710.DBX 3466.7; 
      =     DB2710.DBX 3467.6; 
NETWORK
TITLE =VNI_MOLCH_Sender_A11 VNI Molch an Sendestation (SK)

      A     #GenRel; 
      A     DB2710.DBX 3546.7; 
      =     DB2710.DBX 3547.6; 
NETWORK
TITLE =VNI_MOLCH_Empfang_A11 VNI Molch an Empfangsstation (M11)

      A     #GenRel; 
      A     DB2710.DBX 3626.7; 
      =     DB2710.DBX 3627.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1720
TITLE =U072: Abfllanlage 12
FAMILY : BOTEC_F1
NAME : U072A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1720.DBW    0; 
      T     #UnitNo; 
      L     DB1720.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2725.unv001,
           ValExt                   := DB2725.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2725.unv002,
           ValExt                   := DB2725.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2725.unv003,
           ValExt                   := DB2725.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2725.unv004,
           ValExt                   := DB2725.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// A12_FS1 SpI 001 Anlage 12 Strmungswchter
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_FS1,
           SpIBit                   := I    263.0);

// A12_FUELLER_LAEUFT SpI 002 Koppelsignal von Fller 12 Fller luft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_FUELLER_LAEUFT,
           SpIBit                   := I    268.1);

// A12_MIXER_CIP_BEREIT SpI 003 Koppelsignal von Mixer 5 CIP-Bereitschaft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_MIXER_CIP_BEREIT,
           SpIBit                   := I    270.0);

// A12_MIXER_VOLL SpI 004 Koppelsignal von Mixer 5 Mixer voll
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_MIXER_VOLL,
           SpIBit                   := I    270.1);

// A12_MIXER_LEER SpI 005 Koppelsignal von Mixer 5 Mixer leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_MIXER_LEER,
           SpIBit                   := I    270.2);

// A12_MIXER_Anforderung SpI 006 Koppelsignal von Mixer 5 Anforderung Nachsp.
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_MIXER_Anforderung,
           SpIBit                   := I    270.3);

// A12_FUELLER_CIP_BEREIT SpI 007 Koppelsignal von Fller 12 CIP-Bereitschaft (Dauersignal)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_FUELLER_CIP_BEREIT,
           SpIBit                   := I    268.0);

// GOA_1203 SpI 009 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.GOA_1203,
           SpIBit                   := I    262.2);

// TS_HL_A12 SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.TS_HL_A12,
           SpIBit                   := I     14.4);

// A12_FUELLER_LEER SpI 011 Koppelsignal von Fller 12 Fller leer (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_FUELLER_LEER,
           SpIBit                   := I    268.2);

// A12_FUELLER_VOLL SpI 012 Koppelsignal von Fller 12 Fller voll (Impuls)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2721.A12_FUELLER_VOLL,
           SpIBit                   := I    268.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2727.msg001,
           MsgBit                   := DB2727.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2727.msg002,
           MsgBit                   := DB2727.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2727.msg003,
           MsgBit                   := DB2727.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A12_RRP1  Reinigungsrcklaufpumpe A12
// Act 001
// Box           : LT-CIP
// Input address : I256.4
// Output address: Q256.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.A12_RRP1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    256.4,
           Out                      := Q    256.4);

NETWORK
TITLE =F12_Maschine_Start  Fller A12 Maschine Start
// Act 002
// Box           : Fller12
// Output address: Q268.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Maschine_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.0);

NETWORK
TITLE =F12_Maschine_Stop  Fller A12 Maschine Stop
// Act 003
// Box           : Fller12
// Output address: Q268.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Maschine_Stop,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =F12_Kreislauf_o_puls  Fller A12 CIP-Kreislauf ohne pulsierenden
// Act 010
// Box           : Fller12
// Output address: Q268.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Kreislauf_o_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.2);

NETWORK
TITLE =F12_Kreislauf_m_puls  Fller A12 CIP-Kreislauf mit pulsierenden 
// Act 011
// Box           : Fller12
// Output address: Q268.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Kreislauf_m_puls,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.3);

NETWORK
TITLE =F12_Randvollstellung  Fller A12 Randvollstellung Standdesinfekt
// Act 012
// Box           : Fller12
// Output address: Q268.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.4);

NETWORK
TITLE =F12_Klarspuelen_o_CIP_Be  Fller A12 Klarsplen ohne CIP-Behlte
// Act 013
// Box           : Fller12
// Output address: Q268.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Klarspuelen_o_CIP_Be,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.5);

NETWORK
TITLE =F12_Ausschub_m_Sterilluf  Fller A12 Ausschubprogramm mit Steril
// Act 014
// Box           : Fller12
// Output address: Q268.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Ausschub_m_Sterilluf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.6);

NETWORK
TITLE =F12_Ausschub_m_CO2  Fller A12 Ausschubprogramm mit CO2
// Act 015
// Box           : Fller12
// Output address: Q268.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Ausschub_m_CO2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    268.7);

NETWORK
TITLE =F12_Grundstellung  Fller A12 Maschine Grundstellung (Impuls)
// Act 016
// Box           : Fller12
// Output address: Q269.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    269.0);

NETWORK
TITLE =F12_Drainagestellung  Fller A12 Drainagestellung (Impuls)
// Act 017
// Box           : Fller12
// Output address: Q269.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    269.1);

NETWORK
TITLE =F12_Bypass  Fller A12 Bypass (Impuls)
// Act 018
// Box           : Fller12
// Output address: Q269.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.F12_Bypass,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    269.2);

NETWORK
TITLE =A12RR1  A12RR1 CIP Rcklaufventil Kreis 1 Anlage 12
// Act 020
// Box           : VS-RRA
// Input address : I200.3
// Output address: Q200.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.A12RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    200.3,
           Out                      := Q    200.3);

NETWORK
TITLE =A12RR2  A12RR1 CIP Rcklaufventil Kreis 2 Anlage 12
// Act 021
// Box           : VS-RRA
// Input address : I200.4
// Output address: Q200.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.A12RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    200.4,
           Out                      := Q    200.4);

NETWORK
TITLE =A12RR3  A12RR1 CIP Rcklaufventil Kreis 3 Anlage 12
// Act 022
// Box           : VS-RRA
// Input address : I200.5
// Output address: Q200.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.A12RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    200.5,
           Out                      := Q    200.5);

NETWORK
TITLE =M12_Grundstellung  Mixer A12 Grundstellung (Impuls)
// Act 023
// Box           : Mixer12
// Output address: Q270.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.0);

NETWORK
TITLE =M12_Drainagestellung  Mixer A12 Drainagestellung (Impuls)
// Act 024
// Box           : Mixer12
// Output address: Q270.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Drainagestellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.1);

NETWORK
TITLE =M12_Ausspritzen_o_Ablauf  Mixer A12 Ausspritzen ohne Ablauf (Imp
// Act 025
// Box           : Mixer12
// Output address: Q270.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Ausspritzen_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.2);

NETWORK
TITLE =M12_Ausspritzen_m_Ablauf  Mixer A12 Ausspritzen mit Ablauf (Impu
// Act 026
// Box           : Mixer12
// Output address: Q270.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Ausspritzen_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.3);

NETWORK
TITLE =M12_Fluten_o_Ablauf  Mixer A12 Fluten ohne Ablauf (Impuls)
// Act 027
// Box           : Mixer12
// Output address: Q270.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Fluten_o_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.4);

NETWORK
TITLE =M12_Fluten_m_Ablauf  Mixer A12 Fluten mit Ablauf (Impuls)
// Act 028
// Box           : Mixer12
// Output address: Q270.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Fluten_m_Ablauf,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.5);

NETWORK
TITLE =M12_Randvollstellung  Mixer A12 Randvollstellung (Impuls)
// Act 029
// Box           : Mixer12
// Output address: Q270.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Randvollstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.6);

NETWORK
TITLE =M12_Abpumpen  Mixer A12 Abpumpen (Impuls)
// Act 030
// Box           : Mixer12
// Output address: Q270.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Abpumpen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    270.7);

NETWORK
TITLE =M12_Klarspuelen  Mixer A12 Klarsplen
// Act 031
// Box           : Mixer12
// Output address: Q271.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2720.M12_Klarspuelen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    271.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1721
TITLE =U072: Packaging Plant 12
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1721.DBX 1357.7; 
      CC    FB  1729; // "U072Sim"
      A     DB1721.DBX   17.3; 
      =     DB1721.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1720.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1721.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1725.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1721.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1725; // U072Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U072UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U072UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U072UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U072UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 
// ----------------------------------------------------------
// A12_FS1 
// ----------------------------------------------------------
      A     DB2720.DBX  102.6; 
      =     DB2721.DBX   81.4; 
//      =     "U072SpID".A12_FS1.Pre

// ----------------------------------------------------------
// GOA_1203 
// ----------------------------------------------------------
//     A     "U072SeqD".Seq.Step0
//      A     #CIP
//      =     "U072SpID".GOA_1203.EAl
//     =     "U072SpID".GOA_1203.Pre

// ----------------------------------------------------------
// TS_HL_A12 
// ----------------------------------------------------------
//      CLR   
//      =     "U072SpID".TS_HL_A12.EAl
//      =     "U072SpID".TS_HL_A12.Pre

// ----------------------------------------------------------
// A12A_E_CIP_BEREIT SIGNAL VON FUELLER 6A
// ----------------------------------------------------------
//      CLR   
//      =     "U072SpID".A12A_E_CIP_BEREIT.EAl
//     =     "U072SpID".A12A_E_CIP_BEREIT.Pre

// ----------------------------------------------------------
// A12A_E_LEER_MEDIENWECHSE SIGNAL VON FUELLER 6A
// ----------------------------------------------------------
//      CLR   
//      =     "U072SpID".A12A_E_LEER_MEDIENWECHSE.EAl
//     =     "U072SpID".A12A_E_LEER_MEDIENWECHSE.Pre
//
// ----------------------------------------------------------
// A12A_E_MIX_CIP_BEREIT SIGNAL VON FUELLER 6A
// ----------------------------------------------------------
//      CLR   
//      =     "U072SpID".A12A_E_MIX_CIP_BEREIT.EAl
//     =     "U072SpID".A12A_E_MIX_CIP_BEREIT.Pre

// ----------------------------------------------------------
// A12A_E_MIX_HALT SIGNAL VON FUELLER 6A
// ----------------------------------------------------------
//      CLR   
//     =     "U072SpID".A12A_E_MIX_HALT.EAl
//     =     "U072SpID".A12A_E_MIX_HALT.Pre

// ----------------------------------------------------------
// A12A_E_WASSERANFORDERUNG SIGNAL VON FUELLER 6A
// ----------------------------------------------------------
//      CLR   
//      =     "U072SpID".A12A_E_WASSERANFORDERUNG.EAl
//      =     "U072SpID".A12A_E_WASSERANFORDERUNG.Pre

// ----------------------------------------------------------
// RM_A12RP2 SIGNAL VON FUELLER 6A
// ----------------------------------------------------------
//      CLR   
//      =     "U072SpID".RM_A12RP2.EAl
//      =     "U072SpID".RM_A12RP2.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2727.DBX   80.7; 
      =     DB2727.DBX   81.4; 

      CLR   ; 
      =     DB2727.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2727.DBX  140.7; 
      =     DB2727.DBX  141.4; 

      CLR   ; 
      =     DB2727.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2727.DBX  200.7; 
      =     DB2727.DBX  201.4; 

      CLR   ; 
      =     DB2727.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1723.DBX   43.1; 
      S     DB1723.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2720.DBX  105.4; 
      =     DB2720.DBX  185.4; 
      S     DB2720.DBX  265.4; 
      =     DB2720.DBX  345.4; 
      =     DB2720.DBX  425.4; 
      =     DB2720.DBX  505.4; 
      =     DB2720.DBX  585.4; 
      =     DB2720.DBX  665.4; 
      =     DB2720.DBX  745.4; 
      =     DB2720.DBX  825.4; 
      =     DB2720.DBX  905.4; 
      =     DB2720.DBX  985.4; 
      =     DB2720.DBX 1065.4; 
      =     DB2720.DBX 1145.4; 
      =     DB2720.DBX 1225.4; 
      =     DB2720.DBX 1305.4; 
      =     DB2720.DBX 1385.4; 
      =     DB2720.DBX 1465.4; 

      =     DB2720.DBX 1625.4; 
      =     DB2720.DBX 1705.4; 
      =     DB2720.DBX 1785.4; 

      =     DB2720.DBX 1865.4; 
      =     DB2720.DBX 1945.4; 
      =     DB2720.DBX 2025.4; 
      =     DB2720.DBX 2105.4; 
      =     DB2720.DBX 2185.4; 
      =     DB2720.DBX 2265.4; 
      =     DB2720.DBX 2345.4; 
      =     DB2720.DBX 2425.4; 
      =     DB2720.DBX 2505.4; 


MODE: SET   ; 

NETWORK
TITLE =RWPA12 Pumpe --> Anlage 12

      AN    DB2721.DBX   78.1; 

      A     #GenRel; 
      A     DB2720.DBX  106.7; 
      =     DB2720.DBX  107.6; 
NETWORK
TITLE =A12_RRP1 Reinigungsrcklaufpumpe A12

      A     #GenRel; 
      A     DB2720.DBX  186.7; 
      =     DB2720.DBX  187.6; 

NETWORK
TITLE =Act3 Fller A12 Maschine Stop - release 1

      A     #GenRel; 
      A     DB2720.DBX  266.7; 
      =     DB2720.DBX  267.6; 

      AN    DB2720.DBX  263.4; 
      =     Q    268.1; 

NETWORK
TITLE =A12RR1 A12RR1 CIP Rcklaufventil Kreis 1 Anlage 12

      A     #GenRel; 
      A     DB2720.DBX 1626.7; 
      =     DB2720.DBX 1627.6; 
NETWORK
TITLE =A12RR2 A12RR1 CIP Rcklaufventil Kreis 2 Anlage 12

      A     #GenRel; 
      A     DB2720.DBX 1706.7; 
      =     DB2720.DBX 1707.6; 
NETWORK
TITLE =A12RR3 A12RR1 CIP Rcklaufventil Kreis 3 Anlage 12

      A     #GenRel; 
      A     DB2720.DBX 1786.7; 
      =     DB2720.DBX 1787.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1740
TITLE =U074: Abfllanlage 14
FAMILY : BOTEC_F1
NAME : U074A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1740.DBW    0; 
      T     #UnitNo; 
      L     DB1740.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// U74_AnI001 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2743.U74_AnI001,
           ValPer                   := #DummyInt);

// U74_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2743.U74_AnI002,
           ValPer                   := #DummyInt);

// U74_AnI003 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2743.U74_AnI003,
           ValPer                   := #DummyInt);

// U74_AnI004 AnI 004 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2743.U74_AnI004,
           ValPer                   := #DummyInt);

// U74_AnI005 AnI 005 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2743.U74_AnI005,
           ValPer                   := #DummyInt);

// U74_AnI006 AnI 006 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2743.U74_AnI006,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2745.unv001,
           ValExt                   := DB2745.DBD  234);

// A14M_PROGRAMM_NR UnV 002 Select programme as number 101 ... 131 instead of bits
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2745.A14M_PROGRAMM_NR,
           ValExt                   := DB2745.DBD  362);

// A14M_TANKNR UnV 003 Actual Water Tank
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2745.A14M_TANKNR,
           ValExt                   := DB2745.DBD  490);

// A14M_TANKNIVEAU UnV 004 Water Tank Level
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2745.A14M_TANKNIVEAU,
           ValExt                   := DB2745.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// A14FS1 SpI 001 Flow Switch RL Anlage 14
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FS1,
           SpIBit                   := I     99.0);

// A14FR_LAEUFT SpI 002 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FR_LAEUFT,
           SpIBit                   := I    922.2);

// A14M_CIP_BEREIT SpI 003 Mixer ist Bereit zur Ansteuerung durch die CIP Anlage und hat keine Strung
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14M_CIP_BEREIT,
           SpIBit                   := I    910.1);

// A14M_MIXER_VOLL SpI 004 Alle Tanks und Leitungen sind gefllt
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14M_MIXER_VOLL,
           SpIBit                   := I    910.3);

// A14M_MIXER_LEER SpI 005 Mixer ist komplett leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14M_MIXER_LEER,
           SpIBit                   := I    910.2);

// A14M_ANFORDERUNG_SIRUP SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14M_ANFORDERUNG_SIRUP,
           SpIBit                   := I    912.3);

// A14FR_CIP_BEREIT SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FR_CIP_BEREIT,
           SpIBit                   := I    922.1);

// A14FR_WATCHDOG SpI 009 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FR_WATCHDOG,
           SpIBit                   := I    923.7);

// A14M_WATCHDOG SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14M_WATCHDOG,
           SpIBit                   := I    911.7);

// A14FR_LEER SpI 011 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FR_LEER,
           SpIBit                   := I    922.3);

// A14FR_VOLL SpI 012 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FR_VOLL,
           SpIBit                   := I    922.4);

// A14FR_DIAGNOSE SpI 015 DP Koppler
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14FR_DIAGNOSE,
           SpIBit                   := I    922.0);

// A14M_STOERUNG_MIXER SpI 016 Strung Mixer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.A14M_STOERUNG_MIXER,
           SpIBit                   := I    911.3);

// GOA_1403 SpI 025 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2741.GOA_1403,
           SpIBit                   := I     98.2);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2747.msg001,
           MsgBit                   := DB2747.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2747.msg002,
           MsgBit                   := DB2747.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2747.msg003,
           MsgBit                   := DB2747.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A14RRP1  Reinigungsrcklaufpumpe Anlage 14
// Act 001
// Box           : VSA14
// Input address : I97.7
// Output address: Q97.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14RRP1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     97.7,
           Out                      := Q     97.7);

NETWORK
TITLE =A14FR_START  
// Act 002
// Box           : A14 Fller|Rinser
// Output address: Q922.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_START,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    922.1);

NETWORK
TITLE =A14FR_STOP  
// Act 003
// Box           : A14 Fller|Rinser
// Output address: Q922.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_STOP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =A14FR_KREISLAUF_OHNE_ABL  CIP Kreislauf ohne pulsierendem Ablauf
// Act 010
// Box           : A14 Fller|Rinser
// Output address: Q922.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_KREISLAUF_OHNE_ABL,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    922.5);

NETWORK
TITLE =A14FR_KREISLAUF_MIT_ABLA  CIP Kreislauf mit pulsierendem Ablauf
// Act 011
// Box           : A14 Fller|Rinser
// Output address: Q922.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_KREISLAUF_MIT_ABLA,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    922.6);

NETWORK
TITLE =A14FR_RANDVOLLSTELLUNG  Randvollstellung
// Act 012
// Box           : A14 Fller|Rinser
// Output address: Q923.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_RANDVOLLSTELLUNG,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    923.1);

NETWORK
TITLE =A14FR_KLARSPUELEN  Klarsplen
// Act 013
// Box           : A14 Fller|Rinser
// Output address: Q923.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_KLARSPUELEN,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    923.2);

NETWORK
TITLE =A14FR_AUSSCHUB_M_STERILL  Ausschub mit Sterilluft
// Act 014
// Box           : A14 Fller|Rinser
// Output address: Q922.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_AUSSCHUB_M_STERILL,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    922.7);

NETWORK
TITLE =A14FR_AUSSCHUB_M_CO2  Ausschub mit CO2
// Act 015
// Box           : A14 Fller|Rinser
// Output address: Q923.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_AUSSCHUB_M_CO2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    923.3);

NETWORK
TITLE =A14FR_GRUNDSTELLUNG  Grundstellung
// Act 016
// Box           : A14 Fller|Rinser
// Output address: Q922.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_GRUNDSTELLUNG,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    922.3);

NETWORK
TITLE =A14FR_DRAINAGE  Drainagestellung
// Act 017
// Box           : A14 Fller|Rinser
// Output address: Q922.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_DRAINAGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    922.4);

NETWORK
TITLE =A14FR_BYPASS  Bypass
// Act 018
// Box           : A14 Fller|Rinser
// Output address: Q923.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14FR_BYPASS,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    923.0);

NETWORK
TITLE =A14_RR1  
// Act 020
// Box           : VS-RRA
// Input address : I201.5
// Output address: Q201.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.5,
           Out                      := Q    201.5);

NETWORK
TITLE =A14_RR2  
// Act 021
// Box           : VS-RRA
// Input address : I201.6
// Output address: Q201.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14_RR2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.6,
           Out                      := Q    201.6);

NETWORK
TITLE =A14_RR3  
// Act 022
// Box           : VS-RRA
// Input address : I201.7
// Output address: Q201.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.7,
           Out                      := Q    201.7);

NETWORK
TITLE =A14M_GRUNDSTELLUNG  
// Act 023
// Box           : A14 Mixer
// Output address: Q910.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_GRUNDSTELLUNG,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.1);

NETWORK
TITLE =A14M_DRAINAGE  Drainage
// Act 024
// Box           : A14 Mixer
// Output address: Q910.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_DRAINAGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.2);

NETWORK
TITLE =A14M_AUSSPRITZEN_OHNE_AB  Ausspritzen ohne Ablauf
// Act 025
// Box           : A14 Mixer
// Output address: Q910.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_AUSSPRITZEN_OHNE_AB,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.4);

NETWORK
TITLE =A14M_AUSSPRITZEN_MIT_ABL  Ausspritzen mit Ablauf
// Act 026
// Box           : A14 Mixer
// Output address: Q910.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_AUSSPRITZEN_MIT_ABL,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.5);

NETWORK
TITLE =A14M_RANDVOLLSTELLUNG  Fluten und Randvollstellung
// Act 029
// Box           : A14 Mixer
// Output address: Q910.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_RANDVOLLSTELLUNG,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.7);

NETWORK
TITLE =A14M_ABPUMPEN_MIT_VAKUUM  Abpumpen mit Vakuumausgleich
// Act 030
// Box           : A14 Mixer
// Output address: Q910.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_ABPUMPEN_MIT_VAKUUM,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.6);

NETWORK
TITLE =A14M_DRAINAGE_M_VAKUUMAU  Drainage mit Vakuumausgleich
// Act 032
// Box           : A14 Mixer
// Output address: Q910.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_DRAINAGE_M_VAKUUMAU,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    910.3);

NETWORK
TITLE =A14M_STERILISATION  
// Act 033
// Box           : A14 Mixer
// Output address: Q911.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2740.A14M_STERILISATION,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    911.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1741
TITLE =U074: Packaging Plant 14
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1741.DBX 1357.7; 
      CC    FB  1749; // "U074Sim"
      A     DB1741.DBX   17.3; 
      =     DB1741.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1740.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1741.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1745.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1741.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1745; // U074Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// U74_AnI001 spare
// ----------------------------------------------------------
      L     IW   914; 
      ITD   ; 
      DTR   ; 
      T     DB2743.DBD  214; 
      SET   ; 
      =     DB2743.DBX  143.5; 

      L     DB1741.DBD 1118; // !!! insert correct SFM !!!
      T     DB2743.DBD  238; 

      SET   ; 
      =     DB2743.DBX  141.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U074UnVD".unv001.ValExt

// ----------------------------------------------------------
// A14M_PROGRAMM_NR Select programme as number 101 ... 131 instead of bits
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U074UnVD".A14M_PROGRAMM_NR.ValExt

// ----------------------------------------------------------
// A14M_TANKNR Actual Water Tank
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U074UnVD".A14M_TANKNR.ValExt

// ----------------------------------------------------------
// A14M_TANKNIVEAU Water Tank Level
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U074UnVD".A14M_TANKNIVEAU.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// A14FS1 Flow Switch RL Anlage 14
// ----------------------------------------------------------
//      CLR   
//      =     "U074SpID".A14FS1.EAl
//      =     "U074SpID".A14FS1.Pre

// ----------------------------------------------------------
// GOA_1403 
// ----------------------------------------------------------
//      CLR   
//      =     "U074SpID".A14FR_LAEUFT.EAl
//      =     "U074SpID".A14FR_LAEUFT.Pre

// ----------------------------------------------------------
// A14_FREIGABE_MOLCH_SS 
// ----------------------------------------------------------
//      CLR   
//      =     "U074SpID".A14_FREIGABE_MOLCH_SS.EAl
//      =     "U074SpID".A14_FREIGABE_MOLCH_SS.Pre

// ----------------------------------------------------------
// A14_MOLCH_STOP_DT 
// ----------------------------------------------------------
//      CLR   
//      =     "U074SpID".A14_MOLCH_STOP_DT.EAl
//      =     "U074SpID".A14_MOLCH_STOP_DT.Pre


NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2747.DBX   80.7; 
      =     DB2747.DBX   81.4; 

      CLR   ; 
      =     DB2747.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2747.DBX  140.7; 
      =     DB2747.DBX  141.4; 

      CLR   ; 
      =     DB2747.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2747.DBX  200.7; 
      =     DB2747.DBX  201.4; 

      CLR   ; 
      =     DB2747.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB2743.DBD  146; 
      T     DB1741.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB2743.DBD  266; 
      T     DB1741.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB2743.DBD  386; 
      T     DB1741.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB2743.DBD  506; 
      T     DB1741.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB2743.DBD  626; 
      T     DB1741.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB2743.DBD  746; 
      T     DB1741.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1743.DBX   43.1; 
      S     DB1743.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2740.DBX  105.4; 
      =     DB2740.DBX  185.4; 
      S     DB2740.DBX  265.4; 
      =     DB2740.DBX  345.4; 
      =     DB2740.DBX  425.4; 
      =     DB2740.DBX  505.4; 
      =     DB2740.DBX  585.4; 
      =     DB2740.DBX  665.4; 
      =     DB2740.DBX  745.4; 
      =     DB2740.DBX  825.4; 
      =     DB2740.DBX  905.4; 
      =     DB2740.DBX  985.4; 
      =     DB2740.DBX 1065.4; 
      =     DB2740.DBX 1145.4; 
      =     DB2740.DBX 1225.4; 
      =     DB2740.DBX 1305.4; 
      =     DB2740.DBX 1385.4; 
      =     DB2740.DBX 1465.4; 
      =     DB2740.DBX 1545.4; 
      =     DB2740.DBX 1625.4; 
      =     DB2740.DBX 1705.4; 
      =     DB2740.DBX 1785.4; 
      =     DB2740.DBX 1865.4; 
      =     DB2740.DBX 1945.4; 
      =     DB2740.DBX 2025.4; 
      =     DB2740.DBX 2105.4; 
      =     DB2740.DBX 2185.4; 
      =     DB2740.DBX 2265.4; 
      =     DB2740.DBX 2345.4; 
      =     DB2740.DBX 2425.4; 
      =     DB2740.DBX 2505.4; 
      =     DB2740.DBX 2585.4; 
      =     DB2740.DBX 2665.4; 

MODE: SET   ; 

NETWORK
TITLE =A14RRP1 Reinigungsrcklaufpumpe Anlage 14

      A     DB2741.DBX   78.7; 
      AN    DB2741.DBX   78.1; 

      A     #GenRel; 
      A     DB2740.DBX  106.7; 
      =     DB2740.DBX  107.6; 
NETWORK
TITLE =A14_RWP 

      A     #GenRel; 
      A     DB2740.DBX  186.7; 
      =     DB2740.DBX  187.6; 

NETWORK
TITLE =Act3  - A14FR_STOP

      A     #GenRel; 
      A     DB2740.DBX  266.7; 
      =     DB2740.DBX  267.6; 

      AN    DB2740.DBX  263.4; 
      =     Q    922.2; 
NETWORK
TITLE =U74_Act010 spare

      A     #GenRel; 
      A     DB2740.DBX  826.7; 
      =     DB2740.DBX  827.6; 
NETWORK
TITLE =U74_Act011 spare

      A     #GenRel; 
      A     DB2740.DBX  906.7; 
      =     DB2740.DBX  907.6; 
NETWORK
TITLE =U74_Act012 spare

      A     #GenRel; 
      A     DB2740.DBX  986.7; 
      =     DB2740.DBX  987.6; 
NETWORK
TITLE =U74_Act013 spare

      A     #GenRel; 
      A     DB2740.DBX 1066.7; 
      =     DB2740.DBX 1067.6; 
NETWORK
TITLE =U74_Act014 spare

      A     #GenRel; 
      A     DB2740.DBX 1146.7; 
      =     DB2740.DBX 1147.6; 
NETWORK
TITLE =U74_Act015 spare

      A     #GenRel; 
      A     DB2740.DBX 1226.7; 
      =     DB2740.DBX 1227.6; 
NETWORK
TITLE =U74_Act016 spare

      A     #GenRel; 
      A     DB2740.DBX 1306.7; 
      =     DB2740.DBX 1307.6; 
NETWORK
TITLE =U74_Act017 spare

      A     #GenRel; 
      A     DB2740.DBX 1386.7; 
      =     DB2740.DBX 1387.6; 
NETWORK
TITLE =U74_Act018 spare

      A     #GenRel; 
      A     DB2740.DBX 1466.7; 
      =     DB2740.DBX 1467.6; 
NETWORK
TITLE =U74_Act023 spare

      A     #GenRel; 
      A     DB2740.DBX 1866.7; 
      =     DB2740.DBX 1867.6; 
NETWORK
TITLE =U74_Act024 spare

      A     #GenRel; 
      A     DB2740.DBX 1946.7; 
      =     DB2740.DBX 1947.6; 
NETWORK
TITLE =U74_Act025 spare

      A     #GenRel; 
      A     DB2740.DBX 2026.7; 
      =     DB2740.DBX 2027.6; 
NETWORK
TITLE =U74_Act026 spare

      A     #GenRel; 
      A     DB2740.DBX 2106.7; 
      =     DB2740.DBX 2107.6; 
NETWORK
TITLE =U74_Act029 spare

      A     #GenRel; 
      A     DB2740.DBX 2346.7; 
      =     DB2740.DBX 2347.6; 
NETWORK
TITLE =U74_Act030 spare

      A     #GenRel; 
      A     DB2740.DBX 2426.7; 
      =     DB2740.DBX 2427.6; 
NETWORK
TITLE =U74_Act032 spare

      A     #GenRel; 
      A     DB2740.DBX 2586.7; 
      =     DB2740.DBX 2587.6; 
NETWORK
TITLE =U74_Act033 spare

      A     #GenRel; 
      A     DB2740.DBX 2666.7; 
      =     DB2740.DBX 2667.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1770
TITLE =U077: KZE Anlage  3
FAMILY : BOTEC_F1
NAME : U077A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1770.DBW    0; 
      T     #UnitNo; 
      L     DB1770.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2775.unv001,
           ValExt                   := DB2775.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2775.unv002,
           ValExt                   := DB2775.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2775.unv003,
           ValExt                   := DB2775.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2775.unv004,
           ValExt                   := DB2775.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// KEG_MIXER_BOGEN_23_24 SpI 001 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_23_24,
           SpIBit                   := I    950.0);

// KEG_MIXER_BOGEN_25_26 SpI 002 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_25_26,
           SpIBit                   := I    950.1);

// KEG_MIXER_BOGEN_27_28 SpI 003 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_27_28,
           SpIBit                   := I    950.2);

// KEG_MIXER_BOGEN_27_28_30 SpI 004 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_27_28_30,
           SpIBit                   := I    950.3);

// KEG_MIXER_BOGEN_29_32 SpI 005 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_29_32,
           SpIBit                   := I    950.4);

// KEG_MIXER_BOGEN_31_32 SpI 006 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_31_32,
           SpIBit                   := I    950.5);

// KEG_MIXER_BOGEN_31_33 SpI 007 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_31_33,
           SpIBit                   := I    950.6);

// KEG_MIXER_BOGEN_34_38 SpI 008 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_34_38,
           SpIBit                   := I    950.7);

// KEG_MIXER_BOGEN_35_36_40 SpI 009 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_35_36_40,
           SpIBit                   := I    951.0);

// KEG_MIXER_BOGEN_37_41 SpI 010 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_37_41,
           SpIBit                   := I    951.1);

// KEG_MIXER_BOGEN_21_22 SpI 011 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_21_22,
           SpIBit                   := I    951.2);

// KEG_MIXER_BOGEN_22_24 SpI 012 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_22_24,
           SpIBit                   := I    951.3);

// KEG_MIXER_BOGEN_27_30 SpI 013 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_27_30,
           SpIBit                   := I    951.4);

// KEG_MIXER_FRG_KZE SpI 014 KEG Mixer/KZE Freigabe CIP nur KZE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_FRG_KZE,
           SpIBit                   := I    947.0);

// KEG_MIXER_FRG_GES SpI 015 KEG Mixer/KZE Freigabe CIP Gesamt
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_FRG_GES,
           SpIBit                   := I    946.6);

// KEG_MIXER_FRG_o_KZE SpI 016 KEG Mixer/KZE Freigabe CIP Gesamt ohne KZE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_FRG_o_KZE,
           SpIBit                   := I    946.7);

// KEG_MIXER_BOGEN_28_31 SpI 020 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2771.KEG_MIXER_BOGEN_28_31,
           SpIBit                   := I    951.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2777.msg001,
           MsgBit                   := DB2777.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2777.msg002,
           MsgBit                   := DB2777.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2777.msg003,
           MsgBit                   := DB2777.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1771
TITLE =U077: KZE Anlage  3
FAMILY : BOTEC_F1
NAME : U077E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1771.DBX 1357.7; 
      CC    FB  1779; // "U077Sim"
      A     DB1771.DBX   17.3; 
      =     DB1771.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1770.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1771.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1775.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1771.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1775; // U077Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U077UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U077UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U077UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U077UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_23_24 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_23_24.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_23_24.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_25_26 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_25_26.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_25_26.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_27_28 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_27_28.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_27_28.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_27_28_30 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_27_28_30.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_27_28_30.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_29_32 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_29_32.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_29_32.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_31_32 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_31_32.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_31_32.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_31_33 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_31_33.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_31_33.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_34_38 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_34_38.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_34_38.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_35_36_40 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_35_36_40.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_35_36_40.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_37_41 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_37_41.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_37_41.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_21_22 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_21_22.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_21_22.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_22_24 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_22_24.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_22_24.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_27_30 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_27_30.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_27_30.Pre

// ----------------------------------------------------------
// KEG_MIXER_FRG_KZE KEG Mixer/KZE Freigabe CIP nur KZE
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_FRG_KZE.EAl
//      =     "U077SpID".KEG_MIXER_FRG_KZE.Pre

// ----------------------------------------------------------
// KEG_MIXER_FRG_GES KEG Mixer/KZE Freigabe CIP Gesamt
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_FRG_GES.EAl
//      =     "U077SpID".KEG_MIXER_FRG_GES.Pre

// ----------------------------------------------------------
// KEG_MIXER_FRG_o_KZE KEG Mixer/KZE Freigabe CIP Gesamt ohne KZE
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_FRG_o_KZE.EAl
//      =     "U077SpID".KEG_MIXER_FRG_o_KZE.Pre

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_28_31 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
//      SET   
//      =     "U077SpID".KEG_MIXER_BOGEN_28_31.EAl
//      =     "U077SpID".KEG_MIXER_BOGEN_28_31.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2777.DBX   80.7; 
      =     DB2777.DBX   81.4; 

      CLR   ; 
      =     DB2777.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2777.DBX  140.7; 
      =     DB2777.DBX  141.4; 

      CLR   ; 
      =     DB2777.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2777.DBX  200.7; 
      =     DB2777.DBX  201.4; 

      CLR   ; 
      =     DB2777.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB1773.DBX   43.1; 
      S     DB1773.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 




MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1780
TITLE =U078: KZE Anlage  5
FAMILY : BOTEC_F1
NAME : U078A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1780.DBW    0; 
      T     #UnitNo; 
      L     DB1780.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// FIC450141 AnI 001 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2783.FIC450141,
           ValPer                   := #DummyInt);

// TIR450121 AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2783.TIR450121,
           ValPer                   := #DummyInt);

// TIC450241 AnI 003 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2783.TIC450241,
           ValPer                   := #DummyInt);

// CIS450241 AnI 004 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2783.CIS450241,
           ValPer                   := #DummyInt);

// PIR450131 AnI 006 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2783.PIR450131,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2785.unv001,
           ValExt                   := DB2785.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2785.unv002,
           ValExt                   := DB2785.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2785.unv003,
           ValExt                   := DB2785.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2785.unv004,
           ValExt                   := DB2785.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// KZE5_CIP_BEREIT SpI 003 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_CIP_BEREIT,
           SpIBit                   := I    344.0);

// KZE5_PT_VOLL SpI 004 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_PT_VOLL,
           SpIBit                   := I    344.2);

// KZE5_PT_LEER SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_PT_LEER,
           SpIBit                   := I    344.1);

// KZE5_BEREIT_F_KREISL SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_BEREIT_F_KREISL,
           SpIBit                   := I    344.5);

// KZE5_Watchdog SpI 007 KZE Anl.5 Watchdog
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_Watchdog,
           SpIBit                   := I    345.7);

// KZE5_STERI_BEREIT SpI 009 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_STERI_BEREIT,
           SpIBit                   := I    344.3);

// KZE5_AUSL_90GRAD SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_AUSL_90GRAD,
           SpIBit                   := I    344.4);

// KZE5_V720085 SpI 011 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720085,
           SpIBit                   := I    347.0);

// KZE5_LUFTWAESCHE_AKTIV SpI 012 Luftwsche luft
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_LUFTWAESCHE_AKTIV,
           SpIBit                   := I    345.3);

// KZE5_LUFTWAESCHE_ENDE SpI 013 Luftwsche beendet
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_LUFTWAESCHE_ENDE,
           SpIBit                   := I    345.4);

// KZE5_FRG_KZE SpI 014 Freigabe CIP nur KZE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_FRG_KZE,
           SpIBit                   := I    344.6);

// KZE5_FRG_MIX_KZE_FUELL SpI 015 Freigabe CIP Mixer KZE Fller
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_FRG_MIX_KZE_FUELL,
           SpIBit                   := I    344.7);

// KZE5_FRG_MIX_FUELL SpI 016 Freigabe CIP Mixer Fller
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_FRG_MIX_FUELL,
           SpIBit                   := I    345.0);

// KZE5_V4500V03 SpI 017 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V4500V03,
           SpIBit                   := I    346.0);

// KZE5_V720015 SpI 018 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720015,
           SpIBit                   := I    346.1);

// KZE5_V720016 SpI 019 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720016,
           SpIBit                   := I    346.2);

// KZE5_V720017 SpI 020 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720017,
           SpIBit                   := I    346.3);

// KZE5_V720081 SpI 021 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720081,
           SpIBit                   := I    346.4);

// KZE5_V720082 SpI 022 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720082,
           SpIBit                   := I    346.5);

// KZE5_V720083 SpI 023 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720083,
           SpIBit                   := I    346.6);

// KZE5_V720084 SpI 024 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720084,
           SpIBit                   := I    346.7);

// KZE5_V720086 SpI 025 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720086,
           SpIBit                   := I    347.1);

// KZE5_V720087 SpI 026 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720087,
           SpIBit                   := I    347.2);

// KZE5_V720182 SpI 027 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720182,
           SpIBit                   := I    347.3);

// KZE5_V720006 SpI 028 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2781.KZE5_V720006,
           SpIBit                   := I    347.4);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2787.msg001,
           MsgBit                   := DB2787.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2787.msg002,
           MsgBit                   := DB2787.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2787.msg003,
           MsgBit                   := DB2787.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
NETWORK
TITLE =KZE5_CIP_laeuft  KZE5 CIP Luft
// Act 002
// Box           : KZE5
// Output address: Q344.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_CIP_laeuft,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.0);

NETWORK
TITLE =KZE5_CIP_ENDE  KZE5 CIP ENDE
// Act 003
// Box           : KZE5
// Output address: Q344.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_CIP_ENDE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.3);

NETWORK
TITLE =KZE5_Medienwechsel  KZE5 Medienwechsel
// Act 004
// Box           : KZE5
// Output address: Q346.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Medienwechsel,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    346.3);

NETWORK
TITLE =KZE5_Abpumpen  KZE5 Abpumpen
// Act 005
// Box           : KZE5
// Output address: Q344.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Abpumpen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.6);

NETWORK
TITLE =KZE5_KRSL_OA_PT  KZE5 Kreislauf ohne Ablauf Puffertank
// Act 006
// Box           : KZE5
// Output address: Q344.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_KRSL_OA_PT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.4);

NETWORK
TITLE =KZE5_KRSL_MA_PT  KZE5 Kreislauf mit Ablauf Puffertank
// Act 007
// Box           : KZE5
// Output address: Q344.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_KRSL_MA_PT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.5);

NETWORK
TITLE =KZE5_Grundstellung  KZE5 Grundstellung
// Act 008
// Box           : KZE5
// Output address: Q344.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.2);

NETWORK
TITLE =KZE5_Heizung_ein  KZE5 Heizung ein
// Act 012
// Box           : KZE5
// Output address: Q344.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Heizung_ein,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    344.1);

NETWORK
TITLE =KZE5_H2O  KZE5 Hauptschritte Wasser
// Act 013
// Box           : KZE5
// Output address: Q345.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_H2O,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    345.1);

NETWORK
TITLE =KZE5_Lauge  KZE5 Lauge Kreislauf
// Act 014
// Box           : KZE5
// Output address: Q345.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Lauge,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    345.2);

NETWORK
TITLE =KZE5_Saeure  KZE5 Sure Kreislauf
// Act 015
// Box           : KZE5
// Output address: Q345.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Saeure,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    345.3);

NETWORK
TITLE =KZE5_Sterilisation  KZE5 Sterilisation angewhlt
// Act 016
// Box           : KZE5
// Output address: Q345.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Sterilisation,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    345.4);

NETWORK
TITLE =KZE5_Abkuehlen  KZE5 Abkhlen
// Act 017
// Box           : KZE5
// Output address: Q345.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Abkuehlen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    345.5);

NETWORK
TITLE =KZE5_Freiabe_Luftwaesche  KZE5 Freigabe Luftwsche
// Act 020
// Box           : KZE5
// Output address: Q346.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2780.KZE5_Freiabe_Luftwaesche,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    346.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1781
TITLE =U078: KZE Anlage  5
FAMILY : BOTEC_F1
NAME : U078E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1781.DBX 1357.7; 
      CC    FB  1789; // "U078Sim"
      A     DB1781.DBX   17.3; 
      =     DB1781.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1780.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1781.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1785.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1781.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1785; // U078Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// FIC450141 
// ----------------------------------------------------------


      L     ID   348; // FIC
      L     1.000000e+001; 
      /R    ; 

      T     DB2783.DBD  214; 
      SET   ; 
      =     DB2783.DBX  143.5; 

      L     DB1781.DBD 1118; // !!! insert correct SFM !!!
      T     DB2783.DBD  238; 

      SET   ; 
      =     DB2783.DBX  141.5; 

// ----------------------------------------------------------
// TIR450121 
// ----------------------------------------------------------
      L     ID   352; //TIR
      T     DB2783.DBD  334; 
      SET   ; 
      =     DB2783.DBX  263.5; 

      L     DB1781.DBD 1118; // !!! insert correct SFM !!!
      T     DB2783.DBD  358; 

      SET   ; 
      =     DB2783.DBX  261.5; 

// ----------------------------------------------------------
// TIC450241 
// ----------------------------------------------------------
      L     ID   360; //TIC
      T     DB2783.DBD  454; 
      SET   ; 
      =     DB2783.DBX  383.5; 

      L     DB1781.DBD 1118; // !!! insert correct SFM !!!
      T     DB2783.DBD  478; 

      SET   ; 
      =     DB2783.DBX  381.5; 

// ----------------------------------------------------------
// CIS450241 
// ----------------------------------------------------------
      L     ID   364; // CIS
      T     DB2783.DBD  574; 
      SET   ; 
      =     DB2783.DBX  503.5; 

      L     DB1781.DBD 1118; // !!! insert correct SFM !!!
      T     DB2783.DBD  598; 

      SET   ; 
      =     DB2783.DBX  501.5; 

// ----------------------------------------------------------
// PIR450131 
// ----------------------------------------------------------
      L     ID   356; // PIR
      T     DB2783.DBD  814; 
      SET   ; 
      =     DB2783.DBX  743.5; 

      L     DB1781.DBD 1118; // !!! insert correct SFM !!!
      T     DB2783.DBD  838; 

      SET   ; 
      =     DB2783.DBX  741.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U078UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U078UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U078UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U078UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// KZE5_CIP_BEREIT 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_CIP_BEREIT.EAl
//      =     "U078SpID".KZE5_CIP_BEREIT.Pre

// ----------------------------------------------------------
// KZE5_PT_VOLL 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_PT_VOLL.EAl
//      =     "U078SpID".KZE5_PT_VOLL.Pre

// ----------------------------------------------------------
// KZE5_PT_LEER 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_PT_LEER.EAl
//      =     "U078SpID".KZE5_PT_LEER.Pre

// ----------------------------------------------------------
// KZE5_BEREIT_F_KREISL 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_BEREIT_F_KREISL.EAl
//      =     "U078SpID".KZE5_BEREIT_F_KREISL.Pre

// ----------------------------------------------------------
// KZE5_Watchdog KZE Anl.5 Watchdog
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_Watchdog.EAl
//      =     "U078SpID".KZE5_Watchdog.Pre

// ----------------------------------------------------------
// KZE5_STERI_BEREIT 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_STERI_BEREIT.EAl
//      =     "U078SpID".KZE5_STERI_BEREIT.Pre

// ----------------------------------------------------------
// KZE5_AUSL_90GRAD 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_AUSL_90GRAD.EAl
//      =     "U078SpID".KZE5_AUSL_90GRAD.Pre

// ----------------------------------------------------------
// KZE5_V720085 spare
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720085.EAl
//      =     "U078SpID".KZE5_V720085.Pre

// ----------------------------------------------------------
// KZE5_LUFTWAESCHE_AKTIV Luftwsche luft
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_LUFTWAESCHE_AKTIV.EAl
//      =     "U078SpID".KZE5_LUFTWAESCHE_AKTIV.Pre

// ----------------------------------------------------------
// KZE5_LUFTWAESCHE_ENDE Luftwsche beendet
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_LUFTWAESCHE_ENDE.EAl
//      =     "U078SpID".KZE5_LUFTWAESCHE_ENDE.Pre

// ----------------------------------------------------------
// KZE5_FRG_KZE Freigabe CIP nur KZE
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_FRG_KZE.EAl
//      =     "U078SpID".KZE5_FRG_KZE.Pre

// ----------------------------------------------------------
// KZE5_FRG_MIX_KZE_FUELL Freigabe CIP Mixer KZE Fller
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_FRG_MIX_KZE_FUELL.EAl
//      =     "U078SpID".KZE5_FRG_MIX_KZE_FUELL.Pre

// ----------------------------------------------------------
// KZE5_FRG_MIX_FUELL Freigabe CIP Mixer Fller
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_FRG_MIX_FUELL.EAl
//      =     "U078SpID".KZE5_FRG_MIX_FUELL.Pre

// ----------------------------------------------------------
// KZE5_V4500V03 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V4500V03.EAl
//      =     "U078SpID".KZE5_V4500V03.Pre

// ----------------------------------------------------------
// KZE5_V720015 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720015.EAl
//      =     "U078SpID".KZE5_V720015.Pre

// ----------------------------------------------------------
// KZE5_V720016 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720016.EAl
//      =     "U078SpID".KZE5_V720016.Pre

// ----------------------------------------------------------
// KZE5_V720017 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720017.EAl
//      =     "U078SpID".KZE5_V720017.Pre

// ----------------------------------------------------------
// KZE5_V720081 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720081.EAl
//      =     "U078SpID".KZE5_V720081.Pre

// ----------------------------------------------------------
// KZE5_V720082 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720082.EAl
//      =     "U078SpID".KZE5_V720082.Pre

// ----------------------------------------------------------
// KZE5_V720083 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720083.EAl
//      =     "U078SpID".KZE5_V720083.Pre

// ----------------------------------------------------------
// KZE5_V720084 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720084.EAl
//      =     "U078SpID".KZE5_V720084.Pre

// ----------------------------------------------------------
// KZE5_V720086 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720086.EAl
//      =     "U078SpID".KZE5_V720086.Pre

// ----------------------------------------------------------
// KZE5_V720087 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720087.EAl
//      =     "U078SpID".KZE5_V720087.Pre

// ----------------------------------------------------------
// KZE5_V720182 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720182.EAl
//      =     "U078SpID".KZE5_V720182.Pre

// ----------------------------------------------------------
// KZE5_V720006 
// ----------------------------------------------------------
//      CLR   
//      =     "U078SpID".KZE5_V720006.EAl
//      =     "U078SpID".KZE5_V720006.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2787.DBX   80.7; 
      =     DB2787.DBX   81.4; 

      CLR   ; 
      =     DB2787.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2787.DBX  140.7; 
      =     DB2787.DBX  141.4; 

      CLR   ; 
      =     DB2787.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2787.DBX  200.7; 
      =     DB2787.DBX  201.4; 

      CLR   ; 
      =     DB2787.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM  -----------------------
      L     DB2783.DBD  146; 
      T     DB1781.DBD 1122; 

// analog value to SFM  -----------------------
      L     DB2783.DBD  266; 
      T     DB1781.DBD 1122; 

// analog value to SFM  -----------------------
      L     DB2783.DBD  386; 
      T     DB1781.DBD 1122; 

// analog value to SFM  -----------------------
      L     DB2783.DBD  506; 
      T     DB1781.DBD 1122; 

// analog value to SFM  -----------------------
      L     DB2783.DBD  746; 
      T     DB1781.DBD 1122; 

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1785.DBD  138,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1781.Seq.SFM[15],
           ValueOld                 := DB1781.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1783.DBX   43.1; 
      S     DB1783.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2780.DBX  185.4; 
      =     DB2780.DBX  265.4; 
      =     DB2780.DBX  345.4; 
      =     DB2780.DBX  425.4; 
      =     DB2780.DBX  505.4; 
      =     DB2780.DBX  585.4; 
      =     DB2780.DBX  665.4; 
      =     DB2780.DBX  985.4; 
      =     DB2780.DBX 1065.4; 
      =     DB2780.DBX 1145.4; 
      =     DB2780.DBX 1225.4; 
      =     DB2780.DBX 1305.4; 
      =     DB2780.DBX 1385.4; 
      =     DB2780.DBX 1625.4; 



MODE: SET   ; 

NETWORK
TITLE =KZE5_CIP_laeuft KZE5 CIP Luft

      A     #GenRel; 
      A     DB2780.DBX  186.7; 
      =     DB2780.DBX  187.6; 
NETWORK
TITLE =KZE5_CIP_ENDE KZE5 CIP ENDE

      A     #GenRel; 
      A     DB2780.DBX  266.7; 
      =     DB2780.DBX  267.6; 
NETWORK
TITLE =KZE5_Medienwechsel KZE5 Medienwechsel

      A     #GenRel; 
      A     DB2780.DBX  346.7; 
      =     DB2780.DBX  347.6; 
NETWORK
TITLE =KZE5_Abpumpen KZE5 Abpumpen

      A     #GenRel; 
      A     DB2780.DBX  426.7; 
      =     DB2780.DBX  427.6; 
NETWORK
TITLE =KZE5_KRSL_OA_PT KZE5 Kreislauf ohne Ablauf Puffertank

      A     #GenRel; 
      A     DB2780.DBX  506.7; 
      =     DB2780.DBX  507.6; 
NETWORK
TITLE =KZE5_KRSL_MA_PT KZE5 Kreislauf mit Ablauf Puffertank

      A     #GenRel; 
      A     DB2780.DBX  586.7; 
      =     DB2780.DBX  587.6; 
NETWORK
TITLE =KZE5_Grundstellung KZE5 Grundstellung

      A     #GenRel; 
      A     DB2780.DBX  666.7; 
      =     DB2780.DBX  667.6; 
NETWORK
TITLE =KZE5_Heizung_ein KZE5 Heizung ein

      A     #GenRel; 
      A     DB2780.DBX  986.7; 
      =     DB2780.DBX  987.6; 
NETWORK
TITLE =KZE5_H2O KZE5 Hauptschritte Wasser

      A     #GenRel; 
      A     DB2780.DBX 1066.7; 
      =     DB2780.DBX 1067.6; 
NETWORK
TITLE =KZE5_Lauge KZE5 Lauge Kreislauf

      A     #GenRel; 
      A     DB2780.DBX 1146.7; 
      =     DB2780.DBX 1147.6; 
NETWORK
TITLE =KZE5_Saeure KZE5 Sure Kreislauf

      A     #GenRel; 
      A     DB2780.DBX 1226.7; 
      =     DB2780.DBX 1227.6; 
NETWORK
TITLE =KZE5_Sterilisation KZE5 Sterilisation angewhlt

      A     #GenRel; 
      A     DB2780.DBX 1306.7; 
      =     DB2780.DBX 1307.6; 
NETWORK
TITLE =KZE5_Abkuehlen KZE5 Abkhlen

      A     #GenRel; 
      A     DB2780.DBX 1386.7; 
      =     DB2780.DBX 1387.6; 
NETWORK
TITLE =KZE5_Freiabe_Luftwaesche KZE5 Freigabe Luftwsche

      A     #GenRel; 
      A     DB2780.DBX 1626.7; 
      =     DB2780.DBX 1627.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1790
TITLE =U079: KZE Anlage 14
FAMILY : BOTEC_F1
NAME : U079A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1790.DBW    0; 
      T     #UnitNo; 
      L     DB1790.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// A14_KZE_FIC7101 AnI 001 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2793.A14_KZE_FIC7101,
           ValPer                   := PIW 1006);

// A14_KZE_TIR7101 AnI 002 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2793.A14_KZE_TIR7101,
           ValPer                   := PIW 1010);

// A14_KZE_TIC7102 AnI 003 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2793.A14_KZE_TIC7102,
           ValPer                   := PIW 1014);

// A14_KZE_CIS7102 AnI 004 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2793.A14_KZE_CIS7102,
           ValPer                   := PIW 1018);

// A14_KZE_TIS7111 AnI 005 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2793.A14_KZE_TIS7111,
           ValPer                   := PIW 1022);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2795.unv001,
           ValExt                   := DB2795.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2795.unv002,
           ValExt                   := DB2795.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2795.unv003,
           ValExt                   := DB2795.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2795.unv004,
           ValExt                   := DB2795.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// KZE14_CIP_BEREIT SpI 003 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_CIP_BEREIT,
           SpIBit                   := I   1002.0);

// KZE14_PT_VOLL SpI 004 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_PT_VOLL,
           SpIBit                   := I   1002.2);

// KZE14_PT_LEER SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_PT_LEER,
           SpIBit                   := I   1002.1);

// KZE14_BEREIT_F_KREISL SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_BEREIT_F_KREISL,
           SpIBit                   := I   1002.5);

// KZE14_STERI_BEREIT SpI 009 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_STERI_BEREIT,
           SpIBit                   := I   1002.3);

// KZE14_AUSL_90GRAD SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_AUSL_90GRAD,
           SpIBit                   := I   1002.4);

// KZE14_FRG_KZE SpI 014 Freigabe CIP nur KZE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_FRG_KZE,
           SpIBit                   := I   1002.6);

// KZE14_FRG_MIX_KZE_FUEL SpI 015 Freigabe CIP Mixer KZE Fller
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_FRG_MIX_KZE_FUEL,
           SpIBit                   := I   1002.7);

// KZE14_FRG_MIX_FUEL SpI 016 Freigabe CIP Mixer Fller
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_FRG_MIX_FUEL,
           SpIBit                   := I   1003.0);

// KZE14_FRG_KZE_FUEL SpI 017 Freigabe CIP KZE Fller
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_FRG_KZE_FUEL,
           SpIBit                   := I   1003.1);

// KZE14_V710021 SpI 020 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V710021,
           SpIBit                   := I   1004.0);

// KZE14_V710131 SpI 021 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V710131,
           SpIBit                   := I   1004.1);

// KZE14_V710005 SpI 022 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V710005,
           SpIBit                   := I   1004.2);

// KZE14_V710181 SpI 023 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V710181,
           SpIBit                   := I   1004.3);

// KZE14_V710182 SpI 024 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V710182,
           SpIBit                   := I   1004.4);

// KZE14_V813101 SpI 025 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V813101,
           SpIBit                   := I   1004.5);

// KZE14_V813102 SpI 026 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V813102,
           SpIBit                   := I   1004.6);

// KZE14_V812101 SpI 027 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V812101,
           SpIBit                   := I   1004.7);

// KZE14_V812102 SpI 028 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V812102,
           SpIBit                   := I   1005.0);

// KZE14_V812103 SpI 029 Ventil
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2791.KZE14_V812103,
           SpIBit                   := I   1005.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2797.msg001,
           MsgBit                   := DB2797.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2797.msg002,
           MsgBit                   := DB2797.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2797.msg003,
           MsgBit                   := DB2797.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
NETWORK
TITLE =KZE14_CIP_laeuft  A 1002.0 KZE14 CIP Luft
// Act 002
// Box           : A14 KZE
// Output address: Q1002.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_CIP_laeuft,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.0);

NETWORK
TITLE =KZE14_CIP_ENDE  A 1002.3 KZE14 CIP ENDE
// Act 003
// Box           : A14 KZE
// Output address: Q1002.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_CIP_ENDE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.3);

NETWORK
TITLE =KZE14_Abpumpen  A 1002.6 KZE14 Abpumpen
// Act 005
// Box           : A14 KZE
// Output address: Q1002.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Abpumpen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.6);

NETWORK
TITLE =KZE14_KRSL_OA_PT  A 1002.4 KZE14 Kreislauf ohne Ablauf Puffertank
// Act 006
// Box           : A14 KZE
// Output address: Q1002.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_KRSL_OA_PT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.4);

NETWORK
TITLE =KZE14_KRSL_MA_PT  A 1002.5 KZE14 Kreislauf mit Ablauf Puffertank
// Act 007
// Box           : A14 KZE
// Output address: Q1002.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_KRSL_MA_PT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.5);

NETWORK
TITLE =KZE14_Grundstellung  A 1002.2 KZE14 Grundstellung
// Act 008
// Box           : A14 KZE
// Output address: Q1002.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Grundstellung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.2);

NETWORK
TITLE =KZE14_Heizung_ein  A 1002.1 KZE14 Heizung ein
// Act 012
// Box           : A14 KZE
// Output address: Q1002.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Heizung_ein,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1002.1);

NETWORK
TITLE =KZE14_H2O  A 1003.1 KZE14 Hauptschritte Wasser
// Act 013
// Box           : A14 KZE
// Output address: Q1003.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_H2O,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1003.1);

NETWORK
TITLE =KZE14_Lauge  A 1003.2 KZE14 Lauge Kreislauf
// Act 014
// Box           : A14 KZE
// Output address: Q1003.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Lauge,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1003.2);

NETWORK
TITLE =KZE14_Saeure  A 1003.3 KZE14 Sure Kreislauf
// Act 015
// Box           : A14 KZE
// Output address: Q1003.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Saeure,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1003.3);

NETWORK
TITLE =KZE14_Sterilisation  A 1003.4 KZE14 Sterilisation angewhlt
// Act 016
// Box           : A14 KZE
// Output address: Q1003.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Sterilisation,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1003.4);

NETWORK
TITLE =KZE14_Abkuehlen  A 1003.5 KZE14 Abkhlen
// Act 017
// Box           : A14 KZE
// Output address: Q1003.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2790.KZE14_Abkuehlen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q   1003.5);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1791
TITLE =U079: KZE Anlage 14
FAMILY : BOTEC_F1
NAME : U079E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1791.DBX 1357.7; 
      CC    FB  1799; // "U079Sim"
      A     DB1791.DBX   17.3; 
      =     DB1791.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1790.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1791.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1795.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1791.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1795; // U079Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// A14_KZE_FIC7101 
// ----------------------------------------------------------

      L     ID  1006; 
      T     DB2793.DBD  214; 
      SET   ; 
      =     DB2793.DBX  143.5; 

      L     DB1791.DBD 1118; // !!! insert correct SFM !!!
      T     DB2793.DBD  238; 

      SET   ; 
      =     DB2793.DBX  141.5; 

// ----------------------------------------------------------
// A14_KZE_TIR7101 
// ----------------------------------------------------------

      L     ID  1010; 
      T     DB2793.DBD  334; 
      SET   ; 
      =     DB2793.DBX  263.5; 

      L     DB1791.DBD 1118; // !!! insert correct SFM !!!
      T     DB2793.DBD  358; 

      SET   ; 
      =     DB2793.DBX  261.5; 

// ----------------------------------------------------------
// A14_KZE_TIC7102 
// ----------------------------------------------------------

      L     ID  1014; 
      T     DB2793.DBD  454; 
      SET   ; 
      =     DB2793.DBX  383.5; 

      L     DB1791.DBD 1118; // !!! insert correct SFM !!!
      T     DB2793.DBD  478; 

      SET   ; 
      =     DB2793.DBX  381.5; 

// ----------------------------------------------------------
// A14_KZE_CIS7102 
// ----------------------------------------------------------

      L     ID  1018; 
      T     DB2793.DBD  574; 
      SET   ; 
      =     DB2793.DBX  503.5; 

      L     DB1791.DBD 1118; // !!! insert correct SFM !!!
      T     DB2793.DBD  598; 

      SET   ; 
      =     DB2793.DBX  501.5; 

// ----------------------------------------------------------
// A14_KZE_TIS7111 
// ----------------------------------------------------------

      L     ID  1022; 
      T     DB2793.DBD  694; 
      SET   ; 
      =     DB2793.DBX  623.5; 

      L     DB1791.DBD 1118; // !!! insert correct SFM !!!
      T     DB2793.DBD  718; 

      SET   ; 
      =     DB2793.DBX  621.5; 


NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U079UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U079UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U079UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U079UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// KZE14_CIP_BEREIT 
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_CIP_BEREIT.EAl
//      =     "U079SpID".KZE14_CIP_BEREIT.Pre

// ----------------------------------------------------------
// KZE14_PT_VOLL 
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_PT_VOLL.EAl
//      =     "U079SpID".KZE14_PT_VOLL.Pre

// ----------------------------------------------------------
// KZE14_PT_LEER 
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_PT_LEER.EAl
//      =     "U079SpID".KZE14_PT_LEER.Pre

// ----------------------------------------------------------
// KZE14_BEREIT_F_KREISL 
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_BEREIT_F_KREISL.EAl
//      =     "U079SpID".KZE14_BEREIT_F_KREISL.Pre

// ----------------------------------------------------------
// KZE14_STERI_BEREIT 
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_STERI_BEREIT.EAl
//      =     "U079SpID".KZE14_STERI_BEREIT.Pre

// ----------------------------------------------------------
// KZE14_AUSL_90GRAD 
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_AUSL_90GRAD.EAl
//      =     "U079SpID".KZE14_AUSL_90GRAD.Pre

// ----------------------------------------------------------
// KZE14_FRG_KZE Freigabe CIP nur KZE
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_FRG_KZE.EAl
//      =     "U079SpID".KZE14_FRG_KZE.Pre

// ----------------------------------------------------------
// KZE14_FRG_MIX_KZE_FUEL Freigabe CIP Mixer KZE Fller
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_FRG_MIX_KZE_FUEL.EAl
//      =     "U079SpID".KZE14_FRG_MIX_KZE_FUEL.Pre

// ----------------------------------------------------------
// KZE14_FRG_MIX_FUEL Freigabe CIP Mixer Fller
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_FRG_MIX_FUEL.EAl
//      =     "U079SpID".KZE14_FRG_MIX_FUEL.Pre

// ----------------------------------------------------------
// KZE14_FRG_KZE_FUEL Freigabe CIP KZE Fller
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_FRG_KZE_FUEL.EAl
//      =     "U079SpID".KZE14_FRG_KZE_FUEL.Pre

// ----------------------------------------------------------
// KZE14_V710021 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V710021.EAl
//      =     "U079SpID".KZE14_V710021.Pre

// ----------------------------------------------------------
// KZE14_V710131 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V710131.EAl
//      =     "U079SpID".KZE14_V710131.Pre

// ----------------------------------------------------------
// KZE14_V710005 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V710005.EAl
//      =     "U079SpID".KZE14_V710005.Pre

// ----------------------------------------------------------
// KZE14_V710181 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V710181.EAl
//      =     "U079SpID".KZE14_V710181.Pre

// ----------------------------------------------------------
// KZE14_V710182 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V710182.EAl
//      =     "U079SpID".KZE14_V710182.Pre

// ----------------------------------------------------------
// KZE14_V813101 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V813101.EAl
//      =     "U079SpID".KZE14_V813101.Pre

// ----------------------------------------------------------
// KZE14_V813102 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V813102.EAl
//      =     "U079SpID".KZE14_V813102.Pre

// ----------------------------------------------------------
// KZE14_V812101 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V812101.EAl
//      =     "U079SpID".KZE14_V812101.Pre

// ----------------------------------------------------------
// KZE14_V812102 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V812102.EAl
//      =     "U079SpID".KZE14_V812102.Pre

// ----------------------------------------------------------
// KZE14_V812103 Ventil
// ----------------------------------------------------------
//      CLR   
//      =     "U079SpID".KZE14_V812103.EAl
//      =     "U079SpID".KZE14_V812103.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2797.DBX   80.7; 
      =     DB2797.DBX   81.4; 

      CLR   ; 
      =     DB2797.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2797.DBX  140.7; 
      =     DB2797.DBX  141.4; 

      CLR   ; 
      =     DB2797.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB2797.DBX  200.7; 
      =     DB2797.DBX  201.4; 

      CLR   ; 
      =     DB2797.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM  -----------------------
      L     DB2793.DBD  146; 
      T     DB1791.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM  -----------------------
      L     DB2793.DBD  266; 
      T     DB1791.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM  -----------------------
      L     DB2793.DBD  386; 
      T     DB1791.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM  -----------------------
      L     DB2793.DBD  506; 
      T     DB1791.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM  -----------------------
      L     DB2793.DBD  626; 
      T     DB1791.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1793.DBX   43.1; 
      S     DB1793.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2790.DBX  185.4; 
      =     DB2790.DBX  265.4; 
      =     DB2790.DBX  425.4; 
      =     DB2790.DBX  505.4; 
      =     DB2790.DBX  585.4; 
      =     DB2790.DBX  665.4; 
      =     DB2790.DBX  985.4; 
      =     DB2790.DBX 1065.4; 
      =     DB2790.DBX 1145.4; 
      =     DB2790.DBX 1225.4; 
      =     DB2790.DBX 1305.4; 
      =     DB2790.DBX 1385.4; 



MODE: SET   ; 

NETWORK
TITLE =KZE14_CIP_laeuft A 1002.0 KZE14 CIP Luft

      A     #GenRel; 
      A     DB2790.DBX  186.7; 
      =     DB2790.DBX  187.6; 
NETWORK
TITLE =KZE14_CIP_ENDE A 1002.3 KZE14 CIP ENDE

      A     #GenRel; 
      A     DB2790.DBX  266.7; 
      =     DB2790.DBX  267.6; 
NETWORK
TITLE =KZE14_Abpumpen A 1002.6 KZE14 Abpumpen

      A     #GenRel; 
      A     DB2790.DBX  426.7; 
      =     DB2790.DBX  427.6; 
NETWORK
TITLE =KZE14_KRSL_OA_PT A 1002.4 KZE14 Kreislauf ohne Ablauf Puffertank

      A     #GenRel; 
      A     DB2790.DBX  506.7; 
      =     DB2790.DBX  507.6; 
NETWORK
TITLE =KZE14_KRSL_MA_PT A 1002.5 KZE14 Kreislauf mit Ablauf Puffertank

      A     #GenRel; 
      A     DB2790.DBX  586.7; 
      =     DB2790.DBX  587.6; 
NETWORK
TITLE =KZE14_Grundstellung A 1002.2 KZE14 Grundstellung

      A     #GenRel; 
      A     DB2790.DBX  666.7; 
      =     DB2790.DBX  667.6; 
NETWORK
TITLE =KZE14_Heizung_ein A 1002.1 KZE14 Heizung ein

      A     #GenRel; 
      A     DB2790.DBX  986.7; 
      =     DB2790.DBX  987.6; 
NETWORK
TITLE =KZE14_H2O A 1003.1 KZE14 Hauptschritte Wasser

      A     #GenRel; 
      A     DB2790.DBX 1066.7; 
      =     DB2790.DBX 1067.6; 
NETWORK
TITLE =KZE14_Lauge A 1003.2 KZE14 Lauge Kreislauf

      A     #GenRel; 
      A     DB2790.DBX 1146.7; 
      =     DB2790.DBX 1147.6; 
NETWORK
TITLE =KZE14_Saeure A 1003.3 KZE14 Sure Kreislauf

      A     #GenRel; 
      A     DB2790.DBX 1226.7; 
      =     DB2790.DBX 1227.6; 
NETWORK
TITLE =KZE14_Sterilisation A 1003.4 KZE14 Sterilisation angewhlt

      A     #GenRel; 
      A     DB2790.DBX 1306.7; 
      =     DB2790.DBX 1307.6; 
NETWORK
TITLE =KZE14_Abkuehlen A 1003.5 KZE14 Abkhlen

      A     #GenRel; 
      A     DB2790.DBX 1386.7; 
      =     DB2790.DBX 1387.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1810
TITLE =U081: Caustic Tank
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1810.DBW    0; 
      T     #UnitNo; 
      L     DB1810.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_L AnI 001 Laugetank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2813.LI_L,
           ValPer                   := IW   566);

// CS_L AnI 002 Laugetank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2813.CS_L,
           ValPer                   := IW   154);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2815.unv001,
           ValExt                   := DB2815.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2815.unv002,
           ValExt                   := DB2815.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_LAUGE SpI 001 Laugetank LS-
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2811.LS_LLL_LAUGE,
           SpIBit                   := I     92.2);

// LS_HL_LAUGE SpI 002 Laugetank LS+
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2811.LS_HL_LAUGE,
           SpIBit                   := I     92.0);

// LS_LL_LAUGE SpI 003 Laugetank LS/
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2811.LS_LL_LAUGE,
           SpIBit                   := I      7.3);

// LS_LL_LAUGE_ALT SpI 004 Spare
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U081SpID".LS_LL_LAUGE_ALT
//       SpIBit:="LS_LL_LAUGE_ALT"

// U81_SpI005 SpI 005 spare
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U081SpID".U81_SpI005
//       SpIBit:=#xTmp

// LANG_NEUANSATZ_LAUGE SpI 007 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2811.LANG_NEUANSATZ_LAUGE,
           SpIBit                   := I     40.0);

// LANG_NACHSCH_LAUGE SpI 008 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2811.LANG_NACHSCH_LAUGE,
           SpIBit                   := I     40.4);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2817.msg001,
           MsgBit                   := DB2817.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2817.msg002,
           MsgBit                   := DB2817.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RW_LAUGE  Rhrwerk HLT
// Act 001
// Box           : LT-CIP
// Input address : I256.2
// Output address: Q256.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2810.RW_LAUGE,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    256.2,
           Out                      := Q    256.2);

NETWORK
TITLE =LU_P1  LUP1
// Act 002
// Box           : S6 U6.3
// Input address : I5.5
// Output address: Q5.5
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U081ActD".LU_P1
//       Typ   :=0
//       FBa   :="LU_P1GSK"
//       FBa2  :=#xTmp
//       Out   :="LU_P1O"

NETWORK
TITLE =U81_Act003  spare
// Act 003
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U081ActD".U81_Act003
//       Typ   :=3
//       FBa   :=#xTmp
//       FBa2  :=#xTmp
//       Out   :=#xTmp

NETWORK
TITLE =U81_Act004  Sure Umpumpvetil
// Act 004
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U081ActD".U81_Act004
//       Typ   :=0
//       FBa   :=#xTmp
//       FBa2  :="SU_K1GSC"
//       Out   :="SU_K1O"

NETWORK
TITLE =U81_Act005  spare
// Act 005
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U081ActD".U81_Act005
//       Typ   :=3
//       FBa   :=#xTmp
//       FBa2  :=#xTmp
//       Out   :=#xTmp

NETWORK
TITLE =U81_Act006  spare
// Act 006
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U081ActD".U81_Act006
//       Typ   :=3
//       FBa   :=#xTmp
//       FBa2  :=#xTmp
//       Out   :=#xTmp

NETWORK
TITLE =LU_K1  Lauge Umpumpventil
// Act 007
// Box           : VSRVK1..3
// Input address : I275.4
// Output address: Q275.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2810.LU_K1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.4,
           Out                      := Q    275.4);

NETWORK
TITLE =LANGF_NACHSCHLAUGE  SIGNAL VON TU AN FA.LANG
// Act 008
// Box           : S8 U8.2
// Output address: Q43.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2810.LANGF_NACHSCHLAUGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.0);

NETWORK
TITLE =LANGF_NEUANSLAUGE  SIGNAL VON TU AN FA.LANG
// Act 009
// Box           : S8 U8.2
// Output address: Q43.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2810.LANGF_NEUANSLAUGE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.3);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1811
TITLE =U081: Caustic Tank
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1811.DBX 1357.7; 
      CC    FB  1819; // "U081Sim"
      A     DB1811.DBX   17.3; 
      =     DB1811.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1810.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1811.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1815.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1811.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1815; // U081Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// LI_L Laugetank
// ----------------------------------------------------------
      L     DB1811.DBD 1118; // !!! insert correct SFM !!!
      T     DB2813.DBD  238; 

//      SET   
//      =     "U081AnID".LI_L.EAlHH

// ----------------------------------------------------------
// CS_L Laugetank
// ----------------------------------------------------------
      L     DB1811.DBD 1118; // !!! insert correct SFM !!!
      T     DB2813.DBD  358; 

      SET   ; 
      =     DB2813.DBX  261.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U081UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U081UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LLL_LAUGE Laugetank LS-
// ----------------------------------------------------------
      ON    DB2910.DBX  662.5; 
      ON    DB2920.DBX  662.5; 
      ON    DB2930.DBX  662.5; 
      =     DB2811.DBX   81.4; 

      CLR   ; 
      =     DB2811.DBX   81.5; 

// ----------------------------------------------------------
// LS_HL_LAUGE Laugetank LS+
// ----------------------------------------------------------
      ON    DB2910.DBX  742.5; 
      ON    DB2920.DBX  742.5; 
      ON    DB2930.DBX  742.5; 
      =     DB2811.DBX  141.4; 
      SET   ; 
      =     DB2811.DBX  141.5; 

      SET   ; 
      =     DB2811.DBX  140.6; 

// ----------------------------------------------------------
// LS_LL_LAUGE Laugetank LS/
// ----------------------------------------------------------
      CLR   ; 
//      =     "U081SpID".LS_LL_LAUGE.EAl
      =     DB2811.DBX  201.5; 

// ----------------------------------------------------------
// LS_LL_LAUGE_ALT 
// ----------------------------------------------------------
      CLR   ; 
      =     DB2811.DBX  261.4; 
      =     DB2811.DBX  261.5; 

// ----------------------------------------------------------
// U81_SpI005 spare
// ----------------------------------------------------------
      CLR   ; 
      =     DB2811.DBX  321.4; 
      =     DB2811.DBX  321.5; 

// ----------------------------------------------------------
// LANG_NEUANSATZ_LAUGE RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U081SpID".LANG_NEUANSATZ_LAUGE.EAl
//      =     "U081SpID".LANG_NEUANSATZ_LAUGE.Pre

// ----------------------------------------------------------
// LANG_NACHSCH_LAUGE RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U081SpID".LANG_NACHSCH_LAUGE.EAl
//      =     "U081SpID".LANG_NACHSCH_LAUGE.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2817.DBX   80.7; 
      =     DB2817.DBX   81.4; 

      CLR   ; 
      =     DB2817.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2817.DBX  140.7; 
      =     DB2817.DBX  141.4; 

      CLR   ; 
      =     DB2817.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Laugetank -----------------------
      L     DB2813.DBD  146; 
      T     DB1811.DBD  386; // Level

// analog value to SFM Laugetank -----------------------
      L     DB2813.DBD  266; 
      T     DB1811.DBD  642; // Conductivity
      T     DB1811.DBD  658; // Conductivity Start Pulse/Pause

// sequencer ----------------------------------------------------------------
      A     DB1813.DBX   43.1; 
      S     DB1813.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2810.DBX  105.4; 
      =     DB2810.DBX  185.4; 
      =     DB2810.DBX  265.4; 
      =     DB2810.DBX  345.4; 
      =     DB2810.DBX  425.4; 
      =     DB2810.DBX  505.4; 
      =     DB2810.DBX  585.4; 
      =     DB2810.DBX  665.4; 
      =     DB2810.DBX  745.4; 



MODE: SET   ; 

NETWORK
TITLE =RW_LAUGE Rhrwerk HLT

      AN    DB2811.DBX   78.7; 
      A     #GenRel; 
      A     DB2810.DBX  106.7; 
      =     DB2810.DBX  107.6; 
NETWORK
TITLE =LU_P1 LUP1

      A     #GenRel; 
      A     DB2810.DBX  186.7; 
      =     DB2810.DBX  187.6; 
NETWORK
TITLE =U81_Act003 spare

      A     #GenRel; 
      A     DB2810.DBX  266.7; 
      =     DB2810.DBX  267.6; 
NETWORK
TITLE =U81_Act004 spare

      A     DB2811.DBX  138.7; 

      A     #GenRel; 
      A     DB2810.DBX  346.7; 
      =     DB2810.DBX  347.6; 
NETWORK
TITLE =U81_Act005 spare

      A     DB2811.DBX  138.7; 

      A     #GenRel; 
      A     DB2810.DBX  426.7; 
      =     DB2810.DBX  427.6; 
NETWORK
TITLE =U81_Act006 spare

      A     DB2811.DBX  138.7; 

      A     #GenRel; 
      A     DB2810.DBX  506.7; 
      =     DB2810.DBX  507.6; 
NETWORK
TITLE =LU_K1 Lauge Umpumpventil

      A     #GenRel; 
      A     DB2810.DBX  586.7; 
      =     DB2810.DBX  587.6; 
NETWORK
TITLE =LANGF_NACHSCHLAUGE SIGNAL VON TU AN FA.LANG

      A     #GenRel; 
      A     DB2810.DBX  666.7; 
      =     DB2810.DBX  667.6; 
NETWORK
TITLE =LANGF_NEUANSLAUGE SIGNAL VON TU AN FA.LANG

      A     #GenRel; 
      A     DB2810.DBX  746.7; 
      =     DB2810.DBX  747.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1820
TITLE =U082: Acid Tank
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1820.DBW    0; 
      T     #UnitNo; 
      L     DB1820.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_S AnI 001 Suretank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2823.LI_S,
           ValPer                   := IW   564);

// CS_S AnI 002 Suretank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2823.CS_S,
           ValPer                   := IW   156);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2825.unv001,
           ValExt                   := DB2825.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2825.unv002,
           ValExt                   := DB2825.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LLL_SAEURE SpI 001 Suretank LS-
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2821.LS_LLL_SAEURE,
           SpIBit                   := I     92.7);

// LS_HL_SAEURE SpI 002 Suretank LS+
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2821.LS_HL_SAEURE,
           SpIBit                   := I     92.5);

// LS_LL_SAEURE SpI 003 Suretank LS/
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2821.LS_LL_SAEURE,
           SpIBit                   := I      7.4);

// LS_LL_SAEURE_ALT SpI 004 Spare
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U082SpID".LS_LL_SAEURE_ALT
//       SpIBit:="LS_LL_SAEURE_ALT"

// LANG_NEUANSATZ_SAEURE SpI 007 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2821.LANG_NEUANSATZ_SAEURE,
           SpIBit                   := I     40.1);

// LANG_NACHSCH_SAEURE SpI 008 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2821.LANG_NACHSCH_SAEURE,
           SpIBit                   := I     40.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2827.msg001,
           MsgBit                   := DB2827.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2827.msg002,
           MsgBit                   := DB2827.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RW_SAEURE  Rhrwerk S1T
// Act 001
// Box           : LT-CIP
// Input address : I256.3
// Output address: Q256.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2820.RW_SAEURE,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    256.3,
           Out                      := Q    256.3);

NETWORK
TITLE =SU_P1  SUP1
// Act 002
// Box           : S6 U6.3
// Input address : I5.6
// Output address: Q5.6
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U082ActD".SU_P1
//       Typ   :=0
//       FBa   :="SU_P1GSK"
//       FBa2  :=#xTmp
//       Out   :="SU_P1O"

NETWORK
TITLE =U82_Act004  spare
// Act 004
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U082ActD".U82_Act004
//       Typ   :=3
//       FBa   :=#xTmp
//       FBa2  :=#xTmp
//       Out   :=#xTmp

NETWORK
TITLE =U82_Act005  spare
// Act 005
// Box           : 
// Input address : #xTmp
// Output address: #xTmp
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U082ActD".U82_Act005
//       Typ   :=3
//       FBa   :=#xTmp
//       FBa2  :=#xTmp
//       Out   :=#xTmp

NETWORK
TITLE =SU_K1  Sure Umpumpventil
// Act 007
// Box           : VSRVK1..3
// Input address : I275.5
// Output address: Q275.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2820.SU_K1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.5,
           Out                      := Q    275.5);

NETWORK
TITLE =LANGF_NACHSCHSAEURE  SIGNAL VON TU AN FA.LANG
// Act 008
// Box           : S8 U8.2
// Output address: Q43.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2820.LANGF_NACHSCHSAEURE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.1);

NETWORK
TITLE =LANGF_NEUANSSAEURE  SIGNAL VON TU AN FA.LANG
// Act 009
// Box           : S8 U8.2
// Output address: Q43.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2820.LANGF_NEUANSSAEURE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1821
TITLE =U082: Acid Tank
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1821.DBX 1357.7; 
      CC    FB  1829; // "U082Sim"
      A     DB1821.DBX   17.3; 
      =     DB1821.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1820.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1821.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1825.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1821.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1825; // U082Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// LI_S Suretank
// ----------------------------------------------------------
      L     DB1821.DBD 1118; // !!! insert correct SFM !!!
      T     DB2823.DBD  238; 

//      SET   
//      =     "U082AnID".LI_S.EAlHH

// ----------------------------------------------------------
// CS_S Suretank
// ----------------------------------------------------------
      L     DB1821.DBD 1118; // !!! insert correct SFM !!!
      T     DB2823.DBD  358; 

      SET   ; 
      =     DB2823.DBX  261.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U082UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U082UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LLL_SAEURE Suretank LS-
// ----------------------------------------------------------
      ON    DB2910.DBX  582.5; 
      ON    DB2920.DBX  582.5; 
      ON    DB2930.DBX  582.5; 
      =     DB2821.DBX   81.4; 
      CLR   ; 
      =     DB2821.DBX   81.5; 

// ----------------------------------------------------------
// LS_HL_SAEURE Suretank LS+
// ----------------------------------------------------------
      ON    DB2910.DBX  822.5; 
      ON    DB2920.DBX  822.5; 
      ON    DB2930.DBX  822.5; 
      =     DB2821.DBX  141.4; 
      SET   ; 
      =     DB2821.DBX  141.5; 

      SET   ; 
      =     DB2821.DBX  140.6; 

// ----------------------------------------------------------
// LS_LL_SAEURE Suretank LS/
// ----------------------------------------------------------
      CLR   ; 
//      =     "U082SpID".LS_LL_SAEURE.EAl
      =     DB2821.DBX  201.5; 

// ----------------------------------------------------------
// LS_LL_SAEURE_ALT 
// ----------------------------------------------------------
      SET   ; 
      =     DB2821.DBX  261.4; 
      =     DB2821.DBX  261.5; 

// ----------------------------------------------------------
// LANG_NEUANSATZ_SAEURE RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U082SpID".LANG_NEUANSATZ_SAEURE.EAl
//     =     "U082SpID".LANG_NEUANSATZ_SAEURE.Pre

// ----------------------------------------------------------
// LANG_NACHSCH_SAEURE RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U082SpID".LANG_NACHSCH_SAEURE.EAl
//      =     "U082SpID".LANG_NACHSCH_SAEURE.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2827.DBX   80.7; 
      =     DB2827.DBX   81.4; 

      CLR   ; 
      =     DB2827.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2827.DBX  140.7; 
      =     DB2827.DBX  141.4; 

      CLR   ; 
      =     DB2827.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Suretank -----------------------
      L     DB2823.DBD  146; 
      T     DB1821.DBD  386; // Level

// analog value to SFM Suretank -----------------------
      L     DB2823.DBD  266; 
      T     DB1821.DBD  642; // Conductivity
      T     DB1821.DBD  658; // Conductivity Start Pulse/Pause

// sequencer ----------------------------------------------------------------
      A     DB1823.DBX   43.1; 
      S     DB1823.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2820.DBX  105.4; 
      =     DB2820.DBX  185.4; 
      =     DB2820.DBX  345.4; 
      =     DB2820.DBX  425.4; 
      =     DB2820.DBX  585.4; 
      =     DB2820.DBX  665.4; 
      =     DB2820.DBX  745.4; 



MODE: SET   ; 

NETWORK
TITLE =RW_SAEURE Rhrwerk S1T

      AN    DB2821.DBX   78.7; 
      A     #GenRel; 
      A     DB2820.DBX  106.7; 
      =     DB2820.DBX  107.6; 
NETWORK
TITLE =SU_P1 SUP1

      A     #GenRel; 
      A     DB2820.DBX  186.7; 
      =     DB2820.DBX  187.6; 
NETWORK
TITLE =U82_Act004 spare

      A     DB2821.DBX  138.7; 

      A     #GenRel; 
      A     DB2820.DBX  346.7; 
      =     DB2820.DBX  347.6; 
NETWORK
TITLE =U82_Act005 spare

      A     DB2821.DBX  138.7; 

      A     #GenRel; 
      A     DB2820.DBX  426.7; 
      =     DB2820.DBX  427.6; 
NETWORK
TITLE =SU_K1 Sure Umpumpventil

      A     #GenRel; 
      A     DB2820.DBX  586.7; 
      =     DB2820.DBX  587.6; 
NETWORK
TITLE =LANGF_NACHSCHSAEURE SIGNAL VON TU AN FA.LANG

      A     DB2821.DBX  138.7; 

      A     #GenRel; 
      A     DB2820.DBX  666.7; 
      =     DB2820.DBX  667.6; 
NETWORK
TITLE =LANGF_NEUANSSAEURE SIGNAL VON TU AN FA.LANG

      A     DB2821.DBX  138.7; 

      A     #GenRel; 
      A     DB2820.DBX  746.7; 
      =     DB2820.DBX  747.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1830
TITLE =U083: Hot Water Tank
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1830.DBW    0; 
      T     #UnitNo; 
      L     DB1830.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_HW AnI 001 Niveau Heisswassertank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2833.LI_HW,
           ValPer                   := IW   534);

// HWT_TT01 AnI 002 Temp. HWT
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2833.HWT_TT01,
           ValPer                   := IW   536);

// HWT_PIC02 AnI 003 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2833.HWT_PIC02,
           ValPer                   := IW   542);

// U83_AnI004 AnI 004 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2833.U83_AnI004,
           ValPer                   := IW   236);

// HWT_TT02 AnI 005 Temp. nach Ausdehnungsgefaess
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2833.HWT_TT02,
           ValPer                   := IW   538);

// HWT_FT01 AnI 006 
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2833.HWT_FT01,
           ValPer                   := IW   544);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2835.unv001,
           ValExt                   := DB2835.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2835.unv002,
           ValExt                   := DB2835.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// LS_LL_HWT SpI 001 Heiwassertank LS-
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.LS_LL_HWT,
           SpIBit                   := I     93.4);

// LS_HL_HWT SpI 002 Heiwassertank LS+
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.LS_HL_HWT,
           SpIBit                   := I     93.2);

// LS_HL_HWA SpI 003 Ausdehnungsgef HWT LS+
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.LS_HL_HWA,
           SpIBit                   := I     93.3);

// SpI4 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.SpI4,
           SpIBit                   := #xTmp);

// RM_NI_HW_K1 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.RM_NI_HW_K1,
           SpIBit                   := I     68.4);

// NI_PANEEL_3_NI1 SpI 006 PANEEL3 RV.K2 - HWT
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.NI_PANEEL_3_NI1,
           SpIBit                   := I     68.0);

// S6_HWP1_HAND_EIN_LAUTO SpI 007 SCHALTER PUMPE HW.P1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2831.S6_HWP1_HAND_EIN_LAUTO,
           SpIBit                   := I     64.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2837.msg001,
           MsgBit                   := DB2837.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2837.msg002,
           MsgBit                   := DB2837.DBX  142.7);

NETWORK
TITLE =counters 

      NOP   0; 
// U83_Cnt001 Cnt 001 spare
      CALL FC    25 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2832.U83_Cnt001,
           Imp                      := DB2832.DBX   99.0);

NETWORK
TITLE =controllers 

      NOP   0; 
// HWP1_FU PID 001 FU Heisswasserpumpe
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2836.HWP1_FU,
           SpExt                    := DB2836.DBD  234,
           PVal                     := DB2836.DBD  254,
           OPer                     := PQW  532);

// RV_Kaltwasser PID 002 Kaltwasser Regelventil HWT
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2836.RV_Kaltwasser,
           SpExt                    := DB2836.DBD  414,
           PVal                     := DB2836.DBD  434,
           OPer                     := QW   524);

// U83_PID003 PID 003 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2836.U83_PID003,
           SpExt                    := DB2836.DBD  594,
           PVal                     := DB2836.DBD  614,
           OPer                     := QW   232);// S5 ?

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =HWP1  Heisswasserpumpe Ansteuerung FU
// Act 001
// Box           : LT-CIP
// Input address : I256.5
// Output address: Q256.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HWP1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    256.5);

NETWORK
TITLE =HWP1_NETZ  Heisswasserpumpe Netzschtz
// Act 002
// Box           : LT-CIP
// Output address: Q256.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HWP1_NETZ,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    256.5,
           Out                      := Q    256.6);

NETWORK
TITLE =U83_Act003  spare
// Act 003
// Box           : 
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.U83_Act003,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =U83_Act004  spare
// Act 004
// Box           : 
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.U83_Act004,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =U83_Act005  spare
// Act 005
// Box           : 
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.U83_Act005,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =HWT_V1  HWT Abnahmeventil
// Act 007
// Box           : VSRVK1..3
// Input address : I275.6
// Output address: Q275.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HWT_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.6,
           Out                      := Q    275.6);

NETWORK
TITLE =HWT_V2  
// Act 009
// Box           : VS-RRA
// Input address : I201.2
// Output address: Q201.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HWT_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.2,
           Out                      := Q    201.2);

NETWORK
TITLE =HWT_V3  
// Act 010
// Box           : VS-RRA
// Input address : I201.3
// Output address: Q201.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HWT_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.3,
           Out                      := Q    201.3);

NETWORK
TITLE =HW_WT1_V1  NEU Dampfabsperrung HW-WT1 schlieen
// Act 011
// Box           : VSHF9
// Input address : I116.7
// Output address: Q117.0
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U083ActD".HW_WT1_V1
//       Typ   :=0
//       FBa   :=#xTmp
//       FBa2  :="HW_WT1_V1GSC"
//       Out   :="HW_WT1_V1O"

NETWORK
TITLE =HWT_V4  HWT Luftventil Ausdehnungsgef
// Act 012
// Box           : VSRVK1..3
// Input address : I275.7
// Output address: Q275.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HWT_V4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.7,
           Out                      := Q    275.7);

NETWORK
TITLE =HW_WT1_V1O  NEU Dampfabsperrung HW-WT1 ffnen
// Act 013
// Box           : VSHF9
// Output address: Q116.7

      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2830.HW_WT1_V1O,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    116.7,
           Out                      := Q    117.0);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1831
TITLE =U083: Hot Water Tank
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1831.DBX 1357.7; 
      CC    FB  1839; // "U083Sim"
      A     DB1831.DBX   17.3; 
      =     DB1831.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1830.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1831.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1835.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1831.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1835; // U083Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// LI_HW Niveau Heisswassertank
// ----------------------------------------------------------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2833.DBD  238; 

//      SET   
//      =     "U083AnID".LI_HW.EAlHH

// ----------------------------------------------------------
// HWT_TT01 Temp. HWT
// ----------------------------------------------------------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2833.DBD  358; 

      SET   ; 
      =     DB2833.DBX  261.5; 

// ----------------------------------------------------------
// HWT_PIC02 
// ----------------------------------------------------------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2833.DBD  478; 

      SET   ; 
      =     DB2833.DBX  381.5; 

// ----------------------------------------------------------
// U83_AnI004 
// ----------------------------------------------------------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2833.DBD  598; 

      SET   ; 
      =     DB2833.DBX  501.5; 

// ----------------------------------------------------------
// HWT_TT02 Temp. nach Ausdehnungsgefaess
// ----------------------------------------------------------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2833.DBD  718; 

      SET   ; 
      =     DB2833.DBX  621.5; 

// ----------------------------------------------------------
// HWT_FT01 
// ----------------------------------------------------------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2833.DBD  838; 

      SET   ; 
      =     DB2833.DBX  741.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U083UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U083UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LL_HWT Heiwassertank LS-
// ----------------------------------------------------------
      ON    DB2910.DBX  502.5; 
      ON    DB2920.DBX  502.5; 
      ON    DB2930.DBX  502.5; 
      =     DB2831.DBX   81.4; 
      CLR   ; 
      =     DB2831.DBX   81.5; 

// ----------------------------------------------------------
// LS_HL_HWT Heiwassertank LS+
// ----------------------------------------------------------
      ON    DB2930.DBX  902.5; 
      ON    DB2920.DBX  902.5; 
      ON    DB2910.DBX  902.5; 
      =     DB2831.DBX  141.4; 
      SET   ; 
      =     DB2831.DBX  141.5; 

      CLR   ; 
      =     DB2831.DBX  140.6; 

// ----------------------------------------------------------
// LS_HL_HWA Ausdehnungsgef HWT LS+
// ----------------------------------------------------------
      A     DB2830.DBX  982.6; 
      O     DB2830.DBX  182.6; 
      =     DB2831.DBX  201.4; 
      SET   ; 
      =     DB2831.DBX  201.5; 

// ----------------------------------------------------------
// SpI4 spare
// ----------------------------------------------------------
//      SET   
//      =     "U083SpID".SpI4.EAl
//      =     "U083SpID".SpI4.Pre

// ----------------------------------------------------------
// RM_NI_HW_K1 
// ----------------------------------------------------------
      SET   ; 
      =     DB2831.DBX  321.4; 
      =     DB2831.DBX  321.5; 

// ----------------------------------------------------------
// NI_PANEEL_3_NI1 PANEEL3 RV.K2 - HWT
// ----------------------------------------------------------
      SET   ; 
      =     DB2831.DBX  381.4; 
      CLR   ; 
      =     DB2831.DBX  381.5; 

// ----------------------------------------------------------
// S6_HWP1_HAND_EIN_LAUTO SCHALTER PUMPE HW.P1
// ----------------------------------------------------------
//      CLR   
//      =     "U083SpID".S6_HWP1_HAND_EIN_LAUTO.EAl
//      =     "U083SpID".S6_HWP1_HAND_EIN_LAUTO.Pre

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2837.DBX   80.7; 
      =     DB2837.DBX   81.4; 

      CLR   ; 
      =     DB2837.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2837.DBX  140.7; 
      =     DB2837.DBX  141.4; 

      CLR   ; 
      =     DB2837.DBX  142.7; 

NETWORK
TITLE =Counters

      NOP   0; 

// ----------------------------------------------------------
// U83_Cnt001 spare
// ----------------------------------------------------------
//A     "U083ActD".Act.VOn // !!! insert correct Act !!!
      CLR   ; 
      =     DB2832.DBX  103.5; 

//AN    "U083ActD".Act.VOff // !!! insert correct Act !!!
//A     "U083SpID".SpI.Sig // !!! insert correct SpI !!!
      CLR   ; 
      =     DB2832.DBX   99.0; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// HWP1_FU FU Heisswasserpumpe
// ----------------------------------------------------------
// starting value -----------------------
      A     DB2830.DBX  183.4; 
      A     #GenRel; 
      =     DB2836.DBX  203.2; 
      =     DB2836.DBX  203.5; 

// enable alarm -------------------------
      A     DB2836.DBX  203.5; 
      A     DB2836.DBX  201.4; 
      AN    DB2836.DBX  203.1; 
      AN    DB2836.DBX  203.3; 
      AN    DB2836.DBX  203.4; 
      =     DB2836.DBX  203.0; 

// setpoint to controller ---------------
      L     DB1831.DBD  446; // Pressure
      T     DB2836.DBD  234; 

// static value to controller ----------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2836.DBD  238; 

// process value to controller ----------
      L     DB2833.DBD  386; 
      T     DB2836.DBD  254; 

// low/high value to controller ---------
      L     DB2833.DBD  390; // Pressure
      T     DB2836.DBD  218; 

      L     DB2833.DBD  394; // Pressure 
      T     DB2836.DBD  222; 

// ----------------------------------------------------------
// RV_Kaltwasser Kaltwasser Regelventil HWT
// ----------------------------------------------------------
// starting value -----------------------
      A     DB2830.DBX  343.4; 
      A     #GenRel; 
      =     DB2836.DBX  383.2; 
      =     DB2836.DBX  383.5; 

// enable alarm -------------------------
      A     DB2836.DBX  383.5; 
      A     DB2836.DBX  381.4; 
      AN    DB2836.DBX  383.1; 
      AN    DB2836.DBX  383.3; 
      AN    DB2836.DBX  383.4; 
      =     DB2836.DBX  383.0; 

// setpoint to controller ---------------
      L     DB1831.DBD  366; // Flow Water Inlet
      T     DB2836.DBD  414; 

// static value to controller ----------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2836.DBD  418; 

// process value to controller ----------
      L     DB2833.DBD  746; // Flow Water 
      T     DB2836.DBD  434; 

// low/high value to controller ---------
      L     DB2833.DBD  750; // Flow Water 
      T     DB2836.DBD  398; 

      L     DB2833.DBD  754; // Flow Water 
      T     DB2836.DBD  402; 

// ----------------------------------------------------------
// U83_PID003 spare
// ----------------------------------------------------------
// starting value -----------------------
      A     DB2830.DBX  263.4; 
      A     #GenRel; 
      =     DB2836.DBX  563.2; 
      =     DB2836.DBX  563.5; 

// enable alarm -------------------------
      A     DB2836.DBX  563.5; 
      A     DB2836.DBX  561.4; 
      AN    DB2836.DBX  563.1; 
      AN    DB2836.DBX  563.3; 
      AN    DB2836.DBX  563.4; 
      =     DB2836.DBX  563.0; 

// setpoint to controller ---------------
      L     DB1831.DBD  430; // Temperature Heater
      T     DB2836.DBD  594; 

// static value to controller ----------
      L     DB1831.DBD 1118; // !!! insert correct SFM !!!
      T     DB2836.DBD  598; 

// process value to controller ----------
      L     DB2833.DBD  506; // Temp. After Heater
      T     DB2836.DBD  614; 

// low/high value to controller ---------
      L     DB2833.DBD  510; // Temp. After Heater
      T     DB2836.DBD  578; 

      L     DB2833.DBD  514; // Temp. After Heater
      T     DB2836.DBD  582; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------
// analog value to SFM Niveau Heisswassertank -----------------------
      L     DB2833.DBD  146; 
      T     DB1831.DBD  386; // Level

// analog value to SFM Temp. HWT -----------------------
      L     DB2833.DBD  266; 
      T     DB1831.DBD  402; // Temperature

// analog value to SFM  -----------------------
      L     DB2833.DBD  386; 
      T     DB1831.DBD  450; // Pressure

// analog value to SFM Temp. nach Ausdehnungsgefaess -----------------------
      L     DB2833.DBD  506; 
      T     DB1831.DBD  434; // Temperature Heater

// analog value to SFM  -----------------------
      L     DB2833.DBD  746; 
      T     DB1831.DBD  370; // Flow Water Inlet

// sequencer ----------------------------------------------------------------
      A     DB1833.DBX   43.1; 
      S     DB1833.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2830.DBX  105.4; 
      =     DB2830.DBX  185.4; 
      =     DB2830.DBX  265.4; 
      =     DB2830.DBX  345.4; 
      =     DB2830.DBX  425.4; 
      =     DB2830.DBX  585.4; 
      =     DB2830.DBX  745.4; 
      =     DB2830.DBX  825.4; 
      =     DB2830.DBX  905.4; 
      =     DB2830.DBX  985.4; 
      =     DB2830.DBX 1065.4; 

// assign PID mode
      S     DB2836.DBX  201.4; 
      S     DB2836.DBX  201.5; 
      S     DB2836.DBX  381.4; 
      S     DB2836.DBX  381.5; 
      S     DB2836.DBX  561.4; 
      S     DB2836.DBX  561.5; 



MODE: SET   ; 

NETWORK
TITLE =HWP1 Heisswasserpumpe Ansteuerung FU

      A     #GenRel; 
      A     DB2830.DBX  106.7; 
      =     DB2830.DBX  107.6; 
NETWORK
TITLE =HWP1_NETZ Heisswasserpumpe Netzschtz

      AN    DB2831.DBX   78.7; 
      AN    DB2831.DBX   78.1; 

      A     DB2831.DBX  198.7; 
      AN    DB2831.DBX  198.1; 

      AN    DB2831.DBX  438.7; 
      AN    DB2831.DBX  438.1; 

      A     #GenRel; 
      A     DB2830.DBX  186.7; 
      =     DB2830.DBX  187.6; 
NETWORK
TITLE =U83_Act003 spare

      AN    DB2833.DBX  498.4; 
      AN    DB2833.DBX  498.5; 

      A     #GenRel; 
      A     DB2830.DBX  266.7; 
      =     DB2830.DBX  267.6; 

NETWORK
TITLE =U83_Act004 spare

      A     #GenRel; 
      A     DB2830.DBX  346.7; 
      =     DB2830.DBX  347.6; 

NETWORK
TITLE =U83_Act005 spare

      A     #GenRel; 
      A     DB2830.DBX  426.7; 
      =     DB2830.DBX  427.6; 

NETWORK
TITLE =HWT_V1 HWT Abnahmeventil

      A     #GenRel; 
      A     DB2830.DBX  586.7; 
      =     DB2830.DBX  587.6; 
NETWORK
TITLE =HWT_V2 

      A     #GenRel; 
      A     DB2830.DBX  746.7; 
      =     DB2830.DBX  747.6; 
NETWORK
TITLE =HWT_V3 

      A     DB2831.DBX  138.7; 
      AN    DB2831.DBX  138.1; 

      A     #GenRel; 
      A     DB2830.DBX  826.7; 
      =     DB2830.DBX  827.6; 
NETWORK
TITLE =HW_WT1_V1 NEU Dampfabsperrung HW-WT1 schlieen

      SET   ; 
      =     DB2830.DBX  907.6; 

      AN    DB2830.DBX 1068.0; 
      AN    DB2830.DBX 1068.2; 
      AN    DB2830.DBX 1065.5; 
      =     DB2830.DBX  908.2; 
NETWORK
TITLE =HWT_V4 HWT Luftventil Ausdehnungsgef

      A     #GenRel; 
      A     DB2830.DBX  986.7; 
      =     DB2830.DBX  987.6; 
NETWORK
TITLE =HW_WT1_V1O NEU Dampfabsperrung HW-WT1 ffnen

      AN    DB2833.DBX  498.4; 
      A     #GenRel; 
      A     DB2830.DBX 1066.7; 
      =     DB2830.DBX 1067.6; 


      AN    Q    117.0; 
//     =       Q    117.0  
      =     Q    116.7; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1840
TITLE =U084: Fresh Water Tank
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1840.DBW    0; 
      T     #UnitNo; 
      L     DB1840.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LI_FW AnI 001 Frischwassertank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2843.LI_FW,
           ValPer                   := IW   568);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2845.unv001,
           ValExt                   := DB2845.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2845.unv002,
           ValExt                   := DB2845.DBD  362);

NETWORK
TITLE =special inputs 


// LS_LLL_FW_ALT SpI 001 spare 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.LS_LLL_FW_ALT,
           SpIBit                   := I     42.5);

// LS_HL_FW_ALT SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.LS_HL_FW_ALT,
           SpIBit                   := I     42.3);

// LS_LL_FW_ALT SpI 003 spare 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.LS_LL_FW_ALT,
           SpIBit                   := I     42.4);

// RM_NI_FW_K1 SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.RM_NI_FW_K1,
           SpIBit                   := I     68.5);

// NI_PANEEL_3_NI2 SpI 006 PANEEL3 RV.K2 - FWT
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.NI_PANEEL_3_NI2,
           SpIBit                   := I     68.1);

// LANG_NEUANSATZ_OXONIA SpI 007 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.LANG_NEUANSATZ_OXONIA,
           SpIBit                   := I     40.2);

// LANG_NACHSCH_OXONIA SpI 008 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.LANG_NACHSCH_OXONIA,
           SpIBit                   := I     40.6);

      NOP   0; 
// LS_LLL_FW_NEU SpI 010 Frischwassertank LS-
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U084SpID".LS_LLL_FW_NEU
//       SpIBit:="LS_LLL_FW_NEU"

// LS_HL_FW_NEU SpI 011 Frischwassertank LS+
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U084SpID".LS_HL_FW_NEU
//       SpIBit:="LS_HL_FW_NEU"

// LS_LL_FW_NEU SpI 012 Frischwassertank LS/
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U084SpID".LS_LL_FW_NEU
//       SpIBit:="LS_LL_FW_NEU"



// RM_NI_FW_P1_K1 SpI 015 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2841.RM_NI_FW_P1_K1,
           SpIBit                   := I     61.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2847.msg001,
           MsgBit                   := DB2847.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2847.msg002,
           MsgBit                   := DB2847.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =FW_V4  Frischwasserbehlter Befllventil
// Act 002
// Box           : VSRVK1..3
// Input address : I273.4
// Output address: Q273.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2840.FW_V4,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.4,
           Out                      := Q    273.4);

NETWORK
TITLE =LANGF_NACHSCHOXONIA  SIGNAL VON TU AN FA.LANG
// Act 008
// Box           : S8 U8.2
// Output address: Q43.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2840.LANGF_NACHSCHOXONIA,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.2);

NETWORK
TITLE =LANGF_NEUANSOXONIA  SIGNAL VON TU AN FA.LANG
// Act 009
// Box           : S8 U8.2
// Output address: Q43.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2840.LANGF_NEUANSOXONIA,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     43.5);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1841
TITLE =U084: Fresh Water Tank
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1841.DBX 1357.7; 
      CC    FB  1849; // "U084Sim"
      A     DB1841.DBX   17.3; 
      =     DB1841.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1840.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1841.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1845.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1841.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1845; // U084Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// LI_FW Frischwassertank
// ----------------------------------------------------------
      L     DB1841.DBD 1118; // !!! insert correct SFM !!!
      T     DB2843.DBD  238; 

//      SET   
//      =     "U084AnID".LI_FW.EAlHH

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U084UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U084UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// LS_LLL_FW_NEU Frischwassertank LS-
// ----------------------------------------------------------
      A     DB2910.DBX  422.6; 
      O     DB2920.DBX  422.6; 
      O     DB2930.DBX  422.6; 
      ON    DB2841.DBX  318.7; 
      =     DB2841.DBX   81.4; 
      CLR   ; 
      =     DB2841.DBX   81.5; 

// ----------------------------------------------------------
// LS_HL_FW_NEU Frischwassertank LS+
// ----------------------------------------------------------
      AN    DB2840.DBX  182.5; 
      =     DB2841.DBX  141.4; 
      =     DB2841.DBX  141.5; 

      CLR   ; 
      =     DB2841.DBX  140.6; 

// ----------------------------------------------------------
// LS_LL_FW_NEU Frischwassertank LS/
// ----------------------------------------------------------
      CLR   ; 
//      =     "U084SpID".LS_LL_FW_NEU.EAl
      =     DB2841.DBX  201.5; 

// ----------------------------------------------------------
// RM_NI_FW_K1 
// ----------------------------------------------------------
      SET   ; 
//      =     "U084SpID".RM_NI_FW_K1.EAl
      =     DB2841.DBX  321.5; 

// ----------------------------------------------------------
// NI_PANEEL_3_NI2 PANEEL3 RV.K2 - FWT
// ----------------------------------------------------------
      SET   ; 
//      =     "U084SpID".NI_PANEEL_3_NI2.EAl
      =     DB2841.DBX  381.5; 

// ----------------------------------------------------------
// LANG_NEUANSATZ_OXONIA RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U084SpID".LANG_NEUANSATZ_OXONIA.EAl
//      =     "U084SpID".LANG_NEUANSATZ_OXONIA.Pre

// ----------------------------------------------------------
// LANG_NACHSCH_OXONIA RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U084SpID".LANG_NACHSCH_OXONIA.EAl
//      =     "U084SpID".LANG_NACHSCH_OXONIA.Pre

// ----------------------------------------------------------
// LS_LLL_FW_ALT 
// ----------------------------------------------------------
      CLR   ; 
      =     DB2841.DBX  621.4; 
      =     DB2841.DBX  621.5; 

// ----------------------------------------------------------
// LS_HL_FW_ALT 
// ----------------------------------------------------------
      CLR   ; 
      =     DB2841.DBX  681.4; 
      =     DB2841.DBX  681.5; 

// ----------------------------------------------------------
// LS_LL_FW_ALT 
// ----------------------------------------------------------
      CLR   ; 
      =     DB2841.DBX  741.4; 
      =     DB2841.DBX  741.5; 

// ----------------------------------------------------------
// RM_NI_FW_P1_K1 
// ----------------------------------------------------------
      CLR   ; 
//      =     "U084SpID".RM_NI_FW_P1_K1.EAl
      =     DB2841.DBX  921.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2847.DBX   80.7; 
      =     DB2847.DBX   81.4; 

      CLR   ; 
      =     DB2847.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2847.DBX  140.7; 
      =     DB2847.DBX  141.4; 

      CLR   ; 
      =     DB2847.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Frischwassertank -----------------------
      L     DB2843.DBD  146; 
      T     DB1841.DBD  386; // Level

// sequencer ----------------------------------------------------------------
      A     DB1843.DBX   43.1; 
      S     DB1843.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2840.DBX  185.4; 
      =     DB2840.DBX  665.4; 
      =     DB2840.DBX  745.4; 



MODE: SET   ; 

NETWORK
TITLE =FW_V4 Frischwasserbehlter Befllventil

      A     DB2841.DBX  138.7; 

      A     #GenRel; 
      A     DB2840.DBX  186.7; 
      =     DB2840.DBX  187.6; 
NETWORK
TITLE =LANGF_NACHSCHOXONIA SIGNAL VON TU AN FA.LANG

      AN    DB2841.DBX  138.1; 

      A     #GenRel; 
      A     DB2840.DBX  666.7; 
      =     DB2840.DBX  667.6; 
NETWORK
TITLE =LANGF_NEUANSOXONIA SIGNAL VON TU AN FA.LANG

      A     DB2841.DBX  138.7; 

      A     #GenRel; 
      A     DB2840.DBX  746.7; 
      =     DB2840.DBX  747.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1910
TITLE =U091: CIP Line 1
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1910.DBW    0; 
      T     #UnitNo; 
      L     DB1910.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// RV1T1 AnI 001 Regler 2 RV 1 Temperatur 1
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2913.RV1T1,
           ValPer                   := IW   224);

// TI_RR1 AnI 002 Temperatur CIP Rcklauf 1
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2913.TI_RR1,
           ValPer                   := IW   134);

// CS_RR1 AnI 003 Messbereich ist umschaltber
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2913.CS_RR1,
           ValPer                   := IW   140);

// FIT_RV1 AnI 004 Flow CIP Kreislauf 1
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2913.FIT_RV1,
           ValPer                   := IW   128);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2915.unv001,
           ValExt                   := DB2915.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2915.unv002,
           ValExt                   := DB2915.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// FS_RR1_NEU SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2911.FS_RR1_NEU,
           SpIBit                   := I     94.0);

// IDM_IMPULSE_RV_1FQS SpI 002 DURCHFLUSSMESSUNG KREISLAUF 1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2911.IDM_IMPULSE_RV_1FQS,
           SpIBit                   := I      0.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2917.msg001,
           MsgBit                   := DB2917.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2917.msg002,
           MsgBit                   := DB2917.DBX  142.7);

NETWORK
TITLE =counters 

      NOP   0; 
// IDM_IMPULSE_RV_1FQI Cnt 002 DURCHFLUSSMESSUNG KREISLAUF 1 (U91)
      CALL FC    25 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2912.IDM_IMPULSE_RV_1FQI,
           Imp                      := DB2912.DBX  179.0);

NETWORK
TITLE =controllers 

      NOP   0; 
// RV1RV PID 001 CIP 1
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2916.RV1RV,
           SpExt                    := DB2916.DBD  234,
           PVal                     := DB2916.DBD  254,
           OPer                     := QW   224);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RV_P1  Reinigungsvorlaufpumpe Kreis 1
// Act 001
// Box           : LT-CIP
// Input address : I256.0
// Output address: Q256.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.RV_P1,
           Typ                      := 3,
           FBa                      := I    256.0,
           FBa2                     := #xTmp,
           Out                      := Q    256.0);

NETWORK
TITLE =RV1_RV  Regelventil CIP 1
// Act 004
// Box           : 
// Output address: #DummyBool
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.RV1_RV,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     14.1);

NETWORK
TITLE =FW_V1  Frischwasservorlaufventil Kreis 1
// Act 005
// Box           : VSRVK1..3
// Input address : I273.1
// Output address: Q273.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.FW_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.1,
           Out                      := Q    273.1);

NETWORK
TITLE =HW_V1  Heisswasservorlaufventil Kreis 1
// Act 006
// Box           : VSRVK1..3
// Input address : I274.6
// Output address: Q274.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.HW_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.6,
           Out                      := Q    274.6);

NETWORK
TITLE =SV_V1  Surevorlaufventil Kreis 1
// Act 007
// Box           : VSRVK1..3
// Input address : I272.6
// Output address: Q272.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.SV_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.6,
           Out                      := Q    272.6);

NETWORK
TITLE =LV_V1  Laugevorlaufventil Kreis 1
// Act 008
// Box           : VSRVK1..3
// Input address : I272.3
// Output address: Q272.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.LV_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.3,
           Out                      := Q    272.3);

NETWORK
TITLE =LR_V1  Laugercklaufventil Kreis 1
// Act 009
// Box           : VSRVK1..3
// Input address : I273.5
// Output address: Q273.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.LR_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.5,
           Out                      := Q    273.5);

NETWORK
TITLE =SR_V1  Surercklaufventil Kreis 1
// Act 010
// Box           : VSRVK1..3
// Input address : I274.0
// Output address: Q274.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.SR_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.0,
           Out                      := Q    274.0);

NETWORK
TITLE =HWR_V1  Heisswasserrcklaufventil Kreis 1
// Act 011
// Box           : VSRVK1..3
// Input address : I275.1
// Output address: Q275.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.HWR_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.1,
           Out                      := Q    275.1);

NETWORK
TITLE =GR_V1  Gullyventil Kreis 1
// Act 012
// Box           : VSRVK1..3
// Input address : I274.3
// Output address: Q274.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.GR_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.3,
           Out                      := Q    274.3);

NETWORK
TITLE =KV_V1  Kreislaufventil Kreis 1
// Act 032
// Box           : VSRVK1..3
// Input address : I272.0
// Output address: Q272.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.KV_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.0,
           Out                      := Q    272.0);

NETWORK
TITLE =CSRR1_MBU_A  Leitwertsonde Rcklauf Kontakt A (Lauge)
// Act 033
// Box           : S6 U6.3
// Output address: Q13.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.CSRR1_MBU_A,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     13.0);

NETWORK
TITLE =CSRR1_MBU_B  Leitwertsonde Rcklauf Kontakt B (Saure)
// Act 034
// Box           : S6 U6.3
// Output address: Q13.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2910.CSRR1_MBU_B,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     13.1);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1911
TITLE =U091: CIP Line 1
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1911.DBX 1357.7; 
      CC    FB  1919; // "U091Sim"
      A     DB1911.DBX   17.3; 
      =     DB1911.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1910.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1911.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1915.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1911.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1915; // U091Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// counter value to SFM DURCHFLUSSMESSUNG KREISLAUF 1 (U91) ----------------------
      CALL FC    44 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2912.IDM_IMPULSE_RV_1FQI,
           Enable                   := M     97.1,
           SFMRec                   := DB1911.Seq.SFM[14]);// Amount

// sequencer ----------------------------------------------------------------
      A     DB1913.DBX   43.1; 
      S     DB1913.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1920
TITLE =U092: CIP Line 2
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1920.DBW    0; 
      T     #UnitNo; 
      L     DB1920.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// RV2T1 AnI 001 Temperatur CIP Vorlauf 2
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2923.RV2T1,
           ValPer                   := IW   226);

// TI_RR2 AnI 002 Temperatur CIP Rcklauf 2
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2923.TI_RR2,
           ValPer                   := IW   136);

// CS_RR2 AnI 003 Leitwert CIP Rcklauf 2
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2923.CS_RR2,
           ValPer                   := IW   142);

// FIT_RV2 AnI 004 Flow CIP Kreislauf 2
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2923.FIT_RV2,
           ValPer                   := IW   130);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2925.unv001,
           ValExt                   := DB2925.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2925.unv002,
           ValExt                   := DB2925.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// FS_RR2_NEU SpI 001 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2921.FS_RR2_NEU,
           SpIBit                   := I     94.1);

// IDM_IMPULSE_RV_2FQS SpI 002 DURCHFLUSSMESSUNG KREISLAUF 2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2921.IDM_IMPULSE_RV_2FQS,
           SpIBit                   := I      0.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2927.msg001,
           MsgBit                   := DB2927.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2927.msg002,
           MsgBit                   := DB2927.DBX  142.7);

NETWORK
TITLE =counters 

      NOP   0; 
// IDM_IMPULSE_RV_2FQI Cnt 002 DURCHFLUSSMESSUNG KREISLAUF 2 (U92)
      CALL FC    25 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2922.IDM_IMPULSE_RV_2FQI,
           Imp                      := DB2922.DBX  179.0);

NETWORK
TITLE =controllers 

      NOP   0; 
// RV2RV PID 001 CIP 2
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2926.RV2RV,
           SpExt                    := DB2926.DBD  234,
           PVal                     := DB2926.DBD  254,
           OPer                     := QW   226);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RV_P2  Reinigungsvorlaufpumpe Kreis 2
// Act 001
// Box           : LT-CIP
// Input address : I256.1
// Output address: Q256.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.RV_P2,
           Typ                      := 3,
           FBa                      := I    256.1,
           FBa2                     := #xTmp,
           Out                      := Q    256.1);

NETWORK
TITLE =RV2_RV  Regelventil CIP2
// Act 004
// Box           : 
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.RV2_RV,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     14.2);

NETWORK
TITLE =FW_V2  Frischwasservorlaufventil Kreis 2
// Act 005
// Box           : VSRVK1..3
// Input address : I273.2
// Output address: Q273.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.FW_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.2,
           Out                      := Q    273.2);

NETWORK
TITLE =HW_V2  Heisswasservorlaufventil Kreis 2
// Act 006
// Box           : VSRVK1..3
// Input address : I274.7
// Output address: Q274.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.HW_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.7,
           Out                      := Q    274.7);

NETWORK
TITLE =SV_V2  Surevorlaufventil Kreis 2
// Act 007
// Box           : VSRVK1..3
// Input address : I272.7
// Output address: Q272.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.SV_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.7,
           Out                      := Q    272.7);

NETWORK
TITLE =LV_V2  Laugevorlaufventil Kreis 2
// Act 008
// Box           : VSRVK1..3
// Input address : I272.4
// Output address: Q272.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.LV_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.4,
           Out                      := Q    272.4);

NETWORK
TITLE =LR_V2  Laugercklaufventil Kreis 2
// Act 009
// Box           : VSRVK1..3
// Input address : I273.6
// Output address: Q273.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.LR_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.6,
           Out                      := Q    273.6);

NETWORK
TITLE =SR_V2  Surercklaufventil Kreis 2
// Act 010
// Box           : VSRVK1..3
// Input address : I274.1
// Output address: Q274.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.SR_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.1,
           Out                      := Q    274.1);

NETWORK
TITLE =HWR_V2  Heisswasserrcklaufventil Kreis 2
// Act 011
// Box           : VSRVK1..3
// Input address : I275.2
// Output address: Q275.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.HWR_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.2,
           Out                      := Q    275.2);

NETWORK
TITLE =GR_V2  Gullyventil Kreis 2
// Act 012
// Box           : VSRVK1..3
// Input address : I274.4
// Output address: Q274.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.GR_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.4,
           Out                      := Q    274.4);

NETWORK
TITLE =KV_V2  Kreislaufventil Kreis 2
// Act 032
// Box           : VSRVK1..3
// Input address : I272.1
// Output address: Q272.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.KV_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.1,
           Out                      := Q    272.1);

NETWORK
TITLE =CSRR2_MBU_A  Leitwertsonde Rcklauf2 Kontakt A (Lauge)
// Act 033
// Box           : S6 U6.3
// Output address: Q13.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.CSRR2_MBU_A,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     13.2);

NETWORK
TITLE =CSRR2_MBU_B  Leitwertsonde Rcklauf2 Kontakt B (Saure)
// Act 034
// Box           : S6 U6.3
// Output address: Q13.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2920.CSRR2_MBU_B,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     13.3);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1921
TITLE =U092: CIP Line 2
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1921.DBX 1357.7; 
      CC    FB  1929; // "U092Sim"
      A     DB1921.DBX   17.3; 
      =     DB1921.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1920.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1921.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1925.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1921.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1925; // U092Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// counter value to SFM DURCHFLUSSMESSUNG KREISLAUF 2 (U92) ----------------------
      CALL FC    44 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2922.IDM_IMPULSE_RV_2FQI,
           Enable                   := M     97.1,
           SFMRec                   := DB1921.Seq.SFM[14]);// Amount

// sequencer ----------------------------------------------------------------
      A     DB1923.DBX   43.1; 
      S     DB1923.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1930
TITLE =U093: CIP Line 3
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1930.DBW    0; 
      T     #UnitNo; 
      L     DB1930.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// RV3T1 AnI 001 Temperatur CIP Vorlauf 3
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2933.RV3T1,
           ValPer                   := IW   228);

// TI_RR3 AnI 002 Temperatur CIP Rcklauf 3
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2933.TI_RR3,
           ValPer                   := IW   138);

// CS_RR3 AnI 003 Leitwert CIP Rcklauf 3
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2933.CS_RR3,
           ValPer                   := IW   144);

// FIT_RV3 AnI 004 Flow CIP Kreislauf 3
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2933.FIT_RV3,
           ValPer                   := IW   132);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2935.unv001,
           ValExt                   := DB2935.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2935.unv002,
           ValExt                   := DB2935.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// FS_RR3_ALT SpI 001 FS Reinigungsrcklauf
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2931.FS_RR3_ALT,
           SpIBit                   := I      7.5);

// IDM_IMPULSE_RV_3FQS SpI 002 DURCHFLUSSMESSUNG KREISLAUF 3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2931.IDM_IMPULSE_RV_3FQS,
           SpIBit                   := I      0.2);

// FS_RR3_NEU SpI 003 
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U093SpID".FS_RR3_NEU
//       SpIBit:="FS_RR3_NEU"


NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2937.msg001,
           MsgBit                   := DB2937.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2937.msg002,
           MsgBit                   := DB2937.DBX  142.7);

NETWORK
TITLE =counters 

      NOP   0; 
// IDM_IMPULSE_RV_3FQI Cnt 002 DURCHFLUSSMESSUNG KREISLAUF 3 (U93)
      CALL FC    25 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2932.IDM_IMPULSE_RV_3FQI,
           Imp                      := DB2932.DBX  179.0);

NETWORK
TITLE =controllers 

      NOP   0; 
// RV3RV PID 001 CIP 3
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB2936.RV3RV,
           SpExt                    := DB2936.DBD  234,
           PVal                     := DB2936.DBD  254,
           OPer                     := QW   228);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RV_P3  RVP3 Reinigungsvorlaufpumpe Kreis 3
// Act 001
// Box           : S6 U6.3
// Input address : I5.7
// Output address: Q5.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.RV_P3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      5.7,
           Out                      := Q      5.7);

NETWORK
TITLE =RV3_RV  Regelventil CIP3 
// Act 004
// Box           : ?
// Input address : #xTmp
// Output address: #xTmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.RV3_RV,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     14.3);

NETWORK
TITLE =FW_V3  Frischwasservorlaufventil Kreis 3
// Act 005
// Box           : VSRVK1..3
// Input address : I273.3
// Output address: Q273.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.FW_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.3,
           Out                      := Q    273.3);

NETWORK
TITLE =HW_V3  Heisswasservorlaufventil Kreis 3
// Act 006
// Box           : VSRVK1..3
// Input address : I275.0
// Output address: Q275.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.HW_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.0,
           Out                      := Q    275.0);

NETWORK
TITLE =SV_V3  Surevorlaufventil Kreis 3
// Act 007
// Box           : VSRVK1..3
// Input address : I273.0
// Output address: Q273.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.SV_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.0,
           Out                      := Q    273.0);

NETWORK
TITLE =LV_V3  Laugevorlaufventil Kreis 3
// Act 008
// Box           : VSRVK1..3
// Input address : I272.5
// Output address: Q272.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.LV_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.5,
           Out                      := Q    272.5);

NETWORK
TITLE =LR_V3  Laugercklaufventil Kreis 3
// Act 009
// Box           : VSRVK1..3
// Input address : I273.7
// Output address: Q273.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.LR_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    273.7,
           Out                      := Q    273.7);

NETWORK
TITLE =SR_V3  Surercklaufventil Kreis 3
// Act 010
// Box           : VSRVK1..3
// Input address : I274.2
// Output address: Q274.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.SR_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.2,
           Out                      := Q    274.2);

NETWORK
TITLE =HWR_V3  Heisswasserrcklaufventil Kreis 3
// Act 011
// Box           : VSRVK1..3
// Input address : I275.3
// Output address: Q275.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.HWR_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    275.3,
           Out                      := Q    275.3);

NETWORK
TITLE =GR_V3  Gullyventil Kreis 3
// Act 012
// Box           : VSRVK1..3
// Input address : I274.5
// Output address: Q274.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.GR_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    274.5,
           Out                      := Q    274.5);

NETWORK
TITLE =KV_V3  Kreislaufventil Kreis 3
// Act 032
// Box           : VSRVK1..3
// Input address : I272.2
// Output address: Q272.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.KV_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    272.2,
           Out                      := Q    272.2);

NETWORK
TITLE =CSRR3_MBU_A  Leitwertsonde Rcklauf3 Kontakt A (Lauge)
// Act 033
// Box           : S6 U6.3
// Output address: Q13.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.CSRR3_MBU_A,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     13.4);

NETWORK
TITLE =CSRR3_MBU_B  Leitwertsonde Rcklauf3 Kontakt B (Saure)
// Act 034
// Box           : S6 U6.3
// Output address: Q13.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2930.CSRR3_MBU_B,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     13.5);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1931
TITLE =U093: CIP Line 3
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General



      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1931.DBX 1357.7; 
      CC    FB  1939; // "U093Sim"
      A     DB1931.DBX   17.3; 
      =     DB1931.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1930.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1931.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1935.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1931.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1935; // U093Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// counter value to SFM DURCHFLUSSMESSUNG KREISLAUF 3 (U93) ----------------------
      CALL FC    44 (
           UnitNo                   := #UnitNo,
           CntRec                   := DB2932.IDM_IMPULSE_RV_3FQI,
           Enable                   := M     97.1,
           SFMRec                   := DB1931.Seq.SFM[14]);// Amount

// sequencer ----------------------------------------------------------------
      A     DB1933.DBX   43.1; 
      S     DB1933.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1940
TITLE =U094: CIP 1 Distribution
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1940.DBW    0; 
      T     #UnitNo; 
      L     DB1940.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2945.unv001,
           ValExt                   := DB2945.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2945.unv002,
           ValExt                   := DB2945.DBD  362);

// RK1_KreisNr UnV 003 Circuit Number
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2945.RK1_KreisNr,
           ValExt                   := DB2945.DBD  490);

// RK1_Medium UnV 004 0=NIX 1=Wasser 2=Heiwasser 3=Lauge 4=Sure 5=Desi
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2945.RK1_Medium,
           ValExt                   := DB2945.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// RK1_I_Bereit SpI 001 Das Reinigungs Programm ist gestartet und luft "1"= Luft  "0"=AUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2941.RK1_I_Bereit,
           SpIBit                   := DB304.DBX   10.0);

// RK1_I_VL_Ein SpI 002 Medium wird angefordert (Reinigungs Vorlauf EIN) "1"=VorlaufPumpe an "0"AUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2941.RK1_I_VL_Ein,
           SpIBit                   := DB304.DBX   10.1);

// RK1_I_RL_Ein SpI 003 Medium wird zurckgepumpt "1" RcklaufPumpe an "0"=AUS 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2941.RK1_I_RL_Ein,
           SpIBit                   := DB304.DBX   10.2);

// RK1_I_Leer SpI 004 Der zu Reinigende Anlagenteil ist leer."1"=leer "0"=nicht leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2941.RK1_I_Leer,
           SpIBit                   := DB304.DBX   10.3);

// RK1_I_Stop SpI 005 Stop interner Fehler Pumpen anhalten Reinigungszeit anhalten "1" STOP  "0"= OK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2941.RK1_I_Stop,
           SpIBit                   := DB304.DBX   10.4);

// RK1_I_SK_RM SpI 006 Bypassventil ist angesteuert und offen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2941.RK1_I_SK_RM,
           SpIBit                   := DB304.DBX   10.7);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2947.msg001,
           MsgBit                   := DB2947.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2947.msg002,
           MsgBit                   := DB2947.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RR_P1  RRP1 Reinigungsrcklaufpumpe Kreis 1
// Act 001
// Box           : S6 U6.3
// Input address : I6.6
// Output address: Q6.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RR_P1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I      6.6,
           Out                      := Q      6.6);

NETWORK
TITLE =U94_Act004  spare
// Act 004
// Box           : 
// Output address: #DummyBool
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.U94_Act004,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #DummyBool);

NETWORK
TITLE =KZE5_Ventil_zum_SR_auf  KZE5 Ventil zum Sirupraum ffnen V720085
// Act 005
// Box           : KZE5
// Input address: I347.0
// Output address: Q346.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.KZE5_Ventil_zum_SR_auf,
           Typ                      := 3,
           FBa                      := I    347.0,
           FBa2                     := #xTmp,
           Out                      := Q    346.0);

NETWORK
TITLE =RR1_V2  
// Act 006
// Box           : VSRVK1..3
// Input address : I82.3
// Output address: Q82.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RR1_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     82.3,
           Out                      := Q     82.3);

NETWORK
TITLE =RR1_V3  Ventil CIP 1 -> KF
// Act 007
// Box           : VSRR1-3
// Input address : I85.7
// Output address: Q85.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RR1_V3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     85.7,
           Out                      := Q     85.7);

NETWORK
TITLE =RV1_SK  
// Act 008
// Box           : VSRVK1..3
// Input address : I82.0
// Output address: Q82.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RV1_SK,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     82.0,
           Out                      := Q     82.0);

NETWORK
TITLE =FW_RK1  
// Act 009
// Box           : Ventilinsel 4
// Input address : I335.7
// Output address: Q335.7
//      CALL  "Act"
//       UnitNo:=#UnitNo
//       ActRec:="U094ActD".U094_Act009
//       Typ   :=0
//       FBa   :=#xTmp
//       FBa2  :="FW_RK1GSC"
//       Out   :="FW_RK1O"

NETWORK
TITLE =RK1_Bereit  Die CIP Station hat gestatet "0"=AUS "1"=gestartet
// Act 010
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK1.Bereit
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RK1_Bereit,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   10.0);

NETWORK
TITLE =RK1_Stop  Stop Pumpen anhalten "0"Ok" 1"=Stop 
// Act 011
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK1.Stop
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RK1_Stop,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   10.1);

NETWORK
TITLE =RK1_MED  Medienwechsel der CIP
// Act 012
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK1.MED
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RK1_MED,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   10.2);

NETWORK
TITLE =RK1_ENDE  Ende der Reinigung
// Act 013
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK1.ENDE
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RK1_ENDE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   10.3);

NETWORK
TITLE =RK1_Bypass  CIP Bypass
// Act 014
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK1.Bypass
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RK1_Bypass,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   10.4);

NETWORK
TITLE =SR1_RR1  SR1 RR1 CIP Rcklaufventil RR1SR1
// Act 015
// Box           : VS-RRA
// Input address : I200.6
// Output address: Q200.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.SR1_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    200.6,
           Out                      := Q    200.6);

NETWORK
TITLE =SR2_RR1  SR2 RR1 CIP Rcklaufventil RR1SR2
// Act 016
// Box           : VS-RRA
// Input address : I201.0
// Output address: Q201.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.SR2_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.0,
           Out                      := Q    201.0);

NETWORK
TITLE =RV1_T  
// Act 017
// Box           : Ventilinsel 4
// Input address : I335.6
// Output address: Q335.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RV1_T,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.6,
           Out                      := Q    335.6);

NETWORK
TITLE =RV1_RR1  
// Act 018
// Box           : Ventilinsel 4
// Input address : I335.5
// Output address: Q335.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RV1_RR1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    335.5,
           Out                      := Q    335.5);

NETWORK
TITLE =RV1_RS  Ventil zum Gully beim splen vom Tank
// Act 019
// Box           : Ventilinsel 4
// Input address : I337.2
// Output address: Q337.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2940.RV1_RS,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    337.2,
           Out                      := Q    337.2);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1941
TITLE =U094: CIP 1 Distribution
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1941.DBX 1357.7; 
      CC    FB  1949; // "U094Sim"
      A     DB1941.DBX   17.3; 
      =     DB1941.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1940.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1941.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1945.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1941.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1945; // U094Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U094UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U094UnVD".unv002.ValExt

// ----------------------------------------------------------
// RK1_KreisNr Circuit Number
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U094UnVD".RK1_KreisNr.ValExt

// ----------------------------------------------------------
// RK1_Medium 0=NIX 1=Wasser 2=Heiwasser 3=Lauge 4=Sure 5=Desi
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U094UnVD".RK1_Medium.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// RK1_I_Bereit Das Reinigungs Programm ist gestartet und luft "1"= Luft  "0"=AUS
// ----------------------------------------------------------
      CLR   ; 
      =     DB2941.DBX   81.4; 
      =     DB2941.DBX   81.5; 

// ----------------------------------------------------------
// RK1_I_VL_Ein Medium wird angefordert (Reinigungs Vorlauf EIN) "1"=VorlaufPumpe an "0"AUS
// ----------------------------------------------------------
      CLR   ; 
      =     DB2941.DBX  141.4; 
      =     DB2941.DBX  141.5; 

// ----------------------------------------------------------
// RK1_I_RL_Ein Medium wird zurckgepumpt "1" RcklaufPumpe an "0"=AUS 
// ----------------------------------------------------------
      CLR   ; 
      =     DB2941.DBX  201.4; 
      =     DB2941.DBX  201.5; 

// ----------------------------------------------------------
// RK1_I_Leer Der zu Reinigende Anlagenteil ist leer."1"=leer "0"=nicht leer
// ----------------------------------------------------------
      CLR   ; 
      =     DB2941.DBX  261.4; 
      =     DB2941.DBX  261.5; 

// ----------------------------------------------------------
// RK1_I_Stop Stop interner Fehler Pumpen anhalten Reinigungszeit anhalten "1" STOP  "0"= OK
// ----------------------------------------------------------
      CLR   ; 
      =     DB2941.DBX  321.4; 
      =     DB2941.DBX  321.5; 

// ----------------------------------------------------------
// RK1_I_SK_RM Bypassventil ist angesteuert und offen
// ----------------------------------------------------------
      CLR   ; 
      =     DB2941.DBX  381.4; 
      =     DB2941.DBX  381.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2947.DBX   80.7; 
      =     DB2947.DBX   81.4; 

      CLR   ; 
      =     DB2947.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2947.DBX  140.7; 
      =     DB2947.DBX  141.4; 

      CLR   ; 
      =     DB2947.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// CIP Counter
      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1945.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1941.Seq.SFM[15],
           ValueOld                 := DB1941.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1943.DBX   43.1; 
      S     DB1943.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2940.DBX  105.4; 
      =     DB2940.DBX  265.4; 
      =     DB2940.DBX  345.4; 
      =     DB2940.DBX  425.4; 
      =     DB2940.DBX  505.4; 
      =     DB2940.DBX  585.4; 
      =     DB2940.DBX  665.4; 
      =     DB2940.DBX  745.4; 
      =     DB2940.DBX  825.4; 
      =     DB2940.DBX  905.4; 
      =     DB2940.DBX  985.4; 
      =     DB2940.DBX 1065.4; 
      =     DB2940.DBX 1145.4; 
      =     DB2940.DBX 1225.4; 
      =     DB2940.DBX 1305.4; 
      =     DB2940.DBX 1385.4; 
      =     DB2940.DBX 1465.4; 
      =     DB2940.DBX 1545.4; 



MODE: SET   ; 

NETWORK
TITLE =RR_P1 RRP1 Reinigungsrcklaufpumpe Kreis 1

      A     #GenRel; 
      A     DB2940.DBX  106.7; 
      =     DB2940.DBX  107.6; 
NETWORK
TITLE =K1_SK_CIP_BYPASSST SIGNAL AN SIRUP-KUECHE

      A     #GenRel; 
      A     DB2940.DBX  266.7; 
      =     DB2940.DBX  267.6; 
NETWORK
TITLE =U94_Act004 spare

      A     #GenRel; 
      A     DB2940.DBX  346.7; 
      =     DB2940.DBX  347.6; 
NETWORK
TITLE =KZE5_Ventil_zum_SR_auf KZE5 Ventil zum Sirupraum ffnen V720085

      A     #GenRel; 
      A     DB2940.DBX  426.7; 
      =     DB2940.DBX  427.6; 
NETWORK
TITLE =RR1_V2 

      A     #GenRel; 
      A     DB2940.DBX  506.7; 
      =     DB2940.DBX  507.6; 
NETWORK
TITLE =RR1_V3 Ventil CIP 1 -> KF

      A     #GenRel; 
      A     DB2940.DBX  586.7; 
      =     DB2940.DBX  587.6; 
NETWORK
TITLE =RV1_SK 

      A     #GenRel; 
      A     DB2940.DBX  666.7; 
      =     DB2940.DBX  667.6; 
NETWORK
TITLE =FW_RK1 

      A     #GenRel; 
      A     DB2940.DBX  746.7; 
      =     DB2940.DBX  747.6; 
NETWORK
TITLE =RK1_Bereit Die CIP Station hat gestatet "0"=AUS "1"=gestartet

      A     #GenRel; 
      A     DB2940.DBX  826.7; 
      =     DB2940.DBX  827.6; 
NETWORK
TITLE =RK1_Stop Stop Pumpen anhalten "0"Ok" 1"=Stop 

      A     #GenRel; 
      A     DB2940.DBX  906.7; 
      =     DB2940.DBX  907.6; 
NETWORK
TITLE =RK1_MED Medienwechsel der CIP

      A     #GenRel; 
      A     DB2940.DBX  986.7; 
      =     DB2940.DBX  987.6; 
NETWORK
TITLE =RK1_ENDE Ende der Reinigung

      A     #GenRel; 
      A     DB2940.DBX 1066.7; 
      =     DB2940.DBX 1067.6; 
NETWORK
TITLE =RK1_Bypass CIP Bypass

      A     #GenRel; 
      A     DB2940.DBX 1146.7; 
      =     DB2940.DBX 1147.6; 
NETWORK
TITLE =SR1_RR1 SR1 RR1 CIP Rcklaufventil RR1SR1

      A     #GenRel; 
      A     DB2940.DBX 1226.7; 
      =     DB2940.DBX 1227.6; 
NETWORK
TITLE =SR2_RR1 SR2 RR1 CIP Rcklaufventil RR1SR2

      A     #GenRel; 
      A     DB2940.DBX 1306.7; 
      =     DB2940.DBX 1307.6; 
NETWORK
TITLE =RV1_T 

      A     #GenRel; 
      A     DB2940.DBX 1386.7; 
      =     DB2940.DBX 1387.6; 
NETWORK
TITLE =RV1_RR1 

      A     #GenRel; 
      A     DB2940.DBX 1466.7; 
      =     DB2940.DBX 1467.6; 
NETWORK
TITLE =RV1_RS Ventil zum Gully beim splen vom Tank

      A     #GenRel; 
      A     DB2940.DBX 1546.7; 
      =     DB2940.DBX 1547.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1950
TITLE =U095: CIP 2 Distribution
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1950.DBW    0; 
      T     #UnitNo; 
      L     DB1950.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2955.unv001,
           ValExt                   := DB2955.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2955.unv002,
           ValExt                   := DB2955.DBD  362);

// RK2_KreisNr UnV 003 Circuit Number
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2955.RK2_KreisNr,
           ValExt                   := DB2955.DBD  490);

// RK2_Medium UnV 004 0=NIX 1=Wasser 2=Heiwasser 3=Lauge 4=Sure 5=Desi
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2955.RK2_Medium,
           ValExt                   := DB2955.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_RR2 SpI 001 GOA_RR2 Schwenkbogen Befllblock nach RR2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2951.GOA_RR2,
           SpIBit                   := I    312.0);

// RM_NI_RR2K1 SpI 002 Handklappe im Rcklauf CIP 2 hinter Befllblock
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2951.RM_NI_RR2K1,
           SpIBit                   := I    312.2);

// GOA_RV2K1 SpI 003 RV2K1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2951.GOA_RV2K1,
           SpIBit                   := I    276.0);

// GOA_RV2K2 SpI 004 RV2K2 zur KEG Anlage
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2951.GOA_RV2K2,
           SpIBit                   := I    276.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2957.msg001,
           MsgBit                   := DB2957.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2957.msg002,
           MsgBit                   := DB2957.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =FW_RK1  
// Act 003
// Box           : Ventilinsel 4
// Input address : I335.7
// Output address: Q335.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2950.FW_RK1,
           Typ                      := 23,
           FBa                      := I    335.7,
           FBa2                     := #xTmp,
           Out                      := Q    335.7);

NETWORK
TITLE =RV2_RW  
// Act 004
// Box           : VSRVK1..3
// Input address : I82.1
// Output address: Q82.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2950.RV2_RW,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     82.1,
           Out                      := Q     82.1);

NETWORK
TITLE =RV2V1  KEG/A14 KZE
// Act 006
// Box           : VS2-BB
// Output address: Q311.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2950.RV2V1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    311.1);

NETWORK
TITLE =RV2_RS  Ventil zum Gully beim splen vom Tank
// Act 007
// Box           : Ventilinsel 4
// Input address : I337.3
// Output address: Q337.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2950.RV2_RS,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    337.3,
           Out                      := Q    337.3);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1951
TITLE =U095: CIP 2 Distribution
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1951.DBX 1357.7; 
      CC    FB  1959; // "U095Sim"
      A     DB1951.DBX   17.3; 
      =     DB1951.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1950.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1951.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1955.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1951.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1955; // U095Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U095UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U095UnVD".unv002.ValExt

// ----------------------------------------------------------
// RK2_KreisNr Circuit Number
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U095UnVD".RK2_KreisNr.ValExt

// ----------------------------------------------------------
// RK2_Medium 0=NIX 1=Wasser 2=Heiwasser 3=Lauge 4=Sure 5=Desi
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U095UnVD".RK2_Medium.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// GOA_RR2 GOA_RR2 Schwenkbogen Befllblock nach RR2
// ----------------------------------------------------------
//      SET   
//      =     "U095SpID".GOA_RR2.EAl
//      =     "U095SpID".GOA_RR2.Pre

// ----------------------------------------------------------
// RM_NI_RR2K1 Handklappe im Rcklauf CIP 2 hinter Befllblock
// ----------------------------------------------------------
      SET   ; 
      =     DB2951.DBX  141.4; 
      =     DB2951.DBX  141.5; 

// ----------------------------------------------------------
// GOA_RV2K1 RV2K1
// ----------------------------------------------------------
      SET   ; 
      =     DB2951.DBX  201.4; 
      =     DB2951.DBX  201.5; 

// ----------------------------------------------------------
// GOA_RV2K2 RV2K2 zur KEG Anlage
// ----------------------------------------------------------
      SET   ; 
      =     DB2951.DBX  261.4; 
      =     DB2951.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2957.DBX   80.7; 
      =     DB2957.DBX   81.4; 

      CLR   ; 
      =     DB2957.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2957.DBX  140.7; 
      =     DB2957.DBX  141.4; 

      CLR   ; 
      =     DB2957.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// CIP Counter
//      CALL  "V2S"
//       UnitNo      :=#UnitNo
//       Value       :="U095ComD".Own.Real07
//       Enable      :=TRUE
//       Down        :=FALSE
//       OriginDetect:=0.000000e+000
//       MaxDiffPS   :=1.000000e+000
//       SFMRec      :="U095SeqD".Seq.SFM[15]
//       ValueOld    :="U095SeqD".Seq.User.Real15     

// sequencer ----------------------------------------------------------------
      A     DB1953.DBX   43.1; 
      S     DB1953.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 
      =     DB2950.DBX  265.4; 
      =     DB2950.DBX  345.4; 
      =     DB2950.DBX  505.4; 
      =     DB2950.DBX  585.4; 


MODE: SET   ; 


NETWORK
TITLE =FW_RK1 

      A     #GenRel; 
      A     DB2950.DBX  266.7; 
      =     DB2950.DBX  267.6; 
NETWORK
TITLE =RV2_RW 

      A     #GenRel; 
      A     DB2950.DBX  346.7; 
      =     DB2950.DBX  347.6; 

NETWORK
TITLE =RV2V1

      A     #GenRel; 
      A     DB2950.DBX  506.7; 
      =     DB2950.DBX  507.6; 
NETWORK
TITLE =RV2_RS


      A     #GenRel; 
      A     DB2950.DBX  586.7; 
      =     DB2950.DBX  587.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1960
TITLE =U096: CIP 3 Distribution
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1960.DBW    0; 
      T     #UnitNo; 
      L     DB1960.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2965.unv001,
           ValExt                   := DB2965.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2965.unv002,
           ValExt                   := DB2965.DBD  362);

// RK3_KreisNr UnV 003 Circuit Number
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2965.RK3_KreisNr,
           ValExt                   := DB2965.DBD  490);

// RK3_Medium UnV 004 0=NIX 1=Wasser 2=Heiwasser 3=Lauge 4=Sure 5=Desi
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2965.RK3_Medium,
           ValExt                   := DB2965.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// RK3_I_Bereit SpI 001 Das Reinigungs Programm ist gestartet und luft "1"= Luft  "0"=AUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2961.RK3_I_Bereit,
           SpIBit                   := DB304.DBX   30.0);

// RK3_I_VL_Ein SpI 002 Medium wird angefordert (Reinigungs Vorlauf EIN) "1"=VorlaufPumpe an "0"AUS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2961.RK3_I_VL_Ein,
           SpIBit                   := DB304.DBX   30.1);

// RK3_I_RL_Ein SpI 003 Medium wird zurckgepumpt "1" RcklaufPumpe an "0"=AUS 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2961.RK3_I_RL_Ein,
           SpIBit                   := DB304.DBX   30.2);

// RK3_I_Leer SpI 004 Der zu Reinigende Anlagenteil ist leer."1"=leer "0"=nicht leer
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2961.RK3_I_Leer,
           SpIBit                   := DB304.DBX   30.3);

// RK3_I_Stop SpI 005 Stop interner Fehler Pumpen anhalten Reinigungszeit anhalten "1" STOP  "0"= OK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2961.RK3_I_Stop,
           SpIBit                   := DB304.DBX   30.4);

// RK3_I_SK_RM SpI 006 Bypassventil ist angesteuert und offen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2961.RK3_I_SK_RM,
           SpIBit                   := DB304.DBX   30.7);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2967.msg001,
           MsgBit                   := DB2967.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2967.msg002,
           MsgBit                   := DB2967.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RV3_ST  
// Act 004
// Box           : VSRVK1..3
// Input address : I82.2
// Output address: Q82.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RV3_ST,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     82.2,
           Out                      := Q     82.2);

NETWORK
TITLE =K3_VNI_RSTP  STOP TU AN VNI MELDEN
// Act 004
// Box           : S8 U8.2
// Output address: Q42.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.K3_VNI_RSTP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.0);

NETWORK
TITLE =K3_VNI_RMW  MEDIENWECHSEL AN VNI MELDEN
// Act 005
// Box           : S8 U8.2
// Output address: Q42.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.K3_VNI_RMW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.1);

NETWORK
TITLE =K3_VNI_REND  ENDE MELDUNG AN VNI
// Act 006
// Box           : S8 U8.2
// Output address: Q42.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.K3_VNI_REND,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.2);

NETWORK
TITLE =K3_VNI_RHL  MELDUNG HEISSLAUGE AN VNI
// Act 007
// Box           : S8 U8.2
// Output address: Q42.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.K3_VNI_RHL,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.3);

NETWORK
TITLE =K3_VNI_RBTR  BETRIEBSMELDUNG CIP AN VNI
// Act 008
// Box           : S8 U8.2
// Output address: Q42.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.K3_VNI_RBTR,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.4);

NETWORK
TITLE =K3_VNI_WASSER_OK  WASSER OK AN VNI
// Act 009
// Box           : S8 U8.2
// Output address: Q42.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.K3_VNI_WASSER_OK,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     42.5);

NETWORK
TITLE =RK3_Bereit  Die CIP Station hat gestatet "0"=AUS "1"=gestartet
// Act 010
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK3.Bereit
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RK3_Bereit,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   30.0);

NETWORK
TITLE =RK3_Stop  Stop Pumpen anhalten "0"Ok" 1"=Stop 
// Act 011
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK3.Stop
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RK3_Stop,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   30.1);

NETWORK
TITLE =RK3_MED  Medienwechsel der CIP
// Act 012
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK3.MED
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RK3_MED,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   30.2);

NETWORK
TITLE =RK3_ENDE  Ende der Reinigung
// Act 013
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK3.ENDE
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RK3_ENDE,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   30.3);

NETWORK
TITLE =RK3_Bypass  CIP Bypass
// Act 014
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.RK3.Bypass
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RK3_Bypass,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   30.4);

NETWORK
TITLE =SR1_RR3  SR1 RR3 CIP Rcklaufventil RR3SR1
// Act 015
// Box           : VS-RRA
// Input address : I200.7
// Output address: Q200.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.SR1_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    200.7,
           Out                      := Q    200.7);

NETWORK
TITLE =SR2_RR3  SR2 RR3 CIP Rcklaufventil RR3SR2
// Act 016
// Box           : VS-RRA
// Input address : I201.1
// Output address: Q201.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.SR2_RR3,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    201.1,
           Out                      := Q    201.1);

NETWORK
TITLE =RV3_RS  Ventil zum Gully beim splen vom Tank
// Act 019
// Box           : Ventilinsel 4
// Input address : I337.4
// Output address: Q337.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2960.RV3_RS,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    337.4,
           Out                      := Q    337.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1961
TITLE =U096: CIP 3 Distribution
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1961.DBX 1357.7; 
      CC    FB  1969; // "U096Sim"
      A     DB1961.DBX   17.3; 
      =     DB1961.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1960.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1961.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1965.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1961.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1965; // U096Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U096UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U096UnVD".unv002.ValExt

// ----------------------------------------------------------
// RK3_KreisNr Circuit Number
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U096UnVD".RK3_KreisNr.ValExt

// ----------------------------------------------------------
// RK3_Medium 0=NIX 1=Wasser 2=Heiwasser 3=Lauge 4=Sure 5=Desi
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U096UnVD".RK3_Medium.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// RK3_I_Bereit Das Reinigungs Programm ist gestartet und luft "1"= Luft  "0"=AUS
// ----------------------------------------------------------
      CLR   ; 
      =     DB2961.DBX   81.4; 
      =     DB2961.DBX   81.5; 

// ----------------------------------------------------------
// RK3_I_VL_Ein Medium wird angefordert (Reinigungs Vorlauf EIN) "1"=VorlaufPumpe an "0"AUS
// ----------------------------------------------------------
      CLR   ; 
      =     DB2961.DBX  141.4; 
      =     DB2961.DBX  141.5; 

// ----------------------------------------------------------
// RK3_I_RL_Ein Medium wird zurckgepumpt "1" RcklaufPumpe an "0"=AUS 
// ----------------------------------------------------------
      CLR   ; 
      =     DB2961.DBX  201.4; 
      =     DB2961.DBX  201.5; 

// ----------------------------------------------------------
// RK3_I_Leer Der zu Reinigende Anlagenteil ist leer."1"=leer "0"=nicht leer
// ----------------------------------------------------------
      CLR   ; 
      =     DB2961.DBX  261.4; 
      =     DB2961.DBX  261.5; 

// ----------------------------------------------------------
// RK3_I_Stop Stop interner Fehler Pumpen anhalten Reinigungszeit anhalten "1" STOP  "0"= OK
// ----------------------------------------------------------
      CLR   ; 
      =     DB2961.DBX  321.4; 
      =     DB2961.DBX  321.5; 

// ----------------------------------------------------------
// RK3_I_SK_RM Bypassventil ist angesteuert und offen
// ----------------------------------------------------------
      CLR   ; 
      =     DB2961.DBX  381.4; 
      =     DB2961.DBX  381.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2967.DBX   80.7; 
      =     DB2967.DBX   81.4; 

      CLR   ; 
      =     DB2967.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2967.DBX  140.7; 
      =     DB2967.DBX  141.4; 

      CLR   ; 
      =     DB2967.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

      CALL FC    29 (
           UnitNo                   := #UnitNo,
           Value                    := DB1965.DBD   54,
           Enable                   := TRUE,
           Down                     := FALSE,
           OriginDetect             := 0.000000e+000,
           MaxDiffPS                := 1.000000e+000,
           SFMRec                   := DB1961.Seq.SFM[15],
           ValueOld                 := DB1961.DBD 1418);

// sequencer ----------------------------------------------------------------
      A     DB1963.DBX   43.1; 
      S     DB1963.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2960.DBX  185.4; 
      =     DB2960.DBX  265.4; 
      =     DB2960.DBX  345.4; 
      =     DB2960.DBX  425.4; 
      =     DB2960.DBX  505.4; 
      =     DB2960.DBX  585.4; 
      =     DB2960.DBX  665.4; 
      =     DB2960.DBX  745.4; 
      =     DB2960.DBX  825.4; 
      =     DB2960.DBX  905.4; 
      =     DB2960.DBX  985.4; 
      =     DB2960.DBX 1065.4; 
      =     DB2960.DBX 1145.4; 
      =     DB2960.DBX 1225.4; 
      =     DB2960.DBX 1305.4; 
      =     DB2960.DBX 1545.4; 

MODE: SET   ; 

NETWORK
TITLE =RV3_ST 

      A     #GenRel; 
      A     DB2960.DBX  186.7; 
      =     DB2960.DBX  187.6; 
NETWORK
TITLE =K3_SK_CIP_BYPASSST SIGNAL AN SIRUP-KUECHE

      A     #GenRel; 
      A     DB2960.DBX  266.7; 
      =     DB2960.DBX  267.6; 
NETWORK
TITLE =K3_VNI_RSTP STOP TU AN VNI MELDEN

      A     #GenRel; 
      A     DB2960.DBX  346.7; 
      =     DB2960.DBX  347.6; 
NETWORK
TITLE =K3_VNI_RMW MEDIENWECHSEL AN VNI MELDEN

      A     #GenRel; 
      A     DB2960.DBX  426.7; 
      =     DB2960.DBX  427.6; 
NETWORK
TITLE =K3_VNI_REND ENDE MELDUNG AN VNI

      A     #GenRel; 
      A     DB2960.DBX  506.7; 
      =     DB2960.DBX  507.6; 
NETWORK
TITLE =K3_VNI_RHL MELDUNG HEISSLAUGE AN VNI

      A     #GenRel; 
      A     DB2960.DBX  586.7; 
      =     DB2960.DBX  587.6; 
NETWORK
TITLE =K3_VNI_RBTR BETRIEBSMELDUNG CIP AN VNI

      A     #GenRel; 
      A     DB2960.DBX  666.7; 
      =     DB2960.DBX  667.6; 
NETWORK
TITLE =K3_VNI_WASSER_OK WASSER OK AN VNI

      A     #GenRel; 
      A     DB2960.DBX  746.7; 
      =     DB2960.DBX  747.6; 
NETWORK
TITLE =RK3_Bereit Die CIP Station hat gestatet "0"=AUS "1"=gestartet

      A     #GenRel; 
      A     DB2960.DBX  826.7; 
      =     DB2960.DBX  827.6; 
NETWORK
TITLE =RK3_Stop Stop Pumpen anhalten "0"Ok" 1"=Stop 

      A     #GenRel; 
      A     DB2960.DBX  906.7; 
      =     DB2960.DBX  907.6; 
NETWORK
TITLE =RK3_MED Medienwechsel der CIP

      A     #GenRel; 
      A     DB2960.DBX  986.7; 
      =     DB2960.DBX  987.6; 
NETWORK
TITLE =RK3_ENDE Ende der Reinigung

      A     #GenRel; 
      A     DB2960.DBX 1066.7; 
      =     DB2960.DBX 1067.6; 
NETWORK
TITLE =RK3_Bypass CIP Bypass

      A     #GenRel; 
      A     DB2960.DBX 1146.7; 
      =     DB2960.DBX 1147.6; 
NETWORK
TITLE =SR1_RR3 SR1 RR3 CIP Rcklaufventil RR3SR1

      A     #GenRel; 
      A     DB2960.DBX 1226.7; 
      =     DB2960.DBX 1227.6; 
NETWORK
TITLE =SR2_RR3 SR2 RR3 CIP Rcklaufventil RR3SR2

      A     #GenRel; 
      A     DB2960.DBX 1306.7; 
      =     DB2960.DBX 1307.6; 
NETWORK
TITLE =RV3_RSSR2 Ventil zum Gully beim splen vom Tank

      A     #GenRel; 
      A     DB2960.DBX 1546.7; 
      =     DB2960.DBX 1547.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1980
TITLE =U098: General Syrup Room
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1980.DBW    0; 
      T     #UnitNo; 
      L     DB1980.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// IW518 AnI 001 Produkttemp. Erhitzer
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2983._PIW518,
           ValPer                   := IW   518);

// IW520 AnI 002 Erhitzungsregelung Heisswasser
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2983._PIW520,
           ValPer                   := IW   520);

// IW522 AnI 003 Produkttemp. Khler
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2983._PIW522,
           ValPer                   := IW   522);

// IW524 AnI 004 Produkteintrittstemp.
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2983._PIW524,
           ValPer                   := IW   524);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2985.unv001,
           ValExt                   := DB2985.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2985.unv002,
           ValExt                   := DB2985.DBD  362);

// IW532 UnV 003 Contents Zitronensuretank
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2985._PIW532,
           ValExt                   := DB2985.DBD  490);

// WAS_Wasser_Druck UnV 004 Water Pressure in Bar
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2985.WAS_Wasser_Druck,
           ValExt                   := DB2985.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// NI_RR_SIRUPWASSER SpI 001 PANEEL SIRUPKUECHE (???)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.NI_RR_SIRUPWASSER,
           SpIBit                   := I    102.7);

// KZE_FREIGABE_CIP SpI 002 SIGNAL VON SCHMIDT KZE SK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.KZE_FREIGABE_CIP,
           SpIBit                   := I     65.1);

// KZE_KEIN_STOP SpI 003 SIGNAL VON SCHMIDT KZE SK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.KZE_KEIN_STOP,
           SpIBit                   := I     65.2);

// KZE_INTERNE_REINIGUNG SpI 004 SIGNAL VON SCHMIDT KZE SK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.KZE_INTERNE_REINIGUNG,
           SpIBit                   := I     65.3);

// KZE_TANK_LEERMELDUNG SpI 005 SIGNAL VON SCHMIDT KZE SK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.KZE_TANK_LEERMELDUNG,
           SpIBit                   := I     65.4);

// KZE_FREIGABE_VORLAUF SpI 006 SIGNAL VON SCHMIDT KZE SK
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.KZE_FREIGABE_VORLAUF,
           SpIBit                   := I     65.5);

// LDT_START_MOLCH_S1 SpI 007 STARTTASTER AB SIRUPKUECHE
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.LDT_START_MOLCH_S1,
           SpIBit                   := I     66.2);

// LANG_STOER_DOSIERUNG SpI 008 RUECKMELDUNG VON LANG AN TU
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.LANG_STOER_DOSIERUNG,
           SpIBit                   := I     40.3);

// LiveBit SpI 009 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2981.LiveBit,
           SpIBit                   := DB304.DBX    0.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2987.msg001,
           MsgBit                   := DB2987.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2987.msg002,
           MsgBit                   := DB2987.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =KZE_RBTR  SIGNAL AN SCHMIDT KZE SK
// Act 001
// Box           : S8 U8.2
// Output address: Q122.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.KZE_RBTR,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    122.0);

NETWORK
TITLE =KZE_RMW  SIGNAL AN SCHMIDT KZE SK
// Act 002
// Box           : S8 U8.2
// Output address: Q122.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.KZE_RMW,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    122.1);

NETWORK
TITLE =KZE_RSTP  SIGNAL AN SCHMIDT KZE SK
// Act 003
// Box           : S8 U8.2
// Output address: Q122.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.KZE_RSTP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    122.2);

NETWORK
TITLE =KZE_REND  SIGNAL AN SCHMIDT KZE SK
// Act 004
// Box           : S8 U8.2
// Output address: Q122.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.KZE_REND,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    122.3);

NETWORK
TITLE =KZE_MANNLOCH_OEFFNEN  SIGNAL AN SCHMIDT KZE SK
// Act 005
// Box           : S8 U8.2
// Output address: Q122.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.KZE_MANNLOCH_OEFFNEN,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    122.4);

NETWORK
TITLE =LA_S1_MOLCH_START  LAMPE LDT AB SIRUPKUECHE
// Act 006
// Box           : S8 U8.2
// Output address: Q122.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.LA_S1_MOLCH_START,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    122.7);

NETWORK
TITLE =Act007 spare
// Act 007
// Box           : S8 U8.2
// Output address: Q123.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.Act007,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

NETWORK
TITLE =Act008 spare
// Act 008
// Box           : S8 U8.2
// Output address: Q123.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2980.Act008,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1981
TITLE =U098: General Syrup Room
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1981.DBX 1357.7; 
      CC    FB  1989; // "U098Sim"
      A     DB1981.DBX   17.3; 
      =     DB1981.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1980.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1981.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1985.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1981.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1985; // U098Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// PIW518 Produkttemp. Erhitzer
// ----------------------------------------------------------
      L     DB1981.DBD 1118; // !!! insert correct SFM !!!
      T     DB2983.DBD  238; 

      SET   ; 
      =     DB2983.DBX  141.5; 

// ----------------------------------------------------------
// PIW520 Erhitzungsregelung Heisswasser
// ----------------------------------------------------------
      L     DB1981.DBD 1118; // !!! insert correct SFM !!!
      T     DB2983.DBD  358; 

      SET   ; 
      =     DB2983.DBX  261.5; 

// ----------------------------------------------------------
// PIW522 Produkttemp. Khler
// ----------------------------------------------------------
      L     DB1981.DBD 1118; // !!! insert correct SFM !!!
      T     DB2983.DBD  478; 

      SET   ; 
      =     DB2983.DBX  381.5; 

// ----------------------------------------------------------
// PIW524 Produkteintrittstemp.
// ----------------------------------------------------------
      L     DB1981.DBD 1118; // !!! insert correct SFM !!!
      T     DB2983.DBD  598; 

      SET   ; 
      =     DB2983.DBX  501.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U098UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U098UnVD".unv002.ValExt

// ----------------------------------------------------------
// PIW532 Contents Zitronensuretank
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U098UnVD".PIW532.ValExt

// ----------------------------------------------------------
// WAS_Wasser_Druck Water Pressure in Bar
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U098UnVD".WAS_Wasser_Druck.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// NI_RR_SIRUPWASSER PANEEL SIRUPKUECHE (???)
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX   81.4; 
      =     DB2981.DBX   81.5; 

// ----------------------------------------------------------
// KZE_FREIGABE_CIP SIGNAL VON SCHMIDT KZE SK
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  141.4; 
      =     DB2981.DBX  141.5; 

// ----------------------------------------------------------
// KZE_KEIN_STOP SIGNAL VON SCHMIDT KZE SK
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  201.4; 
      =     DB2981.DBX  201.5; 

// ----------------------------------------------------------
// KZE_INTERNE_REINIGUNG SIGNAL VON SCHMIDT KZE SK
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  261.4; 
      =     DB2981.DBX  261.5; 

// ----------------------------------------------------------
// KZE_TANK_LEERMELDUNG SIGNAL VON SCHMIDT KZE SK
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  321.4; 
      =     DB2981.DBX  321.5; 

// ----------------------------------------------------------
// KZE_FREIGABE_VORLAUF SIGNAL VON SCHMIDT KZE SK
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  381.4; 
      =     DB2981.DBX  381.5; 

// ----------------------------------------------------------
// LDT_START_MOLCH_S1 STARTTASTER AB SIRUPKUECHE
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  441.4; 
      =     DB2981.DBX  441.5; 

// ----------------------------------------------------------
// LANG_STOER_DOSIERUNG RUECKMELDUNG VON LANG AN TU
// ----------------------------------------------------------
      CLR   ; 
//      =     "U098SpID".LANG_STOER_DOSIERUNG.EAl
//      =     "U098SpID".LANG_STOER_DOSIERUNG.Pre

// ----------------------------------------------------------
// LiveBit 
// ----------------------------------------------------------
      SET   ; 
      =     DB2981.DBX  561.4; 
      =     DB2981.DBX  561.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2987.DBX   80.7; 
      =     DB2987.DBX   81.4; 

      CLR   ; 
      =     DB2987.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2987.DBX  140.7; 
      =     DB2987.DBX  141.4; 

      CLR   ; 
      =     DB2987.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Produkttemp. Erhitzer -----------------------
      L     DB2983.DBD  146; 
      T     DB1981.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Erhitzungsregelung Heisswasser -----------------------
      L     DB2983.DBD  266; 
      T     DB1981.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Produkttemp. Khler -----------------------
      L     DB2983.DBD  386; 
      T     DB1981.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM Produkteintrittstemp. -----------------------
      L     DB2983.DBD  506; 
      T     DB1981.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1983.DBX   43.1; 
      S     DB1983.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2980.DBX  105.4; 
      =     DB2980.DBX  185.4; 
      =     DB2980.DBX  265.4; 
      =     DB2980.DBX  345.4; 
      =     DB2980.DBX  425.4; 
      =     DB2980.DBX  505.4; 
      =     DB2980.DBX  585.4; 
      =     DB2980.DBX  665.4; 



MODE: SET   ; 

NETWORK
TITLE =KZE_RBTR SIGNAL AN SCHMIDT KZE SK

      A     #GenRel; 
      A     DB2980.DBX  106.7; 
      =     DB2980.DBX  107.6; 
NETWORK
TITLE =KZE_RMW SIGNAL AN SCHMIDT KZE SK

      A     #GenRel; 
      A     DB2980.DBX  186.7; 
      =     DB2980.DBX  187.6; 
NETWORK
TITLE =KZE_RSTP SIGNAL AN SCHMIDT KZE SK

      A     #GenRel; 
      A     DB2980.DBX  266.7; 
      =     DB2980.DBX  267.6; 
NETWORK
TITLE =KZE_REND SIGNAL AN SCHMIDT KZE SK

      A     #GenRel; 
      A     DB2980.DBX  346.7; 
      =     DB2980.DBX  347.6; 
NETWORK
TITLE =KZE_MANNLOCH_OEFFNEN SIGNAL AN SCHMIDT KZE SK

      A     #GenRel; 
      A     DB2980.DBX  426.7; 
      =     DB2980.DBX  427.6; 
NETWORK
TITLE =LA_S1_MOLCH_START LAMPE LDT AB SIRUPKUECHE

      A     #GenRel; 
      A     DB2980.DBX  506.7; 
      =     DB2980.DBX  507.6; 
NETWORK
TITLE =Act007 spare

      A     #GenRel; 
      A     DB2980.DBX  586.7; 
      =     DB2980.DBX  587.6; 
NETWORK
TITLE =Act008 spare

      A     #GenRel; 
      A     DB2980.DBX  666.7; 
      =     DB2980.DBX  667.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1990
TITLE =U099: PLC 3 General
FAMILY : BOTEC_F1
NAME : UniA
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB1990.DBW    0; 
      T     #UnitNo; 
      L     DB1990.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// LIT_ZST AnI 001 Fllstandsanzeige Zitronensuretank
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB2993.LIT_ZST,
           ValPer                   := IW   532);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2995.unv001,
           ValExt                   := DB2995.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB2995.unv002,
           ValExt                   := DB2995.DBD  362);

NETWORK
TITLE =special inputs 

      NOP   0; 
// NOT_STOP SpI 001 Not-Stop fr alle Programme von extern
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2991.NOT_STOP,
           SpIBit                   := I      7.2);

// S5_EP1_HAND_EIN_LAUTO SpI 002 SCHALTER PUMPE E.P1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2991.S5_EP1_HAND_EIN_LAUTO,
           SpIBit                   := I     64.2);

// RM_NI_RU_K1 SpI 003 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2991.RM_NI_RU_K1,
           SpIBit                   := I     68.6);

// LP_A9_LA10 SpI 006 Lampentest
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2991.LP_A9_LA10,
           SpIBit                   := I    258.7);

// GOA_G1 SpI 007 GOA_G1 Schwenkbogen Befllblock nach Gully
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB2991.GOA_G1,
           SpIBit                   := I    312.1);

// U99_SpI008 SpI 008 spare
//      CALL  "SI1"
//       UnitNo:=#UnitNo
//       SpIRec:="U099SpID".U99_SpI008
//       SpIBit:=#xTmp

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2997.msg001,
           MsgBit                   := DB2997.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB2997.msg002,
           MsgBit                   := DB2997.DBX  142.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =RS_GV1  
// Act 001
// Box           : Ventilinsel 4
// Input address : I337.5
// Output address: Q337.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2990.RS_GV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    337.5,
           Out                      := Q    337.5);

NETWORK
TITLE =U99_Act003  Tank Emptying CIP Drain
// Act 003
// Box           : 
// Output address: #xtmp
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB2990.U99_Act003,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 1991
TITLE =U099: PLC 3 General
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB1991.DBX 1357.7; 
      CC    FB  1999; // "U099Sim"
      A     DB1991.DBX   17.3; 
      =     DB1991.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB1990.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB1991.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB1995.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB1991.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  1995; // U099Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// LIT_ZST Fllstandsanzeige Zitronensuretank
// ----------------------------------------------------------
      L     DB1991.DBD 1118; // !!! insert correct SFM !!!
      T     DB2993.DBD  238; 

      SET   ; 
      =     DB2993.DBX  141.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U099UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U099UnVD".unv002.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// NOT_STOP Not-Stop fr alle Programme von extern
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX   81.4; 
      =     DB2991.DBX   81.5; 

// ----------------------------------------------------------
// S5_EP1_HAND_EIN_LAUTO SCHALTER PUMPE E.P1
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  141.4; 
      =     DB2991.DBX  141.5; 

// ----------------------------------------------------------
// RM_NI_RU_K1 
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  201.4; 
      =     DB2991.DBX  201.5; 

// ----------------------------------------------------------
// GOA_SKP1 GOA
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  261.4; 
      =     DB2991.DBX  261.5; 

// ----------------------------------------------------------
// GOA_SRGV GOA Molchw. Gully
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  321.4; 
      =     DB2991.DBX  321.5; 

// ----------------------------------------------------------
// LP_A9_LA10 Lampentest
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  381.4; 
      =     DB2991.DBX  381.5; 

// ----------------------------------------------------------
// GOA_G1 GOA_G1 Schwenkbogen Befllblock nach Gully
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  441.4; 
      =     DB2991.DBX  441.5; 

// ----------------------------------------------------------
// U99_SpI008 Swingbend Filling tank block to CIP2 return
// ----------------------------------------------------------
      SET   ; 
      =     DB2991.DBX  501.4; 
      =     DB2991.DBX  501.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB2997.DBX   80.7; 
      =     DB2997.DBX   81.4; 

      CLR   ; 
      =     DB2997.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB2997.DBX  140.7; 
      =     DB2997.DBX  141.4; 

      CLR   ; 
      =     DB2997.DBX  142.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM Fllstandsanzeige Zitronensuretank -----------------------
      L     DB2993.DBD  146; 
      T     DB1991.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB1993.DBX   43.1; 
      S     DB1993.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB2990.DBX  105.4; 
      =     DB2990.DBX  185.4; 
      =     DB2990.DBX  265.4; 



MODE: SET   ; 

NETWORK
TITLE =RS_GV1 

      A     #GenRel; 
      A     DB2990.DBX  106.7; 
      =     DB2990.DBX  107.6; 
NETWORK
TITLE =MW_GK1 MOLCHE SR Reserve

      A     #GenRel; 
      A     DB2990.DBX  186.7; 
      =     DB2990.DBX  187.6; 
NETWORK
TITLE =U99_Act003 Tank Emptying CIP Drain

      A     #GenRel; 
      A     DB2990.DBX  266.7; 
      =     DB2990.DBX  267.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4030
TITLE =U103: Sirup Anlage  3
FAMILY : BOTEC_F1
NAME : U103A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4030.DBW    0; 
      T     #UnitNo; 
      L     DB4030.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5035.unv001,
           ValExt                   := DB5035.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5035.unv002,
           ValExt                   := DB5035.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5035.unv003,
           ValExt                   := DB5035.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5035.unv004,
           ValExt                   := DB5035.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SKEG_31_oben SpI 004 GOA_SKEG_31_oben
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_SKEG_31_oben,
           SpIBit                   := I    267.1);

// GOA_SKEG_32_unten SpI 005 GOA_SKEG_32_unten
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_SKEG_32_unten,
           SpIBit                   := I    267.2);

// GOA_SKEG_1 SpI 006 GOA_SKEG_1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_SKEG_1,
           SpIBit                   := I    266.7);

// GOA_SKEG_2 SpI 007 GOA_SKEG_2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_SKEG_2,
           SpIBit                   := I    267.0);

// SK_KEG_Molch_Abbruch_DT SpI 008 MOLCH KEG Drucktaste Abbruch Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.SK_KEG_Molch_Abbruch_DT,
           SpIBit                   := I    264.5);

// SK_KEG_START_Molch_LDT SpI 009 MOLCH KEG L-Drucktaste Start Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.SK_KEG_START_Molch_LDT,
           SpIBit                   := I    265.0);

// KEG_SK1_Handklappe SpI 010 KEG_SK1_Handklappe
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.KEG_SK1_Handklappe,
           SpIBit                   := I    266.6);

// GOA_EKEG_31_oben SpI 014 GOA_EKEG_31_oben
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_EKEG_31_oben,
           SpIBit                   := I     34.5);

// GOA_EKEG_32_unten SpI 015 GOA_EKEG_32_unten
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_EKEG_32_unten,
           SpIBit                   := I     34.6);

// GOA_EKEG_3 SpI 016 GOA_EKEG_3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_EKEG_3,
           SpIBit                   := I     34.3);

// GOA_EKEG_4 SpI 017 GOA_EKEG_4
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_EKEG_4,
           SpIBit                   := I     34.4);

// KEG_Freigabe_Molch_SS SpI 018 KEG_Freigabe_Molch_SS
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.KEG_Freigabe_Molch_SS,
           SpIBit                   := I     35.4);

// KEG_Molch_Start_LDT_I SpI 019 KEG_Molch_Start_LDT
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.KEG_Molch_Start_LDT_I,
           SpIBit                   := I     34.7);

// KEG_Stop_Molch_DT SpI 020 KEG_Stop_Molch_DT
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.KEG_Stop_Molch_DT,
           SpIBit                   := I     35.5);

// GOA_EKEG_5 SpI 021 GOA Handklappe am Paneel KEG Anlage (CO2)
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_EKEG_5,
           SpIBit                   := I     35.1);

// GOA_KEG_RR1 SpI 022 KEG RR Sirup Kreis 1 Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_KEG_RR1,
           SpIBit                   := I     94.4);

// KEG_MIXER_BOGEN_22_24 SpI 023 KEG Mixer/KZE Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.KEG_MIXER_BOGEN_22_24,
           SpIBit                   := I    951.3);

// GOA_KEG_RR3 SpI 025 KEG RR Sirup Kreis 3 Schwenkbogen
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5031.GOA_KEG_RR3,
           SpIBit                   := I     94.5);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5037.msg001,
           MsgBit                   := DB5037.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5037.msg002,
           MsgBit                   := DB5037.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5037.msg003,
           MsgBit                   := DB5037.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =KEG_MWV1  Ansteuerung KEG_MWV1
// Act 002
// Box           : VS-SRA
// Output address: Q190.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.KEG_MWV1,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    190.0);

NETWORK
TITLE =SKEG_V2  Ansteuerung SKEG_V2
// Act 003
// Box           : VS-SRA
// Output address: Q190.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SKEG_V2,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    190.1);

NETWORK
TITLE =SKEG_V31  Ansteuerung SKEG_V31 (ohne RM)
// Act 004
// Box           : VS-SRA
// Output address: Q189.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SKEG_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    189.4);

NETWORK
TITLE =SKEG_V32  Ansteuerung SKEG_V32 (ohne RM)
// Act 005
// Box           : VS-SRA
// Output address: Q189.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SKEG_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    189.5);

NETWORK
TITLE =SKEG_V41  Ansteuerung SKEG_V41
// Act 006
// Box           : VS-SRA
// Output address: Q189.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SKEG_V41,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    189.6);

NETWORK
TITLE =SKEG_V42  Ansteuerung SKEG_V42
// Act 007
// Box           : VS-SRA
// Output address: Q189.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SKEG_V42,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    189.7);

NETWORK
TITLE =SK_KEG_Abbruch_Stoerung  Lampe Abbruch IM SIRUPRAUM
// Act 008
// Box           : AB1SK
// Output address: Q264.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SK_KEG_Abbruch_Stoerung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.7);

NETWORK
TITLE =SK_KEG_Molch_Start_LDT  Lampe Start Molch IM SIRUPRAUM
// Act 009
// Box           : AB1SK
// Output address: Q265.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SK_KEG_Molch_Start_LDT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    265.0);

NETWORK
TITLE =SK_KEG_Molch_bei_KEG  Lampe Molch an A11 IM SIRUPRAUM
// Act 010
// Box           : AB1SK
// Output address: Q264.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SK_KEG_Molch_bei_KEG,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.5);

NETWORK
TITLE =SK_KEG_Molch_in_SK  Lampe Molch im SK IM SIRUPRAUM
// Act 011
// Box           : AB1SK
// Output address: Q264.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.SK_KEG_Molch_in_SK,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.6);

NETWORK
TITLE =EKEG_V1  EKEG_V1
// Act 012
// Box           : VS-KEG
// Input address : I32.4
// Output address: Q32.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.EKEG_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     32.4,
           Out                      := Q     32.4);

NETWORK
TITLE =EKEG_V2  EKEG_V2
// Act 013
// Box           : VS-KEG
// Input address : I32.5
// Output address: Q32.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.EKEG_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     32.5,
           Out                      := Q     32.5);

NETWORK
TITLE =EKEG_V31_o_RM  EKEG_V31_o_RM
// Act 014
// Box           : VS-KEG
// Output address: Q32.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.EKEG_V31_o_RM,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     32.0);

NETWORK
TITLE =EKEG_V32_o_RM  EKEG_V32_o_RM
// Act 015
// Box           : VS-KEG
// Output address: Q32.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.EKEG_V32_o_RM,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     32.1);

NETWORK
TITLE =EKEG_V41  EKEG_V41
// Act 016
// Box           : VS-KEG
// Input address : I32.2
// Output address: Q32.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.EKEG_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     32.2,
           Out                      := Q     32.2);

NETWORK
TITLE =EKEG_V42  EKEG_V42
// Act 017
// Box           : VS-KEG
// Input address : I32.3
// Output address: Q32.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.EKEG_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     32.3,
           Out                      := Q     32.3);

NETWORK
TITLE =KEG_Molch_Start_LDT  KEG_Molch_Start_LDT
// Act 019
// Box           : VS-KEG
// Output address: Q34.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.KEG_Molch_Start_LDT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     34.7);

NETWORK
TITLE =Molch ist unterwegs (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.Act20,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    947.6);

NETWORK
TITLE =Molch in Endposition (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.Act21,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    946.5);

NETWORK
TITLE =A3_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 028
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage3.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.A3_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   45.0);

NETWORK
TITLE =KEG_Pos_Molch  KEG_Pos_Molch
// Act 030
// Box           : VS-KEG
// Output address: Q34.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.KEG_Pos_Molch,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     34.4);

NETWORK
TITLE =KEG_Laufzeit_Molch  KEG_Laufzeit_Molch
// Act 031
// Box           : VS-KEG
// Output address: Q34.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.KEG_Laufzeit_Molch,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     34.5);

NETWORK
TITLE =KEG_Temperatur_erreicht  KEG_Temperatur_erreicht
// Act 032
// Box           : VS-KEG
// Output address: Q34.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.KEG_Temperatur_erreicht,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     34.6);

NETWORK
TITLE =A3_Molch_Sirup  "1"=Molch ist im Sirupraum
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage3.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.A3_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   44.0);

NETWORK
TITLE =A3_Molch_Anlage  "1"=Molch ist an der Anlage
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage3.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.A3_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   44.1);

NETWORK
TITLE =A3_Molch_PRO  "1"=Molch ist bereit fr Produktion
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage3.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.A3_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   44.2);

NETWORK
TITLE =A3_Molch_CIP  "1"=Molch ist bereit fr CIP
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage3.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.A3_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   44.3);

NETWORK
TITLE =A3_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage3.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5030.A3_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   44.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4031
TITLE =U103: Sirup Anlage  3
FAMILY : BOTEC_F1
NAME : U103E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4031.DBX 1357.7; 
      CC    FB  4039; // "U103Sim"
      A     DB4031.DBX   17.3; 
      =     DB4031.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4030.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4031.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4035.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4031.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4035; // U103Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U103UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U103UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U103UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U103UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// GOA_SKEG_31_oben GOA_SKEG_31_oben
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  261.4; 
      =     DB5031.DBX  261.5; 

// ----------------------------------------------------------
// GOA_SKEG_32_unten GOA_SKEG_32_unten
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  321.4; 
      =     DB5031.DBX  321.5; 

// ----------------------------------------------------------
// GOA_SKEG_1 GOA_SKEG_1
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  381.4; 
      =     DB5031.DBX  381.5; 

// ----------------------------------------------------------
// GOA_SKEG_2 GOA_SKEG_2
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  441.4; 
      =     DB5031.DBX  441.5; 

// ----------------------------------------------------------
// SK_KEG_Molch_Abbruch_DT MOLCH KEG Drucktaste Abbruch Sirupraum
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  501.4; 
      =     DB5031.DBX  501.5; 

// ----------------------------------------------------------
// SK_KEG_START_Molch_LDT MOLCH KEG L-Drucktaste Start Sirupraum
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  561.4; 
      =     DB5031.DBX  561.5; 

// ----------------------------------------------------------
// KEG_SK1_Handklappe KEG_SK1_Handklappe
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  621.4; 
      =     DB5031.DBX  621.5; 

// ----------------------------------------------------------
// GOA_EKEG_31_oben GOA_EKEG_31_oben
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  861.4; 
      =     DB5031.DBX  861.5; 

// ----------------------------------------------------------
// GOA_EKEG_32_unten GOA_EKEG_32_unten
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  921.4; 
      =     DB5031.DBX  921.5; 

// ----------------------------------------------------------
// GOA_EKEG_3 GOA_EKEG_3
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX  981.4; 
      =     DB5031.DBX  981.5; 

// ----------------------------------------------------------
// GOA_EKEG_4 GOA_EKEG_4
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1041.4; 
      =     DB5031.DBX 1041.5; 

// ----------------------------------------------------------
// KEG_Freigabe_Molch_SS KEG_Freigabe_Molch_SS
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1101.4; 
      =     DB5031.DBX 1101.5; 

// ----------------------------------------------------------
// KEG_Molch_Start_LDT_I KEG_Molch_Start_LDT
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1161.4; 
      =     DB5031.DBX 1161.5; 

// ----------------------------------------------------------
// KEG_Stop_Molch_DT KEG_Stop_Molch_DT
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1221.4; 
      =     DB5031.DBX 1221.5; 

// ----------------------------------------------------------
// GOA_EKEG_5 GOA Handklappe am Paneel KEG Anlage (CO2)
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1281.4; 
      =     DB5031.DBX 1281.5; 

// ----------------------------------------------------------
// GOA_KEG_RR1 KEG RR Sirup Kreis 1 Schwenkbogen
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1341.4; 
      =     DB5031.DBX 1341.5; 

// ----------------------------------------------------------
// KEG_MIXER_BOGEN_22_24 KEG Mixer/KZE Schwenkbogen
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1401.4; 
      =     DB5031.DBX 1401.5; 

// ----------------------------------------------------------
// GOA_KEG_RR3 KEG RR Sirup Kreis 3 Schwenkbogen
// ----------------------------------------------------------
      SET   ; 
      =     DB5031.DBX 1521.4; 
      =     DB5031.DBX 1521.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5037.DBX   80.7; 
      =     DB5037.DBX   81.4; 

      CLR   ; 
      =     DB5037.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5037.DBX  140.7; 
      =     DB5037.DBX  141.4; 

      CLR   ; 
      =     DB5037.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5037.DBX  200.7; 
      =     DB5037.DBX  201.4; 

      CLR   ; 
      =     DB5037.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB4033.DBX   43.1; 
      S     DB4033.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 

// assign actuator mode
      AN    M    120.1; 
      =     DB5030.DBX  185.4; 
      =     DB5030.DBX  265.4; 
      =     DB5030.DBX  345.4; 
      =     DB5030.DBX  425.4; 
      =     DB5030.DBX  505.4; 
      =     DB5030.DBX  585.4; 
      =     DB5030.DBX  665.4; 
      =     DB5030.DBX  745.4; 
      =     DB5030.DBX  825.4; 
      =     DB5030.DBX  905.4; 
      =     DB5030.DBX  985.4; 
      =     DB5030.DBX 1065.4; 
      =     DB5030.DBX 1145.4; 
      =     DB5030.DBX 1225.4; 
      =     DB5030.DBX 1305.4; 
      =     DB5030.DBX 1385.4; 
      =     DB5030.DBX 1545.4; 
      =     DB5030.DBX 2265.4; 
      =     DB5030.DBX 2425.4; 
      =     DB5030.DBX 2505.4; 
      =     DB5030.DBX 2585.4; 
      =     DB5030.DBX 3705.4; 
      =     DB5030.DBX 3785.4; 
      =     DB5030.DBX 3865.4; 
      =     DB5030.DBX 3945.4; 
      =     DB5030.DBX 4025.4; 



MODE: SET   ; 

NETWORK
TITLE =KEG_MWV1 Ansteuerung KEG_MWV1

      A     #GenRel; 
      A     DB5030.DBX  186.7; 
      =     DB5030.DBX  187.6; 
NETWORK
TITLE =SKEG_V2 Ansteuerung SKEG_V2

      A     #GenRel; 
      A     DB5030.DBX  266.7; 
      =     DB5030.DBX  267.6; 
NETWORK
TITLE =SKEG_V31 Ansteuerung SKEG_V31 (ohne RM)

      A     #GenRel; 
      A     DB5030.DBX  346.7; 
      =     DB5030.DBX  347.6; 
NETWORK
TITLE =SKEG_V32 Ansteuerung SKEG_V32 (ohne RM)

      A     #GenRel; 
      A     DB5030.DBX  426.7; 
      =     DB5030.DBX  427.6; 
NETWORK
TITLE =SKEG_V41 Ansteuerung SKEG_V41

      A     #GenRel; 
      A     DB5030.DBX  506.7; 
      =     DB5030.DBX  507.6; 
NETWORK
TITLE =SKEG_V42 Ansteuerung SKEG_V42

      A     #GenRel; 
      A     DB5030.DBX  586.7; 
      =     DB5030.DBX  587.6; 
NETWORK
TITLE =SK_KEG_Abbruch_Stoerung Lampe Abbruch IM SIRUPRAUM

      A     #GenRel; 
      A     DB5030.DBX  666.7; 
      =     DB5030.DBX  667.6; 
NETWORK
TITLE =SK_KEG_Molch_Start_LDT Lampe Start Molch IM SIRUPRAUM

      A     #GenRel; 
      A     DB5030.DBX  746.7; 
      =     DB5030.DBX  747.6; 
NETWORK
TITLE =SK_KEG_Molch_bei_KEG Lampe Molch an A11 IM SIRUPRAUM

      A     #GenRel; 
      A     DB5030.DBX  826.7; 
      =     DB5030.DBX  827.6; 
NETWORK
TITLE =SK_KEG_Molch_in_SK Lampe Molch im SK IM SIRUPRAUM

      A     #GenRel; 
      A     DB5030.DBX  906.7; 
      =     DB5030.DBX  907.6; 
NETWORK
TITLE =EKEG_V1 EKEG_V1

      A     #GenRel; 
      A     DB5030.DBX  986.7; 
      =     DB5030.DBX  987.6; 
NETWORK
TITLE =EKEG_V2 EKEG_V2

      A     #GenRel; 
      A     DB5030.DBX 1066.7; 
      =     DB5030.DBX 1067.6; 
NETWORK
TITLE =EKEG_V31_o_RM EKEG_V31_o_RM

      A     #GenRel; 
      A     DB5030.DBX 1146.7; 
      =     DB5030.DBX 1147.6; 
NETWORK
TITLE =EKEG_V32_o_RM EKEG_V32_o_RM

      A     #GenRel; 
      A     DB5030.DBX 1226.7; 
      =     DB5030.DBX 1227.6; 
NETWORK
TITLE =EKEG_V41 EKEG_V41

      A     #GenRel; 
      A     DB5030.DBX 1306.7; 
      =     DB5030.DBX 1307.6; 
NETWORK
TITLE =EKEG_V42 EKEG_V42

      A     #GenRel; 
      A     DB5030.DBX 1386.7; 
      =     DB5030.DBX 1387.6; 
NETWORK
TITLE =KEG_Molch_Start_LDT KEG_Molch_Start_LDT

      A     #GenRel; 
      A     DB5030.DBX 1546.7; 
      =     DB5030.DBX 1547.6; 
NETWORK
TITLE =A3_Schwenkbogen "1"=CIP  "0"=Produktion

      A     #GenRel; 
      A     DB5030.DBX 2266.7; 
      =     DB5030.DBX 2267.6; 
NETWORK
TITLE =KEG_Pos_Molch KEG_Pos_Molch

      A     #GenRel; 
      A     DB5030.DBX 2426.7; 
      =     DB5030.DBX 2427.6; 
NETWORK
TITLE =KEG_Laufzeit_Molch KEG_Laufzeit_Molch

      A     #GenRel; 
      A     DB5030.DBX 2506.7; 
      =     DB5030.DBX 2507.6; 
NETWORK
TITLE =KEG_Temperatur_erreicht KEG_Temperatur_erreicht

      A     #GenRel; 
      A     DB5030.DBX 2586.7; 
      =     DB5030.DBX 2587.6; 
NETWORK
TITLE =A3_Molch_Sirup "1"=Molch ist im Sirupraum

      A     #GenRel; 
      A     DB5030.DBX 3706.7; 
      =     DB5030.DBX 3707.6; 
NETWORK
TITLE =A3_Molch_Anlage "1"=Molch ist an der Anlage

      A     #GenRel; 
      A     DB5030.DBX 3786.7; 
      =     DB5030.DBX 3787.6; 
NETWORK
TITLE =A3_Molch_PRO "1"=Molch ist bereit fr Produktion

      A     #GenRel; 
      A     DB5030.DBX 3866.7; 
      =     DB5030.DBX 3867.6; 
NETWORK
TITLE =A3_Molch_CIP "1"=Molch ist bereit fr CIP

      A     #GenRel; 
      A     DB5030.DBX 3946.7; 
      =     DB5030.DBX 3947.6; 
NETWORK
TITLE =A3_Sirupanforderung 

      A     #GenRel; 
      A     DB5030.DBX 4026.7; 
      =     DB5030.DBX 4027.6; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4050
TITLE =U105: Sirup Anlage  5
FAMILY : BOTEC_F1
NAME : U105A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4050.DBW    0; 
      T     #UnitNo; 
      L     DB4050.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5055.unv001,
           ValExt                   := DB5055.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5055.unv002,
           ValExt                   := DB5055.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5055.unv003,
           ValExt                   := DB5055.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5055.unv004,
           ValExt                   := DB5055.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SA5_31_oben SpI 004 GOA SA5.31 oben Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_SA5_31_oben,
           SpIBit                   := I     75.6);

// GOA_SA5_32_unten SpI 005 GOA SA5.32 unten Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_SA5_32_unten,
           SpIBit                   := I     75.7);

// GOA_SA5_1 SpI 006 GOA SA5.1 Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_SA5_1,
           SpIBit                   := I     75.5);//"GOA_SA5_1"

// GOA_SA5_2 SpI 007 GOA SA5.2 Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_SA5_2,
           SpIBit                   := I     75.4);//"GOA_SA5_2"

// SK_A5_Molch_Abbruch_DT SpI 008 MOLCH A5 Drucktaste Abbruch Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.SK_A5_Molch_Abbruch_DT,
           SpIBit                   := I    181.2);

// SK_A5_START_Molch_LDT SpI 009 MOLCH A5 L-Drucktaste Start Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.SK_A5_START_Molch_LDT,
           SpIBit                   := I    181.5);

// A5_Sk1_Handklappe SpI 010 GOA Handlappe Anlage 5 SK1 Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.A5_Sk1_Handklappe,
           SpIBit                   := I     75.3);

// GOA_EA5_31_oben SpI 014 MOLCH A5 GOA EA5.31 oben
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_EA5_31_oben,
           SpIBit                   := I    194.5);

// GOA_EA5_32_unten SpI 015 MOLCH A5 GOA EA5.32 unten
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_EA5_32_unten,
           SpIBit                   := I    194.6);

// GOA_EA5_3 SpI 016 MOLCH A5 GOA EA5.3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_EA5_3,
           SpIBit                   := I    194.3);

// GOA_EA5_4 SpI 017 MOLCH A5 GOA EA5.4
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA_EA5_4,
           SpIBit                   := I    194.4);

// A5_SS_FRG_MOLCH SpI 018 Anlage 5 Schlsselschalter Freigabe Molch
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.A5_SS_FRG_MOLCH,
           SpIBit                   := I    195.4);

// LDT_Start_A5_MOLCH SpI 019 MOLCH A5 Leuchtdrucktaste Start
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.LDT_Start_A5_MOLCH,
           SpIBit                   := I    194.7);

// LDT_Stop_A5_MOLCH SpI 020 Anlage 5 Reserve 5
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.LDT_Stop_A5_MOLCH,
           SpIBit                   := I    195.5);

// A5_K2_Handklappe SpI 021 MOLCH A5 Handklappe K2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.A5_K2_Handklappe,
           SpIBit                   := I    195.2);

// GOA501 SpI 022 MOLCH A5 GOA501 --> RR1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA501,
           SpIBit                   := I    194.0);

// GOA502 SpI 023 MOLCH A5 GOA502 --> Anlage 5
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA502,
           SpIBit                   := I    194.1);

// GOA504 SpI 025 Molch A5 GOA504 --> RR3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5051.GOA504,
           SpIBit                   := I    195.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5057.msg001,
           MsgBit                   := DB5057.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5057.msg002,
           MsgBit                   := DB5057.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5057.msg003,
           MsgBit                   := DB5057.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A5_MWV1  MOLCH A5 Ansteuerung MWV1
// Act 002
// Box           : VS-SRA
// Input address : I188.4
// Output address: Q188.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_MWV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    188.4,
           Out                      := Q    188.4);

NETWORK
TITLE =SA5_V2  MOLCH SA5 Ansteuerung V2
// Act 003
// Box           : VS-SRA
// Input address : I188.5
// Output address: Q188.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SA5_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    188.5,
           Out                      := Q    188.5);

NETWORK
TITLE =SA5_V31  MOLCH SA5 Ansteuerung V31 (ohne RM)
// Act 004
// Box           : VS-SRA
// Output address: Q188.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SA5_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    188.0);

NETWORK
TITLE =SA5_V32  MOLCH SA5 Ansteuerung V32 (ohne RM)
// Act 005
// Box           : VS-SRA
// Output address: Q188.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SA5_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    188.1);

NETWORK
TITLE =SA5_V41  MOLCH SA5 Ansteuerung V41
// Act 006
// Box           : VS-SRA
// Input address : I188.2
// Output address: Q188.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SA5_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    188.2,
           Out                      := Q    188.2);

NETWORK
TITLE =SA5_V42  MOLCH SA5 Ansteuerung V42
// Act 007
// Box           : VS-SRA
// Input address : I188.3
// Output address: Q188.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SA5_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    188.3,
           Out                      := Q    188.3);

NETWORK
TITLE =SK_A5_Abbruch_L  Anlage 5 Lampe Abbruch IM SIRUPRAUM
// Act 008
// Box           : AB-SK
// Output address: Q181.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SK_A5_Abbruch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    181.4);

NETWORK
TITLE =SK_A5_START_Molch_L  Anlage 5 Lampe Start Molch IM SIRUPRAUM
// Act 009
// Box           : AB-SK
// Output address: Q181.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SK_A5_START_Molch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    181.5);

NETWORK
TITLE =SK_A5_MOLCH_BEI_A5_L  Anlage 5 Lampe Molch an A5 IM SIRUPRAUM
// Act 010
// Box           : AB-SK
// Output address: Q181.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SK_A5_MOLCH_BEI_A5_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    181.2);

NETWORK
TITLE =SK_A5_MOLCH_IN_SK_L  Anlage 5 Lampe Molch im SK IM SIRUPRAUM
// Act 011
// Box           : AB-SK
// Output address: Q181.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.SK_A5_MOLCH_IN_SK_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    181.3);

NETWORK
TITLE =EA5_V1  MOLCH A5 V1
// Act 012
// Box           : VSA5
// Input address : I192.4
// Output address: Q192.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.EA5_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    192.4,
           Out                      := Q    192.4);

NETWORK
TITLE =EA5_V2  MOLCH A5 V2
// Act 013
// Box           : VSA5
// Input address : I192.5
// Output address: Q192.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.EA5_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    192.5,
           Out                      := Q    192.5);

NETWORK
TITLE =EA5_V31  MOLCH A5 V31 ohne RM
// Act 014
// Box           : VSA5
// Output address: Q192.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.EA5_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    192.0);

NETWORK
TITLE =EA5_V32  MOLCH A5 V31 ohne RM
// Act 015
// Box           : VSA5
// Input address : I192.1
// Output address: Q192.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.EA5_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    192.1,
           Out                      := Q    192.1);

NETWORK
TITLE =EA5_V41  MOLCH A5 V41
// Act 016
// Box           : VSA5
// Input address : I192.2
// Output address: Q192.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.EA5_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    192.2,
           Out                      := Q    192.2);

NETWORK
TITLE =EA5_V42  MOLCH A5 V42
// Act 017
// Box           : VSA5
// Input address : I192.3
// Output address: Q192.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.EA5_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    192.3,
           Out                      := Q    192.3);

NETWORK
TITLE =A5_MOLCH_LDT_Start  MOLCH A5 Reserve 23
// Act 019
// Box           : VSA5
// Output address: Q194.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_MOLCH_LDT_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    194.7);

NETWORK
TITLE =Molch ist unterwegs(Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.Act20,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    199.3);

NETWORK
TITLE =Molch in Endposition (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.Act21,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    199.7);

NETWORK
TITLE =A5_GOA501  Mixer A5 GOA501 Paneel CIP
// Act 025
// Box           : Mixer5
// Output address: Q199.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_GOA501,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    199.2);

NETWORK
TITLE =A5_GOA502  Mixer A5 GOA502 Paneel CIP
// Act 027
// Box           : Mixer5
// Output address: Q199.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_GOA502,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    199.4);

NETWORK
TITLE =A5_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 028
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage5.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   49.0);

NETWORK
TITLE =A5_GOA503  Mixer A5 GOA503 Paneel CIP
// Act 029
// Box           : Mixer5
// Output address: Q199.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_GOA503,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    199.5);

NETWORK
TITLE =VNI_A5_SCHWENKBOGEN_RL  Schwenkbogen A5-RL liegt richtig
// Act 042
// Box           : AB-SK
// Output address: Q183.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.VNI_A5_SCHWENKBOGEN_RL,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.1);

NETWORK
TITLE =VNI_MOLCH_verr_A5  SIGNAL AN VNI Molch verriegelt an Anlage5
// Act 043
// Box           : AB-SK
// Output address: Q183.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.VNI_MOLCH_verr_A5,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.2);

NETWORK
TITLE =VNI_MOLCH_Sender_A5  SIGNAL AN VNI Molch an Sendestation A5 (SK)
// Act 044
// Box           : AB-SK
// Output address: Q183.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.VNI_MOLCH_Sender_A5,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.3);

NETWORK
TITLE =VNI_MOLCH_Empfang_A5  Molch an Empfangsstation (M5)
// Act 045
// Box           : AB-SK
// Output address: Q183.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.VNI_MOLCH_Empfang_A5,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    183.4);

NETWORK
TITLE =A5_Molch_Sirup  "1"=Molch ist im Sirupraum
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage5.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   48.0);

NETWORK
TITLE =A5_Molch_Anlage  "1"=Molch ist an der Anlage
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage5.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   48.1);

NETWORK
TITLE =A5_Molch_PRO  "1"=Molch ist bereit fr Produktion
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage5.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   48.2);

NETWORK
TITLE =A5_Molch_CIP  "1"=Molch ist bereit fr CIP
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage5.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   48.3);

NETWORK
TITLE =A5_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage5.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5050.A5_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   48.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4051
TITLE =U105: Transfer Plant 5
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4051.DBX 1357.7; 
      CC    FB  4059; // "U105Sim"
      A     DB4051.DBX   17.3; 
      =     DB4051.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4050.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  4055; // U105Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB4053.DBX   43.1; 
      S     DB4053.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4070
TITLE =U107: Sirup Anlage  7
FAMILY : BOTEC_F1
NAME : U107A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4070.DBW    0; 
      T     #UnitNo; 
      L     DB4070.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5075.unv001,
           ValExt                   := DB5075.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5075.unv002,
           ValExt                   := DB5075.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5075.unv003,
           ValExt                   := DB5075.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5075.unv004,
           ValExt                   := DB5075.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SA7_3_1_oben SpI 004 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_SA7_3_1_oben,
           SpIBit                   := I     74.2);

// GOA_SA7_3_2_unten SpI 005 Korb im Sirupraum in unterer Position
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_SA7_3_2_unten,
           SpIBit                   := I     74.3);

// GOA_SA7_1 SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_SA7_1,
           SpIBit                   := I     74.1);// "GOA_SA7_1"

// GOA_SA7_2 SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_SA7_2,
           SpIBit                   := I     74.0);//"GOA_SA7_2"

// SK_A7_Molch_Abbruch_DT SpI 008 MOLCH A7 Drucktaste Abbruch Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.SK_A7_Molch_Abbruch_DT,
           SpIBit                   := I    180.0);

// SK_A7_START_Molch_LDT SpI 009 MOLCH A7 L-Drucktaste Start Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.SK_A7_START_Molch_LDT,
           SpIBit                   := I    180.3);

// A7_Sk1_Handklappe SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.A7_Sk1_Handklappe,
           SpIBit                   := I     74.7);

// GOA_EA7_3_1_oben SpI 014 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_EA7_3_1_oben,
           SpIBit                   := I     26.5);

// GOA_EA7_3_2_unten SpI 015 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_EA7_3_2_unten,
           SpIBit                   := I     26.6);

// GOA_EA7_3 SpI 016 Molch in Startposition an Anlage 7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_EA7_3,
           SpIBit                   := I     26.3);

// GOA_EA7_4 SpI 017 GOA Molch in Ruhelage an Anlage 7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_EA7_4,
           SpIBit                   := I     26.4);

// A7_SS_FRG_MOLCH SpI 018 Anlage 7 Schlsselschalter Freigabe Molch
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.A7_SS_FRG_MOLCH,
           SpIBit                   := I     27.4);

// LDT_START_MOLCH_S2 SpI 019 STARTTASTER AB
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.LDT_START_MOLCH_S2,
           SpIBit                   := I     26.7);

// LDT_STOP_MOLCH_S2 SpI 020 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.LDT_STOP_MOLCH_S2,
           SpIBit                   := I     27.5);

// EA7_K2_Handklappe SpI 021 Handklappe Fueller 7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.EA7_K2_Handklappe,
           SpIBit                   := I     27.2);

// GOA_701 SpI 022 Spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_701x,
           SpIBit                   := FALSE);

// GOA_702 SpI 023 Meldung an Fueller/Sirup Anl.7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_702,
           SpIBit                   := I     26.1);

// GOA_701 SpI 025 Meldung an Fueller/Sirup Anl.7
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5071.GOA_701,
           SpIBit                   := I     26.0);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5077.msg001,
           MsgBit                   := DB5077.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5077.msg002,
           MsgBit                   := DB5077.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5077.msg003,
           MsgBit                   := DB5077.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A7_MWV1  Ansteuerung A7_MWV1
// Act 002
// Box           : VSSK
// Input address : I72.4
// Output address: Q52.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_MWV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     72.4,
           Out                      := Q     52.4);

NETWORK
TITLE =SA7_V2  Ansteuerung SA7_V2
// Act 003
// Box           : VSSK
// Input address : I72.5
// Output address: Q52.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SA7_V2,
           Typ                      := 3,
           FBa                      := I     72.5,
           FBa2                     := #xTmp,
           Out                      := Q     52.5);

NETWORK
TITLE =SA7_V31  Ansteuerung SA7_V31 ohne RM
// Act 004
// Box           : VSSK
// Output address: Q52.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SA7_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     52.0);

NETWORK
TITLE =SA7_V32  Ansteuerung SA7_V32 ohne RM
// Act 005
// Box           : VSSK
// Output address: Q52.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SA7_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     52.1);

NETWORK
TITLE =SA7_V41  Ansteuerung SA7_V41
// Act 006
// Box           : VSSK
// Input address : I72.2
// Output address: Q52.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SA7_V41,
           Typ                      := 3,
           FBa                      := I     72.2,
           FBa2                     := #xTmp,
           Out                      := Q     52.2);

NETWORK
TITLE =SA7_V42  Ansteuerung SA7_V42
// Act 007
// Box           : VSSK
// Input address : I72.3
// Output address: Q52.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SA7_V42,
           Typ                      := 3,
           FBa                      := I     72.3,
           FBa2                     := #xTmp,
           Out                      := Q     52.3);

NETWORK
TITLE =SK_A7_Abbruch_L  Anlage 7 Lampe Abbruch IM SIRUPRAUM
// Act 008
// Box           : AB-SK
// Output address: Q180.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SK_A7_Abbruch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.2);

NETWORK
TITLE =SK_A7_START_Molch_L  Anlage 7 Lampe Start Molch IM SIRUPRAUM
// Act 009
// Box           : AB-SK
// Output address: Q180.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SK_A7_START_Molch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.3);

NETWORK
TITLE =SK_A7_MOLCH_BEI_A7_L  Anlage 7 Lampe Molch an A7 IM SIRUPRAUM
// Act 010
// Box           : AB-SK
// Output address: Q180.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SK_A7_MOLCH_BEI_A7_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.0);

NETWORK
TITLE =SK_A7_MOLCH_IN_SK_L  Anlage 7 Lampe Molch im SK IM SIRUPRAUM
// Act 011
// Box           : AB-SK
// Output address: Q180.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.SK_A7_MOLCH_IN_SK_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.1);

NETWORK
TITLE =EA7_V1  Molch Anlage 7
// Act 012
// Box           : VSA7
// Input address : I24.4
// Output address: Q46.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.EA7_V1,
           Typ                      := 3,
           FBa                      := I     24.4,
           FBa2                     := #xTmp,
           Out                      := Q     46.4);

NETWORK
TITLE =EA7_V2  Molch Anlage 7
// Act 013
// Box           : VSA7
// Input address : I24.5
// Output address: Q46.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.EA7_V2,
           Typ                      := 3,
           FBa                      := I     24.5,
           FBa2                     := #xTmp,
           Out                      := Q     46.5);

NETWORK
TITLE =EA7_V31  Molch Anlage 7
// Act 014
// Box           : VSA7
// Output address: Q46.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.EA7_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     46.0);

NETWORK
TITLE =EA7_V32  Molch Anlage 7
// Act 015
// Box           : VSA7
// Output address: Q46.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.EA7_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     46.1);

NETWORK
TITLE =EA7_V41  Molch Anlage 7
// Act 016
// Box           : VSA7
// Input address : I24.2
// Output address: Q46.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.EA7_V41,
           Typ                      := 3,
           FBa                      := I     24.2,
           FBa2                     := #xTmp,
           Out                      := Q     46.2);

NETWORK
TITLE =EA7_V42  Molch Anlage 7
// Act 017
// Box           : VSA7
// Input address : I24.3
// Output address: Q46.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.EA7_V42,
           Typ                      := 3,
           FBa                      := I     24.3,
           FBa2                     := #xTmp,
           Out                      := Q     46.3);

NETWORK
TITLE =LA_S2_MOLCH_START  LAMPE LDT AB
// Act 019
// Box           : FRM-A7
// Output address: Q59.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.LA_S2_MOLCH_START,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.7);

NETWORK
TITLE =Molch ist unterwegs (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.Act20,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.3);

NETWORK
TITLE =Molch in Endposition (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.Act21,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.6);

NETWORK
TITLE =A7_GOA_701  Meldung an Fueller/Sirup Anl.7
// Act 022
// Box           : FRM-A7
// Output address: Q59.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_GOA_701,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.2);

NETWORK
TITLE =A7_GOA_702  Meldung an Fueller/Mixer Anl.7
// Act 023
// Box           : FRM-A7
// Output address: Q59.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_GOA_702,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.5);

NETWORK
TITLE =A7_GOA_703  Meldung an Fueller/Mixer Anl.7
// Act 024
// Box           : FRM-A7
// Output address: Q59.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_GOA_703,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     59.4);

NETWORK
TITLE =A7_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 028
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage7.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   53.0);

NETWORK
TITLE =A7_Molch_Sirup  "1"=Molch ist im Sirupraum
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage7.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   52.0);

NETWORK
TITLE =A7_Molch_Anlage  "1"=Molch ist an der Anlage
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage7.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   52.1);

NETWORK
TITLE =A7_Molch_PRO  "1"=Molch ist bereit fr Produktion
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage7.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   52.2);

NETWORK
TITLE =A7_Molch_CIP  "1"=Molch ist bereit fr CIP
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage7.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   52.3);

NETWORK
TITLE =A7_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage7.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5070.A7_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   52.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4071
TITLE =U107: Transfer Plant 7
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4071.DBX 1357.7; 
      CC    FB  4079; // "U107Sim"
      A     DB4071.DBX   17.3; 
      =     DB4071.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4070.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4071.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4075.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4071.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4075; // U107Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB4073.DBX   43.1; 
      S     DB4073.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4080
TITLE =U108: Sirup Anlage  8
FAMILY : BOTEC_F1
NAME : U108A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4080.DBW    0; 
      T     #UnitNo; 
      L     DB4080.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5085.unv001,
           ValExt                   := DB5085.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5085.unv002,
           ValExt                   := DB5085.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5085.unv003,
           ValExt                   := DB5085.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5085.unv004,
           ValExt                   := DB5085.DBD  618);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5087.msg001,
           MsgBit                   := DB5087.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5087.msg002,
           MsgBit                   := DB5087.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5087.msg003,
           MsgBit                   := DB5087.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4081
TITLE =U108: Transfer Plant 8
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4081.DBX 1357.7; 
      CC    FB  4089; // "U108Sim"
      A     DB4081.DBX   17.3; 
      =     DB4081.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4080.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4081.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4085.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4081.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4085; // U108Com

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U108UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U108UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Universal Value 03
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U108UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U108UnVD".unv004.ValExt

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5087.DBX   80.7; 
      =     DB5087.DBX   81.4; 

      CLR   ; 
      =     DB5087.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5087.DBX  140.7; 
      =     DB5087.DBX  141.4; 

      CLR   ; 
      =     DB5087.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5087.DBX  200.7; 
      =     DB5087.DBX  201.4; 

      CLR   ; 
      =     DB5087.DBX  202.7; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// sequencer ----------------------------------------------------------------
      A     DB4083.DBX   43.1; 
      S     DB4083.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 




MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4090
TITLE =U109: Sirup Anlage  9
FAMILY : BOTEC_F1
NAME : U109A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4090.DBW    0; 
      T     #UnitNo; 
      L     DB4090.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5095.unv001,
           ValExt                   := DB5095.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5095.unv002,
           ValExt                   := DB5095.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5095.unv003,
           ValExt                   := DB5095.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5095.unv004,
           ValExt                   := DB5095.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SA9_31_oben SpI 004 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_SA9_31_oben,
           SpIBit                   := I     75.0);

// GOA_SA9_32_unten SpI 005 Korb im Sirupraum in unterer Position
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_SA9_32_unten,
           SpIBit                   := I     75.1);

// GOA_SA9_1 SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_SA9_1,
           SpIBit                   := I     74.5);

// GOA_SA9_2 SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_SA9_2,
           SpIBit                   := I     74.6);

// SK_A9_Molch_Abbruch_DT SpI 008 MOLCH A9 Drucktaste Abbruch Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.SK_A9_Molch_Abbruch_DT,
           SpIBit                   := I    180.5);

// SK_A9_START_Molch_LDT SpI 009 MOLCH A9 L-Drucktaste Start Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.SK_A9_START_Molch_LDT,
           SpIBit                   := I    181.0);

// A9_Sk1_Handklappe SpI 010 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.A9_Sk1_Handklappe,
           SpIBit                   := I     75.2);

// GOA_EA9_31_oben SpI 014 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_EA9_31_oben,
           SpIBit                   := I    176.5);

// GOA_EA9_32_unten SpI 015 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_EA9_32_unten,
           SpIBit                   := I    176.6);

// GOA_EA9_3 SpI 016 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_EA9_3,
           SpIBit                   := I    176.3);

// GOA_EA9_4 SpI 017 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_EA9_4,
           SpIBit                   := I    176.4);

// A9_SS_FRG_MOLCH SpI 018 Anlage 9 Schlsselschalter Freigabe Molch
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.A9_SS_FRG_MOLCH,
           SpIBit                   := I    177.4);

// A9_Molch_LDT_Start SpI 019 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.A9_Molch_LDT_Start,
           SpIBit                   := I    176.7);

// A9_Molch_LDT_Stop SpI 020 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.A9_Molch_LDT_Stop,
           SpIBit                   := I    177.5);

// A9_K2_Handklappe SpI 021 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.A9_K2_Handklappe,
           SpIBit                   := I    177.2);

// GOA_901 SpI 022 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_901,
           SpIBit                   := I    176.0);

// GOA_902 SpI 023 gendert 07.11.01
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_902,
           SpIBit                   := I    176.1);

// EA9_K1_Handklappe SpI 024 Handklappe Fueller 9
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.EA9_K1_Handklappe,
           SpIBit                   := I    177.7);

// GOA_904 SpI 025 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5091.GOA_904,
           SpIBit                   := I    177.1);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5097.msg001,
           MsgBit                   := DB5097.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5097.msg002,
           MsgBit                   := DB5097.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5097.msg003,
           MsgBit                   := DB5097.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A9_MWV1  Ansteuerung A9_MWV1
// Act 002
// Box           : VSSK
// Input address : I73.2
// Output address: Q53.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_MWV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     73.2,
           Out                      := Q     53.2);

NETWORK
TITLE =SA9_V2  Ansteuerung SA9_V2
// Act 003
// Box           : VSSK
// Input address : I73.3
// Output address: Q53.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SA9_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     73.3,
           Out                      := Q     53.3);

NETWORK
TITLE =SA9_V31  Ansteuerung SA9_V31 ohne RM
// Act 004
// Box           : VSSK
// Output address: Q52.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SA9_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     52.6);

NETWORK
TITLE =SA9_V32  Ansteuerung SA9_V32 ohne RM
// Act 005
// Box           : VSSK
// Output address: Q52.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SA9_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     52.7);

NETWORK
TITLE =SA9_V41  Ansteuerung SA9_V41
// Act 006
// Box           : VSSK
// Input address : I73.0
// Output address: Q53.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SA9_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     73.0,
           Out                      := Q     53.0);

NETWORK
TITLE =SA9_V42  Ansteuerung SA9_V42
// Act 007
// Box           : VSSK
// Input address : I73.1
// Output address: Q53.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SA9_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     73.1,
           Out                      := Q     53.1);

NETWORK
TITLE =SK_A9_Abbruch_L  Anlage 9 Lampe Abbruch IM SIRUPRAUM
// Act 008
// Box           : AB-SK
// Output address: Q180.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SK_A9_Abbruch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.7);

NETWORK
TITLE =SK_A9_START_Molch_L  Anlage 9 Lampe Start Molch IM SIRUPRAUM
// Act 009
// Box           : AB-SK
// Output address: Q181.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SK_A9_START_Molch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    181.0);

NETWORK
TITLE =SK_A9_MOLCH_BEI_A9_L  Anlage 9 Lampe Molch an A11 IM SIRUPRAUM
// Act 010
// Box           : AB-SK
// Output address: Q180.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SK_A9_MOLCH_BEI_A9_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.5);

NETWORK
TITLE =SK_A9_MOLCH_IN_SK_L  Anlage 9 Lampe Molch im SK IM SIRUPRAUM
// Act 011
// Box           : AB-SK
// Output address: Q180.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.SK_A9_MOLCH_IN_SK_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    180.6);

NETWORK
TITLE =EA9_V1  A9 V1
// Act 012
// Box           : VSA11
// Input address : I174.4
// Output address: Q174.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    174.4,
           Out                      := Q    174.4);

NETWORK
TITLE =EA9_V2  A9 V2
// Act 013
// Box           : VSA11
// Input address : I174.5
// Output address: Q174.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    174.5,
           Out                      := Q    174.5);

NETWORK
TITLE =EA9_V31  A9 V31 ohne RM
// Act 014
// Box           : VSA11
// Output address: Q174.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    174.0);

NETWORK
TITLE =EA9_V32  A9 V31 ohne RM
// Act 015
// Box           : VSA11
// Output address: Q174.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    174.1);

NETWORK
TITLE =EA9_V41  A9 V41
// Act 016
// Box           : VSA11
// Input address : I174.2
// Output address: Q174.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    174.2,
           Out                      := Q    174.2);

NETWORK
TITLE =EA9_V42  A9 V42
// Act 017
// Box           : VSA11
// Input address : I174.3
// Output address: Q174.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    174.3,
           Out                      := Q    174.3);

NETWORK
TITLE =EA9_MOLCH_LDT_Start  Lampe Start Molchen an Anlage 9
// Act 019
// Box           : VSA11
// Output address: Q176.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.EA9_MOLCH_LDT_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    176.7);

NETWORK
TITLE =Molch ist unterwegs (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.Act20,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.3);

NETWORK
TITLE =Molch in Endposition (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.Act21,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.7);

NETWORK
TITLE =A9_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 028
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage9.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   57.0);

NETWORK
TITLE =A9_Molch_Sirup  "1"=Molch ist im Sirupraum 
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage9.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   56.0);

NETWORK
TITLE =A9_Molch_Anlage  "1"=Molch ist an der Anlage 
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage9.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   56.1);

NETWORK
TITLE =A9_Molch_PRO  "1"=Molch ist bereit fr Produktion 
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage9.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   56.2);

NETWORK
TITLE =A9_Molch_CIP  "1"=Molch ist bereit fr CIP 
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage9.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   56.3);

NETWORK
TITLE =A9_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage9.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5090.A9_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   56.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4091
TITLE =U109: Transfer Plant 9
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4091.DBX 1357.7; 
      CC    FB  4099; // "U109Sim"
      A     DB4091.DBX   17.3; 
      =     DB4091.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4090.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  4095; // U109Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 


// sequencer ----------------------------------------------------------------
      A     DB4093.DBX   43.1; 
      S     DB4093.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4110
TITLE =U111: Sirup Anlage 11
FAMILY : BOTEC_F1
NAME : U111A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      BEU   ; 

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4110.DBW    0; 
      T     #UnitNo; 
      L     DB4110.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5115.unv001,
           ValExt                   := DB5115.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5115.unv002,
           ValExt                   := DB5115.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5115.unv003,
           ValExt                   := DB5115.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5115.unv004,
           ValExt                   := DB5115.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// U111_SpI034 SpI 034 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5111.U111_SpI034,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5117.msg001,
           MsgBit                   := DB5117.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5117.msg002,
           MsgBit                   := DB5117.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5117.msg003,
           MsgBit                   := DB5117.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =M11_K2_Handklappe  Mixer A11 Handklappe Sirupleitung 
// Act 020
// Box           : FM-A11
// Output address: Q171.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.M11_K2_Handklappe,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.6);

NETWORK
TITLE =A11_GOA_1101  Mixer A11 KEINE ANSTEUERUNG!!!
// Act 022
// Box           : FM-A11
// Output address: Q171.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_GOA_1101,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.2);

NETWORK
TITLE =A11_GOA_1102  Mixer A11 KEINE ANSTEUERUNG!!!
// Act 023
// Box           : FM-A11
// Output address: Q171.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_GOA_1102,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.4);

NETWORK
TITLE =A11_GOA_1103  Mixer A11 KEINE ANSTEUERUNG!!!
// Act 024
// Box           : FM-A11
// Output address: Q171.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_GOA_1103,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    171.5);

NETWORK
TITLE =A11_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 028
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage11.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   61.0);

NETWORK
TITLE =M11_MOLCH_ENDPOSITION  Mixer A11 Molch am Mixer in Endposition 
// Act 034
// Box           : FM-A11
// Output address: Q171.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.M11_MOLCH_ENDPOSITION,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := #xTmp);//"M11_MOLCH_ENDPOSITIONO"

NETWORK
TITLE =A11_Molch_Sirup  "1"=Molch ist im Sirupraum 
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage11.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   60.0);

NETWORK
TITLE =A11_Molch_Anlage  "1"=Molch ist an der Anlage 
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage11.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   60.1);

NETWORK
TITLE =A11_Molch_PRO  "1"=Molch ist bereit fr Produktion 
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage11.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   60.2);

NETWORK
TITLE =A11_Molch_CIP  "1"=Molch ist bereit fr CIP 
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage11.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   60.3);

NETWORK
TITLE =A11_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage11.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5110.A11_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   60.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4111
TITLE =U111: Transfer Plant 11
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4111.DBX 1357.7; 
      CC    FB  4119; // "U111Sim"
      A     DB4111.DBX   17.3; 
      =     DB4111.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4110.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  4115; // U111Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB4113.DBX   43.1; 
      S     DB4113.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4120
TITLE =U112: Sirup Anlage 12
FAMILY : BOTEC_F1
NAME : U112A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4120.DBW    0; 
      T     #UnitNo; 
      L     DB4120.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5125.unv001,
           ValExt                   := DB5125.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5125.unv002,
           ValExt                   := DB5125.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5125.unv003,
           ValExt                   := DB5125.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5125.unv004,
           ValExt                   := DB5125.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SA12_31_oben SpI 004 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_SA12_31_oben,
           SpIBit                   := I    267.6);

// GOA_SA12_41_unten SpI 005 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_SA12_41_unten,
           SpIBit                   := I    267.7);

// GOA_SA12_1 SpI 006 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_SA12_1,
           SpIBit                   := I    267.4);

// GOA_SA12_2 SpI 007 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_SA12_2,
           SpIBit                   := I    267.5);

// SK_A12_Molch_Abbruch_DT SpI 008 MOLCH A12 Drucktaste Abbruch Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.SK_A12_Molch_Abbruch_DT,
           SpIBit                   := I    264.0);

// SK_A12_START_Molch_LDT SpI 009 MOLCH A12 L-Drucktaste Start Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.SK_A12_START_Molch_LDT,
           SpIBit                   := I    264.3);

// A12_K1_Handklappe SpI 010 Handklappe Sirupraum Molch Anlage 12
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.A12_K1_Handklappe,
           SpIBit                   := I    267.3);

// GOA_EA12_31_oben SpI 014 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_EA12_31_oben,
           SpIBit                   := I    262.5);

// GOA_EA12_32_unten SpI 015 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_EA12_32_unten,
           SpIBit                   := I    262.6);

// GOA_EA12_3 SpI 016 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_EA12_3,
           SpIBit                   := I    262.3);

// GOA_EA12_4 SpI 017 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_EA12_4,
           SpIBit                   := I    262.4);

// A12_SS_FRG_MOLCH SpI 018 Anlage 12 Schlsselschalter Freigabe Molch
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.A12_SS_FRG_MOLCH,
           SpIBit                   := I    263.4);

// A12_Molch_LDT_Start SpI 019 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.A12_Molch_LDT_Start,
           SpIBit                   := I    262.7);

// A12_Molch_LDT_Stop SpI 020 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.A12_Molch_LDT_Stop,
           SpIBit                   := I    263.5);

// A12_K2_Handklappe SpI 021 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.A12_K2_Handklappe,
           SpIBit                   := I    263.2);

// GOA_1201 SpI 022 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_1201,
           SpIBit                   := I    262.0);

// GOA_1202 SpI 023 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_1202,
           SpIBit                   := I    262.1);

// GOA_1204 SpI 025 Schwenkbogen CIP 3
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5121.GOA_1204,
           SpIBit                   := I    263.3);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5127.msg001,
           MsgBit                   := DB5127.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5127.msg002,
           MsgBit                   := DB5127.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5127.msg003,
           MsgBit                   := DB5127.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A12_MWV1  MOLCH A12 Ansteuerung MWV1
// Act 002
// Box           : VS-SRA
// Input address : I189.2
// Output address: Q189.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_MWV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    189.2,
           Out                      := Q    189.2);

NETWORK
TITLE =SA12_V2  MOLCH SA12 Ansteuerung V2
// Act 003
// Box           : VS-SRA
// Input address : I189.3
// Output address: Q189.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SA12_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    189.3,
           Out                      := Q    189.3);

NETWORK
TITLE =SA12_V31  MOLCH SA12 Ansteuerung V31 (ohne RM)
// Act 004
// Box           : VS-SRA
// Output address: Q188.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SA12_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    188.6);

NETWORK
TITLE =SA12_V32  MOLCH SA12 Ansteuerung V32 (ohne RM)
// Act 005
// Box           : VS-SRA
// Output address: Q188.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SA12_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    188.7);

NETWORK
TITLE =SA12_V41  MOLCH SA12 Ansteuerung V41
// Act 006
// Box           : VS-SRA
// Input address : I189.0
// Output address: Q189.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SA12_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    189.0,
           Out                      := Q    189.0);

NETWORK
TITLE =SA12_V42  MOLCH SA12 Ansteuerung V42
// Act 007
// Box           : VS-SRA
// Input address : I189.1
// Output address: Q189.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SA12_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    189.1,
           Out                      := Q    189.1);

NETWORK
TITLE =SK_A12_Abbruch_L  Anlage 12 Lampe Abbruch IM SIRUPRAUM
// Act 008
// Box           : AB1SK
// Output address: Q264.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SK_A12_Abbruch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.2);

NETWORK
TITLE =SK_A12_START_Molch_L  Anlage 12 Lampe Start Molch IM SIRUPRAUM
// Act 009
// Box           : AB1SK
// Output address: Q264.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SK_A12_START_Molch_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.3);

NETWORK
TITLE =A12_MOLCH_A12_L  Anlage 12 Lampe Molch an A12 IM SIRUPRAUM
// Act 010
// Box           : AB1SK
// Output address: Q264.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_MOLCH_A12_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.0);

NETWORK
TITLE =SK_A12_MOLCH_IN_SK_L  Anlage 12 Lampe Molch im SK IM SIRUPRAUM
// Act 011
// Box           : AB1SK
// Output address: Q264.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.SK_A12_MOLCH_IN_SK_L,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    264.1);

NETWORK
TITLE =EA12_V1  A12 V1
// Act 012
// Box           : VSA12
// Input address : I260.4
// Output address: Q260.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    260.4,
           Out                      := Q    260.4);

NETWORK
TITLE =EA12_V2  A12 V2
// Act 013
// Box           : VSA12
// Input address : I260.5
// Output address: Q260.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    260.5,
           Out                      := Q    260.5);

NETWORK
TITLE =EA12_V31  A12 V31 ohne RM
// Act 014
// Box           : VSA12
// Input address : I260.0
// Output address: Q260.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    260.0,
           Out                      := Q    260.0);

NETWORK
TITLE =EA12_V32  A12 V31 ohne RM
// Act 015
// Box           : VSA12
// Input address : I260.1
// Output address: Q260.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := I    260.1,
           Out                      := Q    260.1);

NETWORK
TITLE =EA12_V41  A12 V41
// Act 016
// Box           : VSA12
// Input address : I260.2
// Output address: Q260.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    260.2,
           Out                      := Q    260.2);

NETWORK
TITLE =EA12_V42  A12 V42
// Act 017
// Box           : VSA12
// Input address : I260.3
// Output address: Q260.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    260.3,
           Out                      := Q    260.3);

NETWORK
TITLE =EA12_MOLCH_LDT_Start  Leuchtdrucktaster START Molch Anlage 12
// Act 019
// Box           : VSA12
// Output address: Q262.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.EA12_MOLCH_LDT_Start,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    262.7);

NETWORK
TITLE =Molch ist unterwegs (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.Act20,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    271.3);

NETWORK
TITLE =Molch in Endposition (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.Act21,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    271.7);

NETWORK
TITLE =A12_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 028
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage12.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   63.0);

NETWORK
TITLE =A12_Molch_Sirup  "1"=Molch ist im Sirupraum 
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage12.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   62.0);

NETWORK
TITLE =A12_Molch_Anlage  "1"=Molch ist an der Anlage 
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage12.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   62.1);

NETWORK
TITLE =A12_Molch_PRO  "1"=Molch ist bereit fr Produktion 
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage12.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   62.2);

NETWORK
TITLE =A12_Molch_CIP  "1"=Molch ist bereit fr CIP 
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage12.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   62.3);

NETWORK
TITLE =A12_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage12.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5120.A12_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   62.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4121
TITLE =U112: Transfer Plant 12
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4121.DBX 1357.7; 
      CC    FB  4129; // "U112Sim"
      A     DB4121.DBX   17.3; 
      =     DB4121.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4120.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  4125; // U112Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 


// sequencer ----------------------------------------------------------------
      A     DB4123.DBX   43.1; 
      S     DB4123.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4140
TITLE =U114: Sirup Anlage 14
FAMILY : BOTEC_F1
NAME : U114A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4140.DBW    0; 
      T     #UnitNo; 
      L     DB4140.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5145.unv001,
           ValExt                   := DB5145.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5145.unv002,
           ValExt                   := DB5145.DBD  362);

// unv003 UnV 003 Universal Value 03
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5145.unv003,
           ValExt                   := DB5145.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5145.unv004,
           ValExt                   := DB5145.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// GOA_SA14_31_oben SpI 004 GOA_SA14_31_oben
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_SA14_31_oben,
           SpIBit                   := I    266.4);

// GOA_SA14_32_unten SpI 005 GOA_SA14_32_unten
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_SA14_32_unten,
           SpIBit                   := I    266.5);

// GOA_SA14_2 SpI 006 GOA_SA14_2
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_SA14_2,
           SpIBit                   := I    266.3);

// GOA_SA14_1 SpI 007 GOA_SA14_1
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_SA14_1,
           SpIBit                   := I    266.2);

// SK_A14_Molch_Abbruch_DT SpI 008 MOLCH A14 Drucktaste Abbruch Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.SK_A14_Molch_Abbruch_DT,
           SpIBit                   := I    265.2);

// SK_A14_START_Molch_LDT SpI 009 MOLCH A14 L-Drucktaste Start Sirupraum
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.SK_A14_START_Molch_LDT,
           SpIBit                   := I    265.5);

// GOA_EA14_31_OBEN SpI 014 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_EA14_31_OBEN,
           SpIBit                   := I     98.5);

// GOA_EA14_32_UNTEN SpI 015 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_EA14_32_UNTEN,
           SpIBit                   := I     98.6);

// GOA_EA14_3 SpI 016 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_EA14_3,
           SpIBit                   := I     98.3);

// GOA_EA14_4 SpI 017 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_EA14_4,
           SpIBit                   := I     98.4);

// A14_FREIGABE_MOLCH_SS SpI 018 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.A14_FREIGABE_MOLCH_SS,
           SpIBit                   := I     99.4);

// A14_MOLCH_START_LDT SpI 019 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.A14_MOLCH_START_LDT,
           SpIBit                   := I     98.7);

// A14_MOLCH_STOP_DT SpI 020 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.A14_MOLCH_STOP_DT,
           SpIBit                   := I     99.5);

// GOA_1405 SpI 021 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_1405,
           SpIBit                   := I     99.3);

// GOA_1401 SpI 022 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_1401,
           SpIBit                   := I     98.0);

// GOA_1402 SpI 023 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_1402,
           SpIBit                   := I     98.1);

// GOA_1404 SpI 025 
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5141.GOA_1404,
           SpIBit                   := I     99.2);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5147.msg001,
           MsgBit                   := DB5147.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5147.msg002,
           MsgBit                   := DB5147.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5147.msg003,
           MsgBit                   := DB5147.DBX  202.7);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 

NETWORK
TITLE =A14_MWV1  MOLCH A14 Ansteuerung MWV1
// Act 002
// Box           : VS-SRA
// Input address : I190.6
// Output address: Q190.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_MWV1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    190.6,
           Out                      := Q    190.6);

NETWORK
TITLE =SA14_V2  MOLCH SA14 Ansteuerung V2
// Act 003
// Box           : VS-SRA
// Input address : I190.7
// Output address: Q190.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SA14_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    190.7,
           Out                      := Q    190.7);

NETWORK
TITLE =SA14_V31  MOLCH SA14 Ansteuerung V31 (ohne RM)
// Act 004
// Box           : VS-SRA
// Output address: Q190.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SA14_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    190.2);

NETWORK
TITLE =SA14_V32  MOLCH SA14 Ansteuerung V32 (ohne RM)
// Act 005
// Box           : VS-SRA
// Output address: Q190.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SA14_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    190.3);

NETWORK
TITLE =SA14_V41  MOLCH SA14 Ansteuerung V41
// Act 006
// Box           : VS-SRA
// Input address : I190.4
// Output address: Q190.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SA14_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    190.4,
           Out                      := Q    190.4);

NETWORK
TITLE =SA14_V42  MOLCH SA14 Ansteuerung V42
// Act 007
// Box           : VS-SRA
// Input address : I190.5
// Output address: Q190.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SA14_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I    190.5,
           Out                      := Q    190.5);

NETWORK
TITLE =SK_A14_Abbruch_Stoerung  Anlage 14 Lampe Abbruch IM SIRUPRAUM
// Act 008
// Box           : AB1SK
// Output address: Q265.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SK_A14_Abbruch_Stoerung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    265.4);

NETWORK
TITLE =SK_A14_Molch_Start_LDT  Anlage 14 Lampe Start Molch IM SIRUPRAUM
// Act 009
// Box           : AB1SK
// Output address: Q265.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SK_A14_Molch_Start_LDT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    265.5);

NETWORK
TITLE =SK_A14_Molch_bei_A14  Anlage 14 Lampe Molch an A11 IM SIRUPRAUM
// Act 010
// Box           : AB1SK
// Output address: Q265.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SK_A14_Molch_bei_A14,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    265.2);

NETWORK
TITLE =SK_A14_Molch_in_SK  Anlage 14 Lampe Molch im SK IM SIRUPRAUM
// Act 011
// Box           : AB1SK
// Output address: Q265.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.SK_A14_Molch_in_SK,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    265.3);

NETWORK
TITLE =EA14_V1  
// Act 012
// Box           : VSA14
// Input address : I96.4
// Output address: Q96.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.EA14_V1,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     96.4,
           Out                      := Q     96.4);

NETWORK
TITLE =EA14_V2  
// Act 013
// Box           : VSA14
// Input address : I96.5
// Output address: Q96.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.EA14_V2,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     96.5,
           Out                      := Q     96.5);

NETWORK
TITLE =EA14_V31  EA14 V31 (ohne Rckmeldung)
// Act 014
// Box           : VSA14
// Output address: Q96.0
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.EA14_V31,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     96.0);

NETWORK
TITLE =EA14_V32  EA14 V32 (ohne Rckmeldung)
// Act 015
// Box           : VSA14
// Output address: Q96.1
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.EA14_V32,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     96.1);

NETWORK
TITLE =EA14_V41  
// Act 016
// Box           : VSA14
// Input address : I96.2
// Output address: Q96.2
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.EA14_V41,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     96.2,
           Out                      := Q     96.2);

NETWORK
TITLE =EA14_V42  
// Act 017
// Box           : VSA14
// Input address : I96.3
// Output address: Q96.3
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.EA14_V42,
           Typ                      := 1,
           FBa                      := #xTmp,
           FBa2                     := I     96.3,
           Out                      := Q     96.3);

NETWORK
TITLE =A14_START_MOLCH_LDT  
// Act 019
// Box           : VSA14
// Output address: Q98.7
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_START_MOLCH_LDT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     98.7);

NETWORK
TITLE =Molch ist unterwegs (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.Act20,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    911.5);

NETWORK
TITLE =Molch in Endposition (Mixer) 


      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.Act21,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q    912.6);

NETWORK
TITLE =A14_POS_MOLCH  
// Act 030
// Box           : VSA14
// Output address: Q98.4
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_POS_MOLCH,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     98.4);

NETWORK
TITLE =A14_LAUFZEIT_MOLCH  
// Act 031
// Box           : VSA14
// Output address: Q98.5
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_LAUFZEIT_MOLCH,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     98.5);

NETWORK
TITLE =A14_TEMP_ERREICHT  
// Act 032
// Box           : VSA14
// Output address: Q98.6
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_TEMP_ERREICHT,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := Q     98.6);

NETWORK
TITLE =A14_Schwenkbogen  "1"=CIP  "0"=Produktion
// Act 045
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage14.Schwenkbogen
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_Schwenkbogen,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   67.0);

NETWORK
TITLE =A14_Molch_Sirup  "1"=Molch ist im Sirupraum 
// Act 046
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage14.Molch_Sirup
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_Molch_Sirup,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   66.0);

NETWORK
TITLE =A14_Molch_Anlage  "1"=Molch ist an der Anlage 
// Act 047
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage14.Molch_Anlage
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_Molch_Anlage,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   66.1);

NETWORK
TITLE =A14_Molch_PRO  "1"=Molch ist bereit fr Produktion 
// Act 048
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage14.Molch_PRO
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_Molch_PRO,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   66.2);

NETWORK
TITLE =A14_Molch_CIP  "1"=Molch ist bereit fr CIP 
// Act 049
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage14.Molch_CIP
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_Molch_CIP,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   66.3);

NETWORK
TITLE =A14_Sirupanforderung  
// Act 050
// Box           : Sirup
// Output address: DB_SEND_DOEHLER.Anlage14.Sirupanforderung
      CALL FC    70 (
           UnitNo                   := #UnitNo,
           ActRec                   := DB5140.A14_Sirupanforderung,
           Typ                      := 0,
           FBa                      := #xTmp,
           FBa2                     := #xTmp,
           Out                      := DB404.DBX   66.4);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4141
TITLE =U114: Transfer Plant 14
FAMILY : BOTEC_F1
NAME : UniE
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4141.DBX 1357.7; 
      CC    FB  4149; // "U114Sim"
      A     DB4141.DBX   17.3; 
      =     DB4141.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4140.DBW    0; 
      T     #UnitNo; 

// communication ------------------------------------------------------------
      UC    FB  4145; // U114Com

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// sequencer ----------------------------------------------------------------
      A     DB4143.DBX   43.1; 
      S     DB4143.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4210
TITLE =U121: Planung Transfer VE1
FAMILY : BOTEC_F1
NAME : U121A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4210.DBW    0; 
      T     #UnitNo; 
      L     DB4210.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5213.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5213.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5213.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5215.unv001,
           ValExt                   := DB5215.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5215.unv002,
           ValExt                   := DB5215.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5215.unv003,
           ValExt                   := DB5215.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5215.unv004,
           ValExt                   := DB5215.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5211.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5211.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5211.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5211.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5217.msg001,
           MsgBit                   := DB5217.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5217.msg002,
           MsgBit                   := DB5217.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5217.msg003,
           MsgBit                   := DB5217.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5216.PID01,
           SpExt                    := DB5216.DBD  234,
           PVal                     := DB5216.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4211
TITLE =U121: Planung Transfer VE1
FAMILY : BOTEC_F1
NAME : U121E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4211.DBX 1357.7; 
      CC    FB  4219; // "U121Sim"
      A     DB4211.DBX   17.3; 
      =     DB4211.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4210.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4211.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4215.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4211.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4215; // U121Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4211.DBD 1118; // !!! insert correct SFM !!!
      T     DB5213.DBD  238; 

      SET   ; 
      =     DB5213.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4211.DBD 1118; // !!! insert correct SFM !!!
      T     DB5213.DBD  358; 

      SET   ; 
      =     DB5213.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4211.DBD 1118; // !!! insert correct SFM !!!
      T     DB5213.DBD  478; 

      SET   ; 
      =     DB5213.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U121UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U121UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U121UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U121UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5211.DBX   81.4; 
      =     DB5211.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5211.DBX  141.4; 
      =     DB5211.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5211.DBX  201.4; 
      =     DB5211.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5211.DBX  261.4; 
      =     DB5211.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5217.DBX   80.7; 
      =     DB5217.DBX   81.4; 

      CLR   ; 
      =     DB5217.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5217.DBX  140.7; 
      =     DB5217.DBX  141.4; 

      CLR   ; 
      =     DB5217.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5217.DBX  200.7; 
      =     DB5217.DBX  201.4; 

      CLR   ; 
      =     DB5217.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U121ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5216.DBX  203.2; 
      =     DB5216.DBX  203.5; 

// enable alarm -------------------------
      A     DB5216.DBX  203.5; 
      A     DB5216.DBX  201.4; 
      AN    DB5216.DBX  203.1; 
      AN    DB5216.DBX  203.3; 
      AN    DB5216.DBX  203.4; 
      =     DB5216.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4211.DBD 1118; // !!! insert correct SFM !!!
      T     DB5216.DBD  234; 

// static value to controller ----------
      L     DB4211.DBD 1118; // !!! insert correct SFM !!!
      T     DB5216.DBD  238; 

// process value to controller ----------
      L     DB5213.DBD   26; // !!! insert correct AnI !!!
      T     DB5216.DBD  254; 

// low/high value to controller ---------
      L     DB5213.DBD   30; // !!! insert correct AnI !!!
      T     DB5216.DBD  218; 

      L     DB5213.DBD   34; // !!! insert correct AnI !!!
      T     DB5216.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5213.DBD  146; 
      T     DB4211.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5213.DBD  266; 
      T     DB4211.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5213.DBD  386; 
      T     DB4211.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4213.DBX   43.1; 
      S     DB4213.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5216.DBX  201.4; 
      S     DB5216.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4220
TITLE =U122: Planung Transfer VE2
FAMILY : BOTEC_F1
NAME : U122A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4220.DBW    0; 
      T     #UnitNo; 
      L     DB4220.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5223.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5223.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5223.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5225.unv001,
           ValExt                   := DB5225.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5225.unv002,
           ValExt                   := DB5225.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5225.unv003,
           ValExt                   := DB5225.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5225.unv004,
           ValExt                   := DB5225.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5221.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5221.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5221.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5221.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5227.msg001,
           MsgBit                   := DB5227.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5227.msg002,
           MsgBit                   := DB5227.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5227.msg003,
           MsgBit                   := DB5227.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5226.PID01,
           SpExt                    := DB5226.DBD  234,
           PVal                     := DB5226.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4221
TITLE =U122: Planung Transfer VE2
FAMILY : BOTEC_F1
NAME : U122E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4221.DBX 1357.7; 
      CC    FB  4229; // "U122Sim"
      A     DB4221.DBX   17.3; 
      =     DB4221.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4220.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4221.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4225.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4221.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4225; // U122Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4221.DBD 1118; // !!! insert correct SFM !!!
      T     DB5223.DBD  238; 

      SET   ; 
      =     DB5223.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4221.DBD 1118; // !!! insert correct SFM !!!
      T     DB5223.DBD  358; 

      SET   ; 
      =     DB5223.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4221.DBD 1118; // !!! insert correct SFM !!!
      T     DB5223.DBD  478; 

      SET   ; 
      =     DB5223.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U122UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U122UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U122UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U122UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5221.DBX   81.4; 
      =     DB5221.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5221.DBX  141.4; 
      =     DB5221.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5221.DBX  201.4; 
      =     DB5221.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5221.DBX  261.4; 
      =     DB5221.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5227.DBX   80.7; 
      =     DB5227.DBX   81.4; 

      CLR   ; 
      =     DB5227.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5227.DBX  140.7; 
      =     DB5227.DBX  141.4; 

      CLR   ; 
      =     DB5227.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5227.DBX  200.7; 
      =     DB5227.DBX  201.4; 

      CLR   ; 
      =     DB5227.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U122ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5226.DBX  203.2; 
      =     DB5226.DBX  203.5; 

// enable alarm -------------------------
      A     DB5226.DBX  203.5; 
      A     DB5226.DBX  201.4; 
      AN    DB5226.DBX  203.1; 
      AN    DB5226.DBX  203.3; 
      AN    DB5226.DBX  203.4; 
      =     DB5226.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4221.DBD 1118; // !!! insert correct SFM !!!
      T     DB5226.DBD  234; 

// static value to controller ----------
      L     DB4221.DBD 1118; // !!! insert correct SFM !!!
      T     DB5226.DBD  238; 

// process value to controller ----------
      L     DB5223.DBD   26; // !!! insert correct AnI !!!
      T     DB5226.DBD  254; 

// low/high value to controller ---------
      L     DB5223.DBD   30; // !!! insert correct AnI !!!
      T     DB5226.DBD  218; 

      L     DB5223.DBD   34; // !!! insert correct AnI !!!
      T     DB5226.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5223.DBD  146; 
      T     DB4221.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5223.DBD  266; 
      T     DB4221.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5223.DBD  386; 
      T     DB4221.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4223.DBX   43.1; 
      S     DB4223.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5226.DBX  201.4; 
      S     DB5226.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4250
TITLE =U125: Planung Transfer A
FAMILY : BOTEC_F1
NAME : U125A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4250.DBW    0; 
      T     #UnitNo; 
      L     DB4250.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5253.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5253.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5253.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5255.unv001,
           ValExt                   := DB5255.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5255.unv002,
           ValExt                   := DB5255.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5255.unv003,
           ValExt                   := DB5255.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5255.unv004,
           ValExt                   := DB5255.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5251.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5251.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5251.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5251.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5257.msg001,
           MsgBit                   := DB5257.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5257.msg002,
           MsgBit                   := DB5257.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5257.msg003,
           MsgBit                   := DB5257.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5256.PID01,
           SpExt                    := DB5256.DBD  234,
           PVal                     := DB5256.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4251
TITLE =U125: Planung Transfer A
FAMILY : BOTEC_F1
NAME : U125E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4251.DBX 1357.7; 
      CC    FB  4259; // "U125Sim"
      A     DB4251.DBX   17.3; 
      =     DB4251.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4250.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4251.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4255.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4251.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4255; // U125Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4251.DBD 1118; // !!! insert correct SFM !!!
      T     DB5253.DBD  238; 

      SET   ; 
      =     DB5253.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4251.DBD 1118; // !!! insert correct SFM !!!
      T     DB5253.DBD  358; 

      SET   ; 
      =     DB5253.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4251.DBD 1118; // !!! insert correct SFM !!!
      T     DB5253.DBD  478; 

      SET   ; 
      =     DB5253.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U125UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U125UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U125UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U125UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5251.DBX   81.4; 
      =     DB5251.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5251.DBX  141.4; 
      =     DB5251.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5251.DBX  201.4; 
      =     DB5251.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5251.DBX  261.4; 
      =     DB5251.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5257.DBX   80.7; 
      =     DB5257.DBX   81.4; 

      CLR   ; 
      =     DB5257.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5257.DBX  140.7; 
      =     DB5257.DBX  141.4; 

      CLR   ; 
      =     DB5257.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5257.DBX  200.7; 
      =     DB5257.DBX  201.4; 

      CLR   ; 
      =     DB5257.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U125ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5256.DBX  203.2; 
      =     DB5256.DBX  203.5; 

// enable alarm -------------------------
      A     DB5256.DBX  203.5; 
      A     DB5256.DBX  201.4; 
      AN    DB5256.DBX  203.1; 
      AN    DB5256.DBX  203.3; 
      AN    DB5256.DBX  203.4; 
      =     DB5256.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4251.DBD 1118; // !!! insert correct SFM !!!
      T     DB5256.DBD  234; 

// static value to controller ----------
      L     DB4251.DBD 1118; // !!! insert correct SFM !!!
      T     DB5256.DBD  238; 

// process value to controller ----------
      L     DB5253.DBD   26; // !!! insert correct AnI !!!
      T     DB5256.DBD  254; 

// low/high value to controller ---------
      L     DB5253.DBD   30; // !!! insert correct AnI !!!
      T     DB5256.DBD  218; 

      L     DB5253.DBD   34; // !!! insert correct AnI !!!
      T     DB5256.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5253.DBD  146; 
      T     DB4251.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5253.DBD  266; 
      T     DB4251.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5253.DBD  386; 
      T     DB4251.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4253.DBX   43.1; 
      S     DB4253.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5256.DBX  201.4; 
      S     DB5256.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4260
TITLE =U126: Planung Transfer B
FAMILY : BOTEC_F1
NAME : U126A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4260.DBW    0; 
      T     #UnitNo; 
      L     DB4260.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5263.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5263.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5263.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5265.unv001,
           ValExt                   := DB5265.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5265.unv002,
           ValExt                   := DB5265.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5265.unv003,
           ValExt                   := DB5265.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5265.unv004,
           ValExt                   := DB5265.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5261.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5261.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5261.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5261.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5267.msg001,
           MsgBit                   := DB5267.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5267.msg002,
           MsgBit                   := DB5267.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5267.msg003,
           MsgBit                   := DB5267.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5266.PID01,
           SpExt                    := DB5266.DBD  234,
           PVal                     := DB5266.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4261
TITLE =U126: Planung Transfer B
FAMILY : BOTEC_F1
NAME : U126E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4261.DBX 1357.7; 
      CC    FB  4269; // "U126Sim"
      A     DB4261.DBX   17.3; 
      =     DB4261.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4260.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4261.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4265.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4261.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4265; // U126Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4261.DBD 1118; // !!! insert correct SFM !!!
      T     DB5263.DBD  238; 

      SET   ; 
      =     DB5263.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4261.DBD 1118; // !!! insert correct SFM !!!
      T     DB5263.DBD  358; 

      SET   ; 
      =     DB5263.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4261.DBD 1118; // !!! insert correct SFM !!!
      T     DB5263.DBD  478; 

      SET   ; 
      =     DB5263.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U126UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U126UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U126UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U126UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5261.DBX   81.4; 
      =     DB5261.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5261.DBX  141.4; 
      =     DB5261.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5261.DBX  201.4; 
      =     DB5261.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5261.DBX  261.4; 
      =     DB5261.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5267.DBX   80.7; 
      =     DB5267.DBX   81.4; 

      CLR   ; 
      =     DB5267.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5267.DBX  140.7; 
      =     DB5267.DBX  141.4; 

      CLR   ; 
      =     DB5267.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5267.DBX  200.7; 
      =     DB5267.DBX  201.4; 

      CLR   ; 
      =     DB5267.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U126ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5266.DBX  203.2; 
      =     DB5266.DBX  203.5; 

// enable alarm -------------------------
      A     DB5266.DBX  203.5; 
      A     DB5266.DBX  201.4; 
      AN    DB5266.DBX  203.1; 
      AN    DB5266.DBX  203.3; 
      AN    DB5266.DBX  203.4; 
      =     DB5266.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4261.DBD 1118; // !!! insert correct SFM !!!
      T     DB5266.DBD  234; 

// static value to controller ----------
      L     DB4261.DBD 1118; // !!! insert correct SFM !!!
      T     DB5266.DBD  238; 

// process value to controller ----------
      L     DB5263.DBD   26; // !!! insert correct AnI !!!
      T     DB5266.DBD  254; 

// low/high value to controller ---------
      L     DB5263.DBD   30; // !!! insert correct AnI !!!
      T     DB5266.DBD  218; 

      L     DB5263.DBD   34; // !!! insert correct AnI !!!
      T     DB5266.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5263.DBD  146; 
      T     DB4261.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5263.DBD  266; 
      T     DB4261.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5263.DBD  386; 
      T     DB4261.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4263.DBX   43.1; 
      S     DB4263.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5266.DBX  201.4; 
      S     DB5266.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4270
TITLE =U127: Planung Transfer CF
FAMILY : BOTEC_F1
NAME : U127A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4270.DBW    0; 
      T     #UnitNo; 
      L     DB4270.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5273.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5273.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5273.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5275.unv001,
           ValExt                   := DB5275.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5275.unv002,
           ValExt                   := DB5275.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5275.unv003,
           ValExt                   := DB5275.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5275.unv004,
           ValExt                   := DB5275.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5271.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5271.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5271.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5271.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5277.msg001,
           MsgBit                   := DB5277.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5277.msg002,
           MsgBit                   := DB5277.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5277.msg003,
           MsgBit                   := DB5277.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5276.PID01,
           SpExt                    := DB5276.DBD  234,
           PVal                     := DB5276.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4271
TITLE =U127: Planung Transfer CF
FAMILY : BOTEC_F1
NAME : U127E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4271.DBX 1357.7; 
      CC    FB  4279; // "U127Sim"
      A     DB4271.DBX   17.3; 
      =     DB4271.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4270.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4271.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4275.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4271.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4275; // U127Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4271.DBD 1118; // !!! insert correct SFM !!!
      T     DB5273.DBD  238; 

      SET   ; 
      =     DB5273.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4271.DBD 1118; // !!! insert correct SFM !!!
      T     DB5273.DBD  358; 

      SET   ; 
      =     DB5273.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4271.DBD 1118; // !!! insert correct SFM !!!
      T     DB5273.DBD  478; 

      SET   ; 
      =     DB5273.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U127UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U127UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U127UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U127UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5271.DBX   81.4; 
      =     DB5271.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5271.DBX  141.4; 
      =     DB5271.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5271.DBX  201.4; 
      =     DB5271.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5271.DBX  261.4; 
      =     DB5271.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5277.DBX   80.7; 
      =     DB5277.DBX   81.4; 

      CLR   ; 
      =     DB5277.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5277.DBX  140.7; 
      =     DB5277.DBX  141.4; 

      CLR   ; 
      =     DB5277.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5277.DBX  200.7; 
      =     DB5277.DBX  201.4; 

      CLR   ; 
      =     DB5277.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U127ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5276.DBX  203.2; 
      =     DB5276.DBX  203.5; 

// enable alarm -------------------------
      A     DB5276.DBX  203.5; 
      A     DB5276.DBX  201.4; 
      AN    DB5276.DBX  203.1; 
      AN    DB5276.DBX  203.3; 
      AN    DB5276.DBX  203.4; 
      =     DB5276.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4271.DBD 1118; // !!! insert correct SFM !!!
      T     DB5276.DBD  234; 

// static value to controller ----------
      L     DB4271.DBD 1118; // !!! insert correct SFM !!!
      T     DB5276.DBD  238; 

// process value to controller ----------
      L     DB5273.DBD   26; // !!! insert correct AnI !!!
      T     DB5276.DBD  254; 

// low/high value to controller ---------
      L     DB5273.DBD   30; // !!! insert correct AnI !!!
      T     DB5276.DBD  218; 

      L     DB5273.DBD   34; // !!! insert correct AnI !!!
      T     DB5276.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5273.DBD  146; 
      T     DB4271.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5273.DBD  266; 
      T     DB4271.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5273.DBD  386; 
      T     DB4271.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4273.DBX   43.1; 
      S     DB4273.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5276.DBX  201.4; 
      S     DB5276.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4280
TITLE =U128: Planung Transfer C.1
FAMILY : BOTEC_F1
NAME : U128A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4280.DBW    0; 
      T     #UnitNo; 
      L     DB4280.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5283.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5283.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5283.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5285.unv001,
           ValExt                   := DB5285.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5285.unv002,
           ValExt                   := DB5285.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5285.unv003,
           ValExt                   := DB5285.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5285.unv004,
           ValExt                   := DB5285.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5281.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5281.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5281.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5281.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5287.msg001,
           MsgBit                   := DB5287.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5287.msg002,
           MsgBit                   := DB5287.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5287.msg003,
           MsgBit                   := DB5287.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5286.PID01,
           SpExt                    := DB5286.DBD  234,
           PVal                     := DB5286.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4281
TITLE =U128: Planung Transfer C.1
FAMILY : BOTEC_F1
NAME : U128E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4281.DBX 1357.7; 
      CC    FB  4289; // "U128Sim"
      A     DB4281.DBX   17.3; 
      =     DB4281.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4280.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4281.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4285.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4281.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4285; // U128Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4281.DBD 1118; // !!! insert correct SFM !!!
      T     DB5283.DBD  238; 

      SET   ; 
      =     DB5283.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4281.DBD 1118; // !!! insert correct SFM !!!
      T     DB5283.DBD  358; 

      SET   ; 
      =     DB5283.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4281.DBD 1118; // !!! insert correct SFM !!!
      T     DB5283.DBD  478; 

      SET   ; 
      =     DB5283.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U128UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U128UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U128UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U128UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5281.DBX   81.4; 
      =     DB5281.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5281.DBX  141.4; 
      =     DB5281.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5281.DBX  201.4; 
      =     DB5281.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5281.DBX  261.4; 
      =     DB5281.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5287.DBX   80.7; 
      =     DB5287.DBX   81.4; 

      CLR   ; 
      =     DB5287.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5287.DBX  140.7; 
      =     DB5287.DBX  141.4; 

      CLR   ; 
      =     DB5287.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5287.DBX  200.7; 
      =     DB5287.DBX  201.4; 

      CLR   ; 
      =     DB5287.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U128ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5286.DBX  203.2; 
      =     DB5286.DBX  203.5; 

// enable alarm -------------------------
      A     DB5286.DBX  203.5; 
      A     DB5286.DBX  201.4; 
      AN    DB5286.DBX  203.1; 
      AN    DB5286.DBX  203.3; 
      AN    DB5286.DBX  203.4; 
      =     DB5286.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4281.DBD 1118; // !!! insert correct SFM !!!
      T     DB5286.DBD  234; 

// static value to controller ----------
      L     DB4281.DBD 1118; // !!! insert correct SFM !!!
      T     DB5286.DBD  238; 

// process value to controller ----------
      L     DB5283.DBD   26; // !!! insert correct AnI !!!
      T     DB5286.DBD  254; 

// low/high value to controller ---------
      L     DB5283.DBD   30; // !!! insert correct AnI !!!
      T     DB5286.DBD  218; 

      L     DB5283.DBD   34; // !!! insert correct AnI !!!
      T     DB5286.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5283.DBD  146; 
      T     DB4281.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5283.DBD  266; 
      T     DB4281.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5283.DBD  386; 
      T     DB4281.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4283.DBX   43.1; 
      S     DB4283.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5286.DBX  201.4; 
      S     DB5286.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4290
TITLE =U129: Planung Transfer B6F
FAMILY : BOTEC_F1
NAME : U129A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4290.DBW    0; 
      T     #UnitNo; 
      L     DB4290.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5293.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5293.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5293.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5295.unv001,
           ValExt                   := DB5295.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5295.unv002,
           ValExt                   := DB5295.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5295.unv003,
           ValExt                   := DB5295.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5295.unv004,
           ValExt                   := DB5295.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5291.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5291.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5291.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5291.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5297.msg001,
           MsgBit                   := DB5297.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5297.msg002,
           MsgBit                   := DB5297.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5297.msg003,
           MsgBit                   := DB5297.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5296.PID01,
           SpExt                    := DB5296.DBD  234,
           PVal                     := DB5296.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4291
TITLE =U129: Planung Transfer B6F
FAMILY : BOTEC_F1
NAME : U129E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4291.DBX 1357.7; 
      CC    FB  4299; // "U129Sim"
      A     DB4291.DBX   17.3; 
      =     DB4291.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4290.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4291.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4295.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4291.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4295; // U129Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4291.DBD 1118; // !!! insert correct SFM !!!
      T     DB5293.DBD  238; 

      SET   ; 
      =     DB5293.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4291.DBD 1118; // !!! insert correct SFM !!!
      T     DB5293.DBD  358; 

      SET   ; 
      =     DB5293.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4291.DBD 1118; // !!! insert correct SFM !!!
      T     DB5293.DBD  478; 

      SET   ; 
      =     DB5293.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U129UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U129UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U129UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U129UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5291.DBX   81.4; 
      =     DB5291.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5291.DBX  141.4; 
      =     DB5291.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5291.DBX  201.4; 
      =     DB5291.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5291.DBX  261.4; 
      =     DB5291.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5297.DBX   80.7; 
      =     DB5297.DBX   81.4; 

      CLR   ; 
      =     DB5297.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5297.DBX  140.7; 
      =     DB5297.DBX  141.4; 

      CLR   ; 
      =     DB5297.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5297.DBX  200.7; 
      =     DB5297.DBX  201.4; 

      CLR   ; 
      =     DB5297.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U129ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5296.DBX  203.2; 
      =     DB5296.DBX  203.5; 

// enable alarm -------------------------
      A     DB5296.DBX  203.5; 
      A     DB5296.DBX  201.4; 
      AN    DB5296.DBX  203.1; 
      AN    DB5296.DBX  203.3; 
      AN    DB5296.DBX  203.4; 
      =     DB5296.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4291.DBD 1118; // !!! insert correct SFM !!!
      T     DB5296.DBD  234; 

// static value to controller ----------
      L     DB4291.DBD 1118; // !!! insert correct SFM !!!
      T     DB5296.DBD  238; 

// process value to controller ----------
      L     DB5293.DBD   26; // !!! insert correct AnI !!!
      T     DB5296.DBD  254; 

// low/high value to controller ---------
      L     DB5293.DBD   30; // !!! insert correct AnI !!!
      T     DB5296.DBD  218; 

      L     DB5293.DBD   34; // !!! insert correct AnI !!!
      T     DB5296.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5293.DBD  146; 
      T     DB4291.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5293.DBD  266; 
      T     DB4291.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5293.DBD  386; 
      T     DB4291.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4293.DBX   43.1; 
      S     DB4293.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5296.DBX  201.4; 
      S     DB5296.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4300
TITLE =U130: Planung Transfer H6F
FAMILY : BOTEC_F1
NAME : U130A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4300.DBW    0; 
      T     #UnitNo; 
      L     DB4300.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5303.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5303.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5303.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5305.unv001,
           ValExt                   := DB5305.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5305.unv002,
           ValExt                   := DB5305.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5305.unv003,
           ValExt                   := DB5305.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5305.unv004,
           ValExt                   := DB5305.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5301.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5301.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5301.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5301.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5307.msg001,
           MsgBit                   := DB5307.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5307.msg002,
           MsgBit                   := DB5307.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5307.msg003,
           MsgBit                   := DB5307.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5306.PID01,
           SpExt                    := DB5306.DBD  234,
           PVal                     := DB5306.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4301
TITLE =U130: Planung Transfer H6F
FAMILY : BOTEC_F1
NAME : U130E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4301.DBX 1357.7; 
      CC    FB  4309; // "U130Sim"
      A     DB4301.DBX   17.3; 
      =     DB4301.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4300.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4301.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4305.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4301.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4305; // U130Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4301.DBD 1118; // !!! insert correct SFM !!!
      T     DB5303.DBD  238; 

      SET   ; 
      =     DB5303.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4301.DBD 1118; // !!! insert correct SFM !!!
      T     DB5303.DBD  358; 

      SET   ; 
      =     DB5303.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4301.DBD 1118; // !!! insert correct SFM !!!
      T     DB5303.DBD  478; 

      SET   ; 
      =     DB5303.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U130UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U130UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U130UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U130UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5301.DBX   81.4; 
      =     DB5301.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5301.DBX  141.4; 
      =     DB5301.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5301.DBX  201.4; 
      =     DB5301.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5301.DBX  261.4; 
      =     DB5301.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5307.DBX   80.7; 
      =     DB5307.DBX   81.4; 

      CLR   ; 
      =     DB5307.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5307.DBX  140.7; 
      =     DB5307.DBX  141.4; 

      CLR   ; 
      =     DB5307.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5307.DBX  200.7; 
      =     DB5307.DBX  201.4; 

      CLR   ; 
      =     DB5307.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U130ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5306.DBX  203.2; 
      =     DB5306.DBX  203.5; 

// enable alarm -------------------------
      A     DB5306.DBX  203.5; 
      A     DB5306.DBX  201.4; 
      AN    DB5306.DBX  203.1; 
      AN    DB5306.DBX  203.3; 
      AN    DB5306.DBX  203.4; 
      =     DB5306.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4301.DBD 1118; // !!! insert correct SFM !!!
      T     DB5306.DBD  234; 

// static value to controller ----------
      L     DB4301.DBD 1118; // !!! insert correct SFM !!!
      T     DB5306.DBD  238; 

// process value to controller ----------
      L     DB5303.DBD   26; // !!! insert correct AnI !!!
      T     DB5306.DBD  254; 

// low/high value to controller ---------
      L     DB5303.DBD   30; // !!! insert correct AnI !!!
      T     DB5306.DBD  218; 

      L     DB5303.DBD   34; // !!! insert correct AnI !!!
      T     DB5306.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5303.DBD  146; 
      T     DB4301.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5303.DBD  266; 
      T     DB4301.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5303.DBD  386; 
      T     DB4301.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4303.DBX   43.1; 
      S     DB4303.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5306.DBX  201.4; 
      S     DB5306.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4310
TITLE =U131: Planung Transfer J6F
FAMILY : BOTEC_F1
NAME : U131A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4310.DBW    0; 
      T     #UnitNo; 
      L     DB4310.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5313.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5313.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5313.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5315.unv001,
           ValExt                   := DB5315.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5315.unv002,
           ValExt                   := DB5315.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5315.unv003,
           ValExt                   := DB5315.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5315.unv004,
           ValExt                   := DB5315.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5311.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5311.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5311.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5311.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5317.msg001,
           MsgBit                   := DB5317.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5317.msg002,
           MsgBit                   := DB5317.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5317.msg003,
           MsgBit                   := DB5317.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5316.PID01,
           SpExt                    := DB5316.DBD  234,
           PVal                     := DB5316.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4311
TITLE =U131: Planung Transfer J6F
FAMILY : BOTEC_F1
NAME : U131E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4311.DBX 1357.7; 
      CC    FB  4319; // "U131Sim"
      A     DB4311.DBX   17.3; 
      =     DB4311.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4310.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4311.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4315.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4311.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4315; // U131Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4311.DBD 1118; // !!! insert correct SFM !!!
      T     DB5313.DBD  238; 

      SET   ; 
      =     DB5313.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4311.DBD 1118; // !!! insert correct SFM !!!
      T     DB5313.DBD  358; 

      SET   ; 
      =     DB5313.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4311.DBD 1118; // !!! insert correct SFM !!!
      T     DB5313.DBD  478; 

      SET   ; 
      =     DB5313.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U131UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U131UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U131UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U131UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5311.DBX   81.4; 
      =     DB5311.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5311.DBX  141.4; 
      =     DB5311.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5311.DBX  201.4; 
      =     DB5311.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5311.DBX  261.4; 
      =     DB5311.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5317.DBX   80.7; 
      =     DB5317.DBX   81.4; 

      CLR   ; 
      =     DB5317.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5317.DBX  140.7; 
      =     DB5317.DBX  141.4; 

      CLR   ; 
      =     DB5317.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5317.DBX  200.7; 
      =     DB5317.DBX  201.4; 

      CLR   ; 
      =     DB5317.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U131ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5316.DBX  203.2; 
      =     DB5316.DBX  203.5; 

// enable alarm -------------------------
      A     DB5316.DBX  203.5; 
      A     DB5316.DBX  201.4; 
      AN    DB5316.DBX  203.1; 
      AN    DB5316.DBX  203.3; 
      AN    DB5316.DBX  203.4; 
      =     DB5316.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4311.DBD 1118; // !!! insert correct SFM !!!
      T     DB5316.DBD  234; 

// static value to controller ----------
      L     DB4311.DBD 1118; // !!! insert correct SFM !!!
      T     DB5316.DBD  238; 

// process value to controller ----------
      L     DB5313.DBD   26; // !!! insert correct AnI !!!
      T     DB5316.DBD  254; 

// low/high value to controller ---------
      L     DB5313.DBD   30; // !!! insert correct AnI !!!
      T     DB5316.DBD  218; 

      L     DB5313.DBD   34; // !!! insert correct AnI !!!
      T     DB5316.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5313.DBD  146; 
      T     DB4311.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5313.DBD  266; 
      T     DB4311.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5313.DBD  386; 
      T     DB4311.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4313.DBX   43.1; 
      S     DB4313.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5316.DBX  201.4; 
      S     DB5316.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4320
TITLE =U132: Planung Transfer L6F
FAMILY : BOTEC_F1
NAME : U132A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4320.DBW    0; 
      T     #UnitNo; 
      L     DB4320.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5323.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5323.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5323.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5325.unv001,
           ValExt                   := DB5325.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5325.unv002,
           ValExt                   := DB5325.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5325.unv003,
           ValExt                   := DB5325.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5325.unv004,
           ValExt                   := DB5325.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5321.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5321.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5321.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5321.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5327.msg001,
           MsgBit                   := DB5327.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5327.msg002,
           MsgBit                   := DB5327.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5327.msg003,
           MsgBit                   := DB5327.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5326.PID01,
           SpExt                    := DB5326.DBD  234,
           PVal                     := DB5326.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4321
TITLE =U132: Planung Transfer L6F
FAMILY : BOTEC_F1
NAME : U132E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4321.DBX 1357.7; 
      CC    FB  4329; // "U132Sim"
      A     DB4321.DBX   17.3; 
      =     DB4321.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4320.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4321.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4325.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4321.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4325; // U132Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4321.DBD 1118; // !!! insert correct SFM !!!
      T     DB5323.DBD  238; 

      SET   ; 
      =     DB5323.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4321.DBD 1118; // !!! insert correct SFM !!!
      T     DB5323.DBD  358; 

      SET   ; 
      =     DB5323.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4321.DBD 1118; // !!! insert correct SFM !!!
      T     DB5323.DBD  478; 

      SET   ; 
      =     DB5323.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U132UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U132UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U132UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U132UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5321.DBX   81.4; 
      =     DB5321.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5321.DBX  141.4; 
      =     DB5321.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5321.DBX  201.4; 
      =     DB5321.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5321.DBX  261.4; 
      =     DB5321.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5327.DBX   80.7; 
      =     DB5327.DBX   81.4; 

      CLR   ; 
      =     DB5327.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5327.DBX  140.7; 
      =     DB5327.DBX  141.4; 

      CLR   ; 
      =     DB5327.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5327.DBX  200.7; 
      =     DB5327.DBX  201.4; 

      CLR   ; 
      =     DB5327.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U132ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5326.DBX  203.2; 
      =     DB5326.DBX  203.5; 

// enable alarm -------------------------
      A     DB5326.DBX  203.5; 
      A     DB5326.DBX  201.4; 
      AN    DB5326.DBX  203.1; 
      AN    DB5326.DBX  203.3; 
      AN    DB5326.DBX  203.4; 
      =     DB5326.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4321.DBD 1118; // !!! insert correct SFM !!!
      T     DB5326.DBD  234; 

// static value to controller ----------
      L     DB4321.DBD 1118; // !!! insert correct SFM !!!
      T     DB5326.DBD  238; 

// process value to controller ----------
      L     DB5323.DBD   26; // !!! insert correct AnI !!!
      T     DB5326.DBD  254; 

// low/high value to controller ---------
      L     DB5323.DBD   30; // !!! insert correct AnI !!!
      T     DB5326.DBD  218; 

      L     DB5323.DBD   34; // !!! insert correct AnI !!!
      T     DB5326.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5323.DBD  146; 
      T     DB4321.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5323.DBD  266; 
      T     DB4321.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5323.DBD  386; 
      T     DB4321.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4323.DBX   43.1; 
      S     DB4323.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5326.DBX  201.4; 
      S     DB5326.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4330
TITLE =U133: Planung Transfer B6
FAMILY : BOTEC_F1
NAME : U133A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4330.DBW    0; 
      T     #UnitNo; 
      L     DB4330.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5333.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5333.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5333.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5335.unv001,
           ValExt                   := DB5335.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5335.unv002,
           ValExt                   := DB5335.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5335.unv003,
           ValExt                   := DB5335.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5335.unv004,
           ValExt                   := DB5335.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5331.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5331.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5331.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5331.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5337.msg001,
           MsgBit                   := DB5337.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5337.msg002,
           MsgBit                   := DB5337.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5337.msg003,
           MsgBit                   := DB5337.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5336.PID01,
           SpExt                    := DB5336.DBD  234,
           PVal                     := DB5336.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4331
TITLE =U133: Planung Transfer B6
FAMILY : BOTEC_F1
NAME : U133E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4331.DBX 1357.7; 
      CC    FB  4339; // "U133Sim"
      A     DB4331.DBX   17.3; 
      =     DB4331.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4330.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4331.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4335.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4331.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4335; // U133Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4331.DBD 1118; // !!! insert correct SFM !!!
      T     DB5333.DBD  238; 

      SET   ; 
      =     DB5333.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4331.DBD 1118; // !!! insert correct SFM !!!
      T     DB5333.DBD  358; 

      SET   ; 
      =     DB5333.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4331.DBD 1118; // !!! insert correct SFM !!!
      T     DB5333.DBD  478; 

      SET   ; 
      =     DB5333.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U133UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U133UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U133UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U133UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5331.DBX   81.4; 
      =     DB5331.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5331.DBX  141.4; 
      =     DB5331.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5331.DBX  201.4; 
      =     DB5331.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5331.DBX  261.4; 
      =     DB5331.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5337.DBX   80.7; 
      =     DB5337.DBX   81.4; 

      CLR   ; 
      =     DB5337.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5337.DBX  140.7; 
      =     DB5337.DBX  141.4; 

      CLR   ; 
      =     DB5337.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5337.DBX  200.7; 
      =     DB5337.DBX  201.4; 

      CLR   ; 
      =     DB5337.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U133ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5336.DBX  203.2; 
      =     DB5336.DBX  203.5; 

// enable alarm -------------------------
      A     DB5336.DBX  203.5; 
      A     DB5336.DBX  201.4; 
      AN    DB5336.DBX  203.1; 
      AN    DB5336.DBX  203.3; 
      AN    DB5336.DBX  203.4; 
      =     DB5336.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4331.DBD 1118; // !!! insert correct SFM !!!
      T     DB5336.DBD  234; 

// static value to controller ----------
      L     DB4331.DBD 1118; // !!! insert correct SFM !!!
      T     DB5336.DBD  238; 

// process value to controller ----------
      L     DB5333.DBD   26; // !!! insert correct AnI !!!
      T     DB5336.DBD  254; 

// low/high value to controller ---------
      L     DB5333.DBD   30; // !!! insert correct AnI !!!
      T     DB5336.DBD  218; 

      L     DB5333.DBD   34; // !!! insert correct AnI !!!
      T     DB5336.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5333.DBD  146; 
      T     DB4331.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5333.DBD  266; 
      T     DB4331.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5333.DBD  386; 
      T     DB4331.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4333.DBX   43.1; 
      S     DB4333.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5336.DBX  201.4; 
      S     DB5336.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4340
TITLE =U134: Planung Transfer D6
FAMILY : BOTEC_F1
NAME : U134A
VERSION : 2.1


VAR_TEMP
  EStopOK : BOOL ;	//auxiliary flag
  CIP : BOOL ;	//CIP Program Selected
  xTmp : BOOL ;	//Temporary Bool(free for general use)
  DummyBool : BOOL ;	//Temporary Bool(free for general use)
  UnitNo : INT ;	//unit number
  UnitFB : INT ;	//unit expansion FB number
  rTmp : REAL ;	//Temporary REAL (free for general use)
  iTmp : INT ;	//Temporary INT (free for general use)
  DummyInt : INT ;	//Temporary INT (free for general use)
  dTmp : DINT ;	//Temporary DINT (free for general use)
END_VAR
BEGIN
NETWORK
TITLE =general

      CLR   ; 
      =     #xTmp; 
      =     #EStopOK; 

      L     DB4340.DBW    0; 
      T     #UnitNo; 
      L     DB4340.DBW    2; 
      T     #UnitFB; 

NETWORK
TITLE =analog inputs 

      NOP   0; 
// C_AnI01 AnI 001 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5343.C_AnI01,
           ValPer                   := #DummyInt);

// C_AnI002 AnI 002 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5343.C_AnI002,
           ValPer                   := #DummyInt);

// AnI03 AnI 003 spare
      CALL FC    24 (
           UnitNo                   := #UnitNo,
           AnIRec                   := DB5343.AnI03,
           ValPer                   := #DummyInt);

NETWORK
TITLE =Universal value 

      NOP   0; 
// unv001 UnV 001 Process Status
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5345.unv001,
           ValExt                   := DB5345.DBD  234);

// unv002 UnV 002 Universal Value 02
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5345.unv002,
           ValExt                   := DB5345.DBD  362);

// unv003 UnV 003 Druck Sollwert
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5345.unv003,
           ValExt                   := DB5345.DBD  490);

// unv004 UnV 004 Universal Value 04
      CALL FC    27 (
           UnitNo                   := #UnitNo,
           UnVRec                   := DB5345.unv004,
           ValExt                   := DB5345.DBD  618);

NETWORK
TITLE =special inputs 

      NOP   0; 
// SpI01 SpI 001 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5341.SpI01,
           SpIBit                   := #DummyBool);

// SpI02 SpI 002 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5341.SpI02,
           SpIBit                   := #DummyBool);

// SpI03 SpI 003 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5341.SpI03,
           SpIBit                   := #DummyBool);

// SpI04 SpI 004 spare
      CALL FC    14 (
           UnitNo                   := #UnitNo,
           SpIRec                   := DB5341.SpI04,
           SpIBit                   := #DummyBool);

NETWORK
TITLE =messages 

      NOP   0; 
// msg001 Msg 001 Message 01
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5347.msg001,
           MsgBit                   := DB5347.DBX   82.7);

// msg002 Msg 002 Message 02
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5347.msg002,
           MsgBit                   := DB5347.DBX  142.7);

// msg003 Msg 003 Message 03
      CALL FC    16 (
           UnitNo                   := #UnitNo,
           MsgRec                   := DB5347.msg003,
           MsgBit                   := DB5347.DBX  202.7);

NETWORK
TITLE =controllers 

      NOP   0; 
// PID01 PID 001 spare
      CALL FC    55 (
           UnitNo                   := #UnitNo,
           PIDRec                   := DB5346.PID01,
           SpExt                    := DB5346.DBD  234,
           PVal                     := DB5346.DBD  254,
           OPer                     := #DummyInt);

NETWORK
TITLE =unit supply

      UC    FB [#UnitFB]; 
END_FUNCTION_BLOCK

FUNCTION_BLOCK FB 4341
TITLE =U134: Planung Transfer D6
FAMILY : BOTEC_F1
NAME : U134E
VERSION : 1.2


VAR_TEMP
  CIP : BOOL ;	//CIP active
  UNIM : BOOL ;	//Unit Not In Maintenance
  GenRel : BOOL ;	//general OK (emergency and maintenance OK)
  EStopOK : BOOL ;	//emergency OK
  UnitNo : INT ;	//unit number 
  xTmp : BOOL ;	//Temporary Bool 
  iTmp : INT ;	//Temporary INT 
  rTmp : REAL ;	//Temporary REAL
  dTmp : DINT ;	//Temporary DINT (free for general use)
  RetValInt : INT ;	//return value
END_VAR
BEGIN
NETWORK
TITLE =General

      SET   ; 
// Simulation ---------------------------------------------------------------
      A     DB4341.DBX 1357.7; 
      CC    FB  4349; // "U134Sim"
      A     DB4341.DBX   17.3; 
      =     DB4341.DBX 1357.7; //Help bit for simulation

// get unit number ----------------------------------------------------------
      L     DB4340.DBW    0; 
      T     #UnitNo; 

// CIP ----------------------------------------------------------------------
      L     DB4341.DBD   54; 
      L     0; 
      <D    ; 
      =     #CIP; 

// emergency OK -------------------------------------------------------------
      A     DB4345.DBX   27.0; //Emergency Stop OK
      =     #EStopOK; 

// Write Unit in Maintenance ------------------------------------------------

      AN    DB4341.DBX   69.7; 
      =     #UNIM; 

// emergency and maintenance OK ---------------------------------------------
      A     #EStopOK; 
      A     #UNIM; 
      =     #GenRel; 

// communication ------------------------------------------------------------
      UC    FB  4345; // U134Com

NETWORK
TITLE =Analog Inputs

      NOP   0; 

// ----------------------------------------------------------
// C_AnI01 spare
// ----------------------------------------------------------
      L     DB4341.DBD 1118; // !!! insert correct SFM !!!
      T     DB5343.DBD  238; 

      SET   ; 
      =     DB5343.DBX  141.5; 

// ----------------------------------------------------------
// C_AnI002 spare
// ----------------------------------------------------------
      L     DB4341.DBD 1118; // !!! insert correct SFM !!!
      T     DB5343.DBD  358; 

      SET   ; 
      =     DB5343.DBX  261.5; 

// ----------------------------------------------------------
// AnI03 spare
// ----------------------------------------------------------
      L     DB4341.DBD 1118; // !!! insert correct SFM !!!
      T     DB5343.DBD  478; 

      SET   ; 
      =     DB5343.DBX  381.5; 

NETWORK
TITLE =Universal Value

      NOP   0; 

// ----------------------------------------------------------
// unv001 Process Status
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U134UnVD".unv001.ValExt

// ----------------------------------------------------------
// unv002 Universal Value 02
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U134UnVD".unv002.ValExt

// ----------------------------------------------------------
// unv003 Druck Sollwert
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U134UnVD".unv003.ValExt

// ----------------------------------------------------------
// unv004 Universal Value 04
// ----------------------------------------------------------
// process value to UnV
//      L     0.000000e+000 
//      T     "U134UnVD".unv004.ValExt

NETWORK
TITLE =Special Input

      NOP   0; 

// ----------------------------------------------------------
// SpI01 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5341.DBX   81.4; 
      =     DB5341.DBX   81.5; 

// ----------------------------------------------------------
// SpI02 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5341.DBX  141.4; 
      =     DB5341.DBX  141.5; 

// ----------------------------------------------------------
// SpI03 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5341.DBX  201.4; 
      =     DB5341.DBX  201.5; 

// ----------------------------------------------------------
// SpI04 spare
// ----------------------------------------------------------
      SET   ; 
      =     DB5341.DBX  261.4; 
      =     DB5341.DBX  261.5; 

NETWORK
TITLE =Messages 

      NOP   0; 

// ----------------------------------------------------------
// msg001 Message 01
// ----------------------------------------------------------
      SET   ; 
      R     DB5347.DBX   80.7; 
      =     DB5347.DBX   81.4; 

      CLR   ; 
      =     DB5347.DBX   82.7; 

// ----------------------------------------------------------
// msg002 Message 02
// ----------------------------------------------------------
      SET   ; 
      R     DB5347.DBX  140.7; 
      =     DB5347.DBX  141.4; 

      CLR   ; 
      =     DB5347.DBX  142.7; 

// ----------------------------------------------------------
// msg003 Message 03
// ----------------------------------------------------------
      SET   ; 
      R     DB5347.DBX  200.7; 
      =     DB5347.DBX  201.4; 

      CLR   ; 
      =     DB5347.DBX  202.7; 

NETWORK
TITLE =PID controller

      NOP   0; 

// ----------------------------------------------------------
// PID01 spare
// ----------------------------------------------------------
// starting value -----------------------
//A     "U134ActD".Act.OutI // !!! insert correct Act !!!
      A     #GenRel; 
      CLR   ; 
      =     DB5346.DBX  203.2; 
      =     DB5346.DBX  203.5; 

// enable alarm -------------------------
      A     DB5346.DBX  203.5; 
      A     DB5346.DBX  201.4; 
      AN    DB5346.DBX  203.1; 
      AN    DB5346.DBX  203.3; 
      AN    DB5346.DBX  203.4; 
      =     DB5346.DBX  203.0; 

// setpoint to controller ---------------
      L     DB4341.DBD 1118; // !!! insert correct SFM !!!
      T     DB5346.DBD  234; 

// static value to controller ----------
      L     DB4341.DBD 1118; // !!! insert correct SFM !!!
      T     DB5346.DBD  238; 

// process value to controller ----------
      L     DB5343.DBD   26; // !!! insert correct AnI !!!
      T     DB5346.DBD  254; 

// low/high value to controller ---------
      L     DB5343.DBD   30; // !!! insert correct AnI !!!
      T     DB5346.DBD  218; 

      L     DB5343.DBD   34; // !!! insert correct AnI !!!
      T     DB5346.DBD  222; 

NETWORK
TITLE =Sequence organisation

      CLR   ; 
      =     M    122.2; 

// SFM supply ----------------------------------------------------------------

// analog value to SFM spare -----------------------
      L     DB5343.DBD  146; 
      T     DB4341.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5343.DBD  266; 
      T     DB4341.DBD 1122; // !!! insert correct SFM !!!

// analog value to SFM spare -----------------------
      L     DB5343.DBD  386; 
      T     DB4341.DBD 1122; // !!! insert correct SFM !!!

// sequencer ----------------------------------------------------------------
      A     DB4343.DBX   43.1; 
      S     DB4343.DBX   97.3; 

      CALL FC    40 (
           UnitNo                   := #UnitNo);

NETWORK
TITLE =Auto / Manual

      SET   ; 
      AN    M    122.2; 
      JC    MODE; 
      AN    M    120.1; 


// assign PID mode
      S     DB5346.DBX  201.4; 
      S     DB5346.DBX  201.5; 


MODE: SET   ; 

END_FUNCTION_BLOCK

